var t,e,i,a,r,n,o,s,l,h,c=globalThis;function u(t){return t&&t.__esModule?t.default:t}function d(t){Object.defineProperty(t,"__esModule",{value:!0,configurable:!0})}function p(t,e,i,a){Object.defineProperty(t,e,{get:i,set:a,enumerable:!0,configurable:!0})}var y={},m={},f=c.parcelRequire32f6;null==f&&((f=function(t){if(t in y)return y[t].exports;if(t in m){var e=m[t];delete m[t];var i={id:t,exports:{}};return y[t]=i,e.call(i.exports,i,i.exports),i.exports}var a=Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){m[t]=e},c.parcelRequire32f6=f);var g=f.register;g("lNdKa",function(t,e){var i=f("fNJVo"),a=e&&!e.nodeType&&e,r=a&&t&&!t.nodeType&&t,n=r&&r.exports===a?i.Buffer:void 0,o=n?n.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var i=t.length,a=o?o(i):new t.constructor(i);return t.copy(a),a}}),g("fNJVo",function(t,e){var i=f("akAE7"),a="object"==typeof self&&self&&self.Object===Object&&self,r=i||a||Function("return this")();t.exports=r}),g("akAE7",function(t,e){var i="object"==typeof c&&c&&c.Object===Object&&c;t.exports=i}),g("2W9As",function(t,e){var i=f("fNJVo"),a=f("36p3q"),r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?i.Buffer:void 0,s=o?o.isBuffer:void 0;t.exports=s||a}),g("36p3q",function(t,e){t.exports=function(){return!1}}),g("74qZ6",function(t,e){var i=f("akAE7"),a=e&&!e.nodeType&&e,r=a&&t&&!t.nodeType&&t,n=r&&r.exports===a&&i.process,o=function(){try{var t=r&&r.require&&r.require("util").types;if(t)return t;return n&&n.binding&&n.binding("util")}catch(t){}}();t.exports=o}),g("lQT0x",function(t,e){!function(){var e=Math.abs,i=Math.min,a=Math.max,r=Math.cos,n=Math.sin,o=Math.acos,s=Math.sqrt,l=Math.PI,h={x:0,y:0,z:0},c=f("asPPo"),u=f("9L27D"),d=function(t){var i=t&&t.forEach?t:[].slice.call(arguments),a=!1;if("object"==typeof i[0]){a=i.length;var r=[];i.forEach(function(t){["x","y","z"].forEach(function(e){void 0!==t[e]&&r.push(t[e])})}),i=r}var n=!1,o=i.length;if(a){if(a>4){if(1!=arguments.length)throw Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");n=!0}}else if(6!==o&&8!==o&&9!==o&&12!==o&&1!=arguments.length)throw Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var s=!n&&(9===o||12===o)||t&&t[0]&&void 0!==t[0].z;this._3d=s;for(var l=[],h=0,u=s?3:2;h<o;h+=u){var d={x:i[h],y:i[h+1]};s&&(d.z=i[h+2]),l.push(d)}this.order=l.length-1,this.points=l;var p=["x","y"];s&&p.push("z"),this.dims=p,this.dimlen=p.length,function(t){for(var i=t.order,a=t.points,r=c.align(a,{p1:a[0],p2:a[i]}),n=0;n<r.length;n++)if(e(r[n].y)>1e-4){t._linear=!1;return}t._linear=!0}(this),this._t1=0,this._t2=1,this.update()},p=f("71caD");function y(t,e,i,a,r){void 0===r&&(r=.5);var n=c.projectionratio(r,t),o=1-n,s={x:n*e.x+o*a.x,y:n*e.y+o*a.y},l=c.abcratio(r,t);return{A:{x:i.x+(i.x-s.x)/l,y:i.y+(i.y-s.y)/l},B:i,C:s}}d.SVGtoBeziers=function(t){return p(d,t)},d.quadraticFromPoints=function(t,e,i,a){if(void 0===a&&(a=.5),0===a)return new d(e,e,i);if(1===a)return new d(t,e,e);var r=y(2,t,e,i,a);return new d(t,r.A,i)},d.cubicFromPoints=function(t,e,i,a,r){void 0===a&&(a=.5);var n=y(3,t,e,i,a);void 0===r&&(r=c.dist(e,n.C));var o=r*(1-a)/a,s=c.dist(t,i),l=(i.x-t.x)/s,h=(i.y-t.y)/s,u=r*l,p=r*h,m={x:e.x-u,y:e.y-p},f={x:e.x+o*l,y:e.y+o*h},g=n.A,v={x:g.x+(m.x-g.x)/(1-a),y:g.y+(m.y-g.y)/(1-a)},w={x:g.x+(f.x-g.x)/a,y:g.y+(f.y-g.y)/a},x={x:t.x+(v.x-t.x)/a,y:t.y+(v.y-t.y)/a};return new d(t,x,{x:i.x+(w.x-i.x)/(1-a),y:i.y+(w.y-i.y)/(1-a)},i)};var m=function(){return c};d.getUtils=m,d.PolyBezier=u,d.prototype={getUtils:m,valueOf:function(){return this.toString()},toString:function(){return c.pointsToString(this.points)},toSVG:function(t){if(this._3d)return!1;for(var e=this.points,i=["M",e[0].x,e[0].y,2===this.order?"Q":"C"],a=1,r=e.length;a<r;a++)i.push(e[a].x),i.push(e[a].y);return i.join(" ")},setRatios:function(t){if(t.length!==this.points.length)throw Error("incorrect number of ratio values");this.ratios=t,this._lut=[]},verify:function(){var t=this.coordDigest();t!==this._print&&(this._print=t,this.update())},coordDigest:function(){return this.points.map(function(t,e){return""+e+t.x+t.y+(t.z?t.z:0)}).join("")},update:function(t){this._lut=[],this.dpoints=c.derive(this.points,this._3d),this.computedirection()},computedirection:function(){var t=this.points,e=c.angle(t[0],t[this.order],t[1]);this.clockwise=e>0},length:function(){return c.length(this.derivative.bind(this))},_lut:[],getLUT:function(t){if(this.verify(),t=t||100,this._lut.length===t)return this._lut;this._lut=[],t--;for(var e=0;e<=t;e++)this._lut.push(this.compute(e/t));return this._lut},on:function(t,e){e=e||5;for(var i,a=this.getLUT(),r=[],n=0,o=0;o<a.length;o++)i=a[o],c.dist(i,t)<e&&(r.push(i),n+=o/a.length);return!!r.length&&n/r.length},project:function(t){var e,i,a,r,n=this.getLUT(),o=n.length-1,s=c.closest(n,t),l=s.mdist,h=s.mpos,u=(h-1)/o,d=(h+1)/o,p=.1/o;for(l+=1,e=i=u;i<d+p;i+=p)a=this.compute(i),(r=c.dist(t,a))<l&&(l=r,e=i);return(a=this.compute(e)).t=e,a.d=l,a},get:function(t){return this.compute(t)},point:function(t){return this.points[t]},compute:function(t){return this.ratios?c.computeWithRatios(t,this.points,this.ratios,this._3d):c.compute(t,this.points,this._3d,this.ratios)},raise:function(){for(var t,e,i,a=this.points,r=[a[0]],n=a.length,t=1;t<n;t++)e=a[t],i=a[t-1],r[t]={x:(n-t)/n*e.x+t/n*i.x,y:(n-t)/n*e.y+t/n*i.y};return r[n]=a[n-1],new d(r)},derivative:function(t){var e,i,a=1-t,r=0,n=this.dpoints[0];2===this.order&&(n=[n[0],n[1],h],e=a,i=t),3===this.order&&(e=a*a,i=a*t*2,r=t*t);var o={x:e*n[0].x+i*n[1].x+r*n[2].x,y:e*n[0].y+i*n[1].y+r*n[2].y};return this._3d&&(o.z=e*n[0].z+i*n[1].z+r*n[2].z),o},curvature:function(t){return c.curvature(t,this.points,this._3d)},inflections:function(){return c.inflections(this.points)},normal:function(t){return this._3d?this.__normal3(t):this.__normal2(t)},__normal2:function(t){var e=this.derivative(t),i=s(e.x*e.x+e.y*e.y);return{x:-e.y/i,y:e.x/i}},__normal3:function(t){var e=this.derivative(t),i=this.derivative(t+.01),a=s(e.x*e.x+e.y*e.y+e.z*e.z),r=s(i.x*i.x+i.y*i.y+i.z*i.z);e.x/=a,e.y/=a,e.z/=a,i.x/=r,i.y/=r,i.z/=r;var n={x:i.y*e.z-i.z*e.y,y:i.z*e.x-i.x*e.z,z:i.x*e.y-i.y*e.x},o=s(n.x*n.x+n.y*n.y+n.z*n.z);n.x/=o,n.y/=o,n.z/=o;var l=[n.x*n.x,n.x*n.y-n.z,n.x*n.z+n.y,n.x*n.y+n.z,n.y*n.y,n.y*n.z-n.x,n.x*n.z-n.y,n.y*n.z+n.x,n.z*n.z];return{x:l[0]*e.x+l[1]*e.y+l[2]*e.z,y:l[3]*e.x+l[4]*e.y+l[5]*e.z,z:l[6]*e.x+l[7]*e.y+l[8]*e.z}},hull:function(t){var e,i=this.points,a=[],r=[],n=0,o=0,s=0;for(r[n++]=i[0],r[n++]=i[1],r[n++]=i[2],3===this.order&&(r[n++]=i[3]);i.length>1;){for(o=0,a=[],s=i.length-1;o<s;o++)e=c.lerp(t,i[o],i[o+1]),r[n++]=e,a.push(e);i=a}return r},split:function(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;var i=this.hull(t),a={left:new d(2===this.order?[i[0],i[3],i[5]]:[i[0],i[4],i[7],i[9]]),right:new d(2===this.order?[i[5],i[4],i[2]]:[i[9],i[8],i[6],i[3]]),span:i};return(a.left._t1=c.map(0,0,1,this._t1,this._t2),a.left._t2=c.map(t,0,1,this._t1,this._t2),a.right._t1=c.map(t,0,1,this._t1,this._t2),a.right._t2=c.map(1,0,1,this._t1,this._t2),e)?(e=c.map(e,t,1,0,1),a.right.split(e).left):a},extrema:function(){var t,e,i=this.dims,a={},r=[];return i.forEach((function(i){e=function(t){return t[i]},t=this.dpoints[0].map(e),a[i]=c.droots(t),3===this.order&&(t=this.dpoints[1].map(e),a[i]=a[i].concat(c.droots(t))),a[i]=a[i].filter(function(t){return t>=0&&t<=1}),r=r.concat(a[i].sort(c.numberSort))}).bind(this)),r=r.sort(c.numberSort).filter(function(t,e){return r.indexOf(t)===e}),a.values=r,a},bbox:function(){var t=this.extrema(),e={};return this.dims.forEach((function(i){e[i]=c.getminmax(this,i,t[i])}).bind(this)),e},overlaps:function(t){var e=this.bbox(),i=t.bbox();return c.bboxoverlap(e,i)},offset:function(t,e){if(void 0!==e){var i=this.get(t),a=this.normal(t),r={c:i,n:a,x:i.x+a.x*e,y:i.y+a.y*e};return this._3d&&(r.z=i.z+a.z*e),r}if(this._linear){var n=this.normal(0);return[new d(this.points.map(function(e){var i={x:e.x+t*n.x,y:e.y+t*n.y};return e.z&&a.z&&(i.z=e.z+t*n.z),i}))]}return this.reduce().map(function(e){return e._linear?e.offset(t)[0]:e.scale(t)})},simple:function(){if(3===this.order){var t=c.angle(this.points[0],this.points[3],this.points[1]),i=c.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&i<0||t<0&&i>0)return!1}var a=this.normal(0),r=this.normal(1),n=a.x*r.x+a.y*r.y;return this._3d&&(n+=a.z*r.z),e(o(n))<l/3},reduce:function(){var t,i,a=0,r=0,n=[],o=[],s=this.extrema().values;for(-1===s.indexOf(0)&&(s=[0].concat(s)),-1===s.indexOf(1)&&s.push(1),a=s[0],t=1;t<s.length;t++)r=s[t],(i=this.split(a,r))._t1=a,i._t2=r,n.push(i),a=r;return n.forEach(function(t){for(a=0,r=0;r<=1;)for(r=a+.01;r<=1.01;r+=.01)if(!(i=t.split(a,r)).simple()){if(r-=.01,.01>e(a-r))return[];(i=t.split(a,r))._t1=c.map(a,0,1,t._t1,t._t2),i._t2=c.map(r,0,1,t._t1,t._t2),o.push(i),a=r;break}a<1&&((i=t.split(a,1))._t1=c.map(a,0,1,t._t1,t._t2),i._t2=t._t2,o.push(i))}),o},scale:function(t){var e=this.order,i=!1;if("function"==typeof t&&(i=t),i&&2===e)return this.raise().scale(i);var a=this.clockwise,r=i?i(0):t,n=i?i(1):t,o=[this.offset(0,10),this.offset(1,10)],l=c.lli4(o[0],o[0].c,o[1],o[1].c);if(!l)throw Error("cannot scale this curve. Try reducing it first.");var h=this.points,u=[];return([0,1].forEach((function(t){var i=u[t*e]=c.copy(h[t*e]);i.x+=(t?n:r)*o[t].n.x,i.y+=(t?n:r)*o[t].n.y}).bind(this)),i)?[0,1].forEach((function(r){if(2!==this.order||!r){var n=h[r+1],o={x:n.x-l.x,y:n.y-l.y},c=i?i((r+1)/e):t;i&&!a&&(c=-c);var d=s(o.x*o.x+o.y*o.y);o.x/=d,o.y/=d,u[r+1]={x:n.x+c*o.x,y:n.y+c*o.y}}}).bind(this)):[0,1].forEach((function(t){if(2!==this.order||!t){var i=u[t*e],a=this.derivative(t),r={x:i.x+a.x,y:i.y+a.y};u[t+1]=c.lli4(i,r,l,h[t+1])}}).bind(this)),new d(u)},outline:function(t,e,i,a){e=void 0===e?t:e;var r,n=this.reduce(),o=n.length,s=[],l=[],h=0,d=this.length(),p=void 0!==i&&void 0!==a;function y(t,e,i,a,r){return function(n){var o=e-t;return c.map(n,0,1,t+a/i*o,t+(a+r)/i*o)}}n.forEach(function(r){b=r.length(),p?(s.push(r.scale(y(t,i,d,h,b))),l.push(r.scale(y(-e,-a,d,h,b)))):(s.push(r.scale(t)),l.push(r.scale(-e))),h+=b}),l=l.map(function(t){return(r=t.points)[3]?t.points=[r[3],r[2],r[1],r[0]]:t.points=[r[2],r[1],r[0]],t}).reverse();var m=s[0].points[0],f=s[o-1].points[s[o-1].points.length-1],g=l[o-1].points[l[o-1].points.length-1],v=l[0].points[0],w=c.makeline(g,m),x=c.makeline(f,v),_=[w].concat(s).concat([x]).concat(l),b=_.length;return new u(_)},outlineshapes:function(t,e,i){e=e||t;for(var a=this.outline(t,e).curves,r=[],n=1,o=a.length;n<o/2;n++){var s=c.makeshape(a[n],a[o-n],i);s.startcap.virtual=n>1,s.endcap.virtual=n<o/2-1,r.push(s)}return r},intersects:function(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof d&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)},lineIntersects:function(t){var e=i(t.p1.x,t.p2.x),r=i(t.p1.y,t.p2.y),n=a(t.p1.x,t.p2.x),o=a(t.p1.y,t.p2.y),s=this;return c.roots(this.points,t).filter(function(t){var i=s.get(t);return c.between(i.x,e,n)&&c.between(i.y,r,o)})},selfintersects:function(t){var e,i,a,r,n=this.reduce(),o=n.length-2,s=[];for(e=0;e<o;e++)a=n.slice(e,e+1),r=n.slice(e+2),i=this.curveintersects(a,r,t),s=s.concat(i);return s},curveintersects:function(t,e,i){var a=[];t.forEach(function(t){e.forEach(function(e){t.overlaps(e)&&a.push({left:t,right:e})})});var r=[];return a.forEach(function(t){var e=c.pairiteration(t.left,t.right,i);e.length>0&&(r=r.concat(e))}),r},arcs:function(t){return t=t||.5,this._iterate(t,[])},_error:function(t,i,a,r){var n=(r-a)/4,o=this.get(a+n),s=this.get(r-n),l=c.dist(t,i),h=c.dist(t,o),u=c.dist(t,s);return e(h-l)+e(u-l)},_iterate:function(t,e){var i,a=0,o=1;do{i=0,o=1;var s,l,h,u,d,p=this.get(a),y=!1,m=!1,f=o,g=1;do if(m=y,u=h,f=(a+o)/2,s=this.get(f),l=this.get(o),(h=c.getccenter(p,s,l)).interval={start:a,end:o},y=this._error(h,p,a,o)<=t,(d=m&&!y)||(g=o),y){if(o>=1){if(h.interval.end=g=1,u=h,o>1){var v={x:h.x+h.r*r(h.e),y:h.y+h.r*n(h.e)};h.e+=c.angle({x:h.x,y:h.y},v,this.get(1))}break}o+=(o-a)/2}else o=f;while(!d&&i++<100)if(i>=100)break;u=u||h,e.push(u),a=g}while(o<1)return e}},t.exports=d}()}),g("asPPo",function(t,e){var i,a,r,n,o,s,l,h,c,u,d,p,y,m,g;i=Math.abs,a=Math.cos,r=Math.sin,n=Math.acos,o=Math.atan2,s=Math.sqrt,l=Math.pow,h=function(t){return t<0?-l(-t,1/3):l(t,1/3)},u=2*(c=Math.PI),d=c/2,p=Number.MAX_SAFE_INTEGER||9007199254740991,y=Number.MIN_SAFE_INTEGER||-9007199254740991,m={x:0,y:0,z:0},g={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){var i=e(t),a=i.x*i.x+i.y*i.y;return void 0!==i.z&&(a+=i.z*i.z),s(a)},compute:function(t,e,i){if(0===t)return e[0];var a=e.length-1;if(1===t)return e[a];var r=e,n=1-t;if(0===a)return e[0];if(1===a)return d={x:n*r[0].x+t*r[1].x,y:n*r[0].y+t*r[1].y},i&&(d.z=n*r[0].z+t*r[1].z),d;if(a<4){var o,s,l,h=n*n,c=t*t,u=0;2===a?(r=[r[0],r[1],r[2],m],o=h,s=n*t*2,l=c):3===a&&(o=h*n,s=h*t*3,l=n*c*3,u=t*c);var d={x:o*r[0].x+s*r[1].x+l*r[2].x+u*r[3].x,y:o*r[0].y+s*r[1].y+l*r[2].y+u*r[3].y};return i&&(d.z=o*r[0].z+s*r[1].z+l*r[2].z+u*r[3].z),d}for(var p=JSON.parse(JSON.stringify(e));p.length>1;){for(var y=0;y<p.length-1;y++)p[y]={x:p[y].x+(p[y+1].x-p[y].x)*t,y:p[y].y+(p[y+1].y-p[y].y)*t},void 0!==p[y].z&&(p[y]=p[y].z+(p[y+1].z-p[y].z)*t);p.splice(p.length-1,1)}return p[0]},computeWithRatios:function(t,e,i,a){var r,n=1-t,o=i[0],s=i[1],l=i[2],h=i[3];return(o*=n,s*=t,2===e.length)?(r=o+s,{x:(o*e[0].x+s*e[1].x)/r,y:(o*e[0].y+s*e[1].y)/r,z:!!a&&(o*e[0].z+s*e[1].z)/r}):(o*=n,s*=2*n,l*=t*t,3===e.length)?(r=o+s+l,{x:(o*e[0].x+s*e[1].x+l*e[2].x)/r,y:(o*e[0].y+s*e[1].y+l*e[2].y)/r,z:!!a&&(o*e[0].z+s*e[1].z+l*e[2].z)/r}):(o*=n,s*=1.5*n,l*=3*n,h*=t*t*t,4===e.length)?(r=o+s+l+h,{x:(o*e[0].x+s*e[1].x+l*e[2].x+h*e[3].x)/r,y:(o*e[0].y+s*e[1].y+l*e[2].y+h*e[3].y)/r,z:!!a&&(o*e[0].z+s*e[1].z+l*e[2].z+h*e[3].z)/r}):void 0},derive:function(t,e){for(var i=[],a=t,r=a.length,n=r-1;r>1;r--,n--){for(var o,s=[],l=0;l<n;l++)o={x:n*(a[l+1].x-a[l].x),y:n*(a[l+1].y-a[l].y)},e&&(o.z=n*(a[l+1].z-a[l].z)),s.push(o);i.push(s),a=s}return i},between:function(t,e,i){return e<=t&&t<=i||g.approximately(t,e)||g.approximately(t,i)},approximately:function(t,e,a){return i(t-e)<=(a||1e-6)},length:function(t){var e,i,a=0,r=g.Tvalues.length;for(e=0;e<r;e++)i=.5*g.Tvalues[e]+.5,a+=g.Cvalues[e]*g.arcfn(i,t);return .5*a},map:function(t,e,i,a,r){return a+(t-e)/(i-e)*(r-a)},lerp:function(t,e,i){var a={x:e.x+t*(i.x-e.x),y:e.y+t*(i.y-e.y)};return e.z&&i.z&&(a.z=e.z+t*(i.z-e.z)),a},pointToString:function(t){var e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(g.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,i){var a=e.x-t.x,r=e.y-t.y,n=i.x-t.x,s=i.y-t.y;return o(a*s-r*n,a*n+r*s)},round:function(t,e){var i=""+t,a=i.indexOf(".");return parseFloat(i.substring(0,a+1+e))},dist:function(t,e){var i=t.x-e.x,a=t.y-e.y;return s(i*i+a*a)},closest:function(t,e){var i,a,r=l(2,63);return t.forEach(function(t,n){(a=g.dist(e,t))<r&&(r=a,i=n)}),{mdist:r,mpos:i}},abcratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var a=l(t,e)+l(1-t,e);return i((a-1)/a)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var i=l(1-t,e),a=l(t,e)+i;return i/a},lli8:function(t,e,i,a,r,n,o,s){var l=(t-i)*(n-s)-(e-a)*(r-o);return 0!=l&&{x:((t*a-e*i)*(r-o)-(t-i)*(r*s-n*o))/l,y:((t*a-e*i)*(n-s)-(e-a)*(r*s-n*o))/l}},lli4:function(t,e,i,a){var r=t.x,n=t.y,o=e.x,s=e.y,l=i.x,h=i.y,c=a.x,u=a.y;return g.lli8(r,n,o,s,l,h,c,u)},lli:function(t,e){return g.lli4(t,t.c,e,e.c)},makeline:function(t,e){var i=f("lQT0x"),a=t.x,r=t.y,n=e.x,o=e.y,s=(n-a)/3,l=(o-r)/3;return new i(a,r,a+s,r+l,a+2*s,r+2*l,n,o)},findbbox:function(t){var e=p,i=p,a=y,r=y;return t.forEach(function(t){var n=t.bbox();e>n.x.min&&(e=n.x.min),i>n.y.min&&(i=n.y.min),a<n.x.max&&(a=n.x.max),r<n.y.max&&(r=n.y.max)}),{x:{min:e,mid:(e+a)/2,max:a,size:a-e},y:{min:i,mid:(i+r)/2,max:r,size:r-i}}},shapeintersections:function(t,e,i,a,r){if(!g.bboxoverlap(e,a))return[];var n=[],o=[t.startcap,t.forward,t.back,t.endcap],s=[i.startcap,i.forward,i.back,i.endcap];return o.forEach(function(e){e.virtual||s.forEach(function(a){if(!a.virtual){var o=e.intersects(a,r);o.length>0&&(o.c1=e,o.c2=a,o.s1=t,o.s2=i,n.push(o))}})}),n},makeshape:function(t,e,i){var a=e.points.length,r=t.points.length,n=g.makeline(e.points[a-1],t.points[0]),o=g.makeline(t.points[r-1],e.points[0]),s={startcap:n,forward:t,back:e,endcap:o,bbox:g.findbbox([n,t,e,o])};return s.intersections=function(t){return g.shapeintersections(s,s.bbox,t,t.bbox,i)},s},getminmax:function(t,e,i){if(!i)return{min:0,max:0};var a,r,n=p,o=y;-1===i.indexOf(0)&&(i=[0].concat(i)),-1===i.indexOf(1)&&i.push(1);for(var s=0,l=i.length;s<l;s++)a=i[s],(r=t.get(a))[e]<n&&(n=r[e]),r[e]>o&&(o=r[e]);return{min:n,mid:(n+o)/2,max:o,size:o-n}},align:function(t,e){var i=e.p1.x,n=e.p1.y,s=-o(e.p2.y-n,e.p2.x-i);return t.map(function(t){return{x:(t.x-i)*a(s)-(t.y-n)*r(s),y:(t.x-i)*r(s)+(t.y-n)*a(s)}})},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};var i=t.length-1,r=g.align(t,e),o=function(t){return 0<=t&&t<=1};if(2===i){var l=r[0].y,c=r[1].y,d=r[2].y,p=l-2*c+d;if(0!==p){var y=-s(c*c-l*d),m=-l+c,f=-(y+m)/p;return[f,-(-y+m)/p].filter(o)}return c!==d&&0===p?[(2*c-d)/(2*c-2*d)].filter(o):[]}var v=r[0].y,w=r[1].y,x=r[2].y,p=-v+3*w-3*x+r[3].y,l=3*v-6*w+3*x,c=-3*v+3*w,d=v;if(g.approximately(p,0)){if(g.approximately(l,0))return g.approximately(c,0)?[]:[-d/c].filter(o);var _=s(c*c-4*l*d),b=2*l;return[(_-c)/b,(-c-_)/b].filter(o)}l/=p;var S,f,C,k,r=(3*(c/=p)-l*l)/3,D=r/3,_=(2*l*l*l-9*l*c+27*(d/=p))/27,z=_/2,A=z*z+D*D*D;if(A<0){var P=-r/3,F=s(P*P*P),E=-_/(2*F),B=n(E<-1?-1:E>1?1:E),T=2*h(F);return[C=T*a(B/3)-l/3,T*a((B+u)/3)-l/3,T*a((B+2*u)/3)-l/3].filter(o)}if(0===A)return[C=2*(S=z<0?h(-z):-h(z))-l/3,-S-l/3].filter(o);var M=s(A);return[(S=h(-z+M))-(f=h(z+M))-l/3].filter(o)},droots:function(t){if(3===t.length){var e=t[0],i=t[1],a=t[2],r=e-2*i+a;if(0!==r){var n=-s(i*i-e*a),o=-e+i;return[-(n+o)/r,-(-n+o)/r]}return i!==a&&0===r?[(2*i-a)/(2*(i-a))]:[]}if(2===t.length){var e=t[0],i=t[1];return e!==i?[e/(e-i)]:[]}},curvature:function(t,e,a,r){var n,o,h,c,u=g.derive(e),d=u[0],p=u[1],y=0,m=0,f=g.compute(t,d),v=g.compute(t,p),w=f.x*f.x+f.y*f.y;if(a?(n=s(l(f.y*v.z-v.y*f.z,2)+l(f.z*v.x-v.z*f.x,2)+l(f.x*v.y-v.x*f.y,2)),o=l(w+f.z*f.z,1.5)):(n=f.x*v.y-f.y*v.x,o=l(w,1.5)),0===n||0===o)return{k:0,r:0};if(y=n/o,m=o/n,!r){var x=g.curvature(t-.001,e,a,!0).k,_=g.curvature(t+.001,e,a,!0).k;c=(_-y+(y-x))/2,h=(i(_-y)+i(y-x))/2}return{k:y,r:m,dk:c,adk:h}},inflections:function(t){if(t.length<4)return[];var e=g.align(t,{p1:t[0],p2:t.slice(-1)[0]}),i=e[2].x*e[1].y,a=e[3].x*e[1].y,r=e[1].x*e[2].y,n=e[3].x*e[2].y,o=18*(-3*i+2*a+3*r-n),s=18*(3*i-a-3*r),l=18*(r-i);if(g.approximately(o,0)){if(!g.approximately(s,0)){var h=-l/s;if(0<=h&&h<=1)return[h]}return[]}var c=Math.sqrt(s*s-4*o*l),n=2*o;return g.approximately(n,0)?[]:[(c-s)/n,-(s+c)/n].filter(function(t){return 0<=t&&t<=1})},bboxoverlap:function(t,e){var a,r,n,o,s,l=["x","y"],h=l.length;for(a=0;a<h;a++)if(n=t[r=l[a]].mid,o=e[r].mid,s=(t[r].size+e[r].size)/2,i(n-o)>=s)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,i){var a=t.bbox(),r=e.bbox(),n=i||.5;if(a.x.size+a.y.size<n&&r.x.size+r.y.size<n)return[(1e5*(t._t1+t._t2)/2|0)/1e5+"/"+(1e5*(e._t1+e._t2)/2|0)/1e5];var o=t.split(.5),s=e.split(.5),l=[{left:o.left,right:s.left},{left:o.left,right:s.right},{left:o.right,right:s.right},{left:o.right,right:s.left}];l=l.filter(function(t){return g.bboxoverlap(t.left.bbox(),t.right.bbox())});var h=[];return 0===l.length?h:(l.forEach(function(t){h=h.concat(g.pairiteration(t.left,t.right,n))}),h=h.filter(function(t,e){return h.indexOf(t)===e}))},getccenter:function(t,e,i){var n,s=e.x-t.x,l=e.y-t.y,h=i.x-e.x,c=i.y-e.y,p=s*a(d)-l*r(d),y=s*r(d)+l*a(d),m=h*a(d)-c*r(d),f=h*r(d)+c*a(d),v=(t.x+e.x)/2,w=(t.y+e.y)/2,x=(e.x+i.x)/2,_=(e.y+i.y)/2,b=g.lli8(v,w,v+p,w+y,x,_,x+m,_+f),S=g.dist(b,t),C=o(t.y-b.y,t.x-b.x),k=o(e.y-b.y,e.x-b.x),D=o(i.y-b.y,i.x-b.x);return C<D?((C>k||k>D)&&(C+=u),C>D&&(n=D,D=C,C=n)):D<k&&k<C?(n=D,D=C,C=n):D+=u,b.s=C,b.e=D,b.r=S,b},numberSort:function(t,e){return t-e}},t.exports=g}),g("9L27D",function(t,e){var i,a;i=f("asPPo"),(a=function(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)}).prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map(function(t){return i.pointsToString(t.points)}).join(", ")+"]"},addCurve:function(t){this.curves.push(t),this._3d=this._3d||t._3d},length:function(){return this.curves.map(function(t){return t.length()}).reduce(function(t,e){return t+e})},curve:function(t){return this.curves[t]},bbox:function(){for(var t=this.curves,e=t[0].bbox(),a=1;a<t.length;a++)i.expandbox(e,t[a].bbox());return e},offset:function(t){var e=[];return this.curves.forEach(function(i){e=e.concat(i.offset(t))}),new a(e)}},t.exports=a}),g("71caD",function(t,e){var i=f("krtaB"),a={x:!1,y:!1};t.exports=function(t,e){for(var r,n,o,s=i(e).split(" "),l=/[MLCQZ]/,h=[],c={C:6,Q:4,L:2,M:2};s.length;)l.test(r=s.splice(0,1)[0])&&(o=s.splice(0,c[r]).map(parseFloat),(n=function(t,e,i){if("Z"!==e){if("M"===e){a={x:i[0],y:i[1]};return}var r=[!1,a.x,a.y].concat(i),n=new(t.bind.apply(t,r)),o=i.slice(-2);return a={x:o[0],y:o[1]},n}}(t,r,o))&&h.push(n));return new t.PolyBezier(h)}}),g("krtaB",function(t,e){t.exports=function(t){var e,i,a,r,n,o,s=(t=t.replace(/,/g," ").replace(/-/g," - ").replace(/-\s+/g,"-").replace(/([a-zA-Z])/g," $1 ")).replace(/([a-zA-Z])\s?/g,"|$1").split("|"),l=s.length,h=[],c=0,u=0,d=0,p=0,y=0,m=0,f=0,g=0,v="";for(e=1;e<l;e++)if(r=(a=(i=s[e]).substring(0,1)).toLowerCase(),n=(h=(h=i.replace(a,"").trim().split(" ")).filter(function(t){return""!==t}).map(parseFloat)).length,"m"===r){if(v+="M ","m"===a?(d+=h[0],p+=h[1]):(d=h[0],p=h[1]),c=d,u=p,v+=d+" "+p+" ",n>2)for(o=0;o<n;o+=2)"m"===a?(d+=h[o],p+=h[o+1]):(d=h[o],p=h[o+1]),v+=["L",d,p,""].join(" ")}else if("l"===r)for(o=0;o<n;o+=2)"l"===a?(d+=h[o],p+=h[o+1]):(d=h[o],p=h[o+1]),v+=["L",d,p,""].join(" ");else if("h"===r)for(o=0;o<n;o++)"h"===a?d+=h[o]:d=h[o],v+=["L",d,p,""].join(" ");else if("v"===r)for(o=0;o<n;o++)"v"===a?p+=h[o]:p=h[o],v+=["L",d,p,""].join(" ");else if("q"===r)for(o=0;o<n;o+=4)"q"===a?(y=d+h[o],m=p+h[o+1],d+=h[o+2],p+=h[o+3]):(y=h[o],m=h[o+1],d=h[o+2],p=h[o+3]),v+=["Q",y,m,d,p,""].join(" ");else if("t"===r)for(o=0;o<n;o+=2)y=d+(d-y),m=p+(p-m),"t"===a?(d+=h[o],p+=h[o+1]):(d=h[o],p=h[o+1]),v+=["Q",y,m,d,p,""].join(" ");else if("c"===r)for(o=0;o<n;o+=6)"c"===a?(y=d+h[o],m=p+h[o+1],f=d+h[o+2],g=p+h[o+3],d+=h[o+4],p+=h[o+5]):(y=h[o],m=h[o+1],f=h[o+2],g=h[o+3],d=h[o+4],p=h[o+5]),v+=["C",y,m,f,g,d,p,""].join(" ");else if("s"===r)for(o=0;o<n;o+=4)y=d+(d-f),m=p+(p-g),"s"===a?(f=d+h[o],g=p+h[o+1],d+=h[o+2],p+=h[o+3]):(f=h[o],g=h[o+1],d=h[o+2],p=h[o+3]),v+=["C",y,m,f,g,d,p,""].join(" ");else"z"===r&&(v+="Z ",d=c,p=u);return v.trim()}}),g("eC5G7",function(t,e){var i;t.exports=(i=f("cnNdL"),f("7fQSe"),f("5GuSz"),f("ccckY"),f("1U8gx"),f("3hao2"),f("2Rb5F"),f("26LSc"),f("bvCfA"),f("64OVg"),f("wSnak"),f("f03sF"),f("8r9ug"),f("9prXE"),f("76mdr"),f("hV8yC"),f("kQscY"),f("jaC0I"),f("3vMel"),f("3Sktt"),f("kS8xt"),f("f6kDn"),f("1mazW"),f("3tPMV"),f("3aI6Q"),f("aTgJv"),f("iAW5a"),f("dtinM"),f("em5MW"),f("i20n2"),f("aYkFf"),f("3X7Vr"),f("5Ux0b"),i)}),g("cnNdL",function(t,e){var i,a,r,n,o,s,l,h,c,u,d,p,y;t.exports=y||(i=Math,a=Object.create||function(){function t(){}return function(e){var i;return t.prototype=e,i=new t,t.prototype=null,i}}(),o=(n=(r={}).lib={}).Base={extend:function(t){var e=a(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=n.WordArray=o.extend({init:function(t,e){t=this.words=t||[],void 0!=e?this.sigBytes=e:this.sigBytes=4*t.length},toString:function(t){return(t||h).stringify(this)},concat:function(t){var e=this.words,i=t.words,a=this.sigBytes,r=t.sigBytes;if(this.clamp(),a%4)for(var n=0;n<r;n++){var o=i[n>>>2]>>>24-n%4*8&255;e[a+n>>>2]|=o<<24-(a+n)%4*8}else for(var n=0;n<r;n+=4)e[a+n>>>2]=i[n>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=i.ceil(e/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e,a=[],r=function(t){var t=t,e=987654321;return function(){var a=((e=36969*(65535&e)+(e>>16)&4294967295)<<16)+(t=18e3*(65535&t)+(t>>16)&4294967295)&4294967295;return a/=4294967296,(a+=.5)*(i.random()>.5?1:-1)}},n=0;n<t;n+=4){var o=r(4294967296*(e||i.random()));e=987654071*o(),a.push(4294967296*o()|0)}return new s.init(a,t)}}),h=(l=r.enc={}).Hex={stringify:function(t){for(var e=t.words,i=t.sigBytes,a=[],r=0;r<i;r++){var n=e[r>>>2]>>>24-r%4*8&255;a.push((n>>>4).toString(16)),a.push((15&n).toString(16))}return a.join("")},parse:function(t){for(var e=t.length,i=[],a=0;a<e;a+=2)i[a>>>3]|=parseInt(t.substr(a,2),16)<<24-a%8*4;return new s.init(i,e/2)}},c=l.Latin1={stringify:function(t){for(var e=t.words,i=t.sigBytes,a=[],r=0;r<i;r++){var n=e[r>>>2]>>>24-r%4*8&255;a.push(String.fromCharCode(n))}return a.join("")},parse:function(t){for(var e=t.length,i=[],a=0;a<e;a++)i[a>>>2]|=(255&t.charCodeAt(a))<<24-a%4*8;return new s.init(i,e)}},u=l.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},d=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,a=e.words,r=e.sigBytes,n=this.blockSize,o=r/(4*n),l=(o=t?i.ceil(o):i.max((0|o)-this._minBufferSize,0))*n,h=i.min(4*l,r);if(l){for(var c=0;c<l;c+=n)this._doProcessBlock(a,c);var u=a.splice(0,l);e.sigBytes-=h}return new s.init(u,h)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),n.Hasher=d.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new p.HMAC.init(t,i).finalize(e)}}}),p=r.algo={},r)}),g("7fQSe",function(t,e){var i,a,r,n,o;t.exports=(r=(a=(i=f("cnNdL")).lib).Base,n=a.WordArray,(o=i.x64={}).Word=r.extend({init:function(t,e){this.high=t,this.low=e}}),o.WordArray=r.extend({init:function(t,e){t=this.words=t||[],void 0!=e?this.sigBytes=e:this.sigBytes=8*t.length},toX32:function(){for(var t=this.words,e=t.length,i=[],a=0;a<e;a++){var r=t[a];i.push(r.high),i.push(r.low)}return n.create(i,this.sigBytes)},clone:function(){for(var t=r.clone.call(this),e=t.words=this.words.slice(0),i=e.length,a=0;a<i;a++)e[a]=e[a].clone();return t}}),i)}),g("5GuSz",function(t,e){var i;t.exports=(i=f("cnNdL"),function(){if("function"==typeof ArrayBuffer){var t=i.lib.WordArray,e=t.init;(t.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var i=t.byteLength,a=[],r=0;r<i;r++)a[r>>>2]|=t[r]<<24-r%4*8;e.call(this,a,i)}else e.apply(this,arguments)}).prototype=t}}(),i.lib.WordArray)}),g("ccckY",function(t,e){var i;t.exports=(i=f("cnNdL"),function(){var t=i.lib.WordArray,e=i.enc;function a(t){return t<<8&4278255360|t>>>8&16711935}e.Utf16=e.Utf16BE={stringify:function(t){for(var e=t.words,i=t.sigBytes,a=[],r=0;r<i;r+=2){var n=e[r>>>2]>>>16-r%4*8&65535;a.push(String.fromCharCode(n))}return a.join("")},parse:function(e){for(var i=e.length,a=[],r=0;r<i;r++)a[r>>>1]|=e.charCodeAt(r)<<16-r%2*16;return t.create(a,2*i)}},e.Utf16LE={stringify:function(t){for(var e=t.words,i=t.sigBytes,r=[],n=0;n<i;n+=2){var o=a(e[n>>>2]>>>16-n%4*8&65535);r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var i=e.length,r=[],n=0;n<i;n++)r[n>>>1]|=a(e.charCodeAt(n)<<16-n%2*16);return t.create(r,2*i)}}}(),i.enc.Utf16)}),g("1U8gx",function(t,e){var i,a;t.exports=(a=(i=f("cnNdL")).lib.WordArray,i.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,a=this._map;t.clamp();for(var r=[],n=0;n<i;n+=3)for(var o=(e[n>>>2]>>>24-n%4*8&255)<<16|(e[n+1>>>2]>>>24-(n+1)%4*8&255)<<8|e[n+2>>>2]>>>24-(n+2)%4*8&255,s=0;s<4&&n+.75*s<i;s++)r.push(a.charAt(o>>>6*(3-s)&63));var l=a.charAt(64);if(l)for(;r.length%4;)r.push(l);return r.join("")},parse:function(t){var e=t.length,i=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var n=0;n<i.length;n++)r[i.charCodeAt(n)]=n}var o=i.charAt(64);if(o){var s=t.indexOf(o);-1!==s&&(e=s)}return function(t,e,i){for(var r=[],n=0,o=0;o<e;o++)if(o%4){var s=i[t.charCodeAt(o-1)]<<o%4*2,l=i[t.charCodeAt(o)]>>>6-o%4*2;r[n>>>2]|=(s|l)<<24-n%4*8,n++}return a.create(r,n)}(t,e,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},i.enc.Base64)}),g("3hao2",function(t,e){var i;t.exports=(i=f("cnNdL"),function(t){var e=i.lib,a=e.WordArray,r=e.Hasher,n=i.algo,o=[];!function(){for(var e=0;e<64;e++)o[e]=4294967296*t.abs(t.sin(e+1))|0}();var s=n.MD5=r.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var i=0;i<16;i++){var a=e+i,r=t[a];t[a]=(r<<8|r>>>24)&16711935|(r<<24|r>>>8)&4278255360}var n=this._hash.words,s=t[e+0],d=t[e+1],p=t[e+2],y=t[e+3],m=t[e+4],f=t[e+5],g=t[e+6],v=t[e+7],w=t[e+8],x=t[e+9],_=t[e+10],b=t[e+11],S=t[e+12],C=t[e+13],k=t[e+14],D=t[e+15],z=n[0],A=n[1],P=n[2],F=n[3];z=l(z,A,P,F,s,7,o[0]),F=l(F,z,A,P,d,12,o[1]),P=l(P,F,z,A,p,17,o[2]),A=l(A,P,F,z,y,22,o[3]),z=l(z,A,P,F,m,7,o[4]),F=l(F,z,A,P,f,12,o[5]),P=l(P,F,z,A,g,17,o[6]),A=l(A,P,F,z,v,22,o[7]),z=l(z,A,P,F,w,7,o[8]),F=l(F,z,A,P,x,12,o[9]),P=l(P,F,z,A,_,17,o[10]),A=l(A,P,F,z,b,22,o[11]),z=l(z,A,P,F,S,7,o[12]),F=l(F,z,A,P,C,12,o[13]),P=l(P,F,z,A,k,17,o[14]),A=l(A,P,F,z,D,22,o[15]),z=h(z,A,P,F,d,5,o[16]),F=h(F,z,A,P,g,9,o[17]),P=h(P,F,z,A,b,14,o[18]),A=h(A,P,F,z,s,20,o[19]),z=h(z,A,P,F,f,5,o[20]),F=h(F,z,A,P,_,9,o[21]),P=h(P,F,z,A,D,14,o[22]),A=h(A,P,F,z,m,20,o[23]),z=h(z,A,P,F,x,5,o[24]),F=h(F,z,A,P,k,9,o[25]),P=h(P,F,z,A,y,14,o[26]),A=h(A,P,F,z,w,20,o[27]),z=h(z,A,P,F,C,5,o[28]),F=h(F,z,A,P,p,9,o[29]),P=h(P,F,z,A,v,14,o[30]),A=h(A,P,F,z,S,20,o[31]),z=c(z,A,P,F,f,4,o[32]),F=c(F,z,A,P,w,11,o[33]),P=c(P,F,z,A,b,16,o[34]),A=c(A,P,F,z,k,23,o[35]),z=c(z,A,P,F,d,4,o[36]),F=c(F,z,A,P,m,11,o[37]),P=c(P,F,z,A,v,16,o[38]),A=c(A,P,F,z,_,23,o[39]),z=c(z,A,P,F,C,4,o[40]),F=c(F,z,A,P,s,11,o[41]),P=c(P,F,z,A,y,16,o[42]),A=c(A,P,F,z,g,23,o[43]),z=c(z,A,P,F,x,4,o[44]),F=c(F,z,A,P,S,11,o[45]),P=c(P,F,z,A,D,16,o[46]),A=c(A,P,F,z,p,23,o[47]),z=u(z,A,P,F,s,6,o[48]),F=u(F,z,A,P,v,10,o[49]),P=u(P,F,z,A,k,15,o[50]),A=u(A,P,F,z,f,21,o[51]),z=u(z,A,P,F,S,6,o[52]),F=u(F,z,A,P,y,10,o[53]),P=u(P,F,z,A,_,15,o[54]),A=u(A,P,F,z,d,21,o[55]),z=u(z,A,P,F,w,6,o[56]),F=u(F,z,A,P,D,10,o[57]),P=u(P,F,z,A,g,15,o[58]),A=u(A,P,F,z,C,21,o[59]),z=u(z,A,P,F,m,6,o[60]),F=u(F,z,A,P,b,10,o[61]),P=u(P,F,z,A,p,15,o[62]),A=u(A,P,F,z,x,21,o[63]),n[0]=n[0]+z|0,n[1]=n[1]+A|0,n[2]=n[2]+P|0,n[3]=n[3]+F|0},_doFinalize:function(){var e=this._data,i=e.words,a=8*this._nDataBytes,r=8*e.sigBytes;i[r>>>5]|=128<<24-r%32;var n=t.floor(a/4294967296);i[(r+64>>>9<<4)+15]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360,i[(r+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360,e.sigBytes=(i.length+1)*4,this._process();for(var o=this._hash,s=o.words,l=0;l<4;l++){var h=s[l];s[l]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360}return o},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});function l(t,e,i,a,r,n,o){var s=t+(e&i|~e&a)+r+o;return(s<<n|s>>>32-n)+e}function h(t,e,i,a,r,n,o){var s=t+(e&a|i&~a)+r+o;return(s<<n|s>>>32-n)+e}function c(t,e,i,a,r,n,o){var s=t+(e^i^a)+r+o;return(s<<n|s>>>32-n)+e}function u(t,e,i,a,r,n,o){var s=t+(i^(e|~a))+r+o;return(s<<n|s>>>32-n)+e}i.MD5=r._createHelper(s),i.HmacMD5=r._createHmacHelper(s)}(Math),i.MD5)}),g("2Rb5F",function(t,e){var i,a,r,n,o,s,l;t.exports=(r=(a=(i=f("cnNdL")).lib).WordArray,n=a.Hasher,o=i.algo,s=[],l=o.SHA1=n.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i=this._hash.words,a=i[0],r=i[1],n=i[2],o=i[3],l=i[4],h=0;h<80;h++){if(h<16)s[h]=0|t[e+h];else{var c=s[h-3]^s[h-8]^s[h-14]^s[h-16];s[h]=c<<1|c>>>31}var u=(a<<5|a>>>27)+l+s[h];h<20?u+=(r&n|~r&o)+1518500249:h<40?u+=(r^n^o)+1859775393:h<60?u+=(r&n|r&o|n&o)-1894007588:u+=(r^n^o)-899497514,l=o,o=n,n=r<<30|r>>>2,r=a,a=u}i[0]=i[0]+a|0,i[1]=i[1]+r|0,i[2]=i[2]+n|0,i[3]=i[3]+o|0,i[4]=i[4]+l|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,a=8*t.sigBytes;return e[a>>>5]|=128<<24-a%32,e[(a+64>>>9<<4)+14]=Math.floor(i/4294967296),e[(a+64>>>9<<4)+15]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}}),i.SHA1=n._createHelper(l),i.HmacSHA1=n._createHmacHelper(l),i.SHA1)}),g("26LSc",function(t,e){var i,a,r,n,o,s,l,h,c,u;t.exports=(i=f("cnNdL"),a=Math,n=(r=i.lib).WordArray,o=r.Hasher,s=i.algo,l=[],h=[],function(){function t(t){return(t-(0|t))*4294967296|0}for(var e=2,i=0;i<64;)(function(t){for(var e=a.sqrt(t),i=2;i<=e;i++)if(!(t%i))return!1;return!0})(e)&&(i<8&&(l[i]=t(a.pow(e,.5))),h[i]=t(a.pow(e,1/3)),i++),e++}(),c=[],u=s.SHA256=o.extend({_doReset:function(){this._hash=new n.init(l.slice(0))},_doProcessBlock:function(t,e){for(var i=this._hash.words,a=i[0],r=i[1],n=i[2],o=i[3],s=i[4],l=i[5],u=i[6],d=i[7],p=0;p<64;p++){if(p<16)c[p]=0|t[e+p];else{var y=c[p-15],m=(y<<25|y>>>7)^(y<<14|y>>>18)^y>>>3,f=c[p-2],g=(f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10;c[p]=m+c[p-7]+g+c[p-16]}var v=s&l^~s&u,w=a&r^a&n^r&n,x=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),_=d+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+v+h[p]+c[p],b=x+w;d=u,u=l,l=s,s=o+_|0,o=n,n=r,r=a,a=_+b|0}i[0]=i[0]+a|0,i[1]=i[1]+r|0,i[2]=i[2]+n|0,i[3]=i[3]+o|0,i[4]=i[4]+s|0,i[5]=i[5]+l|0,i[6]=i[6]+u|0,i[7]=i[7]+d|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;return e[r>>>5]|=128<<24-r%32,e[(r+64>>>9<<4)+14]=a.floor(i/4294967296),e[(r+64>>>9<<4)+15]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}}),i.SHA256=o._createHelper(u),i.HmacSHA256=o._createHmacHelper(u),i.SHA256)}),g("bvCfA",function(t,e){var i,a,r,n,o;t.exports=(i=f("cnNdL"),f("26LSc"),a=i.lib.WordArray,n=(r=i.algo).SHA256,o=r.SHA224=n.extend({_doReset:function(){this._hash=new a.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=n._doFinalize.call(this);return t.sigBytes-=4,t}}),i.SHA224=n._createHelper(o),i.HmacSHA224=n._createHmacHelper(o),i.SHA224)}),g("64OVg",function(t,e){var i;t.exports=(i=f("cnNdL"),f("7fQSe"),function(){var t=i.lib.Hasher,e=i.x64,a=e.Word,r=e.WordArray,n=i.algo;function o(){return a.create.apply(a,arguments)}var s=[o(1116352408,3609767458),o(1899447441,602891725),o(3049323471,3964484399),o(3921009573,2173295548),o(961987163,4081628472),o(1508970993,3053834265),o(2453635748,2937671579),o(2870763221,3664609560),o(3624381080,2734883394),o(310598401,1164996542),o(607225278,1323610764),o(1426881987,3590304994),o(1925078388,4068182383),o(2162078206,991336113),o(2614888103,633803317),o(3248222580,3479774868),o(3835390401,2666613458),o(4022224774,944711139),o(264347078,2341262773),o(604807628,2007800933),o(770255983,1495990901),o(1249150122,1856431235),o(1555081692,3175218132),o(1996064986,2198950837),o(2554220882,3999719339),o(2821834349,766784016),o(2952996808,2566594879),o(3210313671,3203337956),o(3336571891,1034457026),o(3584528711,2466948901),o(113926993,3758326383),o(338241895,168717936),o(666307205,1188179964),o(773529912,1546045734),o(1294757372,1522805485),o(1396182291,2643833823),o(1695183700,2343527390),o(1986661051,1014477480),o(2177026350,1206759142),o(2456956037,344077627),o(2730485921,1290863460),o(2820302411,3158454273),o(3259730800,3505952657),o(3345764771,106217008),o(3516065817,3606008344),o(3600352804,1432725776),o(4094571909,1467031594),o(275423344,851169720),o(430227734,3100823752),o(506948616,1363258195),o(659060556,3750685593),o(883997877,3785050280),o(958139571,3318307427),o(1322822218,3812723403),o(1537002063,2003034995),o(1747873779,3602036899),o(1955562222,1575990012),o(2024104815,1125592928),o(2227730452,2716904306),o(2361852424,442776044),o(2428436474,593698344),o(2756734187,3733110249),o(3204031479,2999351573),o(3329325298,3815920427),o(3391569614,3928383900),o(3515267271,566280711),o(3940187606,3454069534),o(4118630271,4000239992),o(116418474,1914138554),o(174292421,2731055270),o(289380356,3203993006),o(460393269,320620315),o(685471733,587496836),o(852142971,1086792851),o(1017036298,365543100),o(1126000580,2618297676),o(1288033470,3409855158),o(1501505948,4234509866),o(1607167915,987167468),o(1816402316,1246189591)],l=[];!function(){for(var t=0;t<80;t++)l[t]=o()}();var h=n.SHA512=t.extend({_doReset:function(){this._hash=new r.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var i=this._hash.words,a=i[0],r=i[1],n=i[2],o=i[3],h=i[4],c=i[5],u=i[6],d=i[7],p=a.high,y=a.low,m=r.high,f=r.low,g=n.high,v=n.low,w=o.high,x=o.low,_=h.high,b=h.low,S=c.high,C=c.low,k=u.high,D=u.low,z=d.high,A=d.low,P=p,F=y,E=m,B=f,T=g,M=v,L=w,R=x,O=_,j=b,H=S,I=C,G=k,q=D,U=z,N=A,V=0;V<80;V++){var X=l[V];if(V<16)var W=X.high=0|t[e+2*V],Y=X.low=0|t[e+2*V+1];else{var K=l[V-15],J=K.high,$=K.low,Q=(J>>>1|$<<31)^(J>>>8|$<<24)^J>>>7,Z=($>>>1|J<<31)^($>>>8|J<<24)^($>>>7|J<<25),tt=l[V-2],te=tt.high,ti=tt.low,ta=(te>>>19|ti<<13)^(te<<3|ti>>>29)^te>>>6,tr=(ti>>>19|te<<13)^(ti<<3|te>>>29)^(ti>>>6|te<<26),tn=l[V-7],to=tn.high,ts=tn.low,tl=l[V-16],th=tl.high,tc=tl.low,Y=Z+ts,W=Q+to+(Y>>>0<Z>>>0?1:0),Y=Y+tr,W=W+ta+(Y>>>0<tr>>>0?1:0),Y=Y+tc,W=W+th+(Y>>>0<tc>>>0?1:0);X.high=W,X.low=Y}var tu=O&H^~O&G,td=j&I^~j&q,tp=P&E^P&T^E&T,ty=F&B^F&M^B&M,tm=(P>>>28|F<<4)^(P<<30|F>>>2)^(P<<25|F>>>7),tf=(F>>>28|P<<4)^(F<<30|P>>>2)^(F<<25|P>>>7),tg=(O>>>14|j<<18)^(O>>>18|j<<14)^(O<<23|j>>>9),tv=(j>>>14|O<<18)^(j>>>18|O<<14)^(j<<23|O>>>9),tw=s[V],tx=tw.high,t_=tw.low,tb=N+tv,tS=U+tg+(tb>>>0<N>>>0?1:0),tb=tb+td,tS=tS+tu+(tb>>>0<td>>>0?1:0),tb=tb+t_,tS=tS+tx+(tb>>>0<t_>>>0?1:0),tb=tb+Y,tS=tS+W+(tb>>>0<Y>>>0?1:0),tC=tf+ty,tk=tm+tp+(tC>>>0<tf>>>0?1:0);U=G,N=q,G=H,q=I,H=O,I=j,O=L+tS+((j=R+tb|0)>>>0<R>>>0?1:0)|0,L=T,R=M,T=E,M=B,E=P,B=F,P=tS+tk+((F=tb+tC|0)>>>0<tb>>>0?1:0)|0}y=a.low=y+F,a.high=p+P+(y>>>0<F>>>0?1:0),f=r.low=f+B,r.high=m+E+(f>>>0<B>>>0?1:0),v=n.low=v+M,n.high=g+T+(v>>>0<M>>>0?1:0),x=o.low=x+R,o.high=w+L+(x>>>0<R>>>0?1:0),b=h.low=b+j,h.high=_+O+(b>>>0<j>>>0?1:0),C=c.low=C+I,c.high=S+H+(C>>>0<I>>>0?1:0),D=u.low=D+q,u.high=k+G+(D>>>0<q>>>0?1:0),A=d.low=A+N,d.high=z+U+(A>>>0<N>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,a=8*t.sigBytes;return e[a>>>5]|=128<<24-a%32,e[(a+128>>>10<<5)+30]=Math.floor(i/4294967296),e[(a+128>>>10<<5)+31]=i,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});i.SHA512=t._createHelper(h),i.HmacSHA512=t._createHmacHelper(h)}(),i.SHA512)}),g("wSnak",function(t,e){var i,a,r,n,o,s,l;t.exports=(i=f("cnNdL"),f("7fQSe"),f("64OVg"),r=(a=i.x64).Word,n=a.WordArray,s=(o=i.algo).SHA512,l=o.SHA384=s.extend({_doReset:function(){this._hash=new n.init([new r.init(3418070365,3238371032),new r.init(1654270250,914150663),new r.init(2438529370,812702999),new r.init(355462360,4144912697),new r.init(1731405415,4290775857),new r.init(2394180231,1750603025),new r.init(3675008525,1694076839),new r.init(1203062813,3204075428)])},_doFinalize:function(){var t=s._doFinalize.call(this);return t.sigBytes-=16,t}}),i.SHA384=s._createHelper(l),i.HmacSHA384=s._createHmacHelper(l),i.SHA384)}),g("f03sF",function(t,e){var i,a,r,n,o,s,l,h,c,u,d,p;t.exports=(i=f("cnNdL"),f("7fQSe"),a=Math,n=(r=i.lib).WordArray,o=r.Hasher,s=i.x64.Word,l=i.algo,h=[],c=[],u=[],function(){for(var t=1,e=0,i=0;i<24;i++){h[t+5*e]=(i+1)*(i+2)/2%64;var a=e%5,r=(2*t+3*e)%5;t=a,e=r}for(var t=0;t<5;t++)for(var e=0;e<5;e++)c[t+5*e]=e+(2*t+3*e)%5*5;for(var n=1,o=0;o<24;o++){for(var l=0,d=0,p=0;p<7;p++){if(1&n){var y=(1<<p)-1;y<32?d^=1<<y:l^=1<<y-32}128&n?n=n<<1^113:n<<=1}u[o]=s.create(l,d)}}(),d=[],function(){for(var t=0;t<25;t++)d[t]=s.create()}(),p=l.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var t=this._state=[],e=0;e<25;e++)t[e]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(t,e){for(var i=this._state,a=this.blockSize/2,r=0;r<a;r++){var n=t[e+2*r],o=t[e+2*r+1];n=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360,o=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360;var s=i[r];s.high^=o,s.low^=n}for(var l=0;l<24;l++){for(var p=0;p<5;p++){for(var y=0,m=0,f=0;f<5;f++){var s=i[p+5*f];y^=s.high,m^=s.low}var g=d[p];g.high=y,g.low=m}for(var p=0;p<5;p++)for(var v=d[(p+4)%5],w=d[(p+1)%5],x=w.high,_=w.low,y=v.high^(x<<1|_>>>31),m=v.low^(_<<1|x>>>31),f=0;f<5;f++){var s=i[p+5*f];s.high^=y,s.low^=m}for(var b=1;b<25;b++){var s=i[b],S=s.high,C=s.low,k=h[b];if(k<32)var y=S<<k|C>>>32-k,m=C<<k|S>>>32-k;else var y=C<<k-32|S>>>64-k,m=S<<k-32|C>>>64-k;var D=d[c[b]];D.high=y,D.low=m}var z=d[0],A=i[0];z.high=A.high,z.low=A.low;for(var p=0;p<5;p++)for(var f=0;f<5;f++){var b=p+5*f,s=i[b],P=d[b],F=d[(p+1)%5+5*f],E=d[(p+2)%5+5*f];s.high=P.high^~F.high&E.high,s.low=P.low^~F.low&E.low}var s=i[0],B=u[l];s.high^=B.high,s.low^=B.low}},_doFinalize:function(){var t=this._data,e=t.words;this._nDataBytes;var i=8*t.sigBytes,r=32*this.blockSize;e[i>>>5]|=1<<24-i%32,e[(a.ceil((i+1)/r)*r>>>5)-1]|=128,t.sigBytes=4*e.length,this._process();for(var o=this._state,s=this.cfg.outputLength/8,l=s/8,h=[],c=0;c<l;c++){var u=o[c],d=u.high,p=u.low;d=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,p=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,h.push(p),h.push(d)}return new n.init(h,s)},clone:function(){for(var t=o.clone.call(this),e=t._state=this._state.slice(0),i=0;i<25;i++)e[i]=e[i].clone();return t}}),i.SHA3=o._createHelper(p),i.HmacSHA3=o._createHmacHelper(p),i.SHA3)}),g("8r9ug",function(t,e){var i;t.exports=(i=f("cnNdL"),/** @preserve
	(c) 2012 by CÃ©dric Mesnil. All rights reserved.

	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/function(t){var e=i.lib,a=e.WordArray,r=e.Hasher,n=i.algo,o=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),c=a.create([0,1518500249,1859775393,2400959708,2840853838]),u=a.create([1352829926,1548603684,1836072691,2053994217,0]),d=n.RIPEMD160=r.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i,a,r,n,d,y,m,f,g,v,w,x,_,b,S,C,k,D,z,A=0;A<16;A++){var P=e+A,F=t[P];t[P]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360}var E=this._hash.words,B=c.words,T=u.words,M=o.words,L=s.words,R=l.words,O=h.words;b=g=E[0],S=v=E[1],C=w=E[2],k=x=E[3],D=_=E[4];for(var A=0;A<80;A+=1)z=g+t[e+M[A]]|0,A<16?z+=(v^w^x)+B[0]:A<32?z+=((i=v)&w|~i&x)+B[1]:A<48?z+=((v|~w)^x)+B[2]:A<64?z+=(a=v,r=w,(a&(n=x)|r&~n)+B[3]):z+=(v^(w|~x))+B[4],z|=0,z=(z=p(z,R[A]))+_|0,g=_,_=x,x=p(w,10),w=v,v=z,z=b+t[e+L[A]]|0,A<16?z+=(S^(C|~k))+T[0]:A<32?z+=(d=S,y=C,(d&(m=k)|y&~m)+T[1]):A<48?z+=((S|~C)^k)+T[2]:A<64?z+=((f=S)&C|~f&k)+T[3]:z+=(S^C^k)+T[4],z|=0,z=(z=p(z,O[A]))+D|0,b=D,D=k,k=p(C,10),C=S,S=z;z=E[1]+w+k|0,E[1]=E[2]+x+D|0,E[2]=E[3]+_+b|0,E[3]=E[4]+g+S|0,E[4]=E[0]+v+C|0,E[0]=z},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,a=8*t.sigBytes;e[a>>>5]|=128<<24-a%32,e[(a+64>>>9<<4)+14]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360,t.sigBytes=(e.length+1)*4,this._process();for(var r=this._hash,n=r.words,o=0;o<5;o++){var s=n[o];n[o]=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360}return r},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});function p(t,e){return t<<e|t>>>32-e}i.RIPEMD160=r._createHelper(d),i.HmacRIPEMD160=r._createHmacHelper(d)}(Math),i.RIPEMD160)}),g("9prXE",function(t,e){var i,a,r;t.exports=void(a=(i=f("cnNdL")).lib.Base,r=i.enc.Utf8,i.algo.HMAC=a.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=r.parse(e));var i=t.blockSize,a=4*i;e.sigBytes>a&&(e=t.finalize(e)),e.clamp();for(var n=this._oKey=e.clone(),o=this._iKey=e.clone(),s=n.words,l=o.words,h=0;h<i;h++)s[h]^=1549556828,l[h]^=909522486;n.sigBytes=o.sigBytes=a,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,i=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(i))}}))}),g("76mdr",function(t,e){var i,a,r,n,o,s,l,h;t.exports=(i=f("cnNdL"),f("2Rb5F"),f("9prXE"),r=(a=i.lib).Base,n=a.WordArray,s=(o=i.algo).SHA1,l=o.HMAC,h=o.PBKDF2=r.extend({cfg:r.extend({keySize:4,hasher:s,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=this.cfg,a=l.create(i.hasher,t),r=n.create(),o=n.create([1]),s=r.words,h=o.words,c=i.keySize,u=i.iterations;s.length<c;){var d=a.update(e).finalize(o);a.reset();for(var p=d.words,y=p.length,m=d,f=1;f<u;f++){m=a.finalize(m),a.reset();for(var g=m.words,v=0;v<y;v++)p[v]^=g[v]}r.concat(d),h[0]++}return r.sigBytes=4*c,r}}),i.PBKDF2=function(t,e,i){return h.create(i).compute(t,e)},i.PBKDF2)}),g("hV8yC",function(t,e){var i,a,r,n,o,s,l;t.exports=(i=f("cnNdL"),f("2Rb5F"),f("9prXE"),r=(a=i.lib).Base,n=a.WordArray,s=(o=i.algo).MD5,l=o.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:s,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=this.cfg,a=i.hasher.create(),r=n.create(),o=r.words,s=i.keySize,l=i.iterations;o.length<s;){h&&a.update(h);var h=a.update(t).finalize(e);a.reset();for(var c=1;c<l;c++)h=a.finalize(h),a.reset();r.concat(h)}return r.sigBytes=4*s,r}}),i.EvpKDF=function(t,e,i){return l.create(i).compute(t,e)},i.EvpKDF)}),g("kQscY",function(t,e){var i,a,r,n,o,s,l,h,c,u,d,p,y,m,g,v,w,x;t.exports=(i=f("cnNdL"),f("hV8yC"),void(i.lib.Cipher||(r=(a=i.lib).Base,n=a.WordArray,o=a.BufferedBlockAlgorithm,(s=i.enc).Utf8,l=s.Base64,h=i.algo.EvpKDF,c=a.Cipher=o.extend({cfg:r.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(t){return"string"==typeof t?x:v}return function(e){return{encrypt:function(i,a,r){return t(a).encrypt(e,i,a,r)},decrypt:function(i,a,r){return t(a).decrypt(e,i,a,r)}}}}()}),a.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),u=i.mode={},d=a.BlockCipherMode=r.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),p=u.CBC=function(){var t=d.extend();function e(t,e,i){var a=this._iv;if(a){var r=a;this._iv=void 0}else var r=this._prevBlock;for(var n=0;n<i;n++)t[e+n]^=r[n]}return t.Encryptor=t.extend({processBlock:function(t,i){var a=this._cipher,r=a.blockSize;e.call(this,t,i,r),a.encryptBlock(t,i),this._prevBlock=t.slice(i,i+r)}}),t.Decryptor=t.extend({processBlock:function(t,i){var a=this._cipher,r=a.blockSize,n=t.slice(i,i+r);a.decryptBlock(t,i),e.call(this,t,i,r),this._prevBlock=n}}),t}(),y=(i.pad={}).Pkcs7={pad:function(t,e){for(var i=4*e,a=i-t.sigBytes%i,r=a<<24|a<<16|a<<8|a,o=[],s=0;s<a;s+=4)o.push(r);var l=n.create(o,a);t.concat(l)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},a.BlockCipher=c.extend({cfg:c.cfg.extend({mode:p,padding:y}),reset:function(){c.reset.call(this);var t=this.cfg,e=t.iv,i=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var a=i.createEncryptor;else{var a=i.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==a?this._mode.init(this,e&&e.words):(this._mode=a.call(i,this,e&&e.words),this._mode.__creator=a)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else{var e=this._process(!0);t.unpad(e)}return e},blockSize:4}),m=a.CipherParams=r.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),g=(i.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext,i=t.salt;if(i)var a=n.create([1398893684,1701076831]).concat(i).concat(e);else var a=e;return a.toString(l)},parse:function(t){var e=l.parse(t),i=e.words;if(1398893684==i[0]&&1701076831==i[1]){var a=n.create(i.slice(2,4));i.splice(0,4),e.sigBytes-=16}return m.create({ciphertext:e,salt:a})}},v=a.SerializableCipher=r.extend({cfg:r.extend({format:g}),encrypt:function(t,e,i,a){a=this.cfg.extend(a);var r=t.createEncryptor(i,a),n=r.finalize(e),o=r.cfg;return m.create({ciphertext:n,key:i,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:a.format})},decrypt:function(t,e,i,a){return a=this.cfg.extend(a),e=this._parse(e,a.format),t.createDecryptor(i,a).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),w=(i.kdf={}).OpenSSL={execute:function(t,e,i,a){a||(a=n.random(8));var r=h.create({keySize:e+i}).compute(t,a),o=n.create(r.words.slice(e),4*i);return r.sigBytes=4*e,m.create({key:r,iv:o,salt:a})}},x=a.PasswordBasedCipher=v.extend({cfg:v.cfg.extend({kdf:w}),encrypt:function(t,e,i,a){var r=(a=this.cfg.extend(a)).kdf.execute(i,t.keySize,t.ivSize);a.iv=r.iv;var n=v.encrypt.call(this,t,e,r.key,a);return n.mixIn(r),n},decrypt:function(t,e,i,a){a=this.cfg.extend(a),e=this._parse(e,a.format);var r=a.kdf.execute(i,t.keySize,t.ivSize,e.salt);return a.iv=r.iv,v.decrypt.call(this,t,e,r.key,a)}}))))}),g("jaC0I",function(t,e){var i;t.exports=(i=f("cnNdL"),f("kQscY"),i.mode.CFB=function(){var t=i.lib.BlockCipherMode.extend();function e(t,e,i,a){var r=this._iv;if(r){var n=r.slice(0);this._iv=void 0}else var n=this._prevBlock;a.encryptBlock(n,0);for(var o=0;o<i;o++)t[e+o]^=n[o]}return t.Encryptor=t.extend({processBlock:function(t,i){var a=this._cipher,r=a.blockSize;e.call(this,t,i,r,a),this._prevBlock=t.slice(i,i+r)}}),t.Decryptor=t.extend({processBlock:function(t,i){var a=this._cipher,r=a.blockSize,n=t.slice(i,i+r);e.call(this,t,i,r,a),this._prevBlock=n}}),t}(),i.mode.CFB)}),g("3vMel",function(t,e){var i,a,r;t.exports=(i=f("cnNdL"),f("kQscY"),i.mode.CTR=(r=(a=i.lib.BlockCipherMode.extend()).Encryptor=a.extend({processBlock:function(t,e){var i=this._cipher,a=i.blockSize,r=this._iv,n=this._counter;r&&(n=this._counter=r.slice(0),this._iv=void 0);var o=n.slice(0);i.encryptBlock(o,0),n[a-1]=n[a-1]+1|0;for(var s=0;s<a;s++)t[e+s]^=o[s]}}),a.Decryptor=r,a),i.mode.CTR)}),g("3Sktt",function(t,e){var i;t.exports=(i=f("cnNdL"),f("kQscY"),/** @preserve
	 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
	 * derived from CryptoJS.mode.CTR
	 * Jan Hruby jhruby.web@gmail.com
	 */i.mode.CTRGladman=function(){var t=i.lib.BlockCipherMode.extend();function e(t){if((t>>24&255)==255){var e=t>>16&255,i=t>>8&255,a=255&t;255===e?(e=0,255===i?(i=0,255===a?a=0:++a):++i):++e,t=0+(e<<16)+(i<<8)+a}else t+=16777216;return t}var a=t.Encryptor=t.extend({processBlock:function(t,i){var a,r=this._cipher,n=r.blockSize,o=this._iv,s=this._counter;o&&(s=this._counter=o.slice(0),this._iv=void 0),0===((a=s)[0]=e(a[0]))&&(a[1]=e(a[1]));var l=s.slice(0);r.encryptBlock(l,0);for(var h=0;h<n;h++)t[i+h]^=l[h]}});return t.Decryptor=a,t}(),i.mode.CTRGladman)}),g("kS8xt",function(t,e){var i,a,r;t.exports=(i=f("cnNdL"),f("kQscY"),i.mode.OFB=(r=(a=i.lib.BlockCipherMode.extend()).Encryptor=a.extend({processBlock:function(t,e){var i=this._cipher,a=i.blockSize,r=this._iv,n=this._keystream;r&&(n=this._keystream=r.slice(0),this._iv=void 0),i.encryptBlock(n,0);for(var o=0;o<a;o++)t[e+o]^=n[o]}}),a.Decryptor=r,a),i.mode.OFB)}),g("f6kDn",function(t,e){var i,a;t.exports=(i=f("cnNdL"),f("kQscY"),i.mode.ECB=((a=i.lib.BlockCipherMode.extend()).Encryptor=a.extend({processBlock:function(t,e){this._cipher.encryptBlock(t,e)}}),a.Decryptor=a.extend({processBlock:function(t,e){this._cipher.decryptBlock(t,e)}}),a),i.mode.ECB)}),g("1mazW",function(t,e){var i;t.exports=(i=f("cnNdL"),f("kQscY"),i.pad.AnsiX923={pad:function(t,e){var i=t.sigBytes,a=4*e,r=a-i%a,n=i+r-1;t.clamp(),t.words[n>>>2]|=r<<24-n%4*8,t.sigBytes+=r},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},i.pad.Ansix923)}),g("3tPMV",function(t,e){var i;t.exports=(i=f("cnNdL"),f("kQscY"),i.pad.Iso10126={pad:function(t,e){var a=4*e,r=a-t.sigBytes%a;t.concat(i.lib.WordArray.random(r-1)).concat(i.lib.WordArray.create([r<<24],1))},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},i.pad.Iso10126)}),g("3aI6Q",function(t,e){var i;t.exports=(i=f("cnNdL"),f("kQscY"),i.pad.Iso97971={pad:function(t,e){t.concat(i.lib.WordArray.create([2147483648],1)),i.pad.ZeroPadding.pad(t,e)},unpad:function(t){i.pad.ZeroPadding.unpad(t),t.sigBytes--}},i.pad.Iso97971)}),g("aTgJv",function(t,e){var i;t.exports=(i=f("cnNdL"),f("kQscY"),i.pad.ZeroPadding={pad:function(t,e){var i=4*e;t.clamp(),t.sigBytes+=i-(t.sigBytes%i||i)},unpad:function(t){for(var e=t.words,i=t.sigBytes-1;!(e[i>>>2]>>>24-i%4*8&255);)i--;t.sigBytes=i+1}},i.pad.ZeroPadding)}),g("iAW5a",function(t,e){var i;t.exports=(i=f("cnNdL"),f("kQscY"),i.pad.NoPadding={pad:function(){},unpad:function(){}},i.pad.NoPadding)}),g("dtinM",function(t,e){var i,a,r;t.exports=(i=f("cnNdL"),f("kQscY"),a=i.lib.CipherParams,r=i.enc.Hex,i.format.Hex={stringify:function(t){return t.ciphertext.toString(r)},parse:function(t){var e=r.parse(t);return a.create({ciphertext:e})}},i.format.Hex)}),g("em5MW",function(t,e){var i,a,r,n,o,s,l,h,c,u,d,p,y,m,g;t.exports=(i=f("cnNdL"),f("1U8gx"),f("3hao2"),f("hV8yC"),f("kQscY"),a=i.lib.BlockCipher,r=i.algo,n=[],o=[],s=[],l=[],h=[],c=[],u=[],d=[],p=[],y=[],function(){for(var t=[],e=0;e<256;e++)e<128?t[e]=e<<1:t[e]=e<<1^283;for(var i=0,a=0,e=0;e<256;e++){var r=a^a<<1^a<<2^a<<3^a<<4;r=r>>>8^255&r^99,n[i]=r,o[r]=i;var m=t[i],f=t[m],g=t[f],v=257*t[r]^16843008*r;s[i]=v<<24|v>>>8,l[i]=v<<16|v>>>16,h[i]=v<<8|v>>>24,c[i]=v;var v=16843009*g^65537*f^257*m^16843008*i;u[r]=v<<24|v>>>8,d[r]=v<<16|v>>>16,p[r]=v<<8|v>>>24,y[r]=v,i?(i=m^t[t[t[g^m]]],a^=t[t[a]]):i=a=1}}(),m=[0,1,2,4,8,16,32,64,128,27,54],g=r.AES=a.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var t=this._keyPriorReset=this._key,e=t.words,i=t.sigBytes/4,a=((this._nRounds=i+6)+1)*4,r=this._keySchedule=[],o=0;o<a;o++)if(o<i)r[o]=e[o];else{var s=r[o-1];o%i?i>6&&o%i==4&&(s=n[s>>>24]<<24|n[s>>>16&255]<<16|n[s>>>8&255]<<8|n[255&s]):s=(n[(s=s<<8|s>>>24)>>>24]<<24|n[s>>>16&255]<<16|n[s>>>8&255]<<8|n[255&s])^m[o/i|0]<<24,r[o]=r[o-i]^s}for(var l=this._invKeySchedule=[],h=0;h<a;h++){var o=a-h;if(h%4)var s=r[o];else var s=r[o-4];h<4||o<=4?l[h]=s:l[h]=u[n[s>>>24]]^d[n[s>>>16&255]]^p[n[s>>>8&255]]^y[n[255&s]]}}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,l,h,c,n)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,u,d,p,y,o);var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,a,r,n,o,s){for(var l=this._nRounds,h=t[e]^i[0],c=t[e+1]^i[1],u=t[e+2]^i[2],d=t[e+3]^i[3],p=4,y=1;y<l;y++){var m=a[h>>>24]^r[c>>>16&255]^n[u>>>8&255]^o[255&d]^i[p++],f=a[c>>>24]^r[u>>>16&255]^n[d>>>8&255]^o[255&h]^i[p++],g=a[u>>>24]^r[d>>>16&255]^n[h>>>8&255]^o[255&c]^i[p++],v=a[d>>>24]^r[h>>>16&255]^n[c>>>8&255]^o[255&u]^i[p++];h=m,c=f,u=g,d=v}var m=(s[h>>>24]<<24|s[c>>>16&255]<<16|s[u>>>8&255]<<8|s[255&d])^i[p++],f=(s[c>>>24]<<24|s[u>>>16&255]<<16|s[d>>>8&255]<<8|s[255&h])^i[p++],g=(s[u>>>24]<<24|s[d>>>16&255]<<16|s[h>>>8&255]<<8|s[255&c])^i[p++],v=(s[d>>>24]<<24|s[h>>>16&255]<<16|s[c>>>8&255]<<8|s[255&u])^i[p++];t[e]=m,t[e+1]=f,t[e+2]=g,t[e+3]=v},keySize:8}),i.AES=a._createHelper(g),i.AES)}),g("i20n2",function(t,e){var i;t.exports=(i=f("cnNdL"),f("1U8gx"),f("3hao2"),f("hV8yC"),f("kQscY"),function(){var t=i.lib,e=t.WordArray,a=t.BlockCipher,r=i.algo,n=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],o=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],s=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],c=r.DES=a.extend({_doReset:function(){for(var t=this._key.words,e=[],i=0;i<56;i++){var a=n[i]-1;e[i]=t[a>>>5]>>>31-a%32&1}for(var r=this._subKeys=[],l=0;l<16;l++){for(var h=r[l]=[],c=s[l],i=0;i<24;i++)h[i/6|0]|=e[(o[i]-1+c)%28]<<31-i%6,h[4+(i/6|0)]|=e[28+(o[i+24]-1+c)%28]<<31-i%6;h[0]=h[0]<<1|h[0]>>>31;for(var i=1;i<7;i++)h[i]=h[i]>>>(i-1)*4+3;h[7]=h[7]<<5|h[7]>>>27}for(var u=this._invSubKeys=[],i=0;i<16;i++)u[i]=r[15-i]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(t,e,i){this._lBlock=t[e],this._rBlock=t[e+1],u.call(this,4,252645135),u.call(this,16,65535),d.call(this,2,858993459),d.call(this,8,16711935),u.call(this,1,1431655765);for(var a=0;a<16;a++){for(var r=i[a],n=this._lBlock,o=this._rBlock,s=0,c=0;c<8;c++)s|=l[c][((o^r[c])&h[c])>>>0];this._lBlock=o,this._rBlock=n^s}var p=this._lBlock;this._lBlock=this._rBlock,this._rBlock=p,u.call(this,1,1431655765),d.call(this,8,16711935),d.call(this,2,858993459),u.call(this,16,65535),u.call(this,4,252645135),t[e]=this._lBlock,t[e+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function u(t,e){var i=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=i,this._lBlock^=i<<t}function d(t,e){var i=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=i,this._rBlock^=i<<t}i.DES=a._createHelper(c);var p=r.TripleDES=a.extend({_doReset:function(){var t=this._key.words;this._des1=c.createEncryptor(e.create(t.slice(0,2))),this._des2=c.createEncryptor(e.create(t.slice(2,4))),this._des3=c.createEncryptor(e.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2});i.TripleDES=a._createHelper(p)}(),i.TripleDES)}),g("aYkFf",function(t,e){var i;t.exports=(i=f("cnNdL"),f("1U8gx"),f("3hao2"),f("hV8yC"),f("kQscY"),function(){var t=i.lib.StreamCipher,e=i.algo,a=e.RC4=t.extend({_doReset:function(){for(var t=this._key,e=t.words,i=t.sigBytes,a=this._S=[],r=0;r<256;r++)a[r]=r;for(var r=0,n=0;r<256;r++){var o=r%i,s=e[o>>>2]>>>24-o%4*8&255;n=(n+a[r]+s)%256;var l=a[r];a[r]=a[n],a[n]=l}this._i=this._j=0},_doProcessBlock:function(t,e){t[e]^=r.call(this)},keySize:8,ivSize:0});function r(){for(var t=this._S,e=this._i,i=this._j,a=0,r=0;r<4;r++){i=(i+t[e=(e+1)%256])%256;var n=t[e];t[e]=t[i],t[i]=n,a|=t[(t[e]+t[i])%256]<<24-8*r}return this._i=e,this._j=i,a}i.RC4=t._createHelper(a);var n=e.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var t=this.cfg.drop;t>0;t--)r.call(this)}});i.RC4Drop=t._createHelper(n)}(),i.RC4)}),g("3X7Vr",function(t,e){var i;t.exports=(i=f("cnNdL"),f("1U8gx"),f("3hao2"),f("hV8yC"),f("kQscY"),function(){var t=i.lib.StreamCipher,e=i.algo,a=[],r=[],n=[],o=e.Rabbit=t.extend({_doReset:function(){for(var t=this._key.words,e=this.cfg.iv,i=0;i<4;i++)t[i]=(t[i]<<8|t[i]>>>24)&16711935|(t[i]<<24|t[i]>>>8)&4278255360;var a=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],r=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];this._b=0;for(var i=0;i<4;i++)s.call(this);for(var i=0;i<8;i++)r[i]^=a[i+4&7];if(e){var n=e.words,o=n[0],l=n[1],h=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360,c=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,u=h>>>16|4294901760&c,d=c<<16|65535&h;r[0]^=h,r[1]^=u,r[2]^=c,r[3]^=d,r[4]^=h,r[5]^=u,r[6]^=c,r[7]^=d;for(var i=0;i<4;i++)s.call(this)}},_doProcessBlock:function(t,e){var i=this._X;s.call(this),a[0]=i[0]^i[5]>>>16^i[3]<<16,a[1]=i[2]^i[7]>>>16^i[5]<<16,a[2]=i[4]^i[1]>>>16^i[7]<<16,a[3]=i[6]^i[3]>>>16^i[1]<<16;for(var r=0;r<4;r++)a[r]=(a[r]<<8|a[r]>>>24)&16711935|(a[r]<<24|a[r]>>>8)&4278255360,t[e+r]^=a[r]},blockSize:4,ivSize:2});function s(){for(var t=this._X,e=this._C,i=0;i<8;i++)r[i]=e[i];e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<r[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<r[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<r[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<r[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<r[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<r[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<r[6]>>>0?1:0)|0,this._b=e[7]>>>0<r[7]>>>0?1:0;for(var i=0;i<8;i++){var a=t[i]+e[i],o=65535&a,s=a>>>16,l=((o*o>>>17)+o*s>>>15)+s*s,h=((4294901760&a)*a|0)+((65535&a)*a|0);n[i]=l^h}t[0]=n[0]+(n[7]<<16|n[7]>>>16)+(n[6]<<16|n[6]>>>16)|0,t[1]=n[1]+(n[0]<<8|n[0]>>>24)+n[7]|0,t[2]=n[2]+(n[1]<<16|n[1]>>>16)+(n[0]<<16|n[0]>>>16)|0,t[3]=n[3]+(n[2]<<8|n[2]>>>24)+n[1]|0,t[4]=n[4]+(n[3]<<16|n[3]>>>16)+(n[2]<<16|n[2]>>>16)|0,t[5]=n[5]+(n[4]<<8|n[4]>>>24)+n[3]|0,t[6]=n[6]+(n[5]<<16|n[5]>>>16)+(n[4]<<16|n[4]>>>16)|0,t[7]=n[7]+(n[6]<<8|n[6]>>>24)+n[5]|0}i.Rabbit=t._createHelper(o)}(),i.Rabbit)}),g("5Ux0b",function(t,e){var i;t.exports=(i=f("cnNdL"),f("1U8gx"),f("3hao2"),f("hV8yC"),f("kQscY"),function(){var t=i.lib.StreamCipher,e=i.algo,a=[],r=[],n=[],o=e.RabbitLegacy=t.extend({_doReset:function(){var t=this._key.words,e=this.cfg.iv,i=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],a=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];this._b=0;for(var r=0;r<4;r++)s.call(this);for(var r=0;r<8;r++)a[r]^=i[r+4&7];if(e){var n=e.words,o=n[0],l=n[1],h=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360,c=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,u=h>>>16|4294901760&c,d=c<<16|65535&h;a[0]^=h,a[1]^=u,a[2]^=c,a[3]^=d,a[4]^=h,a[5]^=u,a[6]^=c,a[7]^=d;for(var r=0;r<4;r++)s.call(this)}},_doProcessBlock:function(t,e){var i=this._X;s.call(this),a[0]=i[0]^i[5]>>>16^i[3]<<16,a[1]=i[2]^i[7]>>>16^i[5]<<16,a[2]=i[4]^i[1]>>>16^i[7]<<16,a[3]=i[6]^i[3]>>>16^i[1]<<16;for(var r=0;r<4;r++)a[r]=(a[r]<<8|a[r]>>>24)&16711935|(a[r]<<24|a[r]>>>8)&4278255360,t[e+r]^=a[r]},blockSize:4,ivSize:2});function s(){for(var t=this._X,e=this._C,i=0;i<8;i++)r[i]=e[i];e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<r[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<r[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<r[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<r[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<r[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<r[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<r[6]>>>0?1:0)|0,this._b=e[7]>>>0<r[7]>>>0?1:0;for(var i=0;i<8;i++){var a=t[i]+e[i],o=65535&a,s=a>>>16,l=((o*o>>>17)+o*s>>>15)+s*s,h=((4294901760&a)*a|0)+((65535&a)*a|0);n[i]=l^h}t[0]=n[0]+(n[7]<<16|n[7]>>>16)+(n[6]<<16|n[6]>>>16)|0,t[1]=n[1]+(n[0]<<8|n[0]>>>24)+n[7]|0,t[2]=n[2]+(n[1]<<16|n[1]>>>16)+(n[0]<<16|n[0]>>>16)|0,t[3]=n[3]+(n[2]<<8|n[2]>>>24)+n[1]|0,t[4]=n[4]+(n[3]<<16|n[3]>>>16)+(n[2]<<16|n[2]>>>16)|0,t[5]=n[5]+(n[4]<<8|n[4]>>>24)+n[3]|0,t[6]=n[6]+(n[5]<<16|n[5]>>>16)+(n[4]<<16|n[4]>>>16)|0,t[7]=n[7]+(n[6]<<8|n[6]>>>24)+n[5]|0}i.RabbitLegacy=t._createHelper(o)}(),i.RabbitLegacy)}),function t(e,i,a){function r(o,s){if(!i[o]){if(!e[o]){var l=void 0;if(!s&&l)return l(o,!0);if(n)return n(o,!0);var h=Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[o]={exports:{}};e[o][0].call(c.exports,function(t){return r(e[o][1][t]||t)},c,c.exports,t,e,i,a)}return i[o].exports}for(var n=void 0,o=0;o<a.length;o++)r(a[o]);return r}({1:[function(t,e,i){var a,r,n,o=e.exports={};function s(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function h(t){if(a===setTimeout)return setTimeout(t,0);if((a===s||!a)&&setTimeout)return a=setTimeout,setTimeout(t,0);try{return a(t,0)}catch(e){try{return a.call(null,t,0)}catch(e){return a.call(this,t,0)}}}!function(){try{a="function"==typeof setTimeout?setTimeout:s}catch(t){a=s}try{r="function"==typeof clearTimeout?clearTimeout:l}catch(t){r=l}}();var c=[],u=!1,d=-1;function p(){u&&n&&(u=!1,n.length?c=n.concat(c):d=-1,c.length&&y())}function y(){if(!u){var t=h(p);u=!0;for(var e=c.length;e;){for(n=c,c=[];++d<e;)n&&n[d].run();d=-1,e=c.length}n=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===l||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function f(){}o.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];c.push(new m(t,e)),1!==c.length||u||h(y)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=f,o.addListener=f,o.once=f,o.off=f,o.removeListener=f,o.removeAllListeners=f,o.emit=f,o.binding=function(t){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],2:[function(t,e,i){function a(t,e,i,a){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,get:function(){return i[a]},set:function(t){i[a]=t}})}e.exports={defineAliases:function(t){a(t,"image_whitelist",t,"imageWhitelist"),a(t,"mouseDispatch",t.s("Mouse"),"processEvent"),a(t,"mouseButtonsDown",t.s("Mouse"),"_buttonDown"),a(t,"lastEvent",t.s("Mouse"),"lastMouseEvent"),a(t,"mouseObjs",t.s("Mouse"),"mouseObjs"),a(t,"keyboardDispatch",t.s("Keyboard"),"processEvent"),a(t,"keydown",t.s("Keyboard"),"_keyDown"),a(t,"resetKeyDown",t.s("Keyboard"),"resetKeyDown"),a(t,"touchDispatch",t,"_touchDispatch"),a(t,"touchObjs",t.s("Touch"),"touchObjs"),t.touchHandler={},a(t.touchHandler,"fingers",t.s("Touch"),"touchPoints")}}},{}],3:[function(t,e,i){var a=t("../core/core.js");function r(t){this.button=t}function n(t){this.key=t}function o(t){this.inputs=t}r.prototype={isDown:function(){var t=this.mouseSystem;return t||(this.mouseSystem=t=a.s("Mouse")),t.isButtonDown(this.button)}},n.prototype={isDown:function(){var t=this.keyboardSystem;return t||(this.keyboardSystem=t=a.s("Keyboard")),t.isKeyDown(this.key)}},o.prototype={timeDown:null,isActive:function(){for(var t in this.inputs)if(this.inputs[t].isDown())return this.timeDown||(this.timeDown=Date.now()),!0;return delete this.timeDown,!1},destroy:function(){for(var t in this.inputs)"function"==typeof this.inputs[t].destroy&&this.inputs[t].destroy()}},a.s("Controls",{init:function(){this._dpads={},this._triggers={},a.s("Mouse").bind("MouseDown",this.updateTriggers.bind(this)),a.s("Mouse").bind("MouseUp",this.updateTriggers.bind(this)),a.s("Mouse").bind("DoubleClick",this.updateTriggers.bind(this)),a.s("Mouse").bind("Click",this.updateTriggers.bind(this))},events:{EnterFrame:"runEvents",KeyDown:"updateTriggers",KeyUp:"updateTriggers"},updateTriggers:function(t){for(var e in this._triggers){var i=this._triggers[e];this.updateTriggerInput(i)}},runEvents:function(){for(var t in this._dpads){var e=this._dpads[t];e.oldX=e.x,e.oldY=e.y,this.updateDpadInput(e,e.multipleDirectionBehavior),this.updateActiveDirection(e,e.normalize),e.event.x=e.x,e.event.y=e.y,(e.x!==e.oldX||e.y!==e.oldY)&&a.trigger("DirectionalInput",e.event)}},getDpad:function(t){return this._dpads[t]},isTriggerDown:function(t){return this._triggers[t].active},defineTriggerGroup:function(t,e){var i;if(Array.isArray(e))i=e;else{if(i=[],e.mouseButtons)for(var s in e.mouseButtons)i.push(new r(e.mouseButtons[s]));if(e.keys)for(var l in e.keys)i.push(new n(e.keys[l]))}this.destroyTriggerGroup(t),this._triggers[t]={name:t,input:new o(i),downFor:0,active:!1},a.trigger("ControlDefined",{type:"TriggerGroup",name:t})},destroyTriggerGroup:function(t){this._triggers[t]&&(this._triggers[t].input.destroy(),delete this._triggers[t],a.trigger("ControlDestroyed",{type:"TriggerGroup",name:t}))},defineDpad:function(t,e,i){var r={};for(var s in e){var l=e[s],h=a.keys[s]||s;r[l]||(r[l]=[]),r[l].push(new n(h))}var c={};for(var u in r)c[u]={input:new o(r[u]),active:!1,n:this.parseDirection(u)};void 0===i&&(i={}),void 0===i.normalize&&(i.normalize=!1),void 0===i.multipleDirectionBehavior&&(i.multipleDirectionBehavior="all"),this.destroyDpad(t),this._dpads[t]={name:t,directions:c,x:0,y:0,oldX:0,oldY:0,event:{x:0,y:0,name:t},normalize:i.normalize,multipleDirectionBehavior:i.multipleDirectionBehavior},a.trigger("ControlDefined",{type:"Dpad",name:t})},destroyDpad:function(t){if(this._dpads[t]){for(var e in this._dpads[t].parsedDefinition)this._dpads[t].parsedDefinition[e].input.destroy();delete this._dpads[t],a.trigger("ControlDestroyed",{type:"Dpad",name:t})}},parseDirection:function(t){return{x:Math.round(1e3*Math.cos(Math.PI/180*t))/1e3,y:Math.round(1e3*Math.sin(Math.PI/180*t))/1e3}},updateActiveDirection:function(t,e){var i=0,a=0;for(var r in t.directions){var n=t.directions[r];n.active&&(i+=n.n.x,a+=n.n.y)}if(i=-.0000000001<i&&i<1e-10?0:i,a=-.0000000001<a&&a<1e-10?0:a,e){var o=Math.sqrt(i*i+a*a);o>0&&(i/=o,a/=o)}t.x=i,t.y=a},updateTriggerInput:function(t){t.active?t.input.isActive()||(t.active=!1,a.trigger("TriggerInputUp",t),t.downFor=0):t.input.isActive()&&(t.downFor=Date.now()-t.input.timeDown,t.active=!0,a.trigger("TriggerInputDown",t))},updateDpadInput:function(t,e){var i,a,r;for(i in t.directions)(a=t.directions[i]).active=!1,a.input.isActive()&&("all"===e?a.active=!0:r?("first"===e&&r.input.timeDown>a.input.timeDown&&(r=a),"last"===e&&r.input.timeDown<a.input.timeDown&&(r=a)):r=a);r&&(r.active=!0)}})},{"../core/core.js":10}],4:[function(t,e,i){var a=t("../core/core.js");a.c("Draggable",{_origX:null,_origY:null,_oldX:null,_oldY:null,_dir:null,required:"MouseDrag",events:{StartDrag:"_startDrag",Dragging:"_drag"},enableDrag:function(){return this.uniqueBind("Dragging",this._drag),this},disableDrag:function(){return this.unbind("Dragging",this._drag),this},dragDirection:function(t){if(void 0===t)this._dir=null;else if(+t===t)this._dir={x:Math.cos(t/180*Math.PI),y:Math.sin(t/180*Math.PI)};else if(0===t.x&&0===t.y)this._dir={x:0,y:0};else{var e=Math.sqrt(t.x*t.x+t.y*t.y);this._dir={x:t.x/e,y:t.y/e}}return this},_startDrag:function(t){this._origX=t.realX,this._origY=t.realY,this._oldX=this._x,this._oldY=this._y},_drag:function(t){if(this._dir){if(0!==this._dir.x||0!==this._dir.y){var e=(t.realX-this._origX)*this._dir.x+(t.realY-this._origY)*this._dir.y;this.x=this._oldX+e*this._dir.x,this.y=this._oldY+e*this._dir.y}}else this.x=this._oldX+(t.realX-this._origX),this.y=this._oldY+(t.realY-this._origY)}}),a.c("Controllable",{init:function(){this._inputBindings={DirectionalInput:{},TriggerInputDown:{},TriggerInputUp:{}}},events:{DirectionalInput:function(t){this._inputBindings.DirectionalInput[t.name]&&this._inputBindings.DirectionalInput[t.name].call(this,t)},TriggerInputDown:function(t){this._inputBindings.TriggerInputDown[t.name]&&this._inputBindings.TriggerInputDown[t.name].call(this,t)},TriggerInputUp:function(t){this._inputBindings.TriggerInputUp[t.name]&&this._inputBindings.TriggerInputUp[t.name].call(this,t)}},linkInput:function(t,e,i){return this._inputBindings[t][e]=i,this},unlinkInput:function(t,e){return delete this._inputBindings[t][e],this},disableControls:!1,enableControl:function(){return this.disableControls=!1,this},disableControl:function(){return this.disableControls=!0,this}}),a.c("Multiway",{_speed:null,init:function(){this.requires("Motion, Controllable"),this._dpadName="MultiwayDpad"+this[0],this._speed={x:150,y:150},this._direction={x:0,y:0}},remove:function(){this.disableControls||(this.vx=this.vy=0),this.unlinkInput("DirectionalInput",this._dpadName),a.s("Controls").destroyDpad(this._dpadName)},events:{UpdateFrame:function(){this.disableControls||(void 0!==this._speed.x&&null!==this._speed.x&&(this.vx=this._speed.x*this._direction.x),void 0===this._speed.y||null===this._speed.y||(this.vy=this._speed.y*this._direction.y))}},_updateDirection:function(t){this._direction.x=t.x,this._direction.y=t.y},multiway:function(t,e,i){var r=a.s("Controls");return e?this.speed(t):e=t,r.defineDpad(this._dpadName,e,i),this.linkInput("DirectionalInput",this._dpadName,this._updateDirection),this},speed:function(t){return"object"==typeof t?(this._speed.x=t.x,this._speed.y=t.y):(this._speed.x=t,this._speed.y=t),this}}),a.c("Jumper",{_jumpSpeed:300,canJump:!0,init:function(){this.requires("Supportable, Motion, Controllable")},remove:function(){this.unlinkInput("TriggerInputDown",this._jumpTriggerName),a.s("Controls").destroyTriggerGroup(this._jumpTriggerName)},_keydown_jumper:function(t){this.disableControls||this.jump()},jump:function(){var t=this.ground;return this.canJump=!!t,this.trigger("CheckJumping",t),this.canJump&&(this.vy=-this._jumpSpeed),this},jumper:function(t,e){if(e?this._jumpSpeed=t:e=t,this._jumpTriggerName="JumpTrigger"+this[0],Array.isArray(e)){for(var i=[],r=0;r<e.length;++r){var n=e[r],o=a.keys[n]||n;i.push(o)}a.s("Controls").defineTriggerGroup(this._jumpTriggerName,{keys:i})}else a.s("Controls").defineTriggerGroup(this._jumpTriggerName,e);return this.linkInput("TriggerInputDown",this._jumpTriggerName,this._keydown_jumper),this},jumpSpeed:function(t){return this._jumpSpeed=t,this}}),a.c("Fourway",{init:function(){this.requires("Multiway")},fourway:function(t,e){return this.multiway(t||this._speed,{UP_ARROW:-90,DOWN_ARROW:90,RIGHT_ARROW:0,LEFT_ARROW:180,W:-90,S:90,D:0,A:180,Z:-90,Q:180},e),this}}),a.c("Twoway",{init:function(){this.requires("Multiway, Jumper")},twoway:function(t,e){var i=t||this._speed;return this.multiway({x:i},{RIGHT_ARROW:0,LEFT_ARROW:180,D:0,A:180,Q:180}),this.jumper(e||2*t||this._jumpSpeed,[a.keys.UP_ARROW,a.keys.W,a.keys.Z]),this}})},{"../core/core.js":10}],5:[function(t,e,i){var a=t("../core/core.js");a.__keyboardStateTemplate={_keyDown:null,init:function(){this._keyDown={},this.triggerKeyEvent=this.triggerKeyEvent||this.trigger},isKeyDown:function(t){return"string"==typeof t&&(t=a.keys[t]),!!this._keyDown[t]},resetKeyDown:function(){var t={key:-1,eventName:"KeyUp"},e=this._keyDown;for(var i in e)!0===e[i]&&(t.key=+i,this.triggerKey("KeyUp",t));return this},triggerKey:function(t,e){var i=e.key;return"KeyDown"===t?!0!==this._keyDown[i]&&(this._keyDown[i]=!0,this.triggerKeyEvent(t,e)):"KeyUp"===t?!0===this._keyDown[i]&&(this._keyDown[i]=!1,this.triggerKeyEvent(t,e)):this.triggerKeyEvent(t,e),this}},a.c("KeyboardState",a.__keyboardStateTemplate),a.s("Keyboard",a.extend.call({triggerKeyEvent:function(t,e){a.trigger(t,e)}},a.__keyboardStateTemplate),{},!1)},{"../core/core.js":10}],6:[function(t,e,i){t("../core/core.js").extend({keys:{BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,PULT_UP:29460,PULT_DOWN:29461,PULT_LEFT:4,PULT_RIGHT:5},mouseButtons:{LEFT:0,MIDDLE:1,RIGHT:2}})},{"../core/core.js":10}],7:[function(t,e,i){var a=t("../core/core.js");a.__mouseStateTemplate={_buttonDown:null,lastMouseEvent:null,init:function(){this._buttonDown={},this.triggerMouseEvent=this.triggerMouseEvent||this.trigger,this.lastMouseEvent={eventName:"",mouseButton:-1,target:null,realX:0,realY:0,clientX:0,clientY:0,originalEvent:null}},isButtonDown:function(t){return"string"==typeof t&&(t=a.mouseButtons[t]),!!this._buttonDown[t]},resetButtonDown:function(){var t=this.lastMouseEvent,e=this._buttonDown;for(var i in e)!0===e[i]&&(t.mouseButton=+i,t.eventName="MouseUp",this.triggerMouse("MouseUp",t));return this},triggerMouse:function(t,e){var i=this.lastMouseEvent;i.eventName=t,i.mouseButton=e.mouseButton,i.target=e.target,i.realX=e.realX,i.realY=e.realY,i.clientX=e.clientX,i.clientY=e.clientY,i.originalEvent=e.originalEvent;var a=e.mouseButton;return"MouseDown"===t?!0!==this._buttonDown[a]&&(this._buttonDown[a]=!0,this.triggerMouseEvent(t,e)):"MouseUp"===t?!0===this._buttonDown[a]&&(this._buttonDown[a]=!1,this.triggerMouseEvent(t,e)):this.triggerMouseEvent(t,e),this}},a.c("MouseState",a.__mouseStateTemplate),a.s("Mouse",a.extend.call({triggerMouseEvent:function(t,e){a.trigger(t,e)}},a.__mouseStateTemplate),{},!1)},{"../core/core.js":10}],8:[function(t,e,i){var a=t("../core/core.js");a.__touchStateTemplate={touchPoints:null,_touchPointsPool:null,init:function(){this.touchPoints=[],this._touchPointsPool=[],this.triggerTouchEvent=this.triggerTouchEvent||this.trigger},resetTouchPoints:function(){for(var t,e=this.touchPoints,i=e.length;i--;)(t=e[i]).eventName="TouchCancel",this.triggerTouch("TouchCancel",t);return this},triggerTouch:function(t,e){switch(t){case"TouchStart":this._handleStart(e);break;case"TouchMove":this._handleMove(e);break;case"TouchCancel":case"TouchEnd":this._handleEnd(e);break;default:this.triggerTouchEvent(t,e)}return this},_indexOfTouchPoint:function(t){for(var e=this.touchPoints,i=0,a=e.length;i<a;i++)if(e[i].identifier===t)return i;return -1},_setTouchPoint:function(t,e){t.eventName=e.eventName,t.identifier=e.identifier,t.target=e.target,t.entity=e.entity,t.realX=e.realX,t.realY=e.realY,t.originalEvent=e.originalEvent},_handleStart:function(t){var e=this._indexOfTouchPoint(t.identifier);if(!(e>=0?this.touchPoints[e]:null)){var i=this._touchPointsPool.pop()||{};this._setTouchPoint(i,t),this.touchPoints.push(i),this.triggerTouchEvent(i.eventName,i)}},_handleMove:function(t){var e=this._indexOfTouchPoint(t.identifier),i=e>=0?this.touchPoints[e]:null;i&&(this._setTouchPoint(i,t),this.triggerTouchEvent(i.eventName,i))},_handleEnd:function(t){var e=this._indexOfTouchPoint(t.identifier),i=e>=0?this.touchPoints[e]:null;i&&(this._setTouchPoint(i,t),this.triggerTouchEvent(i.eventName,i),this.touchPoints.splice(e,1),i.target=null,i.entity=null,i.originalEvent=null,this._touchPointsPool.push(i))}},a.c("TouchState",a.__touchStateTemplate),a.s("Touch",a.extend.call({triggerTouchEvent:function(t,e){a.trigger(t,e)}},a.__touchStateTemplate),{},!1)},{"../core/core.js":10}],9:[function(t,e,i){var a=t("../core/core.js"),r=function(t,e){this.timePerFrame=1e3/a.timer.FPS(),this.duration=t,"function"==typeof e?this.easing_function=e:"string"==typeof e&&this.standardEasingFunctions[e]?this.easing_function=this.standardEasingFunctions[e]:this.easing_function=this.standardEasingFunctions.linear,this.reset()};r.prototype={duration:0,clock:0,steps:null,complete:!1,paused:!1,reset:function(){this.loops=1,this.clock=0,this.complete=!1,this.paused=!1},repeat:function(t){this.loops=t},setProgress:function(t,e){this.clock=this.duration*t,void 0!==e&&(this.loops=e)},pause:function(){this.paused=!0},resume:function(){this.paused=!1,this.complete=!1},tick:function(t){if(!this.paused&&!this.complete)for(this.clock+=t,this.frames=Math.floor(this.clock/this.timePerFrame);this.clock>=this.duration&&!1===this.complete;)this.loops--,this.loops>0?this.clock-=this.duration:this.complete=!0},time:function(){return Math.min(this.clock/this.duration,1)},value:function(){return this.easing_function(this.time())},standardEasingFunctions:{linear:function(t){return t},smoothStep:function(t){return(3-2*t)*t*t},smootherStep:function(t){return(6*t*t-15*t+10)*t*t*t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1}}},e.exports=r},{"../core/core.js":10}],10:[function(t,e,i){var a,r,n,o,s,l,h,c,u,d,p,y,m,f,g,v,w,x,_,b,S,C=t("./version"),k=function(t){return new k.fn.init(t)};g={},_=Array.prototype.slice,b=/\s*,\s*/,S=/\s+/;var D=function(){m=1,f=0,v={},x={},w={}};D(),k.fn=k.prototype={init:function(t){if("string"!=typeof t)return(t||(t=0)in v||(v[t]=this),t in v)?(this[0]=t,this.length=1,this.__c||(this.__c={}),this._callbacks||k._addCallbackMethods(this),v[t]||(v[t]=this),v[t]):(this.length=0,this);var e,i,a,r,n,o,s,l,h,c=0,u=!1,d=!1;if("*"===t){for(e in l=0,v)this[l]=+e,l++;return(this.length=l,1===l)?v[this[0]]:this}if(-1!==t.indexOf(",")?(d=!0,i=b):-1!==t.indexOf(" ")&&(u=!0,i=S),d){for(l=0,a=t.split(i),r={},h=a.length;l<h;l++)for(s in n=x[a[l]])r[s]=+s;for(s in r)this[c++]=r[s]}else if(u){for(s in a=t.split(i),r={},n=x[a[0]],o=x[a[1]],n)void 0!==o[s]&&(r[s]=+s);for(l=2,h=a.length;l<h;l++)for(s in n=x[a[l]],r)void 0===n[s]&&(r[s]=-1);for(s in r)(l=r[s])>=0&&(this[c++]=l)}else for(s in n=x[t])this[c++]=+s;return(this.length=c,1===c)?v[this[c-1]]:(k._addCallbackMethods(this),this)},setName:function(t){var e=String(t);return this._entityName=e,this.trigger("NewEntityName",e),this},getName:function(t){return this._entityName},addComponent:function(t){var e,i,a,r=0;for(e=1==arguments.length&&-1!==t.indexOf(",")?t.split(b):arguments;r<e.length;r++)if(i=e[r],!0!==this.__c[i]){if(this.__c[i]=!0,(x[i]=x[i]||{})[this[0]]=this,a=g[i],this.extend(a),a&&"required"in a&&this.requires(a.required),a&&"properties"in a){var n=a.properties;for(var o in n)Object.defineProperty(this,o,n[o])}if(a&&"events"in a){var s=a.events;for(var l in s){var h="function"==typeof s[l]?s[l]:a[s[l]];this.bind(l,h)}}a&&"init"in a&&a.init.call(this)}return this.trigger("NewComponent",e),this},toggleComponent:function(t){var e,i,a=0;if(arguments.length>1)for(e=arguments.length;a<e;a++)this.has(arguments[a])?this.removeComponent(arguments[a]):this.addComponent(arguments[a]);else if(-1!==t.indexOf(","))for(e=(i=t.split(b)).length;a<e;a++)this.has(i[a])?this.removeComponent(i[a]):this.addComponent(i[a]);else this.has(t)?this.removeComponent(t):this.addComponent(t);return this},requires:function(){return this.addComponent.apply(this,arguments)},removeComponent:function(t,e){var i=g[t];if(this.trigger("RemoveComponent",t),i&&"events"in i){var a=i.events;for(var r in a){var n="function"==typeof a[r]?a[r]:i[a[r]];this.unbind(r,n)}}if(i&&"remove"in i&&i.remove.call(this,!1),!1===e&&i)for(var o in i)delete this[o];return delete this.__c[t],x[t]&&delete x[t][this[0]],this},getId:function(){return this[0]},has:function(t){return!!this.__c[t]},attr:function(t,e,i,a){return 1==arguments.length&&"string"==typeof arguments[0]?this._attr_get(t):this._attr_set(t,e,i,a)},_attr_get:function(t,e){var i,a;return(null==e&&(e=this),t.indexOf(".")>-1)?(i=(a=t.split(".")).shift(),a.join("."),this._attr_get(a.join("."),e[i])):e[t]},_attr_set:function(){var t,e,i;return"string"==typeof arguments[0]?(t=this._set_create_object(arguments[0],arguments[1]),e=!!arguments[2],i=arguments[3]||arguments[0].indexOf(".")>-1):(t=arguments[0],e=!!arguments[1],i=!!arguments[2]),e||this.trigger("Change",t),i?this._recursive_extend(t,this):this.extend.call(this,t),this},_set_create_object:function(t,e){var i,a,r,n={};return t.indexOf(".")>-1?(a=(i=t.split(".")).shift(),r=i.join("."),n[a]=this._set_create_object(r,e)):n[t]=e,n},_recursive_extend:function(t,e){var i;for(i in t)t[i].constructor===Object?e[i]=this._recursive_extend(t[i],e[i]):e[i]=t[i];return e},toArray:function(){return _.call(this,0)},timeout:function(t,e){return this.each(function(){var i=this;setTimeout(function(){t.call(i)},e)}),this},bind:function(t,e){if(1===this.length)this._bindCallback(t,e);else for(var i=0;i<this.length;i++){var a=v[this[i]];a&&a._bindCallback(t,e)}return this},uniqueBind:function(t,e){this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,a=function(r){e.call(i,r),i.unbind(t,a)};return i.bind(t,a)},unbind:function(t,e){var i,a;for(i=0;i<this.length;i++)(a=v[this[i]])&&a._unbindCallbacks(t,e);return this},trigger:function(t,e){if(1===this.length)this._runCallbacks(t,e);else for(var i=0;i<this.length;i++){var a=v[this[i]];a&&a._runCallbacks(t,e)}return this},each:function(t){for(var e=0,i=this.length;e<i;e++)v[this[e]]&&t.call(v[this[e]],e);return this},get:function(t){var e=this.length;if(void 0!==t)return t>=e||t+e<0?void 0:t>=0?v[this[t]]:v[this[t+e]];for(var i=0,a=[];i<e;i++)v[this[i]]&&a.push(v[this[i]]);return a},clone:function(){var t,e,i=this.__c,a=k.e();for(t in i)a.addComponent(t);for(e in this)"0"!==e&&"_global"!==e&&"_changed"!==e&&"function"!=typeof this[e]&&"object"!=typeof this[e]&&(a[e]=this[e]);return a},setter:function(t,e){return this.defineField(t,function(){},e)},defineField:function(t,e,i){return k.defineField(this,t,e,i),this},destroy:function(){this.each(function(){var t;for(var e in this.trigger("Remove"),this.__c)(t=g[e])&&"remove"in t&&t.remove.call(this,!0),delete x[e][this[0]];this._unbindAll(),delete v[this[0]]})},freeze:function(){if(1!==this.length||this.__frozen)for(var t=0;t<this.length;t++){var e=v[this[t]];e&&!e.__frozen&&(e.trigger("Freeze",e),e._freezeCallbacks(),e.__frozen=!0)}else this.trigger("Freeze",this),this._freezeCallbacks(),this.__frozen=!0;return this},unfreeze:function(){if(1===this.length&&this.__frozen)this.__frozen=!1,this._unfreezeCallbacks(),this.trigger("Unfreeze",this);else for(var t=0;t<this.length;t++){var e=v[this[t]];e&&e.__frozen&&(e.__frozen=!1,e._unfreezeCallbacks(),e.trigger("Unfreeze",e))}return this}},k.fn.init.prototype=k.fn,k.extend=k.fn.extend=function(t){var e;if(!t)return this;for(e in t)this!==t[e]&&(this[e]=t[e]);return this},k._callbackMethods={_bindCallback:function(t,e){var i=this._callbacks[t];i||((i=this._callbacks[t]=(w[t]||(w[t]={}))[this[0]]=[]).context=this,i.depth=0),i.push(e)},_runCallbacks:function(t,e){if(this._callbacks[t]&&!this.__callbacksFrozen){var i,a=this._callbacks[t],r=a.length;for(a.depth++,i=0;i<r;i++)void 0===a[i]?a.depth<=1&&(a.splice(i,1),i--,r--,0===a.length&&(delete this._callbacks[t],delete w[t][this[0]])):a[i].call(this,e);a.depth--}},_unbindCallbacks:function(t,e){if(this._callbacks[t])for(var i=this._callbacks[t],a=0;a<i.length;a++)e&&i[a]!==e||delete i[a]},_unbindAll:function(){if(this._callbacks)for(var t in this.__callbacksFrozen=!1,this._callbacks)this._callbacks[t]&&(this._unbindCallbacks(t),delete w[t][this[0]])},_freezeCallbacks:function(){if(this._callbacks){for(var t in this._callbacks)this._callbacks[t]&&delete w[t][this[0]];this.__callbacksFrozen=!0}},_unfreezeCallbacks:function(){if(this._callbacks)for(var t in this.__callbacksFrozen=!1,this._callbacks)this._callbacks[t]&&(w[t][this[0]]=this._callbacks[t])}},k._addCallbackMethods=function(t){t.extend(k._callbackMethods),t._callbacks={}},k._addCallbackMethods(k),k.extend({0:"global",init:function(t,e,i){if(!this._preBindDone)for(var a=0;a<this._bindOnInit.length;a++){var r=this._bindOnInit[a];k.bind(r.event,r.handler)}return k.viewport.init(t,e,i),this.trigger("Load"),this.timer.init(),this},initAsync:function(t,e,i,a){"object"!=typeof t&&(a=i,i=e,e=t,t=[]);var r=[];for(var n in t)"function"==typeof t[n]?r.push(t[n](k)):r.push(t[n]);if("complete"!==document.readyState)var o=new Promise(function(t,e){window.onload=t,r.push(o)});return Promise.all(r).then(function(r){return k.init(e,i,a),r.slice(0,t.length)})},_bindOnInit:[],_preBindDone:!1,_preBind:function(t,e){this._bindOnInit.push({event:t,handler:e})},getVersion:function(){return C},stop:function(t){if(k.trigger("CraftyStop",t),this.timer.stop(),t){for(var e in k.audio.remove(),k._systems)k._systems[e].destroy();if(k.stage&&k.stage.elem.parentNode){var i=document.createElement("div");i.id=k.stage.elem.id,k.stage.elem.parentNode.replaceChild(i,k.stage.elem)}k._unbindAll(),k._addCallbackMethods(k),this._preBindDone=!1,D()}return this},pause:function(t){return(1==arguments.length?t:!this._paused)?(this.trigger("Pause"),this._paused=!0,setTimeout(function(){k.timer.stop()},0)):(this.trigger("Unpause"),this._paused=!1,setTimeout(function(){k.timer.init()},0)),this},isPaused:function(){return this._paused},timer:(a="fixed",r=5,n=40,h=0,c=0,u=50,d=20,{init:function(){void 0===l&&(l=Date.now()-d);var t="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null);t?(o=function(){k.timer.step(),null!==o&&(s=t(o))})():o=setInterval(function(){k.timer.step()},1e3/u)},stop:function(){k.trigger("CraftyStopTimer"),"function"!=typeof o&&clearInterval(o);var t="undefined"!=typeof window&&(window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||null);t&&t(s),o=null},steptype:function(t,e){if("variable"===t||"semifixed"===t)a=t,e&&(n=e),k.trigger("NewSteptype",{mode:a,maxTimeStep:n});else if("fixed"===t)a="fixed",e&&(r=e),k.trigger("NewSteptype",{mode:a,maxTimeStep:r});else if(void 0===t)return{mode:a,maxTimeStep:"variable"===a||"semifixed"===a?n:r};else throw"Invalid step type specified"},step:function(){var t,e,i,o=0,s=Date.now();if(h>0&&k.trigger("MeasureWaitTime",s-h),l+c>=s){h=s;return}var u=s-(l+c);u>20*d&&(c+=u-d,u=d),"fixed"===a?(o=Math.min(o=Math.ceil(u/d),r),e=d):"variable"===a?(o=1,e=Math.min(e=u,n)):"semifixed"===a&&(o=Math.ceil(u/n),e=u/o);for(var p=0;p<o;p++){i=s;var y={frame:f++,dt:e,gameTime:l};k.trigger("EnterFrame",y),k.trigger("UpdateFrame",y),k.trigger("ExitFrame",y),l+=e,s=Date.now(),k.trigger("MeasureFrameTime",s-i)}o>0&&(t=s,k.trigger("PreRender"),k.trigger("RenderScene"),k.trigger("PostRender"),s=Date.now(),k.trigger("MeasureRenderTime",s-t)),h=s},FPS:function(t){if(void 0===t)return u;d=1e3/(u=t),k.trigger("FPSChange",t)},simulateFrames:function(t,e){for(e=e||d;t-- >0;){var i={frame:f++,dt:e};k.trigger("EnterFrame",i),k.trigger("UpdateFrame",i),k.trigger("ExitFrame",i)}k.trigger("PreRender"),k.trigger("RenderScene"),k.trigger("PostRender")}}),e:function(){var t=function t(){var e=m++;return e in v?t():e}();return v[t]=null,v[t]=k(t),arguments.length>0&&v[t].addComponent.apply(v[t],arguments),v[t].setName("Entity #"+t),v[t].addComponent("obj"),k.trigger("NewEntity",{id:t}),v[t]},c:function(t,e){g[t]=e},trigger:function(t,e){var i,a,r=w[t]||(w[t]={});for(i in r)r.hasOwnProperty(i)&&(a=r[i])&&0!==a.length&&a.context._runCallbacks(t,e)},bind:function(t,e){return this._bindCallback(t,e),e},uniqueBind:function(t,e){return this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,a=function(r){e.call(i,r),i.unbind(t,a)};return i.bind(t,a)},unbind:function(t,e){this._unbindCallbacks(t,e)},frame:function(){return f},entities:function(){return v},components:function(){return g},isComp:function(t){return t in g},debug:function(t){return"handlers"===t?w:v},settings:(p={},y={},{register:function(t,e){y[t]=e},modify:function(t,e){y[t]&&(y[t].call(p[t],e),p[t]=e)},get:function(t){return p[t]}}),defineField:function(t,e,i,a){Object.defineProperty(t,e,{get:i,set:a,configurable:!1,enumerable:!0})},clone:function t(e){if(null===e||"object"!=typeof e)return e;var i=e.constructor();for(var a in e)i[a]=t(e[a]);return i}}),"function"==typeof define&&define("crafty",[],function(){return k}),e.exports=k},{"./version":20}],11:[function(t,e,i){(function(e){var i=t("../core/core.js"),a="undefined"!=typeof window&&window.document;!function(){var t,r=i.support={},n="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase()||void 0!==e&&e.version,o=/(webkit)[ \/]([\w.]+)/.exec(n)||/(o)pera(?:.*version)?[ \/]([\w.]+)/.exec(n)||/(ms)ie ([\w.]+)/.exec(n)||/(moz)illa(?:.*? rv:([\w.]+))?/.exec(n)||/(v)\d+\.(\d+)/.exec(n)||[],s=/iPad|iPod|iPhone|Android|webOS|IEMobile/i.exec(n);if(s&&(i.mobile=s[0]),r.defineProperty=function(){if(!("defineProperty"in Object))return!1;try{Object.defineProperty({},"x",{})}catch(t){return!1}return!0}(),r.audio="undefined"!=typeof window&&"canPlayType"in a.createElement("audio"),r.prefix=o[1]||o[0],"moz"===r.prefix&&(r.prefix="Moz"),"o"===r.prefix&&(r.prefix="O"),"v"===r.prefix&&(r.prefix="node"),o[2]&&(r.versionName=o[2],r.version=+o[2].split(".")[0]),r.canvas="undefined"!=typeof window&&"getContext"in a.createElement("canvas"),r.canvas){try{var l=a.createElement("canvas");(t=l.getContext("webgl")||l.getContext("experimental-webgl")).viewportWidth=r.canvas.width,t.viewportHeight=r.canvas.height}catch(t){}r.webgl=!!t}else r.webgl=!1;r.css3dtransform="undefined"!=typeof window&&(void 0!==a.createElement("div").style.Perspective||void 0!==a.createElement("div").style[r.prefix+"Perspective"]),r.deviceorientation="undefined"!=typeof window&&(void 0!==window.DeviceOrientationEvent||void 0!==window.OrientationEvent),r.devicemotion="undefined"!=typeof window&&void 0!==window.DeviceMotionEvent}()}).call(this,t("_process"))},{"../core/core.js":10,_process:1}],12:[function(t,e,i){var a=t("../core/core.js"),r=t("./utility");e.exports={assets:{},__paths:{audio:"",images:""},paths:function(t){if(void 0===t)return this.__paths;t.audio&&(this.__paths.audio=t.audio),t.images&&(this.__paths.images=t.images)},asset:function(t,e){return 1==arguments.length?a.assets[t]:a.assets[t]?void 0:(a.assets[t]=e,this.trigger("NewAsset",{key:t,value:e}),e)},imageWhitelist:["jpg","jpeg","gif","png","svg"],load:function(t,e,i,n){if(Array.isArray(t)){a.log("Calling Crafty.load with an array of assets no longer works; see the docs for more details.");return}t="string"==typeof t?JSON.parse(t):t;var o,s,l,h,c,u=0,d=(t.audio?Object.keys(t.audio).length:0)+(t.images?Object.keys(t.images).length:0)+(t.sprites?Object.keys(t.sprites).length:0),p=a.paths(),y=function(t,e){return -1===e.search("://")?"audio"===t?p.audio+e:p.images+e:e},m=function(t){return a.asset(t)||null},f=function(t){return"data"===r.fileTypeOf(t).schema?URL.createObjectURL(r.toBlob(t)):t};function g(){var t=this.src;this.removeEventListener&&this.removeEventListener("canplaythrough",g,!1),u++,i&&i({loaded:u,total:d,percent:u/d*100,src:t}),u===d&&e&&e()}function v(){var t=this.src;n&&n({loaded:u,total:d,percent:u/d*100,src:t}),++u===d&&e&&e()}for(h in t)for(c in t[h])if(t[h].hasOwnProperty(c)){if(o=t[h][c],l=null,"audio"===h){var w,x,_,b=Object.keys(o="object"==typeof o?o:{"":o+""}).filter(function(t){var e,i=y(h,o[t]);if(!m(i)&&(e=o[t],a.support.audio&&a.audio.supports(r.fileTypeOf(e).type))&&!a.audio.sounds[c])return f(i)});b[0]&&(l=a.audio.add(c,b)),l&&(l=l.obj),l&&l.addEventListener&&l.addEventListener("canplaythrough",g,!1)}else c="sprites"===h?c:o,!m(s=y(h,c))&&(w=c,-1<a.imageWhitelist.indexOf(r.fileTypeOf(w).type))&&(l=new Image,s=f(s),"sprites"===h&&a.sprite(o.tile,o.tileh,s,o.map,o.paddingX,o.paddingY,o.paddingAroundBorder),a.asset(s,l),x=l,_=s,x.onload=g,"webkit"===a.support.prefix&&(x.src=""),x.src=_);l?l.onerror=v:v.call({src:s})}0===d&&e&&e()},removeAssets:function(t){t="string"==typeof t?JSON.parse(t):t;var e,i,r,n,o=a.paths(),s=function(t,e){return -1===e.search("://")?"audio"===t?o.audio+e:o.images+e:e};for(r in t)for(n in t[r])if(t[r].hasOwnProperty(n)){if(e=t[r][n],"audio"===r){if("object"==typeof e)for(var l in e)i=s(r,e[l]),a.asset(i)&&a.audio.remove(n);else"string"==typeof e&&(i=s(r,e),a.asset(i)&&a.audio.remove(n))}else if(n="sprites"===r?n:e,i=s(r,n),a.asset(i)){if("sprites"===r)for(var h in e.map)delete a.components()[h];delete a.assets[i]}}}}},{"../core/core.js":10,"./utility":19}],13:[function(t,e,i){var a=t("../core/core.js");e.exports={init:function(){this.changed=[],this.bind("Change",this._changed_attributes),this.bind("Change",this._changed_triggers)},_changed_triggers:function(t,e){var i;for(i in e=a.extend.call({pre:""},e),t)this.trigger("Change["+e.pre+i+"]",t[i]),t[i].constructor===Object&&this._changed_triggers(t[i],{pre:e.pre+i+"."})},_changed_attributes:function(t){var e;for(e in t)this.changed.push(e);return this},is_dirty:function(t){return 0==arguments.length?!!this.changed.length:this.changed.indexOf(t)>-1}}},{"../core/core.js":10}],14:[function(t,e,i){var a=t("../core/core.js");e.exports={_scenes:{},_current:null,scene:function(t,e,i){if(1==arguments.length||"function"!=typeof arguments[1]){a.enterScene(t,arguments[1]);return}a.defineScene(t,e,i)},defineScene:function(t,e,i){if("function"!=typeof e)throw"Init function is the wrong type.";this._scenes[t]={},this._scenes[t].initialize=e,void 0!==i&&(this._scenes[t].uninitialize=i)},enterScene:function(t,e){if("function"==typeof e)throw"Scene data cannot be a function";a.trigger("SceneDestroy",{newScene:t}),a.viewport.reset(),a("2D").each(function(){this.has("Persist")||this.destroy()}),null!==this._current&&"uninitialize"in this._scenes[this._current]&&this._scenes[this._current].uninitialize.call(this);var i=this._current;this._current=t,a.trigger("SceneChange",{oldScene:i,newScene:t}),this._scenes.hasOwnProperty(t)?this._scenes[t].initialize.call(this,e):a.error('The scene "'+t+'" does not exist')}}},{"../core/core.js":10}],15:[function(t,e,i){var a=t("../core/core.js");try{var r="undefined"!=typeof window&&window.localStorage||new t("node-localstorage").LocalStorage("./localStorage")}catch(t){var r=null}var n=function(t,e){var i=e;if(!r)return a.error("Local storage is not accessible.  (Perhaps you are including crafty.js cross-domain?)"),!1;if(1==arguments.length)try{return JSON.parse(r.getItem(t))}catch(e){return r.getItem(t)}else"object"==typeof e&&(i=JSON.stringify(e)),r.setItem(t,i)};n.remove=function(t){if(!r){a.error("Local storage is not accessible.  (Perhaps you are including crafty.js cross-domain?)");return}r.removeItem(t)},e.exports=n},{"../core/core.js":10}],16:[function(t,e,i){var a,r=t("../core/core.js");r._systems={},r.s=function(t,e,i,a){if(!e)return r._systems[t];"boolean"==typeof i&&(a=i,i=null),!1===a?(r._systems[t]=new r.CraftySystem(t,e,i),r.trigger("SystemLoaded",t)):r._registerLazySystem(t,e,i)},r._registerLazySystem=function(t,e,i){Object.defineProperty(r._systems,t,{get:function(){return Object.defineProperty(r._systems,t,{value:new r.CraftySystem(t,e,i),writable:!0,enumerable:!0,configurable:!0}),r.trigger("SystemLoaded",t),r._systems[t]},configurable:!0})},r.CraftySystem=(a=1,function(t,e,i){if(this.name=t,!e)return this;if(this._systemTemplate=e,this.extend(e),this.options=function(t,e){var i={};for(var a in e)i[a]=e[a];for(a in t)a in e||(i[a]=t[a]);return i}(this.options,i),r._addCallbackMethods(this),this[0]="system"+a++,"properties"in e){var n=e.properties;for(var o in n)Object.defineProperty(this,o,n[o])}if("events"in e){var s=e.events;for(var l in s){var h="function"==typeof s[l]?s[l]:e[s[l]];this.bind(l,h)}}"function"==typeof this.init&&this.init(t)}),r.CraftySystem.prototype={extend:function(t){for(var e in t)void 0===this[e]&&(this[e]=t[e])},bind:function(t,e){return this._bindCallback(t,e),this},trigger:function(t,e){return this._runCallbacks(t,e),this},unbind:function(t,e){return this._unbindCallbacks(t,e),this},one:function(t,e){var i=this,a=function(r){e.call(i,r),i.unbind(t,a)};return i.bind(t,a)},uniqueBind:function(t,e){return this.unbind(t,e),this.bind(t,e)},destroy:function(){r.trigger("SystemDestroyed",this),"function"==typeof this.remove&&this.remove(),this._unbindAll(),delete r._systems[this.name]}}},{"../core/core.js":10}],17:[function(t,e,i){e.exports={delaySpeed:1,init:function(){this._delays=[],this._delaysPaused=!1,this.bind("UpdateFrame",function(t){if(!this._delaysPaused)for(var e=this._delays.length;--e>=0;){var i=this._delays[e];if(!1===i)this._delays.splice(e,1);else{for(i.accumulator+=t.dt*this.delaySpeed;i.accumulator>=i.delay&&i.repeat>=0;)i.accumulator-=i.delay,i.repeat--,i.callback.call(this);i.repeat<0&&(this._delays.splice(e,1),"function"==typeof i.callbackOff&&i.callbackOff.call(this))}}})},delay:function(t,e,i,a){return this._delays.push({accumulator:0,callback:t,callbackOff:a,delay:e,repeat:(i<0?1/0:i)||0}),this},cancelDelay:function(t){for(var e=this._delays.length;--e>=0;){var i=this._delays[e];i&&i.callback===t&&(this._delays[e]=!1)}return this},pauseDelays:function(){this._delaysPaused=!0},resumeDelays:function(){this._delaysPaused=!1}}},{}],18:[function(t,e,i){var a=t("../core/core.js");e.exports={tweenSpeed:1,init:function(){this.tweenGroup={},this.tweenStart={},this.tweens=[],this.uniqueBind("UpdateFrame",this._tweenTick)},_tweenTick:function(t){var e,i,a;for(a=this.tweens.length-1;a>=0;a--)(e=this.tweens[a]).easing.tick(t.dt*this.tweenSpeed),i=e.easing.value(),this._doTween(e.props,i),e.easing.complete&&(this.tweens.splice(a,1),this._endTween(e.props))},_doTween:function(t,e){for(var i in t)this[i]=(1-e)*this.tweenStart[i]+e*t[i]},tween:function(t,e,i){var r={props:t,easing:new a.easing(e,i)};for(var n in t)void 0!==this.tweenGroup[n]&&this.cancelTween(n),this.tweenStart[n]=this[n],this.tweenGroup[n]=t;return this.tweens.push(r),this},cancelTween:function(t){if("string"==typeof t)"object"==typeof this.tweenGroup[t]&&delete this.tweenGroup[t][t];else if("object"==typeof t)for(var e in t)this.cancelTween(e);return this},pauseTweens:function(){this.tweens.map(function(t){t.easing.pause()})},resumeTweens:function(){this.tweens.map(function(t){t.easing.resume()})},_endTween:function(t){var e=!1;for(var i in t)e=!0,delete this.tweenGroup[i];e&&this.trigger("TweenEnd",t)}}},{"../core/core.js":10}],19:[function(t,e,i){i.blobOf=function(t){var e=new XMLHttpRequest;return e.responseType="blob",e.open("GET",t),new Promise(function(t,i){e.onload=function(){t(this.response)},e.onerror=i,e.send()})};var a=/^data:(.+?\/(.+?))?(;base64)?,(\S+)/;i.fileTypeOf=function(t){var e=/^(?:(\w+):)?.+?(?:\.(\w+))?$/.exec(t);switch(e[1]){case"data":return{schema:"data",type:a.exec(t)[2]};case"blob":return i.blobOf(t).then(function(t){return{schema:"blob",type:t.type}});default:return{schema:e[1],type:e[2]}}};var r=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;i.toBlob=function(t){var e=(t=a.exec(t))[1],i=t[3],n=t[4];n=i?window.atob(n):n;for(var o=new ArrayBuffer(n.length),s=new Uint8Array(o),l=0;n[l];l++)s[l]=n.charCodeAt(l);if(!r)return new window.Blob([o],{type:e});var h=new r;return h.append(o),h.getBlob(e)}},{}],20:[function(t,e,i){e.exports="0.8.0"},{}],21:[function(t,e,i){e.exports=function(e){e&&(t=e);var i=t("./core/core");t("./core/extensions"),i.easing=t("./core/animation"),i.c("Model",t("./core/model")),i.extend(t("./core/scenes")),i.storage=t("./core/storage"),i.c("Delay",t("./core/time")),i.c("Tween",t("./core/tween"));var a=t("./spatial/spatial-grid");return i.HashMap=a,i.map=new a,t("./core/systems"),t("./spatial/2d"),t("./spatial/motion"),t("./spatial/platform"),t("./spatial/collision"),t("./spatial/rect-manager"),t("./spatial/math"),t("./controls/controls-system"),t("./controls/controls"),t("./controls/keyboard"),t("./controls/keycodes"),t("./controls/mouse"),t("./controls/touch"),t("./debug/logging"),i}},{"./controls/controls":4,"./controls/controls-system":3,"./controls/keyboard":5,"./controls/keycodes":6,"./controls/mouse":7,"./controls/touch":8,"./core/animation":9,"./core/core":10,"./core/extensions":11,"./core/model":13,"./core/scenes":14,"./core/storage":15,"./core/systems":16,"./core/time":17,"./core/tween":18,"./debug/logging":24,"./spatial/2d":55,"./spatial/collision":56,"./spatial/math":57,"./spatial/motion":58,"./spatial/platform":59,"./spatial/rect-manager":60,"./spatial/spatial-grid":61}],22:[function(t,e,i){var a=t("./crafty-common.js")();a.extend(t("./core/loader")),a.extend(t("./inputs/dom-events")),t("./graphics/layers"),t("./graphics/canvas"),t("./graphics/canvas-layer"),t("./graphics/webgl"),t("./graphics/webgl-layer"),t("./graphics/color"),t("./graphics/dom"),t("./graphics/dom-helper"),t("./graphics/dom-layer"),t("./graphics/drawing"),t("./graphics/gl-textures"),t("./graphics/renderable"),t("./graphics/html"),t("./graphics/image"),t("./graphics/particles"),t("./graphics/sprite-animation"),t("./graphics/sprite"),t("./graphics/text"),t("./graphics/viewport"),t("./isometric/diamond-iso"),t("./isometric/isometric"),t("./inputs/util"),t("./inputs/device"),t("./inputs/keyboard"),t("./inputs/lifecycle"),t("./inputs/mouse"),t("./inputs/pointer"),t("./inputs/touch"),t("./sound/sound"),t("./debug/debug-layer"),t("./aliases").defineAliases(a),window&&(window.Crafty=a),e.exports=a},{"./aliases":2,"./core/loader":12,"./crafty-common.js":21,"./debug/debug-layer":23,"./graphics/canvas":26,"./graphics/canvas-layer":25,"./graphics/color":27,"./graphics/dom":30,"./graphics/dom-helper":28,"./graphics/dom-layer":29,"./graphics/drawing":31,"./graphics/gl-textures":32,"./graphics/html":33,"./graphics/image":34,"./graphics/layers":35,"./graphics/particles":36,"./graphics/renderable":37,"./graphics/sprite":39,"./graphics/sprite-animation":38,"./graphics/text":40,"./graphics/viewport":41,"./graphics/webgl":43,"./graphics/webgl-layer":42,"./inputs/device":44,"./inputs/dom-events":45,"./inputs/keyboard":46,"./inputs/lifecycle":47,"./inputs/mouse":48,"./inputs/pointer":49,"./inputs/touch":50,"./inputs/util":51,"./isometric/diamond-iso":52,"./isometric/isometric":53,"./sound/sound":54}],23:[function(t,e,i){var a=t("../core/core.js"),r=window.document;a.c("DebugCanvas",{init:function(){this.requires("2D"),a.DebugCanvas.context||a.DebugCanvas.init(),a.DebugCanvas.add(this),this._debug={alpha:1,lineWidth:1},this.bind("RemoveComponent",this.onDebugRemove),this.bind("Remove",this.onDebugDestroy)},onDebugRemove:function(t){"DebugCanvas"===t&&a.DebugCanvas.remove(this)},onDebugDestroy:function(t){a.DebugCanvas.remove(this)},debugAlpha:function(t){return this._debug.alpha=t,this},debugFill:function(t){return void 0===t&&(t="red"),this._debug.fillStyle=t,this},debugStroke:function(t){return void 0===t&&(t="red"),this._debug.strokeStyle=t,this},debugDraw:function(t){var e=t.globalAlpha,i=this._debug;i.alpha&&(t.globalAlpha=this._debug.alpha),i.strokeStyle&&(t.strokeStyle=i.strokeStyle),i.lineWidth&&(t.lineWidth=i.lineWidth),i.fillStyle&&(t.fillStyle=i.fillStyle),this.trigger("DebugDraw",t),t.globalAlpha=e}}),a.c("DebugRectangle",{init:function(){this.requires("2D, DebugCanvas")},debugRectangle:function(t){return this.debugRect=t,this.unbind("DebugDraw",this.drawDebugRect),this.bind("DebugDraw",this.drawDebugRect),this},drawDebugRect:function(t){var e=this.debugRect;null!=e&&e._h&&e._w&&(this._debug.fillStyle&&t.fillRect(e._x,e._y,e._w,e._h),this._debug.strokeStyle&&t.strokeRect(e._x,e._y,e._w,e._h))}}),a.c("WiredMBR",{init:function(){this.requires("DebugRectangle").debugStroke("purple")},events:{PreRender:function(){this.debugRectangle(this._mbr||this)}}});var n={init:function(){this.requires("DebugRectangle").debugFill("pink")},events:{PreRender:function(){this.debugRectangle(this._mbr||this)}}};a.c("SolidMBR",n),a.c("VisibleMBR",n),a.c("DebugPolygon",{init:function(){this.requires("2D, DebugCanvas")},debugPolygon:function(t){return this.polygon=t,this.unbind("DebugDraw",this.drawDebugPolygon),this.bind("DebugDraw",this.drawDebugPolygon),this},drawDebugPolygon:function(t){if(void 0!==this.polygon){t.beginPath();for(var e=this.polygon.points,i=e.length,a=0;a<i;a+=2)t.lineTo(e[a],e[a+1]);t.closePath(),this._debug.fillStyle&&t.fill(),this._debug.strokeStyle&&t.stroke()}}}),a.c("WiredHitBox",{init:function(){this.requires("DebugPolygon").debugStroke("red").matchHitBox(),this.bind("NewHitbox",this.matchHitBox)},matchHitBox:function(){this.debugPolygon(this.map)}}),a.c("SolidHitBox",{init:function(){this.requires("Collision, DebugPolygon").debugFill("orange").debugAlpha(.7).matchHitBox(),this.bind("NewHitbox",this.matchHitBox)},matchHitBox:function(){this.debugPolygon(this.map)}}),a.c("WiredAreaMap",{init:function(){this.requires("DebugPolygon").debugStroke("green").matchAreaMap(),this.bind("NewAreaMap",this.matchAreaMap)},matchAreaMap:function(){this.debugPolygon(this.mapArea)}}),a.c("SolidAreaMap",{init:function(){this.requires("DebugPolygon").debugFill("lime").debugAlpha(.7).matchAreaMap(),this.bind("NewAreaMap",this.matchAreaMap)},matchAreaMap:function(){this.debugPolygon(this.mapArea)}}),a.DebugCanvas={context:null,entities:[],onetimeEntities:[],add:function(t){this.entities.push(t)},remove:function(t){for(var e=this.entities,i=e.length-1;i>=0;i--)e[i]===t&&e.splice(i,1)},init:function(){if(!a.DebugCanvas.context){var t;if(!a.support.canvas){a.trigger("NoCanvas"),a.stop();return}(t=r.createElement("canvas")).width=a.viewport.width,t.height=a.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.id="debug-canvas",t.style.zIndex=1e5,a.stage.elem.appendChild(t),a.DebugCanvas.context=t.getContext("2d"),a.DebugCanvas._canvas=t}a.unbind("RenderScene",a.DebugCanvas.renderScene),a.bind("RenderScene",a.DebugCanvas.renderScene)},renderScene:function(t){t=t||a.viewport.rect();var e,i=a.DebugCanvas.entities,r=0,n=i.length,o=a.DebugCanvas.context,s=a.viewport;o.setTransform(s._scale,0,0,s._scale,Math.round(s._x*s._scale),Math.round(s._y*s._scale)),o.clearRect(t._x,t._y,t._w,t._h);for(var l=null;r<n;r++)l!==(e=i[r])._drawLayer&&(e._drawLayer?(s=e._drawLayer._viewportRect(),o.setTransform(s._scale,0,0,s._scale,Math.round(-s._x*s._scale),Math.round(-s._y*s._scale))):(s=a.viewport,o.setTransform(s._scale,0,0,s._scale,Math.round(s._x*s._scale),Math.round(s._y*s._scale))),l=e._drawLayer),e.debugDraw(o)}}},{"../core/core.js":10}],24:[function(t,e,i){var a=t("../core/core.js");a.extend({loggingEnabled:!0,log:function(){a.loggingEnabled&&("undefined"!=typeof window?window.console:console)&&console.log&&console.log.apply(console,arguments)},error:function(){a.loggingEnabled&&("undefined"!=typeof window?window.console:console)&&console.error&&console.error.apply(console,arguments)}})},{"../core/core.js":10}],25:[function(t,e,i){var a=t("../core/core.js");a._registerLayerTemplate("Canvas",{type:"Canvas",layerCount:0,_changedObjs:null,_dirtyRects:null,_dirtyCells:null,_viewKeys:null,__tempRect:null,__tempSearchRect:null,__tempScreenRect:null,dirty:function(t){this._changedObjs.push(t)},attach:function(t){t._drawContext=this.context,this.layerCount++},detach:function(t){this.dirty(t),t._drawContext=null,this.layerCount--},context:null,_canvas:null,events:{LayerInit:"layerInit",LayerRemove:"layerRemove",RenderScene:"_render",PixelartSet:"_setPixelart",ViewportResize:"_resize"},layerInit:function(){if(!a.support.canvas){a.trigger("NoCanvas"),a.stop();return}this._changedObjs=[],this._dirtyRects=[],this._dirtyCells={},this._viewKeys={x1:0,y1:0,x2:0,y2:0},this.__tempRect={_x:0,_y:0,_w:0,_h:0},this.__tempSearchRect={_x:0,_y:0,_w:0,_h:0},this.__tempScreenRect={_x:0,_y:0,_w:0,_h:0},(t=document.createElement("canvas")).width=a.viewport.width,t.height=a.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.zIndex=this.options.z,a.stage.elem.appendChild(t),this.context=t.getContext("2d"),this._canvas=t;var t,e=a.viewport._scale;1!==e&&this.context.scale(e,e)},layerRemove:function(){this._canvas.parentNode.removeChild(this._canvas)},_render:function(){var t=this._dirtyViewport,e=this._changedObjs.length,i=this.context;if(e||t){var a=this.options;if(t&&a){var r=this._viewportRect(),n=r._scale,o=-r._x*n,s=-r._y*n;i.setTransform(n,0,0,n,Math.round(o),Math.round(s))}e/this.layerCount>.6||t?this._drawAll():this._drawDirtyCells(),this._clean()}},_drawDirtyCells:function(t){var e,i,r=this._viewportRect(),n=this.__tempRect,o=this._dirtyRects,s=a.rectManager.integerBounds,l=this.context;for(t=s(t||r),this._createDirtyCells(t),this._createDirtyRects(),e=0,i=o.length;e<i;e+=4)n._x=o[e+0],n._y=o[e+1],n._w=o[e+2],n._h=o[e+3],this._drawRect(n);if(!0===this.debugDirty){var h=a.frame();for(e=0,l.strokeStyle="rgb("+(6*h+0)%255+", "+(6*h+85)%255+", "+(6*h+170)%255+")",i=o.length;e<i;e+=4)l.strokeRect(o[e+0],o[e+1],o[e+2],o[e+3])}},_drawAll:function(t){var e=this._viewportRect();this._drawRect(t||e)},_drawRect:function(t){var e,i,r,n,o,s=a.rectManager.integerBounds,l=this.context,h=this.__tempSearchRect,c=this.__tempScreenRect;for(c=s(c=this._viewTransformRect(t,c,!0)),t=s(t),h._x=t._x,h._y=t._y,h._w=t._w-1,h._h=t._h-1,(r=a.map.search(h)).sort(this._sort),l.save(),l.save(),l.setTransform(1,0,0,1,0,0),l.beginPath(),l.rect(c._x,c._y,c._w,c._h),l.clearRect(c._x,c._y,c._w,c._h),l.restore(),l.clip(),o=-1/0,e=0,i=r.length;e<i;++e)(n=r[e])._globalZ>o&&n._visible&&n._drawLayer===this&&(n.draw(l),n._changed=!1,o=n._globalZ);l.restore()},debug:function(){a.log(this._changedObjs)},_clean:function(){var t,e,i,a,r,n=this._changedObjs;for(a=0,r=n.length;a<r;a++)t=(i=n[a])._entry.keys,void 0===(e=i.staleKeys)&&(i.staleKeys=e={x1:0,y1:0,x2:0,y2:0}),e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,i._changed=!1;n.length=0,this._dirtyCells={},this._dirtyRects.length=0,this._dirtyViewport=!1},_createDirtyCells:function(t){var e,i,r,n,o,s,l=this._changedObjs,h=this._dirtyCells,c=a.HashMap.key(t,this._viewKeys);for(e=0,i=l.length;e<i;e++){if(s=(o=l[e]).staleKeys)for(r=s.x1;r<=s.x2;r++)for(n=s.y1;n<=s.y2;n++)c.x1<=r&&r<=c.x2&&c.y1<=n&&n<=c.y2&&(h[r<<16^n]=!0);for(r=(s=o._entry.keys).x1;r<=s.x2;r++)for(n=s.y1;n<=s.y2;n++)c.x1<=r&&r<=c.x2&&c.y1<=n&&n<=c.y2&&(h[r<<16^n]=!0)}},_createDirtyRects:function(){var t,e,i,r=a.HashMap.cellsize(),n=this._dirtyCells,o=this._dirtyRects;for(var s in n)e=(i=(t=+s)<<16>>16)<0?~(t>>16):t>>16,o.push(e*r,i*r,r,r)},_resize:function(){var t=this._canvas;t.width=a.viewport.width,t.height=a.viewport.height},_setPixelart:function(t){var e=this.context;e.imageSmoothingEnabled=!t,e.mozImageSmoothingEnabled=!t,e.webkitImageSmoothingEnabled=!t,e.oImageSmoothingEnabled=!t,e.msImageSmoothingEnabled=!t}})},{"../core/core.js":10}],26:[function(t,e,i){var a=t("../core/core.js");a.c("Canvas",{init:function(){this.requires("Renderable"),this.currentRect={},this._customLayer||this._attachToLayer(a.s("DefaultCanvasLayer"))},remove:function(){this._detachFromLayer()},drawVars:{type:"canvas",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(t,e,i,a,r){if(this.ready){var n,o=this.drawVars.pos;o._x=this._x+(e||0),o._y=this._y+(i||0),o._w=a||this._w,o._h=r||this._h;var s=t||this._drawContext,l=this.__coord||[0,0,0,0],h=this.drawVars.co;return h.x=l[0]+(e||0),h.y=l[1]+(i||0),h.w=a||l[2],h.h=r||l[3],(this._flipX||this._flipY||this._rotation)&&s.save(),0!==this._rotation&&(s.translate(this._origin.x+this._x,this._origin.y+this._y),o._x=-this._origin.x,o._y=-this._origin.y,s.rotate(this._rotation%360*(Math.PI/180))),(this._flipX||this._flipY)&&(s.scale(this._flipX?-1:1,this._flipY?-1:1),this._flipX&&(o._x=-(o._x+o._w)),this._flipY&&(o._y=-(o._y+o._h))),this._alpha<1&&(n=s.globalAlpha,s.globalAlpha=this._alpha),this.drawVars.ctx=s,this.trigger("Draw",this.drawVars),(0!==this._rotation||this._flipX||this._flipY)&&s.restore(),n&&(s.globalAlpha=n),this}}})},{"../core/core.js":10}],27:[function(t,e,i){var a=t("../core/core.js"),r=window.document;a.extend({assignColor:function(){var t=r.createElement("div");t.style.display="none";var e=!1,i={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#00ff00",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"};function a(t){return t._red=t._blue=t._green=0,t}function n(t){var e=t.toString(16);return 1===e.length&&(e="0"+e),e}function o(t,e){var i,r,n,o=t.length;if(7===o)i=t.substr(1,2),r=t.substr(3,2),n=t.substr(5,2);else{if(4!==o)return a(e);i=t.substr(1,1),i+=i,r=t.substr(2,1),r+=r,n=t.substr(3,1),n+=n}return e._red=parseInt(i,16),e._green=parseInt(r,16),e._blue=parseInt(n,16),e}var s=/rgba?\s*\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,?\s*([0-9.]+)?\)/;function l(t,e){var i=s.exec(t);return null===i||4!==i.length&&5!==i.length?a(e):(e._red=Math.round(parseFloat(i[1])),e._green=Math.round(parseFloat(i[2])),e._blue=Math.round(parseFloat(i[3])),i[4]&&(e._strength=parseFloat(i[4])),e)}return function(a,r){var s;r=r||{},"#"===(a=a.trim().toLowerCase())[0]?o(a,r):"r"===a[0]&&"g"===a[1]&&"b"===a[2]?l(a,r):function(a,r){if(void 0===i[a]){var s,h,c;!1===e&&(window.document.body.appendChild(t),e=!0),t.style.color=a,l(window.getComputedStyle(t).color,r),i[a]=(s=r._red,h=r._green,c=r._blue,"#"+n(s)+n(h)+n(c))}else o(i[a],r);return r}(a,r),r._strength=r._strength||1,r._color="rgba("+(s=r)._red+", "+s._green+", "+s._blue+", "+s._strength+")"}}()}),a.defaultShader("Color",new a.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec4 aColor;\n\nvarying lowp vec4 vColor;\n\nuniform  vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vColor = vec4(aColor.rgb*aColor.a*aLayer.y, aColor.a*aLayer.y);\n}","precision mediump float;\nvarying lowp vec4 vColor;\nvoid main(void) {\n	gl_FragColor = vColor;\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aColor",width:4}],function(t,e){t.program.writeVector("aColor",e._red/255,e._green/255,e._blue/255,e._strength)})),a.c("Color",{_red:0,_green:0,_blue:0,_strength:1,_color:"",ready:!0,init:function(){this.__coord=this.__coord||[0,0,0,0],this.bind("Draw",this._drawColor),this._drawLayer&&this._setupColor(this._drawLayer),this.trigger("Invalidate")},events:{LayerAttached:"_setupColor"},remove:function(){this.unbind("Draw",this._drawColor),this.has("DOM")&&(this._element.style.backgroundColor="transparent"),this.trigger("Invalidate")},_setupColor:function(t){"WebGL"===t.type&&this._establishShader("Color",a.defaultShader("Color"))},_drawColor:function(t){this._color&&("DOM"===t.type?(t.style.backgroundColor=this._color,t.style.lineHeight=0):"canvas"===t.type?(t.ctx.fillStyle=this._color,t.ctx.fillRect(t.pos._x,t.pos._y,t.pos._w,t.pos._h)):"webgl"===t.type&&t.program.draw(t,this))},color:function(t){return 0==arguments.length?this._color:(arguments.length>=3?(this._red=arguments[0],this._green=arguments[1],this._blue=arguments[2],"number"==typeof arguments[3]&&(this._strength=arguments[3])):(a.assignColor(t,this),"number"==typeof arguments[1]&&(this._strength=arguments[1])),this._color="rgba("+this._red+", "+this._green+", "+this._blue+", "+this._strength+")",this.trigger("Invalidate"),this)}})},{"../core/core.js":10}],28:[function(t,e,i){var a=t("../core/core.js"),r=window.document;a.extend({domHelper:{innerPosition:function(t,e){e=e||{};var i=t.getBoundingClientRect(),a=i.left+(window.pageXOffset?window.pageXOffset:r.body.scrollLeft),n=i.top+(window.pageYOffset?window.pageYOffset:r.body.scrollTop),o=parseInt(this.getStyle(t,"border-left-width")||0,10)||parseInt(this.getStyle(t,"borderLeftWidth")||0,10)||0,s=parseInt(this.getStyle(t,"border-top-width")||0,10)||parseInt(this.getStyle(t,"borderTopWidth")||0,10)||0;return e.x=a+o,e.y=n+s,e},getStyle:function(t,e){var i;return t.currentStyle?i=t.currentStyle[this.camelize(e)]:window.getComputedStyle&&(i=r.defaultView.getComputedStyle(t,null).getPropertyValue(this.csselize(e))),i},camelize:function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},csselize:function(t){return t.replace(/[A-Z]/g,function(t){return t?"-"+t.toLowerCase():""})},translate:function(t,e,i,n){n=n||{};var o,s=r.documentElement,l=r.body;return i?(o=i._viewportRect(),n.x=(t-a.stage.x+(s&&s.scrollLeft||l&&l.scrollLeft||0))/o._scale+o._x,n.y=(e-a.stage.y+(s&&s.scrollTop||l&&l.scrollTop||0))/o._scale+o._y):(o=a.viewport,n.x=(t-a.stage.x+(s&&s.scrollLeft||l&&l.scrollLeft||0))/o._scale-o._x,n.y=(e-a.stage.y+(s&&s.scrollTop||l&&l.scrollTop||0))/o._scale-o._y),n}}})},{"../core/core.js":10}],29:[function(t,e,i){var a=t("../core/core.js"),r=window.document;a._registerLayerTemplate("DOM",{type:"DOM",_changedObjs:[],_div:null,events:{LayerInit:"layerInit",LayerRemove:"layerRemove",RenderScene:"_render",PixelartSet:"_setPixelart"},layerInit:function(){this._changedObjs=[];var t=this._div=r.createElement("div");a.stage.elem.appendChild(t),t.style.position="absolute",t.style.zIndex=this.options.z,t.style.transformStyle="preserve-3d"},layerRemove:function(){this._div.parentNode.removeChild(this._div)},_setPixelArt:function(t){var e=this._div.style,i=a.domHelper.camelize;t?(e[i("image-rendering")]="optimizeSpeed",e[i("image-rendering")]="-moz-crisp-edges",e[i("image-rendering")]="-o-crisp-edges",e[i("image-rendering")]="-webkit-optimize-contrast",e[i("-ms-interpolation-mode")]="nearest-neighbor",e[i("image-rendering")]="optimize-contrast",e[i("image-rendering")]="pixelated",e[i("image-rendering")]="crisp-edges"):(e[i("image-rendering")]="optimizeQuality",e[i("-ms-interpolation-mode")]="bicubic",e[i("image-rendering")]="auto")},debug:function(){a.log(this._changedObjs)},_render:function(){var t=this._changedObjs;if(this._dirtyViewport&&(this._setViewport(),this._dirtyViewport=!1),t.length){for(var e=0,i=t.length;e<i;++e)t[e].draw()._changed=!1;t.length=0}},dirty:function(t){this._changedObjs.push(t)},attach:function(t){t._drawContext=this.context,this._div.appendChild(t._element),t._element.style.position="absolute",t._element.id="ent"+t[0]},detach:function(t){this._div.removeChild(t._element)},_setViewport:function(){var t=this._div.style,e=this._viewportRect(),i=e._scale,r=-e._x*i,n=-e._y*i;t.transform=t[a.support.prefix+"Transform"]="scale("+i+", "+i+")",t.left=Math.round(r)+"px",t.top=Math.round(n)+"px",t.zIndex=this.options.z}})},{"../core/core.js":10}],30:[function(t,e,i){var a=t("../core/core.js"),r=window.document;a.c("DOM",{_element:null,_cssStyles:null,avoidCss3dTransforms:!1,init:function(){this.requires("Renderable"),this._cssStyles={visibility:"",left:"",top:"",width:"",height:"",zIndex:"",opacity:"",transformOrigin:"",transform:""},this._element=r.createElement("div"),this._customLayer||this._attachToLayer(a.s("DefaultDOMLayer")),this.bind("NewComponent",this._updateClass),this.bind("RemoveComponent",this._removeClass)},remove:function(){this._detachFromLayer(),this.unbind("NewComponent",this._updateClass),this.unbind("RemoveComponent",this._removeClass)},getDomId:function(){return this._element.id},_removeClass:function(t){var e,i=this.__c,a="";for(e in i)e!==t&&(a+=" "+e);a=a.substr(1),this._element.className=a},_updateClass:function(){var t,e=this.__c,i="";for(t in e)i+=" "+t;i=i.substr(1),this._element.className=i},DOM:function(t){if(t&&t.nodeType){var e=this._drawLayer;this._detachFromLayer(),this._element=t,this._attachToLayer(e)}return this},draw:function(){var t=this._element.style,e=this.__coord||[0,0,0,0],i={x:e[0],y:e[1],w:e[2],h:e[3]},r=a.support.prefix,n=[];if(this._cssStyles.visibility!==this._visible&&(this._cssStyles.visibility=this._visible,this._visible?t.visibility="visible":t.visibility="hidden"),a.support.css3dtransform&&!this.avoidCss3dTransforms?n.push("translate3d("+~~this._x+"px,"+~~this._y+"px,0)"):(this._cssStyles.left!==this._x&&(this._cssStyles.left=this._x,t.left=~~this._x+"px"),this._cssStyles.top!==this._y&&(this._cssStyles.top=this._y,t.top=~~this._y+"px")),this._cssStyles.width!==this._w&&(this._cssStyles.width=this._w,t.width=~~this._w+"px"),this._cssStyles.height!==this._h&&(this._cssStyles.height=this._h,t.height=~~this._h+"px"),this._cssStyles.zIndex!==this._z&&(this._cssStyles.zIndex=this._z,t.zIndex=this._z),this._cssStyles.opacity!==this._alpha&&(this._cssStyles.opacity=this._alpha,t.opacity=this._alpha,t[r+"Opacity"]=this._alpha),this._mbr){var o=this._origin.x+"px "+this._origin.y+"px";t.transformOrigin=o,t[r+"TransformOrigin"]=o,a.support.css3dtransform?n.push("rotateZ("+this._rotation+"deg)"):n.push("rotate("+this._rotation+"deg)")}return this._flipX&&n.push("scaleX(-1)"),this._flipY&&n.push("scaleY(-1)"),this._cssStyles.transform!==n.join(" ")&&(this._cssStyles.transform=n.join(" "),t.transform=this._cssStyles.transform,t[r+"Transform"]=this._cssStyles.transform),this.trigger("Draw",{style:t,type:"DOM",co:i}),this},_setCssProperty:function(t,e,i){e=a.domHelper.camelize(e),"number"==typeof i&&(i+="px"),t[e]=i,this.trigger("SetStyle",e)},css:function(t,e){var i,r,n=this._element,o=n.style;if("object"==typeof t)for(i in t)t.hasOwnProperty(i)&&(r=t[i],this._setCssProperty(o,i,r));else{if(!e)return a.domHelper.getStyle(n,t);this._setCssProperty(o,t,e)}return this.trigger("Invalidate"),this}})},{"../core/core.js":10}],31:[function(t,e,i){var a=t("../core/core.js");a.extend({background:function(t){a.stage.elem.style.background=t},_pixelartEnabled:!1,pixelart:function(t){a._pixelartEnabled=t,a.trigger("PixelartSet",t)}})},{"../core/core.js":10}],32:[function(t,e,i){var a=t("../core/core.js");function r(t,e){this.gl=t,this.webgl=e,this.max_units=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.bound_textures=[],this.registered_textures={},this.active=null}function n(t,e){this.manager=t,this.gl=t.gl,this.glTexture=this.gl.createTexture(),this.id=e,this.active=!1,this.unit=null,this.powerOfTwo=!1}a.TextureManager=r,r.prototype={reset:function(){for(var t=0;t<this.bound_textures.length;t++)this.bound_textures[t].unbind();this.bound_textures=[],this.active=null},makeTexture:function(t,e,i){var a=this.webgl,r="texture-(r:"+i+")-"+t;if(void 0!==this.registered_textures[r])return this.registered_textures[r];var o=new n(this,r);return this.registered_textures[r]=o,this.bindTexture(o),o.setImage(e),o.setFilter(a.texture_filter),o.setRepeat(i),o},smallest:function(){for(var t=1/0,e=null,i=0;i<this.bound_textures.length;i++){var a=this.bound_textures[i];a.size<t&&(t=a.size,e=i)}return e},getAvailableUnit:function(){return this.bound_textures.length<this.max_units?this.bound_textures.length:this.smallest()},bindTexture:function(t){if(null===t.unit){var e=this.getAvailableUnit();this.bound_textures[e]&&this.unbindTexture(this.bound_textures[e]),this.bound_textures[e]=t,t.bind(e)}},unbindTexture:function(t){t.unbind()},setActiveTexture:function(t){this.active!==t.id&&(this.gl.activeTexture(this.gl[t.name]),this.active=t.unit)}},a.TextureWrapper=n,n.prototype={bind:function(t){var e=this.gl;this.unit=t,this.name="TEXTURE"+t,this.manager.setActiveTexture(this),e.bindTexture(e.TEXTURE_2D,this.glTexture)},isActive:function(){return this.manager.active===this.unit},unbind:function(){this.unit=null,this.name=null,this.isActive()&&(this.manager.active=null)},setImage:function(t){if(!this.isActive())throw"Trying to set image of texture that isn't active";this.width=t.width,this.height=t.height,this.size=t.width*t.height,this.powerOfTwo=!(Math.log(t.width)/Math.LN2!==Math.floor(Math.log(t.width)/Math.LN2)||Math.log(t.height)/Math.LN2!==Math.floor(Math.log(t.height)/Math.LN2));var e=this.gl;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)},setFilter:function(t){if(!this.isActive())throw"Trying to set filter of texture that isn't active";var e=this.gl;e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t)},setRepeat:function(t){if(!this.isActive())throw"Trying to set repeat property of texture that isn't active";if(t&&!this.powerOfTwo)throw"Can't create a repeating image whose dimensions aren't a power of 2 in WebGL contexts";var e=this.gl;this.repeatMode=t?e.REPEAT:e.CLAMP_TO_EDGE,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this.repeatMode),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this.repeatMode)},setToProgram:function(t,e,i){if(null===this.unit)throw"Trying to use texture not set to a texture unit.";var a=this.gl;a.useProgram(t),a.uniform1i(a.getUniformLocation(t,e),this.unit),a.uniform2f(a.getUniformLocation(t,i),this.width,this.height)}}},{"../core/core.js":10}],33:[function(t,e,i){t("../core/core.js").c("HTML",{inner:"",init:function(){this.requires("2D, DOM")},replace:function(t){return this.inner=t,this._element.innerHTML=t,this},append:function(t){return this.inner+=t,this._element.innerHTML+=t,this},prepend:function(t){return this.inner=t+this.inner,this._element.innerHTML=t+this.inner,this}})},{"../core/core.js":10}],34:[function(t,e,i){var a=t("../core/core.js");a.defaultShader("Image",new a.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\n\nvarying mediump vec3 vTextureCoord;\n\nuniform vec4 uViewport;\nuniform mediump vec2 uTextureDimensions;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n  \n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n}","varying mediump vec3 vTextureCoord;\n  \nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nvoid main(void) {\n  highp vec2 coord =   vTextureCoord.xy / uTextureDimensions;\n  mediump vec4 base_color = texture2D(uSampler, coord);\n  gl_FragColor = vec4(base_color.rgb*base_color.a*vTextureCoord.z, base_color.a*vTextureCoord.z);\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2}],function(t,e){var i=t.pos;t.program.writeVector("aTextureCoord",0,0,0,i._h,i._w,0,i._w,i._h)})),a.c("Image",{_repeat:"repeat",ready:!1,init:function(){this.bind("Draw",this._drawImage),this.bind("LayerAttached",this._setupImage)},remove:function(){this.unbind("LayerAttached",this._setupImage),this.unbind("Draw",this._drawImage)},image:function(t,e){if(this.__image=t,this._repeat=e||"no-repeat",this.img=a.asset(t),this.img)this._setupImage(this._drawLayer);else{this.img=new Image,a.asset(t,this.img),this.img.src=t;var i=this;this.img.onload=function(){i._setupImage(i._drawLayer)}}return this.trigger("Invalidate"),this},_setupImage:function(t){this.img&&t&&("Canvas"===t.type?this._pattern=this._drawContext.createPattern(this.img,this._repeat):"WebGL"===t.type&&(this._establishShader("image:"+this.__image,a.defaultShader("Image")),this.program.setTexture(this._drawLayer.makeTexture(this.__image,this.img,"no-repeat"!==this._repeat))),"no-repeat"===this._repeat&&(this.w=this.w||this.img.width,this.h=this.h||this.img.height),this.ready=!0,this.trigger("Invalidate"))},_drawImage:function(t){if("canvas"===t.type){if(this.ready&&this._pattern){var e=t.ctx;e.fillStyle=this._pattern,e.save(),e.translate(t.pos._x,t.pos._y),e.fillRect(0,0,t.pos._w,t.pos._h),e.restore()}}else"DOM"===t.type?this.__image&&(t.style.backgroundImage="url("+this.__image+")",t.style.backgroundRepeat=this._repeat):"webgl"===t.type&&t.program.draw(t,this)}})},{"../core/core.js":10}],35:[function(t,e,i){var a=t("../core/core.js");a.extend({_drawLayerTemplates:{},_drawLayers:[],_addDrawLayerInstance:function(t){a._drawLayers.push(t),this._drawLayers.sort(function(t,e){return t.options.z-e.options.z})},_removeDrawLayerInstance:function(t){var e=this._drawLayers.indexOf(t);e>=0&&this._drawLayers.splice(e,1),this._drawLayers.sort(function(t,e){return t.options.z-e.options.z})},_registerLayerTemplate:function(t,e){this._drawLayerTemplates[t]=e;var i=this._commonLayerProperties;for(var a in i)e[a]||(e[a]=i[a])},_commonLayerProperties:{options:{xResponse:1,yResponse:1,scaleResponse:1,z:0},_pointerEntities:0,_dirtyViewport:!1,_cachedViewportRect:null,init:function(){this._cachedViewportRect={},this.trigger("LayerInit"),this.uniqueBind("InvalidateViewport",function(){this._dirtyViewport=!0}),this.trigger("PixelartSet",a._pixelartEnabled),a._addDrawLayerInstance(this)},remove:function(){this.trigger("LayerRemove"),a._removeDrawLayerInstance(this)},_sort:function(t,e){return t._globalZ-e._globalZ},_viewportRect:function(t){var e=this._cachedViewportRect;if(t)return e;var i=a.viewport,r=this.options,n=Math.pow(i._scale,r.scaleResponse);return e._scale=n,e._w=i._width/n,e._h=i._height/n,e._x=-(r.xResponse*i._x)-.5*(r.xResponse-1)*(1-1/n)*i._width,e._y=-(r.yResponse*i._y)-.5*(r.yResponse-1)*(1-1/n)*i._height,e},_viewTransformRect:function(t,e,i){var a=this._viewportRect(i),r=a._scale;return(e=e||{})._x=t._x*r+Math.round(-a._x*r),e._y=t._y*r+Math.round(-a._y*r),e._w=t._w*r,e._h=t._h*r,e}},createLayer:function(t,e,i){var r=this._drawLayerTemplates[e];a.s(t,r,i),a.c(t,{init:function(){this.requires("Renderable"),this._customLayer=!0,this.requires(r.type),this._attachToLayer(a.s(t))},remove:function(){this._detachFromLayer()}})}})},{"../core/core.js":10}],36:[function(t,e,i){var a=t("../core/core.js");a.c("Particles",{required:"Renderable",ready:!0,_particlesPaused:!1,init:function(){this._Particles=a.clone(this._Particles),this._Particles.init(),this._Particles.parentEntity=this},events:{UpdateFrame:function(){!this._particlesPaused&&this._Particles.active&&(this._Particles.update(),this.trigger("Invalidate"))},Draw:function(t){this._Particles.active&&"canvas"===t.type&&this._Particles.render(t)}},particles:function(t){return this._Particles.config(t),this._Particles.start(),this},_Particles:{presets:{maxParticles:150,size:18,sizeRandom:4,speed:1,speedRandom:1.2,lifeSpan:29,lifeSpanRandom:7,angle:65,angleRandom:34,startColour:[255,131,0,1],startColourRandom:[48,50,45,0],endColour:[245,35,0,0],endColourRandom:[60,60,60,0],sharpness:20,sharpnessRandom:10,spread:10,duration:-1,fastMode:!1,gravity:{x:0,y:.1},jitter:0,originOffset:{x:0,y:0}},emissionRate:0,elapsedFrames:0,emitCounter:0,active:!0,particles:[],init:function(){for(var t in this.presets)this[t]=this.presets[t]},config:function(t){for(var e in t=t||{})this[e]=t[e];if(this.emissionRate=this.maxParticles/this.lifeSpan,this.particles.length!==this.maxParticles){this.particles.length=0;for(var i=0,a=this.maxParticles;i<a;++i)this.particles.push(new this.Particle)}},start:function(){this.active=!0,this.elapsedFrames=0,this.emitCounter=0;for(var t=this.particles,e=0,i=t.length;e<i;++e)t[e].timeToLive=0;this.parentEntity.trigger("ParticleStart")},stop:function(){this.active=!1,this.parentEntity.trigger("ParticleEnd")},initParticle:function(t){var e,i,a,r,n,o,s,l,h,c,u,d,p,y;t.timeToLive=r=this.lifeSpan+this.lifeSpanRandom*this.RANDM1TO1(),t.positionX=this.originOffset.x+this.spread*this.RANDM1TO1(),t.positionY=this.originOffset.y+this.spread*this.RANDM1TO1(),e=(this.angle+this.angleRandom*this.RANDM1TO1())*(Math.PI/180),i=this.speed+this.speedRandom*this.RANDM1TO1(),t.directionX=Math.sin(e)*i,t.directionY=-Math.cos(e)*i,a=this.size+this.sizeRandom*this.RANDM1TO1(),t.size=a=a<0?0:~~a,n=this.sharpness+this.sharpnessRandom*this.RANDM1TO1(),t.sharpness=n=n>100?100:n<0?0:n,t.sizeSmall=~~(a/200*n),o=s=this.startColour[0]+this.startColourRandom[0]*this.RANDM1TO1(),t.colourR=o>255?255:o<0?0:~~o,o=l=this.startColour[1]+this.startColourRandom[1]*this.RANDM1TO1(),t.colourG=o>255?255:o<0?0:~~o,o=h=this.startColour[2]+this.startColourRandom[2]*this.RANDM1TO1(),t.colourB=o>255?255:o<0?0:~~o,o=c=this.startColour[3]+this.startColourRandom[3]*this.RANDM1TO1(),t.colourA=o>1?1:o<0?0:~~(100*o)/100,u=this.endColour[0]+this.endColourRandom[0]*this.RANDM1TO1(),d=this.endColour[1]+this.endColourRandom[1]*this.RANDM1TO1(),p=this.endColour[2]+this.endColourRandom[2]*this.RANDM1TO1(),y=this.endColour[3]+this.endColourRandom[3]*this.RANDM1TO1(),t.deltaColourR=(u-s)/r,t.deltaColourG=(d-l)/r,t.deltaColourB=(p-h)/r,t.deltaColourA=(y-c)/r},update:function(){var t=this.RANDM1TO1,e=this.gravity.x,i=this.gravity.y,a=this.jitter;this.elapsedFrames++,this.duration>=0&&this.duration<this.elapsedFrames&&this.stop();var r=this.emissionRate>0?1/this.emissionRate:1/0;this.emitCounter++;for(var n,o,s=this.particles,l=0,h=s.length;l<h;++l)(o=s[l]).timeToLive>0?(o.directionX+=e,o.directionY+=i,o.positionX+=o.directionX,o.positionY+=o.directionY,a&&(o.positionX+=a*t(),o.positionY+=a*t()),n=o.colourR+o.deltaColourR,o.colourR=n>255?255:n<0?0:~~n,n=o.colourG+o.deltaColourG,o.colourG=n>255?255:n<0?0:~~n,n=o.colourB+o.deltaColourB,o.colourB=n>255?255:n<0?0:~~n,n=o.colourA+o.deltaColourA,o.colourA=n>1?1:n<0?0:~~(100*n)/100,o.timeToLive--):this.emitCounter>r&&(this.initParticle(o),this.emitCounter-=r)},render:function(t){for(var e,i=t.ctx,a=this.particles,r=0,n=a.length;r<n;r++){var o=(e=a[r]).size,s=o>>1;if(!(e.positionX<0)&&!(e.positionX+o>t.pos._w)&&!(e.positionY<0)&&!(e.positionY+o>t.pos._h)){var l=~~(t.pos._x+e.positionX),h=~~(t.pos._y+e.positionY),c=e.colourR,u=e.colourG,d=e.colourB,p="rgba("+c+","+u+","+d+","+e.colourA+")";if(this.fastMode)i.fillStyle=p;else{var y="rgba("+c+","+u+","+d+",0)",m=i.createRadialGradient(l+s,h+s,e.sizeSmall,l+s,h+s,s);m.addColorStop(0,p),m.addColorStop(.9,y),i.fillStyle=m}i.fillRect(l,h,o,o)}}},Particle:function(){this.positionX=0,this.positionY=0,this.directionX=0,this.directionY=0,this.size=0,this.sizeSmall=0,this.timeToLive=0,this.colourR=0,this.colourG=0,this.colourB=0,this.colourA=0,this.deltaColourR=0,this.deltaColourG=0,this.deltaColourB=0,this.deltaColourA=0,this.sharpness=0},RANDM1TO1:function(){return 2*Math.random()-1}},pauseParticles:function(){this._particlesPaused=!0},resumeParticles:function(){this._particlesPaused=!1}})},{"../core/core.js":10}],37:[function(t,e,i){t("../core/core.js").c("Renderable",{_changed:!1,_alpha:1,_visible:!0,_setterRenderable:function(t,e){this[t]!==e&&(this[t]=e,this.trigger("Invalidate"))},properties:{alpha:{set:function(t){this._setterRenderable("_alpha",t)},get:function(){return this._alpha},configurable:!0,enumerable:!0},_alpha:{enumerable:!1},visible:{set:function(t){this._setterRenderable("_visible",t)},get:function(){return this._visible},configurable:!0,enumerable:!0},_visible:{enumerable:!1}},init:function(){},_hideOnUnfreeze:!1,events:{Freeze:function(){this._hideOnUnfreeze=!this._visible,this._visible=!1,this.trigger("Invalidate")},Unfreeze:function(){this._visible=!this._hideOnUnfreeze,this.trigger("Invalidate")}},_invalidateRenderable:function(){!1===this._changed&&(this._changed=!0,this._drawLayer.dirty(this))},_attachToLayer:function(t){this._drawLayer&&this._detachFromLayer(),this._drawLayer=t,t.attach(this),this.bind("Invalidate",this._invalidateRenderable),this.trigger("LayerAttached",t),this.trigger("Invalidate")},_detachFromLayer:function(){this._drawLayer&&(this._drawLayer.detach(this),this.unbind("Invalidate",this._invalidateRenderable),this.trigger("LayerDetached",this._drawLayer),delete this._drawLayer)},flip:function(t){return this["_flip"+(t=t||"X")]||(this["_flip"+t]=!0,this.trigger("Invalidate")),this},unflip:function(t){return this["_flip"+(t=t||"X")]&&(this["_flip"+t]=!1,this.trigger("Invalidate")),this}})},{"../core/core.js":10}],38:[function(t,e,i){var a=t("../core/core.js");a.c("SpriteAnimation",{_reels:null,_currentReelId:null,_currentReel:null,_isPlaying:!1,animationSpeed:1,init:function(){this._reels={}},reel:function(t,e,i,r,n,o){var s,l;if(0==arguments.length)return this._currentReelId;if(1==arguments.length&&"string"==typeof t){if(void 0===this._reels[t])throw"The specified reel "+t+" is undefined.";return this.pauseAnimation(),this._currentReelId!==t&&(this._currentReelId=t,this._currentReel=this._reels[t],this._updateSprite(),this.trigger("ReelChange",this._currentReel)),this}if((s={id:t,frames:[],currentFrame:0,easing:new a.easing(e),defaultLoops:1}).duration=s.easing.duration,"number"==typeof i){if(o=o||1/0,n>=0)for(l=0;l<n;++l)s.frames.push([i,r]),++i>=o&&(i=0,r++);else for(l=0;l>n;--l)s.frames.push([i,r]),--i<0&&(i=o-1,r--)}else if(3==arguments.length&&"object"==typeof i)s.frames=i;else throw"Unrecognized arguments. Please see the documentation for 'reel(...)'.";return this._reels[t]=s,this},animate:function(t,e){"string"==typeof t&&this.reel(t);var i=this._currentReel;if(null==i)throw"No reel is specified, and there is no currently active reel.";return this.pauseAnimation(),void 0===e&&(e="number"==typeof t?t:1),i.easing.reset(),this.loops(e),this._setFrame(0),this.bind("UpdateFrame",this._animationTick),this._isPlaying=!0,this.trigger("StartAnimation",i),this},resumeAnimation:function(){return!1===this._isPlaying&&null!==this._currentReel&&(this.bind("UpdateFrame",this._animationTick),this._isPlaying=!0,this._currentReel.easing.resume(),this.trigger("StartAnimation",this._currentReel)),this},pauseAnimation:function(){return!0===this._isPlaying&&(this.unbind("UpdateFrame",this._animationTick),this._isPlaying=!1,this._reels[this._currentReelId].easing.pause()),this},resetAnimation:function(){var t=this._currentReel;if(null===t)throw"No active reel to reset.";return this.reelPosition(0),t.easing.repeat(t.defaultLoops),this},loops:function(t){return 0==arguments.length?null!==this._currentReel?this._currentReel.easing.loops:0:(null!==this._currentReel&&(t<0&&(t=1/0),this._currentReel.easing.repeat(t),this._currentReel.defaultLoops=t),this)},reelPosition:function(t){if(null===this._currentReel)throw"No active reel.";if(0==arguments.length)return this._currentReel.currentFrame;var e,i=this._currentReel.frames.length;if("end"===t&&(t=i-1),t<1&&t>0)t=Math.floor(i*(e=t));else{if(t!==Math.floor(t))throw"Position "+t+" is invalid.";t<0&&(t=i-1+t),e=t/i}return t=Math.max(t=Math.min(t,i-1),0),this._setProgress(e),this._setFrame(t),this},reelFrame:function(t){if(null===this._currentReel)throw"No active reel.";var e=this._currentReel.frames.indexOf(t);if(-1===e)throw"Frame name "+t+" is invalid.";return this.reelPosition(e),this},_animationTick:function(t){var e=this._reels[this._currentReelId];e.easing.tick(t.dt*this.animationSpeed);var i=e.easing.value(),a=Math.min(Math.floor(e.frames.length*i),e.frames.length-1);this._setFrame(a),!0===e.easing.complete&&(this.pauseAnimation(),this.trigger("AnimationEnd",this._currentReel))},_setFrame:function(t){var e=this._currentReel;t!==e.currentFrame&&(e.currentFrame=t,this._updateSprite(),this.trigger("FrameChange",e))},_updateSprite:function(){var t=this._currentReel,e=t.frames[t.currentFrame];"string"==typeof e?this.sprite(e):this.sprite(e[0],e[1])},_setProgress:function(t,e){this._currentReel.easing.setProgress(t,e)},isPlaying:function(t){return!!this._isPlaying&&(t?this._currentReelId===t:!!this._currentReelId)},getReel:function(t){if(0==arguments.length){if(!this._currentReelId)return null;t=this._currentReelId}return this._reels[t]}})},{"../core/core.js":10}],39:[function(t,e,i){var a=t("../core/core.js");a.defaultShader("Sprite",new a.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\n\nvarying mediump vec3 vTextureCoord;\n\nuniform vec4 uViewport;\nuniform mediump vec2 uTextureDimensions;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n  \n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n}","varying mediump vec3 vTextureCoord;\n  \nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nvoid main(void) {\n  highp vec2 coord =   vTextureCoord.xy / uTextureDimensions;\n  mediump vec4 base_color = texture2D(uSampler, coord);\n  gl_FragColor = vec4(base_color.rgb*base_color.a*vTextureCoord.z, base_color.a*vTextureCoord.z);\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2}],function(t,e){var i=t.co;t.program.writeVector("aTextureCoord",i.x,i.y,i.x,i.y+i.h,i.x+i.w,i.y,i.x+i.w,i.y+i.h)})),a.extend({sprite:function(t,e,i,r,n,o,s){"string"==typeof t&&(o=n,n=r,r=e,i=t,t=1,e=1),"string"==typeof e&&(o=n,n=r,r=i,i=e,e=t),!o&&n&&(o=n),n=parseInt(n||0,10),o=parseInt(o||0,10);var l,h,c,u=function(){this.ready=!0,this.trigger("Invalidate")};(c=a.asset(i))||((c=new Image).src=i,a.asset(i,c),c.onload=function(){for(var t in r)a(t).each(u)});var d=function(){this.requires("2D, Sprite"),this.__trim=[0,0,0,0],this.__image=i,this.__map=r,this.__coord=[this.__coord[0],this.__coord[1],this.__coord[2],this.__coord[3]],this.__tile=t,this.__tileh=e,this.__padding=[n,o],this.__padBorder=s,this.sprite(this.__coord[0],this.__coord[1],this.__coord[2],this.__coord[3]),this.img=c,this.img.complete&&this.img.width>0&&(this.ready=!0,this.trigger("Invalidate")),this.w=this.__coord[2],this.h=this.__coord[3],this._setupSpriteImage(this._drawLayer)};for(l in r)r.hasOwnProperty(l)&&(h=r[l],a.c(l,{ready:!1,__coord:[h[0],h[1],h[2]||1,h[3]||1],init:d}));return this}}),a.c("Sprite",{__image:"",__tile:0,__tileh:0,__padding:null,__trim:null,img:null,ready:!1,init:function(){this.__trim=[0,0,0,0],this.bind("Draw",this._drawSprite),this.bind("LayerAttached",this._setupSpriteImage)},remove:function(){this.unbind("Draw",this._drawSprite),this.unbind("LayerAttached",this._setupSpriteImage)},_setupSpriteImage:function(t){this.__image&&this.img&&t&&"WebGL"===t.type&&(this._establishShader(this.__image,a.defaultShader("Sprite")),this.program.setTexture(t.makeTexture(this.__image,this.img,!1)))},_drawSprite:function(t){var e=t.co,i=t.pos,a=t.ctx;if("canvas"===t.type)a.drawImage(this.img,e.x,e.y,e.w,e.h,i._x,i._y,i._w,i._h);else if("DOM"===t.type){var r=this._h/e.h,n=this._w/e.w,o=this._element.style,s=o.backgroundColor;"initial"===s&&(s="");var l=s+" url('"+this.__image+"') no-repeat";l!==o.background&&(o.background=l),o.backgroundPosition="-"+e.x*n+"px -"+e.y*r+"px",(1!==r||1!==n)&&(o.backgroundSize=this.img.width*n+"px "+this.img.height*r+"px")}else"webgl"===t.type&&t.program.draw(t,this)},sprite:function(t,e,i,a){if("string"==typeof t){var r=this.__map[t];if(!r)return this;t=r[0],e=r[1],i=r[2]||1,a=r[3]||1}return this.__coord=this.__coord||[0,0,0,0],this.__coord[0]=t*(this.__tile+this.__padding[0])+(this.__padBorder?this.__padding[0]:0)+this.__trim[0],this.__coord[1]=e*(this.__tileh+this.__padding[1])+(this.__padBorder?this.__padding[1]:0)+this.__trim[1],void 0!==i&&void 0!==a&&(this.__coord[2]=this.__trim[2]||i*this.__tile||this.__tile,this.__coord[3]=this.__trim[3]||a*this.__tileh||this.__tileh),this.trigger("Invalidate"),this},crop:function(t,e,i,a){var r=this._mbr||this.pos();return this.__trim=[],this.__trim[0]=t,this.__trim[1]=e,this.__trim[2]=i,this.__trim[3]=a,this.__coord[0]+=t,this.__coord[1]+=e,this.__coord[2]=i,this.__coord[3]=a,this._w=i,this._h=a,this.trigger("Invalidate",r),this}})},{"../core/core.js":10}],40:[function(t,e,i){var a,r,n=t("../core/core.js");n.c("Text",{_text:"",defaultSize:"10px",defaultFamily:"sans-serif",defaultVariant:"normal",defaultLineHeight:"normal",defaultTextAlign:"left",ready:!0,init:function(){this.requires("2D"),this._textFont={type:"",weight:"",size:this.defaultSize,lineHeight:this.defaultLineHeight,family:this.defaultFamily,variant:this.defaultVariant},this._textAlign=this.defaultTextAlign},events:{Draw:function(t){var e=this._fontString();if("DOM"===t.type){var i=this._element,a=i.style;a.color=this._textColor,a.font=e,a.textAlign=this._textAlign,i.innerHTML=this._text}else if("canvas"===t.type){var r=t.ctx;r.save(),r.textBaseline="top",r.fillStyle=this._textColor||"rgb(0,0,0)",r.font=e,r.textAlign=this._textAlign,r.fillText(this._text,t.pos._x,t.pos._y),r.restore()}},SetStyle:function(t){switch(t){case"textAlign":this._textAlign=this._element.style.textAlign;break;case"color":this.textColor(this._element.style.color);break;case"fontType":this._textFont.type=this._element.style.fontType;break;case"fontWeight":this._textFont.weight=this._element.style.fontWeight;break;case"fontSize":this._textFont.size=this._element.style.fontSize;break;case"fontFamily":this._textFont.family=this._element.style.fontFamily;break;case"fontVariant":this._textFont.variant=this._element.style.fontVariant;break;case"lineHeight":this._textFont.lineHeight=this._element.style.lineHeight}}},remove:function(){this.unbind(this._textUpdateEvent,this._dynamicTextUpdate)},_getFontHeight:(a=/([a-zA-Z]+)\b/,r={px:1,pt:4/3,pc:16,cm:96/2.54,mm:96/25.4,in:96,em:void 0,ex:void 0},function(t){var e=parseFloat(t),i=a.exec(t),n=i?i[1]:"px";return void 0!==r[n]?Math.ceil(e*r[n]):Math.ceil(e)}),_textGenerator:null,text:function(t,e){return null!=t?("function"==typeof t?(this._text=t.call(this,e),this._textGenerator=t):(this._text=t,this._textGenerator=null),this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this):this._text},_dynamicTextOn:!1,_textUpdateEvent:null,_dynamicTextUpdate:function(t){this._textGenerator&&this.text(this._textGenerator,t)},dynamicTextGeneration:function(t,e){return this.unbind(this._textUpdateEvent,this._dynamicTextUpdate),t&&(this._textUpdateEvent=e||"UpdateFrame",this.bind(this._textUpdateEvent,this._dynamicTextUpdate)),this},_resizeForCanvas:function(){var t=this._drawContext;t.font=this._fontString(),this.w=t.measureText(this._text).width;var e=this._textFont.size||this.defaultSize;this.h=1.1*this._getFontHeight(e),"left"===this._textAlign||"start"===this._textAlign?this.offsetBoundary(0,0,0,0):"center"===this._textAlign?this.offsetBoundary(this.w/2,0,-this.w/2,0):("end"===this._textAlign||"right"===this._textAlign)&&this.offsetBoundary(this.w,0,-this.w,0)},_fontString:function(){return this._textFont.type+" "+this._textFont.variant+" "+this._textFont.weight+" "+this._textFont.size+" / "+this._textFont.lineHeight+" "+this._textFont.family},textColor:function(t){return n.assignColor(t,this),this._textColor="rgba("+this._red+", "+this._green+", "+this._blue+", "+this._strength+")",this.trigger("Invalidate"),this},textAlign:function(t){return this._textAlign=t,this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this},textFont:function(t,e){if(1==arguments.length){if("string"==typeof t)return this._textFont[t];if("object"==typeof t)for(var i in t)"family"===i?this._textFont[i]="'"+t[i]+"'":this._textFont[i]=t[i]}else this._textFont[t]=e;return this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this},unselectable:function(){return this.has("DOM")&&(this.css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",cursor:"default"}),this.trigger("Invalidate")),this}})},{"../core/core.js":10}],41:[function(t,e,i){var a=t("../core/core.js"),r=window.document;a.extend({viewport:{clampToEntities:!0,_width:0,_height:0,_x:0,_y:0,_scale:1,bounds:null,scroll:function(t,e){this[t]=e,a.trigger("ViewportScroll"),a.trigger("InvalidateViewport")},rect_object:{_x:0,_y:0,_w:0,_h:0},rect:function(t){return(t=t||this.rect_object)._x=-this._x,t._y=-this._y,t._w=this._width/this._scale,t._h=this._height/this._scale,t},pan:function(){var t,e,i,r,n;function o(o){n.tick(o.dt);var l=n.value();a.viewport.x=(1-l)*i+l*t,a.viewport.y=(1-l)*r+l*e,a.viewport._clamp(),n.complete&&(s(),a.trigger("CameraAnimationDone"))}function s(){a.unbind("UpdateFrame",o)}return a._preBind("StopCamera",s),function(s,l,h,c){a.trigger("StopCamera"),"reset"!==s&&(i=a.viewport._x,r=a.viewport._y,t=i-s,e=r-l,n=new a.easing(h,c),a.uniqueBind("UpdateFrame",o))}}(),follow:function(){var t,e,i;function r(){var t=a.viewport._scale;a.viewport.scroll("_x",-(this.x+this.w/2-a.viewport.width/2/t-e*t)),a.viewport.scroll("_y",-(this.y+this.h/2-a.viewport.height/2/t-i*t)),a.viewport._clamp()}return a._preBind("StopCamera",function(){t&&(t.unbind("Move",r),t.unbind("ViewportScale",r),t.unbind("ViewportResize",r))}),function(n,o,s){n&&n.has("2D")&&(a.trigger("StopCamera"),t=n,e=void 0!==o?o:0,i=void 0!==s?s:0,n.bind("Move",r),n.bind("ViewportScale",r),n.bind("ViewportResize",r),r.call(n))}}(),centerOn:function(t,e){var i=t.x+a.viewport.x,r=t.y+a.viewport.y,n=t.w/2,o=t.h/2,s=a.viewport.width/2/a.viewport._scale,l=a.viewport.height/2/a.viewport._scale;a.viewport.pan(i+n-s,r+o-l,e)},zoom:function(){var t,e,i,r,n,o,s,l;function h(){a.unbind("UpdateFrame",c)}function c(e){var c,u;l.tick(e.dt),c=Math.pow(i,l.value()),u=1===i?l.value():(1/c-1)/(1/i-1),a.viewport.scale(c*t),a.viewport.scroll("_x",r*(1-u)+n*u),a.viewport.scroll("_y",o*(1-u)+s*u),a.viewport._clamp(),l.complete&&(h(),a.trigger("CameraAnimationDone"))}return a._preBind("StopCamera",h),function(h,u,d,p,y){if(!h){a.viewport.scale(1);return}arguments.length<=2&&(p=u,u=a.viewport.x-a.viewport.width,d=a.viewport.y-a.viewport.height),a.trigger("StopCamera"),e=(t=a.viewport._scale)*(i=h),r=a.viewport.x,o=a.viewport.y,n=-(u-a.viewport.width/(2*e)),s=-(d-a.viewport.height/(2*e)),l=new a.easing(p,y),a.uniqueBind("UpdateFrame",c)}}(),scale:function(t){this._scale=t||1,a.trigger("InvalidateViewport"),a.trigger("ViewportScale")},mouselook:function(){var t,e=!1,i=!1,r={x:0,y:0},n={x:0,y:0};function o(t){i||t.target||(a.trigger("StopCamera"),r.x=t.clientX,r.y=t.clientY,i=!0)}function s(t){if(i){n.x=t.clientX-r.x,n.y=t.clientY-r.y,r.x=t.clientX,r.y=t.clientY;var e=a.viewport;e.x+=n.x/e._scale,e.y+=n.y/e._scale,e._clamp()}}function l(t){i&&(i=!1)}return function(i){t=a.s("Mouse"),i&&!e?(t.bind("MouseDown",o),t.bind("MouseMove",s),t.bind("MouseUp",l),e=i):!i&&e&&(t.unbind("MouseDown",o),t.unbind("MouseMove",s),t.unbind("MouseUp",l),e=i)}}(),_clamp:function(){if(this.clampToEntities){var t=a.clone(this.bounds)||a.map.boundaries();t.max.x*=this._scale,t.min.x*=this._scale,t.max.y*=this._scale,t.min.y*=this._scale,t.max.x-t.min.x>a.viewport.width?a.viewport.x<(-t.max.x+a.viewport.width)/this._scale?a.viewport.x=(-t.max.x+a.viewport.width)/this._scale:a.viewport.x>-t.min.x&&(a.viewport.x=-t.min.x):a.viewport.x=-1*(t.min.x+(t.max.x-t.min.x)/2-a.viewport.width/2),t.max.y-t.min.y>a.viewport.height?a.viewport.y<(-t.max.y+a.viewport.height)/this._scale?a.viewport.y=(-t.max.y+a.viewport.height)/this._scale:a.viewport.y>-t.min.y&&(a.viewport.y=-t.min.y):a.viewport.y=-1*(t.min.y+(t.max.y-t.min.y)/2-a.viewport.height/2)}},init:function(t,e,i){if(void 0===i&&void 0===e&&void 0!==t&&"number"!=typeof t&&(i=t,t=window.innerWidth,e=window.innerHeight),a.createLayer("DefaultCanvasLayer","Canvas",{z:20}),a.createLayer("DefaultDOMLayer","DOM",{z:30}),a.createLayer("DefaultWebGLLayer","WebGL",{z:10}),this._defineViewportProperties(),this._x=0,this._y=0,this._scale=1,this.bounds=null,this._width=t||window.innerWidth,this._height=e||window.innerHeight,void 0===i&&(i="cr-stage"),"string"==typeof i)n=r.getElementById(i);else if("undefined"!=typeof HTMLElement?i instanceof HTMLElement:i instanceof Element)n=i;else throw TypeError("stage_elem must be a string or an HTMLElement");a.stage={x:0,y:0,fullscreen:!1,elem:n||r.createElement("div")},t||e||(r.body.style.overflow="hidden",a.stage.fullscreen=!0),a.addEvent(this,window,"resize",a.viewport.reload),a.addEvent(this,window,"blur",function(){a.settings.get("autoPause")&&!a._paused&&a.pause()}),a.addEvent(this,window,"focus",function(){a._paused&&a.settings.get("autoPause")&&a.pause()}),a.settings.register("stageSelectable",function(t){a.stage.elem.onselectstart=t?function(){return!0}:function(){return!1}}),a.settings.modify("stageSelectable",!1),a.settings.register("stageContextMenu",function(t){a.stage.elem.oncontextmenu=t?function(){return!0}:function(){return!1}}),a.settings.modify("stageContextMenu",!1),a.settings.register("autoPause",function(){}),a.settings.modify("autoPause",!1),n||(r.body.appendChild(a.stage.elem),a.stage.elem.id=i);var n,o,s=a.stage.elem.style;if(s.width=this.width+"px",s.height=this.height+"px",s.overflow="hidden",a.bind("ViewportResize",function(){a.trigger("InvalidateViewport")}),a.mobile){s.webkitTapHighlightColor,s.webkitTapHighlightColor="rgba(0,0,0,0)";var l=r.createElement("meta"),h=r.getElementsByTagName("head")[0];(l=r.createElement("meta")).setAttribute("name","apple-mobile-web-app-capable"),l.setAttribute("content","yes"),h.appendChild(l),a.addEvent(this,a.stage.elem,"touchmove",function(t){t.preventDefault()})}s.position="relative",o=a.domHelper.innerPosition(a.stage.elem),a.stage.x=o.x,a.stage.y=o.y,a.uniqueBind("ViewportResize",this._resize)},_resize:function(){a.stage.elem.style.width=a.viewport.width+"px",a.stage.elem.style.height=a.viewport.height+"px"},_defineViewportProperties:function(){Object.defineProperty(this,"x",{set:function(t){this.scroll("_x",t)},get:function(){return this._x},configurable:!0}),Object.defineProperty(this,"y",{set:function(t){this.scroll("_y",t)},get:function(){return this._y},configurable:!0}),Object.defineProperty(this,"width",{set:function(t){this._width=t,a.trigger("ViewportResize")},get:function(){return this._width},configurable:!0}),Object.defineProperty(this,"height",{set:function(t){this._height=t,a.trigger("ViewportResize")},get:function(){return this._height},configurable:!0})},reload:function(){var t,e=window.innerWidth,i=window.innerHeight;a.stage.fullscreen&&(this._width=e,this._height=i,a.trigger("ViewportResize")),t=a.domHelper.innerPosition(a.stage.elem),a.stage.x=t.x,a.stage.y=t.y},reset:function(){a.viewport.mouselook(!1),a.trigger("StopCamera"),a.viewport.scroll("_x",0),a.viewport.scroll("_y",0),a.viewport.scale(1)},onScreen:function(t){return a.viewport._x+t._x+t._w>0&&a.viewport._y+t._y+t._h>0&&a.viewport._x+t._x<a.viewport.width&&a.viewport._y+t._y<a.viewport.height}}})},{"../core/core.js":10}],42:[function(t,e,i){var a=t("../core/core.js"),r=window.document;function n(t,e){this.shader=e,this.layer=t,this.context=t.context,this.draw=function(){},this.array_size=16,this.max_size=1024,this._indexArray=new Uint16Array(6*this.array_size),this._indexBuffer=t.context.createBuffer()}n.prototype={initAttributes:function(t){this.attributes=t,this._attribute_table={};for(var e=0,i=0;i<t.length;i++){var a=t[i];this._attribute_table[a.name]=a,a.bytes=a.bytes||Float32Array.BYTES_PER_ELEMENT,a.type=a.type||this.context.FLOAT,a.offset=e,a.location=this.context.getAttribLocation(this.shader,a.name),this.context.enableVertexAttribArray(a.location),e+=a.width}this.stride=e,this._attributeArray=new Float32Array(4*this.array_size*this.stride),this._attributeBuffer=this.context.createBuffer(),this._registryHoles=[],this._registrySize=0},growArrays:function(t){if(!(this.array_size>=this.max_size)){var e=Math.min(t,this.max_size),i=new Float32Array(4*e*this.stride),a=new Uint16Array(6*e);i.set(this._attributeArray),a.set(this._indexArray),this._attributeArray=i,this._indexArray=a,this.array_size=e}},registerEntity:function(t){if(0===this._registryHoles.length){if(this._registrySize>=this.max_size)throw"Number of entities exceeds maximum limit.";this._registrySize>=this.array_size&&this.growArrays(2*this.array_size),t._glBufferIndex=this._registrySize,this._registrySize++}else t._glBufferIndex=this._registryHoles.pop()},unregisterEntity:function(t){"number"==typeof t._glBufferIndex&&this._registryHoles.push(t._glBufferIndex),t._glBufferIndex=null},resetRegistry:function(){this._maxElement=0,this._registryHoles.length=0},setCurrentEntity:function(t){this.ent_offset=4*t._glBufferIndex,this.ent=t},switchTo:function(){var t=this.context;t.useProgram(this.shader),t.bindBuffer(t.ARRAY_BUFFER,this._attributeBuffer);for(var e,i=this.attributes,a=0;a<i.length;a++)e=i[a],t.vertexAttribPointer(e.location,e.width,e.type,!1,this.stride*e.bytes,e.offset*e.bytes);var r=this.texture_obj;r&&null===r.unit&&this.layer.texture_manager.bindTexture(r),this.index_pointer=0},setTexture:function(t){void 0===this.texture_obj&&(t.setToProgram(this.shader,"uSampler","uTextureDimensions"),this.texture_obj=t)},addIndices:function(t){var e=this._indexArray,i=this.index_pointer;e[0+i]=0+t,e[1+i]=1+t,e[2+i]=2+t,e[3+i]=1+t,e[4+i]=2+t,e[5+i]=3+t,this.index_pointer+=6},renderBatch:function(){var t=this.context;t.bindBuffer(t.ARRAY_BUFFER,this._attributeBuffer),t.bufferData(t.ARRAY_BUFFER,this._attributeArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indexArray,t.STATIC_DRAW),t.drawElements(t.TRIANGLES,this.index_pointer,t.UNSIGNED_SHORT,0)},setViewportUniforms:function(t,e){var i=this.context;i.useProgram(this.shader),i.uniform4f(this.shader.viewport,-t._x,-t._y,t._w,t._h)},writeVector:function(t,e,i){for(var a=this._attribute_table[t],r=this.stride,n=a.offset+this.ent_offset*r,o=a.width,s=arguments.length-1,l=this._attributeArray,h=0;h<4;h++)for(var c=0;c<o;c++)l[n+r*h+c]=arguments[(o*h+c)%s+1]}},a._registerLayerTemplate("WebGL",{type:"WebGL",context:null,_compileShader:function(t,e){var i=this.context,a=i.createShader(e);if(i.shaderSource(a,t),i.compileShader(a),!i.getShaderParameter(a,i.COMPILE_STATUS))throw i.getShaderInfoLog(a);return a},_makeProgram:function(t){var e=this.context,i=this._compileShader(t.fragmentCode,e.FRAGMENT_SHADER),a=this._compileShader(t.vertexCode,e.VERTEX_SHADER),r=e.createProgram();if(e.attachShader(r,a),e.attachShader(r,i),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))throw"Could not initialise shaders";return r.viewport=e.getUniformLocation(r,"uViewport"),r},getProgramWrapper:function(t,e){if(void 0===this.programs[t]){var i=new n(this,this._makeProgram(e));i.name=t,i.initAttributes(e.attributeList),i.draw=e.drawCallback,i.setViewportUniforms(this._viewportRect(),this.options),this.programs[t]=i}return this.programs[t]},makeTexture:function(t,e,i){return this.texture_manager.makeTexture(t,e,i)},events:{LayerInit:"layerInit",LayerRemove:"layerRemove",RenderScene:"_render",PixelartSet:"_setPixelart",ViewportResize:"_resize"},layerInit:function(){var t,e;if(!a.support.webgl){a.trigger("NoWebGL"),a.stop();return}this.programs={},(t=r.createElement("canvas")).width=a.viewport.width,t.height=a.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.zIndex=this.options.z,a.stage.elem.appendChild(t);try{(e=t.getContext("webgl",{premultipliedalpha:!0})||t.getContext("experimental-webgl",{premultipliedalpha:!0})).viewportWidth=t.width,e.viewportHeight=t.height}catch(t){a.trigger("NoWebGL"),a.stop();return}this.context=e,this._canvas=t,e.clearColor(0,0,0,0),e.disable(e.DEPTH_TEST),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.BLEND),this.texture_manager=new a.TextureManager(e,this),this._dirtyViewport=!0},layerRemove:function(){this._canvas.parentNode.removeChild(this._canvas)},_resize:function(){var t=this._canvas;t.width=a.viewport.width,t.height=a.viewport.height;var e=this.context;e.viewportWidth=t.width,e.viewportHeight=t.height},_setPixelart:function(t){var e=this.context;t?this.texture_filter=e.NEAREST:this.texture_filter=e.LINEAR},visible_gl:[],_render:function(t){t=t||this._viewportRect();var e=this.context;e.viewport(0,0,e.viewportWidth,e.viewportHeight),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var i=this.programs;if(this._dirtyViewport){var r=this._viewportRect();for(var n in i)i[n].setViewportUniforms(r,this.options);this._dirtyViewport=!1}var o,s=a.map.search(t),l=0,h=s.length,c=this.visible_gl;for(l=0,c.length=0;l<h;l++)(o=s[l])._visible&&o.program&&o._drawLayer===this&&c.push(o);c.sort(this._sort),h=c.length;var u=null;for(l=0;l<h;l++)u!==(o=c[l]).program&&(null!==u&&u.renderBatch(),(u=o.program).index_pointer=0,u.switchTo()),o.draw(),o._changed=!1;null!==u&&u.renderBatch()},dirty:function(t){},attach:function(t){t._drawContext=this.context},detach:function(t){t.program&&t.program.unregisterEntity(t)}})},{"../core/core.js":10}],43:[function(t,e,i){var a=t("../core/core.js");a.extend({WebGLShader:function(t,e,i,a){this.vertexCode=t,this.fragmentCode=e,this.attributeList=i,this.drawCallback=a},defaultShader:function(t,e){if(this._defaultShaders=this._defaultShaders||{},1==arguments.length)return this._defaultShaders[t];this._defaultShaders[t]=e}}),a.c("WebGL",{init:function(){this.requires("Renderable"),this._customLayer||this._attachToLayer(a.s("DefaultWebGLLayer"))},remove:function(){this._detachFromLayer()},drawVars:{type:"webgl",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(){if(this.ready){var t=this.drawVars.pos;t._x=this._x,t._y=this._y,t._w=this._w,t._h=this._h;var e=this.__coord||[0,0,0,0],i=this.drawVars.co;i.x=e[0],i.y=e[1],i.w=e[2],i.h=e[3],this._flipX&&(i.x=i.x+i.w,i.w=-i.w),this._flipY&&(i.y=i.y+i.h,i.h=-i.h);var a=this._drawContext;this.drawVars.gl=a;var r=this.drawVars.program=this.program;return r.setCurrentEntity(this),r.writeVector("aPosition",this._x,this._y,this._x,this._y+this._h,this._x+this._w,this._y,this._x+this._w,this._y+this._h),r.writeVector("aOrientation",this._origin.x+this._x,this._origin.y+this._y,this._rotation*Math.PI/180),r.writeVector("aLayer",this._globalZ,this._alpha),this.trigger("Draw",this.drawVars),r.addIndices(r.ent_offset),this}},_establishShader:function(t,e){this.program=this._drawLayer.getProgramWrapper(t,e),this.program.registerEntity(this),this.ready=!0}})},{"../core/core.js":10}],44:[function(t,e,i){var a=t("../core/core.js");a.extend({device:{_deviceOrientationCallback:!1,_deviceMotionCallback:!1,_normalizeDeviceOrientation:function(t){var e;window.DeviceOrientationEvent?e={tiltLR:t.gamma,tiltFB:t.beta,dir:t.alpha,motUD:null}:window.OrientationEvent&&(e={tiltLR:90*t.x,tiltFB:-90*t.y,dir:null,motUD:t.z}),a.device._deviceOrientationCallback(e)},_normalizeDeviceMotion:function(t){var e=t.accelerationIncludingGravity,i=e.z>0?1:-1,r={acceleration:e,rawAcceleration:"["+Math.round(e.x)+", "+Math.round(e.y)+", "+Math.round(e.z)+"]",facingUp:i,tiltLR:Math.round(-(e.x/9.81*90)),tiltFB:Math.round((e.y+9.81)/9.81*90*i)};a.device._deviceMotionCallback(r)},deviceOrientation:function(t){this._deviceOrientationCallback=t,a.support.deviceorientation&&(window.DeviceOrientationEvent?a.addEvent(this,window,"deviceorientation",this._normalizeDeviceOrientation):window.OrientationEvent&&a.addEvent(this,window,"MozOrientation",this._normalizeDeviceOrientation))},deviceMotion:function(t){this._deviceMotionCallback=t,a.support.devicemotion&&window.DeviceMotionEvent&&a.addEvent(this,window,"devicemotion",this._normalizeDeviceMotion)}}})},{"../core/core.js":10}],45:[function(t,e,i){e.exports={_events:{},addEvent:function(t,e,i,a){3==arguments.length&&(a=i,i=e,e=window.document);var r=t[0]||"",n=function(e){a.call(t,e)};this._events[r+e+i+a]||(this._events[r+e+i+a]=n,e.addEventListener(i,n,!1))},removeEvent:function(t,e,i,a){3==arguments.length&&(a=i,i=e,e=window.document);var r=t[0]||"",n=this._events[r+e+i+a];n&&(e.removeEventListener(i,n,!1),delete this._events[r+e+i+a])}}},{}],46:[function(t,e,i){var a=t("../core/core.js");a.s("Keyboard",a.extend.call(a.extend.call(new a.__eventDispatcher,{_evt:{eventName:"",key:0,which:0,originalEvent:null},prepareEvent:function(t){var e=this._evt,i=t.type;return e.eventName="keydown"===i?"KeyDown":"keyup"===i?"KeyUp":i,e.which=null!==t.charCode?t.charCode:t.keyCode,e.key=t.keyCode||t.which,e.originalEvent=t,e},triggerKeyEvent:function(t,e){a.trigger(t,e)},dispatchEvent:function(t){var e=this.prepareEvent(t);this.triggerKey(e.eventName,e)}}),a.__keyboardStateTemplate),{},!1),a.c("Keyboard",{isDown:function(t){return a.s("Keyboard").isKeyDown(t)}})},{"../core/core.js":10}],47:[function(t,e,i){var a=t("../core/core.js"),r=window.document,n=void 0!==r.onwheel?"wheel":void 0!==r.onmousewheel?"mousewheel":"DOMMouseScroll";a._preBind("Load",function(){a.addEvent(this,r.body,"mouseup",a.detectBlur),a.addEvent(a.s("Keyboard"),window,"blur",a.s("Keyboard").resetKeyDown),a.addEvent(a.s("Mouse"),window,"mouseup",a.s("Mouse").resetButtonDown),a.addEvent(a.s("Touch"),window,"touchend",a.s("Touch").resetTouchPoints),a.addEvent(a.s("Touch"),window,"touchcancel",a.s("Touch").resetTouchPoints),a.addEvent(a.s("Keyboard"),"keydown",a.s("Keyboard").processEvent),a.addEvent(a.s("Keyboard"),"keyup",a.s("Keyboard").processEvent),a.addEvent(a.s("Mouse"),a.stage.elem,"mousedown",a.s("Mouse").processEvent),a.addEvent(a.s("Mouse"),a.stage.elem,"mouseup",a.s("Mouse").processEvent),a.addEvent(a.s("Mouse"),a.stage.elem,"mousemove",a.s("Mouse").processEvent),a.addEvent(a.s("Mouse"),a.stage.elem,"click",a.s("Mouse").processEvent),a.addEvent(a.s("Mouse"),a.stage.elem,"dblclick",a.s("Mouse").processEvent),a.addEvent(this,a.stage.elem,"touchstart",this._touchDispatch),a.addEvent(this,a.stage.elem,"touchmove",this._touchDispatch),a.addEvent(this,a.stage.elem,"touchend",this._touchDispatch),a.addEvent(this,a.stage.elem,"touchcancel",this._touchDispatch),a.addEvent(this,a.stage.elem,"touchleave",this._touchDispatch),a.addEvent(a.s("MouseWheel"),a.stage.elem,n,a.s("MouseWheel").processEvent)}),a.bind("Pause",function(){a.s("Keyboard").resetKeyDown(),a.s("Mouse").resetButtonDown()}),a._preBind("CraftyStop",function(){a.s("Keyboard").resetKeyDown(),a.s("Mouse").resetButtonDown()}),a._preBind("CraftyStop",function(){a.removeEvent(this,r.body,"mouseup",a.detectBlur),a.removeEvent(a.s("Keyboard"),window,"blur",a.s("Keyboard").resetKeyDown),a.removeEvent(a.s("Mouse"),window,"mouseup",a.s("Mouse").resetButtonDown),a.removeEvent(a.s("Touch"),window,"touchend",a.s("Touch").resetTouchPoints),a.removeEvent(a.s("Touch"),window,"touchcancel",a.s("Touch").resetTouchPoints),a.removeEvent(a.s("Keyboard"),"keydown",a.s("Keyboard").processEvent),a.removeEvent(a.s("Keyboard"),"keyup",a.s("Keyboard").processEvent),a.stage&&(a.removeEvent(a.s("Mouse"),a.stage.elem,"mousedown",a.s("Mouse").processEvent),a.removeEvent(a.s("Mouse"),a.stage.elem,"mouseup",a.s("Mouse").processEvent),a.removeEvent(a.s("Mouse"),a.stage.elem,"mousemove",a.s("Mouse").processEvent),a.removeEvent(a.s("Mouse"),a.stage.elem,"click",a.s("Mouse").processEvent),a.removeEvent(a.s("Mouse"),a.stage.elem,"dblclick",a.s("Mouse").processEvent),a.removeEvent(this,a.stage.elem,"touchstart",this._touchDispatch),a.removeEvent(this,a.stage.elem,"touchmove",this._touchDispatch),a.removeEvent(this,a.stage.elem,"touchend",this._touchDispatch),a.removeEvent(this,a.stage.elem,"touchcancel",this._touchDispatch),a.removeEvent(this,a.stage.elem,"touchleave",this._touchDispatch),a.removeEvent(a.s("MouseWheel"),a.stage.elem,n,a.s("MouseWheel").processEvent))})},{"../core/core.js":10}],48:[function(t,e,i){var a=t("../core/core.js");a.s("MouseWheel",a.extend.call(new a.__eventDispatcher,{_evt:{eventName:"",direction:0,target:null,clientX:0,clientY:0,realX:0,realY:0,originalEvent:null},_mouseSystem:null,prepareEvent:function(t){var e=this._mouseSystem;e||(this._mouseSystem=e=a.s("Mouse"));var i=this._evt;return i.eventName="MouseWheelScroll",i.direction=t.detail<0||t.wheelDelta>0||t.deltaY<0?1:-1,i.clientX=void 0!==t.clientX?t.clientX:e.lastMouseEvent.clientX,i.clientY=void 0!==t.clientY?t.clientY:e.lastMouseEvent.clientY,a.translatePointerEventCoordinates(t,i),i.target=e.mouseObjs?a.findPointerEventTargetByComponent("Mouse",t):null,i.originalEvent=t,i},dispatchEvent:function(t){var e=this.prepareEvent(t);a.trigger("MouseWheelScroll",e)}}),{},!1),a.s("Mouse",a.extend.call(a.extend.call(new a.__eventDispatcher,{normedEventNames:{mousedown:"MouseDown",mouseup:"MouseUp",dblclick:"DoubleClick",click:"Click",mousemove:"MouseMove"},_evt:{eventName:"",mouseButton:-1,target:null,clientX:0,clientY:0,realX:0,realY:0,originalEvent:null},mouseObjs:0,over:null,prepareEvent:function(t){var e=this._evt,i=t.type;return e.eventName=this.normedEventNames[i]||i,void 0===t.which?e.mouseButton=t.button<2?a.mouseButtons.LEFT:4===t.button?a.mouseButtons.MIDDLE:a.mouseButtons.RIGHT:e.mouseButton=t.which<2?a.mouseButtons.LEFT:2===t.which?a.mouseButtons.MIDDLE:a.mouseButtons.RIGHT,e.clientX=t.clientX,e.clientY=t.clientY,a.translatePointerEventCoordinates(t,e),e.target=this.mouseObjs?a.findPointerEventTargetByComponent("Mouse",t):null,e.originalEvent=t,e},triggerMouseEvent:function(t,e){this.trigger(t,e);var i=this.over,a=e.target;"MouseMove"===t&&i!==a&&(i&&(e.eventName="MouseOut",e.target=i,i.trigger("MouseOut",e),e.eventName="MouseMove",e.target=a),this.over=a,a&&(e.eventName="MouseOver",a.trigger("MouseOver",e),e.eventName="MouseMove")),a&&a.trigger(t,e)},dispatchEvent:function(t){var e=this.prepareEvent(t);this.triggerMouse(e.eventName,e)}}),a.__mouseStateTemplate),{},!1),a.c("Mouse",{required:"AreaMap",init:function(){a.s("Mouse").mouseObjs++},remove:function(){a.s("Mouse").mouseObjs--}}),a.c("MouseDrag",{_dragging:!1,required:"Mouse",events:{MouseDown:"_ondown"},init:function(){this._ondown=this._ondown.bind(this),this._ondrag=this._ondrag.bind(this),this._onup=this._onup.bind(this)},_ondown:function(t){t.mouseButton===a.mouseButtons.LEFT&&this.startDrag(t)},_ondrag:function(t){if(!this._dragging||0===t.realX||0===t.realY)return!1;this.trigger("Dragging",t)},_onup:function(t){t.mouseButton===a.mouseButtons.LEFT&&this.stopDrag(t)},startDrag:function(t){if(!this._dragging)return this._dragging=!0,a.s("Mouse").bind("MouseMove",this._ondrag),a.s("Mouse").bind("MouseUp",this._onup),this.trigger("StartDrag",t||a.s("Mouse").lastMouseEvent),this},stopDrag:function(t){if(this._dragging)return this._dragging=!1,a.s("Mouse").unbind("MouseMove",this._ondrag),a.s("Mouse").unbind("MouseUp",this._onup),this.trigger("StopDrag",t||a.s("Mouse").lastMouseEvent),this}})},{"../core/core.js":10}],49:[function(t,e,i){var a=t("../core/core.js");a.extend({findPointerEventTargetByComponent:function(t,e,i){var r=e.target||e.srcElement||a.stage.elem;i=void 0!==i?i:e.clientY,e=void 0!==e.clientX?e.clientX:e;var n,o,s,l,h,c=null,u=-1/0;if("CANVAS"!==r.nodeName){for(;"string"!=typeof r.id&&-1===r.id.indexOf("ent");)r=r.parentNode;var d=a(parseInt(r.id.replace("ent",""),10));h=a.domHelper.translate(e,i,d._drawLayer),d.__c[t]&&d.isAt(h.x,h.y)&&(c=d)}if(!c)for(var p in a._drawLayers){var y=a._drawLayers[p];if(!(y._pointerEntities<=0))for(l=0,h=a.domHelper.translate(e,i,y),s=(o=a.map.unfilteredSearch({_x:h.x,_y:h.y,_w:1,_h:1})).length;l<s;++l)(n=o[l])._visible&&n._drawLayer===y&&n._globalZ>u&&n.__c[t]&&n.isAt(h.x,h.y)&&(u=n._globalZ,c=n)}return c},translatePointerEventCoordinates:function(t,e){e=e||t;var i=a.domHelper.translate(t.clientX,t.clientY,void 0,this.__pointerPos);e.realX=i.x,e.realY=i.y},__pointerPos:{x:0,y:0}}),a.c("AreaMap",{init:function(){this.has("Renderable")&&this._drawLayer&&this._drawLayer._pointerEntities++},remove:function(t){!t&&this.has("Renderable")&&this._drawLayer&&this._drawLayer._pointerEntities--},events:{LayerAttached:function(t){t._pointerEntities++},LayerDetached:function(t){t._pointerEntities--}},areaMap:function(t){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,0);t=new a.polygon(e)}else t=t.constructor===Array?new a.polygon(t.slice()):t.clone();return t.shift(this._x,this._y),this.mapArea=t,this.attach(this.mapArea),this.trigger("NewAreaMap",t),this}}),a.c("Button",{init:function(){var t=a.mobile&&(!a.mobile||a.multitouch())?"Touch":"Mouse";this.requires(t)}})},{"../core/core.js":10}],50:[function(t,e,i){var a,r,n,o=t("../core/core.js");o.extend({multitouch:function(t){return"boolean"!=typeof t?this._multitouch:(this._multitouch=t,this)},_multitouch:!1,_touchDispatch:(r=0,n=0,function(t){o._multitouch?(a||(a=o.s("Touch")),a.processEvent(t)):function(t){"touchstart"===t.type?e="mousedown":"touchmove"===t.type?e="mousemove":"touchend"===t.type?e="mouseup":"touchcancel"===t.type?e="mouseup":"touchleave"===t.type&&(e="mouseup"),t.touches&&t.touches.length?i=t.touches[0]:t.changedTouches&&t.changedTouches.length&&(i=t.changedTouches[0]);var e,i,a=document.createEvent("MouseEvent");if(a.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,t.relatedTarget),i.target.dispatchEvent(a),"mousedown"===e)r=i.clientX,n=i.clientY;else if("mouseup"===e){var o=i.clientX-r,s=i.clientY-n;o*o+s*s<=256&&(e="click",(a=document.createEvent("MouseEvent")).initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,t.relatedTarget),i.target.dispatchEvent(a))}t.preventDefault()}(t)})}),o.s("Touch",o.extend.call(o.extend.call(new o.__eventDispatcher,{normedEventNames:{touchstart:"TouchStart",touchmove:"TouchMove",touchend:"TouchEnd",touchcancel:"TouchCancel"},_evt:{eventName:"",identifier:-1,target:null,entity:null,realX:0,realY:0,originalEvent:null},touchObjs:0,overs:{},prepareEvent:function(t,e){var i=this._evt;return i.eventName=this.normedEventNames[e]||e,i.identifier=t.identifier,o.translatePointerEventCoordinates(t,i),i.target=this.touchObjs?o.findPointerEventTargetByComponent("Touch",t):null,i.entity=i.target,i},triggerTouchEvent:function(t,e){this.trigger(t,e);var i=e.identifier,a=e.target,r=this.overs[i];r&&("TouchMove"===t&&r!==a||"TouchEnd"===t||"TouchCancel"===t)&&(e.eventName="TouchOut",e.target=r,e.entity=r,r.trigger("TouchOut",e),e.eventName=t,e.target=a,e.entity=a,delete this.overs[i]),a&&a.trigger(t,e),a&&("TouchStart"===t||"TouchMove"===t&&r!==a)&&(e.eventName="TouchOver",a.trigger("TouchOver",e),e.eventName=t,this.overs[i]=a)},dispatchEvent:function(t){for(var e,i=t.changedTouches,a=0,r=i.length;a<r;a++)(e=this.prepareEvent(i[a],t.type)).originalEvent=t,this.triggerTouch(e.eventName,e)}}),o.__touchStateTemplate),{},!1),o.c("Touch",{required:"AreaMap",init:function(){o.s("Touch").touchObjs++},remove:function(){o.s("Touch").touchObjs--}})},{"../core/core.js":10}],51:[function(t,e,i){var a=t("../core/core.js");a.__eventDispatcher=function(){},a.__eventDispatcher.prototype={processEvent:function(t){return this.dispatchEvent(t),this.preventBubbling(t)},dispatchEvent:function(t){},preventBubbling:function(t){if(a.selected&&!(8===t.key||t.key>=112&&t.key<=135))return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,!!t.target&&("INPUT"===t.target.nodeName||"TEXTAREA"===t.target.nodeName)||(t.preventDefault?t.preventDefault():t.returnValue=!1,!1)}},a.extend({selected:!0,detectBlur:function(t){var e=t.clientX>a.stage.x&&t.clientX<a.stage.x+a.viewport.width&&t.clientY>a.stage.y&&t.clientY<a.stage.y+a.viewport.height;!a.selected&&e&&a.trigger("CraftyFocus"),a.selected&&!e&&a.trigger("CraftyBlur"),a.selected=e}})},{"../core/core.js":10}],52:[function(t,e,i){var a=t("../core/core.js");a.extend({diamondIso:{_tile:{width:0,height:0},getTileDimensions:function(){return{w:this._tile.width,h:this._tile.height}},_map:{width:0,height:0},_origin:{x:0,y:0},_tiles:[],getTile:function(t,e,i){return this._tiles[t][e][i]},init:function(t,e,i,a,r,n){this._tile.width=parseInt(t,10),this._tile.height=parseInt(e,10)||parseInt(t,10)/2,this._tile.r=this._tile.width/this._tile.height,this._map.width=parseInt(i,10),this._map.height=parseInt(a,10)||parseInt(i,10);for(var o=0;o<i;o++){this._tiles[o]=[];for(var s=0;s<a;s++)this._tiles[o][s]=[]}return this.x=parseInt(r,10)||0,this.y=parseInt(n,10)||0,this.layerZLevel=i+a+1,this},place:function(t,e,i,a){var r=this.pos2px(e,i),n=t.h/this._tile.height;t.x=r.x,t.y=r.y-(n-2)*this._tile.height-this._tile.height*a,t.z=this.getZAtLoc(e,i,a);for(var o=0;o<=n-2;o++){var s=this._tiles[e][i][a+o];s&&s!==t&&s.destroy(),this._tiles[e][i][a+o]=t}return this},detachTile:function(t){for(var e=0;e<this._map.width;e++)for(var i=0;i<this._map.height;i++)for(var a=this._tiles[e][i].length,r=0;r<a;r++)if(this._tiles[e][i][r]&&t===this._tiles[e][i][r]){for(var n=t.h/this._tile.height,o=0;o<n;o++)this._tiles[e][i][r+o]=void 0;return{x:e,y:i,z:r}}return!1},centerAt:function(t,e){var i=this.pos2px(t,e);a.viewport.x=-i.x+a.viewport.width/2-this._tile.width,a.viewport.y=-i.y+a.viewport.height/2},getZAtLoc:function(t,e,i){return this.layerZLevel*i+t+e},pos2px:function(t,e){return{x:this.x+(t-e-1)*this._tile.width/2,y:this.y+(t+e)*this._tile.height/2}},px2pos:function(t,e){var i=(e-this.y)/this._tile.height,a=(t-this.x)/this._tile.width,r=i+a,n=i-a,o=r>0&&r<this._map.width,s=n>0&&n<this._map.height;if(o&&s)return{x:~~r,y:~~n}},getOverlappingTiles:function(t,e){var i=this.px2pos(t,e),a=[],r=~~i.x,n=~~i.y,o=Math.min(this._map.width-r,this._map.height-n),s=this._tiles[r][n][1];s&&a.push(s);for(var l=1;l<o;l++){var h=this._tiles[r+l][n+l][l];h&&a.push(h)}return a},polygon:function(t){t.requires("Collision");var e=[0,t.h-0-this._tile.height/2,0-this._tile.width/2,t.h-0-0,0-this._tile.width,t.h-0-this._tile.height/2,0-this._tile.width/2,t.h-0-this._tile.height];return new a.polygon(e)}}})},{"../core/core.js":10}],53:[function(t,e,i){var a=t("../core/core.js");a.extend({isometric:{_tile:{width:0,height:0},_elements:{},_pos:{x:0,y:0},_z:0,size:function(t,e){return this._tile.width=t,this._tile.height=e>0?e:t/2,this},place:function(t,e,i,r){var n=this.pos2px(t,e);return n.top-=this._tile.height/2*i,r.x=n.left+a.viewport._x,r.y=n.top+a.viewport._y,r.z+=i,this},pos2px:function(t,e){return{left:t*this._tile.width+this._tile.width/2*(1&e),top:e*this._tile.height/2}},px2pos:function(t,e){return{x:-Math.ceil(-t/this._tile.width-(1&e)*.5),y:e/this._tile.height*2}},centerAt:function(t,e){if("number"!=typeof t||"number"!=typeof e)return{top:-a.viewport._y+a.viewport.height/2-this._tile.height/2,left:-a.viewport._x+a.viewport.width/2-this._tile.width/2};var i=this.pos2px(t,e);return a.viewport._x=-i.left+a.viewport.width/2-this._tile.width/2,a.viewport._y=-i.top+a.viewport.height/2-this._tile.height/2,this},area:function(){var t=this.centerAt(),e=this.px2pos(-t.left+a.viewport.width/2,-t.top+a.viewport.height/2),i=this.px2pos(-t.left-a.viewport.width/2,-t.top-a.viewport.height/2);return{x:{start:e.x,end:i.x},y:{start:e.y,end:i.y}}}}})},{"../core/core.js":10}],54:[function(t,e,i){var a=t("../core/core.js"),r=window.document;a.extend({audio:{sounds:{},supported:null,codecs:{ogg:'audio/ogg; codecs="vorbis"',wav:'audio/wav; codecs="1"',webma:'audio/webm; codecs="vorbis"',mp3:'audio/mpeg; codecs="mp3"',m4a:'audio/mp4; codecs="mp4a.40.2"'},volume:1,muted:!1,paused:!1,playCheck:null,_canPlay:function(){if(this.supported={},a.support.audio){var t,e=this.audioElement();for(var i in this.codecs)""!==(t=e.canPlayType(this.codecs[i]))&&"no"!==t?this.supported[i]=!0:this.supported[i]=!1}},supports:function(t){return null===this.supported&&this._canPlay(),!!this.supported[t]},audioElement:function(){return"undefined"!=typeof Audio?new Audio(""):r.createElement("audio")},create:function(t,e){var i=e.substr(e.lastIndexOf(".")+1).toLowerCase();if(!this.supports(i))return!1;var r=this.audioElement();return r.id=t,r.preload="auto",r.volume=a.audio.volume,r.src=e,a.asset(e,r),this.sounds[t]={obj:r,played:0,volume:a.audio.volume},this.sounds[t]},add:function(t,e){var i,r;if(a.support.audio){if(1==arguments.length&&"object"==typeof t){for(var n in t)for(i in t[n])if(r=a.audio.create(n,t[n][i]))break}if("string"==typeof t&&("string"==typeof e&&(r=a.audio.create(t,e)),"object"==typeof e)){for(i in e)if(r=a.audio.create(t,e[i]))break}return r}},play:function(t,e,i){if(0!==e&&a.support.audio&&this.sounds[t]){var r=this.sounds[t],n=this.getOpenChannel();if(!n)return null;n.id=t,n.repeat=e;var o=n.obj;return n.volume=r.volume=r.obj.volume=i||a.audio.volume,o.volume=r.volume,o.src=r.obj.src,this.muted&&(o.volume=0),o.play(),r.played++,n.onEnd=function(){r.played<n.repeat||-1===n.repeat?(this.currentTime&&(this.currentTime=0),this.play(),r.played++):(n.active=!1,this.pause(),this.removeEventListener("ended",n.onEnd,!0),this.currentTime=0,a.trigger("SoundComplete",{id:n.id}))},o.addEventListener("ended",n.onEnd,!0),o}},maxChannels:7,setChannels:function(t){this.maxChannels=t,t<this.channels.length&&(this.channels.length=t)},channels:[],getOpenChannel:function(){for(var t=0;t<this.channels.length;t++){var e=this.channels[t];if(!1===e.active||e.obj.ended&&e.repeat<=this.sounds[e.id].played)return e.active=!0,e}if(t<this.maxChannels){var i={obj:this.audioElement(),active:!0,_is:function(t){return this.id===t&&this.active}};return this.channels.push(i),i}return null},remove:function(t){if(a.support.audio){var e,i,r=a.paths().audio;if(!t){for(var n in this.sounds)i=(e=this.sounds[n]).obj.src.split("/").pop(),a.audio.stop(t),delete a.assets[r+i],delete a.assets[e.obj.src],delete a.audio.sounds[t];return}this.sounds[t]&&(i=(e=this.sounds[t]).obj.src.split("/").pop(),a.audio.stop(t),delete a.assets[r+i],delete a.assets[e.obj.src],delete a.audio.sounds[t])}},stop:function(t){var e;if(a.support.audio)for(var i in this.channels)e=this.channels[i],(!t&&e.active||e._is(t))&&(e.active=!1,e.obj.pause())},_mute:function(t){var e;if(a.support.audio){for(var i in this.channels)(e=this.channels[i]).obj.volume=t?0:e.volume;this.muted=t}},toggleMute:function(){this.muted?this._mute(!1):this._mute(!0)},mute:function(){this._mute(!0)},unmute:function(){this._mute(!1)},pause:function(t){var e;if(a.support.audio&&t&&this.sounds[t])for(var i in this.channels)(e=this.channels[i])._is(t)&&!e.obj.paused&&e.obj.pause()},unpause:function(t){var e;if(a.support.audio&&t&&this.sounds[t])for(var i in this.channels)(e=this.channels[i])._is(t)&&e.obj.paused&&e.obj.play()},togglePause:function(t){var e;if(a.support.audio&&t&&this.sounds[t])for(var i in this.channels)(e=this.channels[i])._is(t)&&(e.obj.paused?e.obj.play():e.obj.pause())},isPlaying:function(t){if(!a.support.audio)return!1;for(var e in this.channels)if(this.channels[e]._is(t))return!0;return!1}}})},{"../core/core.js":10}],55:[function(t,e,i){var a=t("../core/core.js"),r=Math.PI/180,n=function(t){var e=Math.cos(t);return -.0000000001<e&&e<1e-10?0:e},o=function(t){var e=Math.sin(t);return -.0000000001<e&&e<1e-10?0:e};a.c("2D",{_x:0,_y:0,_w:0,_h:0,_z:0,_globalZ:null,_rotation:0,_origin:null,_mbr:null,_entry:null,_children:null,_parent:null,properties:{x:{set:function(t){this._setter2d("_x",t)},get:function(){return this._x},configurable:!0,enumerable:!0},_x:{enumerable:!1},y:{set:function(t){this._setter2d("_y",t)},get:function(){return this._y},configurable:!0,enumerable:!0},_y:{enumerable:!1},w:{set:function(t){this._setter2d("_w",t)},get:function(){return this._w},configurable:!0,enumerable:!0},_w:{enumerable:!1},h:{set:function(t){this._setter2d("_h",t)},get:function(){return this._h},configurable:!0,enumerable:!0},_h:{enumerable:!1},z:{set:function(t){this._setter2d("_z",t)},get:function(){return this._z},configurable:!0,enumerable:!0},_z:{enumerable:!1},rotation:{set:function(t){this._setter2d("_rotation",t)},get:function(){return this._rotation},configurable:!0,enumerable:!0},_rotation:{enumerable:!1},ox:{set:function(t){var e=t-this._origin.x;this._setter2d("_x",e)},get:function(){return this._x+this._origin.x},configurable:!0,enumerable:!0},oy:{set:function(t){var e=t-this._origin.y;this._setter2d("_y",e)},get:function(){return this._y+this._origin.y},configurable:!0,enumerable:!0}},init:function(){this._globalZ=this[0],this._origin={x:0,y:0},this._bx1=0,this._bx2=0,this._by1=0,this._by2=0,this._children=[],this._entry=a.map.insert(this),this.bind("Move",function(t){var e=this._cbr||this._mbr||this;this._entry.update(e),this._children.length>0&&this._cascade(t)}),this.bind("Rotate",function(t){var e=this._cbr||this._mbr||this;this._entry.update(e),this._children.length>0&&this._cascadeRotation(t)}),this.bind("Remove",function(){if(this._children){for(var t=0;t<this._children.length;t++)delete this._children[t]._parent,this._children[t].destroy&&this._children[t].destroy();this._children=[]}this._parent&&this._parent.detach(this),a.map.remove(this._entry),this.detach()})},events:{Freeze:function(){a.map.remove(this._entry)},Unfreeze:function(){this._entry=a.map.insert(this,this._entry)}},offsetBoundary:function(t,e,i,a){return 1==arguments.length&&(e=i=a=t),this._bx1=t,this._bx2=i,this._by1=e,this._by2=a,this.trigger("BoundaryOffset"),this._calculateMBR(),this},_calculateMBR:function(){var t=this._origin.x+this._x,e=this._origin.y+this._y,i=-this._rotation*r,a=this._x-this._bx1-t,s=this._x+this._w+this._bx2-t,l=this._y-this._by1-e,h=this._y+this._h+this._by2-e,c=n(i),u=o(i),d=a*c+l*u,p=-a*u+l*c,y=s*c+l*u,m=-s*u+l*c,f=s*c+h*u,g=-s*u+h*c,v=a*c+h*u,w=-a*u+h*c,x=Math.floor(Math.min(d,y,f,v)+t),_=Math.floor(Math.min(p,m,g,w)+e),b=Math.ceil(Math.max(d,y,f,v)+t),S=Math.ceil(Math.max(p,m,g,w)+e);if(this._mbr?(this._mbr._x=x,this._mbr._y=_,this._mbr._w=b-x,this._mbr._h=S-_):this._mbr={_x:x,_y:_,_w:b-x,_h:S-_},this._cbr){var C=this._cbr,k=C.cx,D=C.cy,z=C.r,A=t+(k+this._x-t)*c+(D+this._y-e)*u,P=e-(k+this._x-t)*u+(D+this._y-e)*c;C._x=Math.min(A-z,x),C._y=Math.min(P-z,_),C._w=Math.max(A+z,b)-C._x,C._h=Math.max(P+z,S)-C._y}},_rotate:function(t){var e=this._rotation-t;0!==e&&(this._rotation=t,this._calculateMBR(),this.trigger("Rotate",e))},area:function(){return this._w*this._h},intersect:function(t,e,i,a){var r,n=this._mbr||this;return r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:a},n._x<r._x+r._w&&n._x+n._w>r._x&&n._y<r._y+r._h&&n._y+n._h>r._y},within:function(t,e,i,a){var r,n=this._mbr||this;return(r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:a})._x<=n._x&&r._x+r._w>=n._x+n._w&&r._y<=n._y&&r._y+r._h>=n._y+n._h},contains:function(t,e,i,a){var r,n=this._mbr||this;return(r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:a})._x>=n._x&&r._x+r._w<=n._x+n._w&&r._y>=n._y&&r._y+r._h<=n._y+n._h},pos:function(t){return(t=t||{})._x=this._x,t._y=this._y,t._w=this._w,t._h=this._h,t},mbr:function(t){return(t=t||{},this._mbr)?(t._x=this._mbr._x,t._y=this._mbr._y,t._w=this._mbr._w,t._h=this._mbr._h,t):this.pos(t)},isAt:function(t,e){if(this.mapArea)return this.mapArea.containsPoint(t,e);if(this.map)return this.map.containsPoint(t,e);var i=this._mbr||this;return i._x<=t&&i._x+i._w>=t&&i._y<=e&&i._y+i._h>=e},move:function(t,e){return"n"===t.charAt(0)&&(this.y-=e),"s"===t.charAt(0)&&(this.y+=e),("e"===t||"e"===t.charAt(1))&&(this.x+=e),("w"===t||"w"===t.charAt(1))&&(this.x-=e),this},shift:function(t,e,i,a){return(t||e)&&this._setPosition(this._x+t,this._y+e),i&&(this.w+=i),a&&(this.h+=a),this},_cascade:function(t){if(t){var e=this._x-t._x,i=this._y-t._y,a=this._w-t._w,r=this._h-t._h;this._cascadeInner(e,i,a,r)}},_cascadeInner:function(t,e,i,a){for(var r,n=0,o=this._children,s=o.length;n<s;++n)(r=o[n]).__frozen||r.shift(t,e,i,a)},_cascadeRotation:function(t){if(t)for(var e,i=0,a=this._children,s=a.length,l=t*r,h=n(l),c=o(l),u=this._origin.x+this._x,d=this._origin.y+this._y;i<s;++i)!(e=a[i]).__frozen&&"rotate"in e&&e.rotate(t,u,d,h,c)},attach:function(){for(var t,e=0,i=arguments,a=arguments.length;e<a;++e)(t=i[e])._parent&&t._parent.detach(t),t._parent=this,this._children.push(t);return this},detach:function(t){var e;if(!t){for(e=0;e<this._children.length;e++)this._children[e]._parent=null;return this._children=[],this}for(e=0;e<this._children.length;e++)this._children[e]===t&&this._children.splice(e,1);return t._parent=null,this},origin:function(t,e){if("string"==typeof t){if("centre"===t||"center"===t||-1===t.indexOf(" "))t=this._w/2,e=this._h/2;else{var i=t.split(" ");"top"===i[0]?e=0:"bottom"===i[0]?e=this._h:("middle"===i[0]||"center"===i[1]||"centre"===i[1])&&(e=this._h/2),"center"===i[1]||"centre"===i[1]||"middle"===i[1]?t=this._w/2:"left"===i[1]?t=0:"right"===i[1]&&(t=this._w)}}if(this.rotation){var a=-this._rotation*r,s=t-this._origin.x,l=e-this._origin.y,h=n(a),c=o(a);this._cascadeInner(s*(1-h)-l*c,l*(1-h)+s*c,0,0)}return this._origin.x=t,this._origin.y=e,this._mbr&&this._calculateMBR(),this._entry.update(this._cbr||this._mbr||this),this.trigger("OriginChanged"),this.trigger("Invalidate"),this},rotate:function(t,e,i,a,r){var n,o;n=(this._x+this._origin.x-e)*a+(this._y+this._origin.y-i)*r+(e-this._origin.x),o=(this._y+this._origin.y-i)*a-(this._x+this._origin.x-e)*r+(i-this._origin.y),this._setter2d("_rotation",this._rotation-t),this._setter2d("_x",n),this._setter2d("_y",o)},_setPosition:function(t,e){if(t!==this._x||e!==this._y){var i=a.rectManager._pool.copy(this),r=this._mbr;r&&(r._x-=this._x-t,r._y-=this._y-e,this._cbr&&(this._cbr._x-=this._x-t,this._cbr._y-=this._y-e)),this._x=t,this._y=e,this.trigger("Move",i),this.trigger("Invalidate"),a.rectManager._pool.recycle(i)}},_setter2d:function(t,e){if(this[t]!==e){var i,r=a.rectManager._pool.copy(this);if("_rotation"===t)this._rotate(e);else if("_x"===t||"_y"===t)(i=this._mbr)&&(i[t]-=this[t]-e,this._cbr&&(this._cbr[t]-=this[t]-e)),this[t]=e,this.trigger("Move",r);else if("_h"===t||"_w"===t){i=this._mbr;var n=this[t];this[t]=e,i&&this._calculateMBR(),"_w"===t?this.trigger("Resize",{axis:"w",amount:e-n}):"_h"===t&&this.trigger("Resize",{axis:"h",amount:e-n}),this.trigger("Move",r)}else if("_z"===t){var o=e<<0;e=e===o?o:o+1,this._globalZ=1e5*e+this[0],this[t]=e,this.trigger("Reorder")}this[t]=e,this.trigger("Invalidate"),a.rectManager._pool.recycle(r)}}}),a.polygon=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0)),this.points=t},a.polygon.prototype={containsPoint:function(t,e){var i,a,r=this.points,n=r.length/2,o=!1;for(i=0,a=n-1;i<n;a=i++)r[2*i+1]>e!=r[2*a+1]>e&&t<(r[2*a]-r[2*i])*(e-r[2*i+1])/(r[2*a+1]-r[2*i+1])+r[2*i]&&(o=!o);return o},shift:function(t,e){for(var i=0,a=this.points,r=a.length;i<r;i+=2)a[i]+=t,a[i+1]+=e},clone:function(){return new a.polygon(this.points.slice(0))},rotate:function(t,e,i,a,r){for(var n,o,s=0,l=this.points,h=l.length;s<h;s+=2)n=e+(l[s]-e)*a+(l[s+1]-i)*r,o=i-(l[s]-e)*r+(l[s+1]-i)*a,l[s]=n,l[s+1]=o},intersectRay:function(t,e){for(var i,a,r,n,o,s,l,h,c,u=this.points,d=1/0,p=t._x,y=e.x,m=t._y,f=e.y,g=0,v=u.length,w=u[v-2],x=u[v-1];g<v;g+=2)s=u[g],h=u[g+1],l=s-w,a=(w-p)*(c=h-x)-(x-m)*l,n=(w-p)*f-(x-m)*y,0!=(o=y*c-f*l)?(i=a/o,(r=n/o)>=0&&r<=1&&i>=0&&i<d&&(d=i)):(0===a||0===n)&&((i=(w-p)*y+(x-m)*f)>=0&&i<d&&(d=i),(i=(s-p)*y+(h-m)*f)>=0&&i<d&&(d=i)),w=s,x=h;return d}},a.circle=function(t,e,i){this.x=t,this.y=e,this.radius=i,this.points=[];for(var a,r=0;r<16;r+=2)a=r*Math.PI/8,this.points[r]=this.x+Math.sin(a)*i,this.points[r+1]=this.y+Math.cos(a)*i},a.circle.prototype={containsPoint:function(t,e){var i=this.radius,a=this.x-t,r=this.y-e;return a*a+r*r<i*i},shift:function(t,e){this.x+=t,this.y+=e;for(var i=0,a=this.points,r=a.length;i<r;i+=2)a[i]+=t,a[i+1]+=e},rotate:function(){}},a.matrix=function(t){this.mtx=t,this.width=t[0].length,this.height=t.length},a.matrix.prototype={x:function(t){if(this.width===t.height){for(var e=[],i=0;i<this.height;i++){e[i]=[];for(var r=0;r<t.width;r++){for(var n=0,o=0;o<this.width;o++)n+=this.mtx[i][o]*t.mtx[o][r];e[i][r]=n}}return new a.matrix(e)}},e:function(t,e){return t<1||t>this.mtx.length||e<1||e>this.mtx[0].length?null:this.mtx[t-1][e-1]}}},{"../core/core.js":10}],56:[function(t,e,i){var a=t("../core/core.js"),r=Math.PI/180;a.extend({raycast:function(t,e){for(var i,r,n="obj",o=1/0,s=!0,l=2,h=arguments.length;l<h;++l)i=arguments[l],"number"==(r=typeof i)?o=i+1e-6:"string"===r?n=i:"boolean"===r&&(s=i);var c=t._x,u=t._y,d=e.x,p=e.y,y={},m=[];if(o<0){var f=null,g=1/0;a.map.traverseRay(t,e,function(i,a){if(f&&g<a)return m.push({obj:f,distance:g,x:c+g*d,y:u+g*p}),f=null,g=1/0,!0;if(i.map&&i.__c[n]&&!y[i[0]]){y[i[0]]=!0;var r=i.map.intersectRay(t,e);r<g&&(f=i,g=r)}}),f&&m.push({obj:f,distance:g,x:c+g*d,y:u+g*p})}else a.map.traverseRay(t,e,function(i,a){if(a>o)return!0;if(i.map&&i.__c[n]&&!y[i[0]]){y[i[0]]=!0;var r=i.map.intersectRay(t,e);r<o&&m.push({obj:i,distance:r,x:c+r*d,y:u+r*p})}});return s&&m.sort(function(t,e){return t.distance-e.distance}),m}}),a.c("Collision",{init:function(){this.requires("2D"),this._collisionData={},this.collision()},remove:function(){this._cbr=null,this.unbind("Resize",this._resizeMap),this.unbind("Resize",this._checkBounds)},collision:function(t){if(this.unbind("Resize",this._resizeMap),this.unbind("Resize",this._checkBounds),t){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,0);t=new a.polygon(e)}else t=t.constructor===Array?new a.polygon(t.slice()):t.clone();this._findBounds(t.points)}else t=new a.polygon([0,0,this._w,0,this._w,this._h,0,this._h]),this.bind("Resize",this._resizeMap),this._cbr=null;return this.rotation&&t.rotate(this.rotation,this._origin.x,this._origin.y,Math.cos(-this.rotation*r),Math.sin(-this.rotation*r)),this.map=t,this.attach(this.map),this.map.shift(this._x,this._y),this.trigger("NewHitbox",t),this},cbr:function(t){return(t=t||{},this._cbr)?(t._x=this._cbr._x,t._y=this._cbr._y,t._w=this._cbr._w,t._h=this._cbr._h,t):this.mbr(t)},_findBounds:function(t){for(var e=1/0,i=-1/0,a=1/0,r=-1/0,n=t.length,o=0;o<n;o+=2)t[o]<e&&(e=t[o]),t[o]>i&&(i=t[o]),t[o+1]<a&&(a=t[o+1]),t[o+1]>r&&(r=t[o+1]);var s={cx:(e+i)/2,cy:(a+r)/2,r:Math.sqrt((i-e)*(i-e)+(r-a)*(r-a))/2};return(e>=0&&a>=0&&(this._checkBounds=function(){null===this._cbr&&this._w<i||this._h<r?(this._cbr=s,this._calculateMBR()):this._cbr&&(this._cbr=null,this._calculateMBR())},this.bind("Resize",this._checkBounds)),e>=0&&a>=0&&i<=this._w&&r<=this._h)?(this._cbr=null,!1):(this._cbr=s,this._calculateMBR(),!0)},_resizeMap:function(t){var e,i,a=this.rotation*r,n=this.map.points;"w"===t.axis?(a?(e=t.amount*Math.cos(a),i=t.amount*Math.sin(a)):(e=t.amount,i=0),n[2]+=e,n[3]+=i):(a?(i=t.amount*Math.cos(a),e=-t.amount*Math.sin(a)):(e=0,i=t.amount),n[6]+=e,n[7]+=i),n[4]+=e,n[5]+=i},_collisionHitDupes:[],_collisionHitResults:[],hit:function(t,e){var i=this._cbr||this._mbr||this,r=this._collisionHitResults;r.length=0;var n=(r=a.map.unfilteredSearch(i,r)).length;if(!n)return null;var o,s,l=0,h=this._collisionHitDupes;for(e=e||[],h.length=0;l<n;++l)if((s=r[l])&&!h[o=s[0]]&&this[0]!==o&&s.__c[t]){if(h[o]=s,s.map){var c=this._SAT(this.map,s.map);c&&(e.push(c),c.obj=s,c.type="SAT")}else a.rectManager.overlap(i,s._cbr||s._mbr||s)&&e.push({obj:s,type:"MBR"})}return e.length?e:null},onHit:function(t,e,i){var a=!1;return this.bind("UpdateFrame",function(){var r=this.hit(t);r?(e.call(this,r,!a),a=!0):a&&("function"==typeof i&&i.call(this),a=!1)}),this},_createCollisionHandler:function(t,e){return function(){var i=this.hit(t);if(!0===e.occurring){if(null!==i)return;e.occurring=!1,this.trigger("HitOff",t)}else null!==i&&(e.occurring=!0,this.trigger("HitOn",i))}},checkHits:function(){var t=arguments,e=0;for(1===t.length&&(t=t[0].split(/\s*,\s*/));e<t.length;++e){var i=t[e],a=this._collisionData[i];void 0===a&&(this._collisionData[i]=a={occurring:!1,handler:null},a.handler=this._createCollisionHandler(i,a),this.bind("UpdateFrame",a.handler))}return this},ignoreHits:function(){var t,e=arguments,i=0;if(0===e.length){for(t in this._collisionData)this.unbind("UpdateFrame",t.handler);this._collisionData={}}for(1===e.length&&(e=e[0].split(/\s*,\s*/));i<e.length;++i){var a=e[i];void 0!==(t=this._collisionData[a])&&(this.unbind("UpdateFrame",t.handler),delete this._collisionData[a])}return this},resetHitChecks:function(){var t,e=arguments,i=0;if(0===e.length)for(t in this._collisionData)this._collisionData[t].occurring=!1;for(1===e.length&&(e=e[0].split(/\s*,\s*/));i<e.length;++i){var a=e[i];void 0!==(t=this._collisionData[a])&&(t.occurring=!1)}return this},_SAT:function(t,e){for(var i,a,r,n,o,s,l,h,c,u=0,d=t.points,p=e.points,y=d.length/2,m=p.length/2,f=0,g=0,v=-1/0,w=null,x=null;u<y;u++){for(c=u===y-1?0:u+1,a=Math.sqrt((f=-(d[2*u+1]-d[2*c+1]))*f+(g=d[2*u]-d[2*c])*g),f/=a,g/=a,r=n=1/0,o=s=-1/0,i=0;i<y;++i)(h=d[2*i]*f+d[2*i+1]*g)>o&&(o=h),h<r&&(r=h);for(i=0;i<m;++i)(h=p[2*i]*f+p[2*i+1]*g)>s&&(s=h),h<n&&(n=h);if(r<n?(l=n-o,f=-f,g=-g):l=r-s,l>=0)return!1;l>v&&(v=l,w=f,x=g)}for(u=0;u<m;u++){for(c=u===m-1?0:u+1,a=Math.sqrt((f=-(p[2*u+1]-p[2*c+1]))*f+(g=p[2*u]-p[2*c])*g),f/=a,g/=a,r=n=1/0,o=s=-1/0,i=0;i<y;++i)(h=d[2*i]*f+d[2*i+1]*g)>o&&(o=h),h<r&&(r=h);for(i=0;i<m;++i)(h=p[2*i]*f+p[2*i+1]*g)>s&&(s=h),h<n&&(n=h);if(r<n?(l=n-o,f=-f,g=-g):l=r-s,l>=0)return!1;l>v&&(v=l,w=f,x=g)}return{overlap:v,nx:w,ny:x}}})},{"../core/core.js":10}],57:[function(t,e,i){var a=t("../core/core.js");a.math={abs:function(t){return t<0?-t:t},amountOf:function(t,e,i){return e<i?(t-e)/(i-e):(t-i)/(e-i)},clamp:function(t,e,i){return t>i?i:t<e?e:t},degToRad:function(t){return t*Math.PI/180},distance:function(t,e,i,r){return Math.sqrt(parseFloat(a.math.squaredDistance(t,e,i,r)))},lerp:function(t,e,i){return t+(e-t)*i},negate:function(t){return Math.random()<t?-1:1},radToDeg:function(t){return 180*t/Math.PI},randomElementOfArray:function(t){return t[Math.floor(t.length*Math.random())]},randomInt:function(t,e){return t+Math.floor((1+e-t)*Math.random())},randomNumber:function(t,e){return t+(e-t)*Math.random()},squaredDistance:function(t,e,i,a){return(t-i)*(t-i)+(e-a)*(e-a)},withinRange:function(t,e,i){return t>=e&&t<=i}},a.math.Vector2D=function(){function t(e,i){if(e instanceof t)this.x=e.x,this.y=e.y;else if(2==arguments.length)this.x=e,this.y=i;else if(arguments.length>0)throw"Unexpected number of arguments for Vector2D()"}return t.prototype.x=0,t.prototype.y=0,t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.angleBetween=function(t){return Math.atan2(this.x*t.y-this.y*t.x,this.x*t.x+this.y*t.y)},t.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},t.prototype.clone=function(){return new t(this)},t.prototype.distance=function(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y))},t.prototype.distanceSq=function(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y},t.prototype.crossProduct=function(t){return this.x*t.y-this.y*t.x},t.prototype.equals=function(e){return e instanceof t&&this.x===e.x&&this.y===e.y},t.prototype.perpendicular=function(e){return(e=e||new t).setValues(-this.y,this.x)},t.prototype.getNormal=function(e,i){return(i=i||new t).setValues(e.y-this.y,this.x-e.x).normalize()},t.prototype.isZero=function(){return 0===this.x&&0===this.y},t.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.magnitudeSq=function(){return this.x*this.x+this.y*this.y},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return 0===t?(this.x=1,this.y=0):(this.x/=t,this.y/=t),this},t.prototype.scale=function(t,e){return void 0===e&&(e=t),this.x*=t,this.y*=e,this},t.prototype.scaleToMagnitude=function(t){var e=t/this.magnitude();return this.x*=e,this.y*=e,this},t.prototype.setValues=function(e,i){return e instanceof t?(this.x=e.x,this.y=e.y):(this.x=e,this.y=i),this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.toString=function(){return"Vector2D("+this.x+", "+this.y+")"},t.prototype.translate=function(t,e){return void 0===e&&(e=t),this.x+=t,this.y+=e,this},t.tripleProduct=function(t,e,i,r){r=r||new a.math.Vector2D;var n=t.dotProduct(i),o=e.dotProduct(i);return r.setValues(e.x*n-t.x*o,e.y*n-t.y*o)},t}(),a.math.Matrix2D=function(){function t(e,i,a,r,n,o){if(e instanceof t)this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,this.f=e.f;else if(6==arguments.length)this.a=e,this.b=i,this.c=a,this.d=r,this.e=n,this.f=o;else if(arguments.length>0)throw"Unexpected number of arguments for Matrix2D()"}return t.prototype.a=1,t.prototype.b=0,t.prototype.c=0,t.prototype.d=1,t.prototype.e=0,t.prototype.f=0,t.prototype.apply=function(t){var e=t.x;return t.x=e*this.a+t.y*this.c+this.e,t.y=e*this.b+t.y*this.d+this.f,t},t.prototype.clone=function(){return new t(this)},t.prototype.combine=function(t){var e=this.a;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,e=this.c,this.c=e*t.a+this.d*t.c,this.d=e*t.b+this.d*t.d,e=this.e,this.e=e*t.a+this.f*t.c+t.e,this.f=e*t.b+this.f*t.d+t.f,this},t.prototype.equals=function(e){return e instanceof t&&this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f},t.prototype.determinant=function(){return this.a*this.d-this.b*this.c},t.prototype.invert=function(){var t=this.determinant();if(0!==t){var e={a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f};this.a=e.d/t,this.b=-e.b/t,this.c=-e.c/t,this.d=e.a/t,this.e=(e.c*e.f-e.e*e.d)/t,this.f=(e.e*e.b-e.a*e.f)/t}return this},t.prototype.isIdentity=function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},t.prototype.isInvertible=function(){return 0!==this.determinant()},t.prototype.preRotate=function(t){var e=Math.cos(t),i=Math.sin(t),a=this.a;return this.a=e*a-i*this.b,this.b=i*a+e*this.b,a=this.c,this.c=e*a-i*this.d,this.d=i*a+e*this.d,this},t.prototype.preScale=function(t,e){return void 0===e&&(e=t),this.a*=t,this.b*=e,this.c*=t,this.d*=e,this},t.prototype.preTranslate=function(t,e){return"number"==typeof t?(this.e+=t,this.f+=e):(this.e+=t.x,this.f+=t.y),this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),a=this.a;return this.a=e*a-i*this.b,this.b=i*a+e*this.b,a=this.c,this.c=e*a-i*this.d,this.d=i*a+e*this.d,a=this.e,this.e=e*a-i*this.f,this.f=i*a+e*this.f,this},t.prototype.scale=function(t,e){return void 0===e&&(e=t),this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e,this},t.prototype.setValues=function(e,i,a,r,n,o){return e instanceof t?(this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,this.f=e.f):(this.a=e,this.b=i,this.c=a,this.d=r,this.e=n,this.f=o),this},t.prototype.toString=function(){return"Matrix2D(["+this.a+", "+this.c+", "+this.e+"] ["+this.b+", "+this.d+", "+this.f+"] [0, 0, 1])"},t.prototype.translate=function(t,e){return"number"==typeof t?(this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e):(this.e+=this.a*t.x+this.c*t.y,this.f+=this.b*t.x+this.d*t.y),this},t}()},{"../core/core.js":10}],58:[function(t,e,i){var a=t("../core/core.js"),r=function(t,e,i,r){var n=e+i,o="_"+n,s={key:"",oldValue:0};r?a.defineField(t,n,function(){return this[o]},function(t){var e=this[o];t!==e&&(this[o]=t,s.key=n,s.oldValue=e,this.trigger("MotionChange",s))}):a.defineField(t,n,function(){return this[o]},function(t){}),Object.defineProperty(t,o,{value:0,writable:!0,enumerable:!1,configurable:!1})},n=function(t,e,i,r){var n=e+"x",o=e+"y",s="_"+n,l="_"+o;return i?(a.defineField(r,"x",function(){return t[s]},function(e){t[n]=e}),a.defineField(r,"y",function(){return t[l]},function(e){t[o]=e})):(a.defineField(r,"x",function(){return t[s]},function(t){}),a.defineField(r,"y",function(){return t[l]},function(t){})),Object.seal&&Object.seal(r),r};a.c("AngularMotion",{_vrotation:0,_arotation:0,_drotation:0,init:function(){this.requires("2D"),r(this,"v","rotation",!0),r(this,"a","rotation",!0),r(this,"d","rotation",!1),this.__oldRotationDirection=0,this.bind("UpdateFrame",this._angularMotionTick)},remove:function(t){this.unbind("UpdateFrame",this._angularMotionTick)},resetAngularMotion:function(){return this._drotation=0,this.vrotation=0,this.arotation=0,this},_angularMotionTick:function(t){var e=t.dt/1e3,i=this._rotation,a=this._vrotation,r=this._arotation,n=i+a*e+.5*r*e*e;this.vrotation=a+r*e;var o=this._vrotation,s=o?o<0?-1:1:0;this.__oldRotationDirection!==s&&(this.__oldRotationDirection=s,this.trigger("NewRotationDirection",s)),this._drotation=n-i,0!==this._drotation&&(this.rotation=n,this.trigger("Rotated",i))}}),a.c("Motion",{_vx:0,_vy:0,_ax:0,_ay:0,_dx:0,_dy:0,init:function(){this.requires("2D"),r(this,"v","x",!0),r(this,"v","y",!0),this._velocity=n(this,"v",!0,new a.math.Vector2D),r(this,"a","x",!0),r(this,"a","y",!0),this._acceleration=n(this,"a",!0,new a.math.Vector2D),r(this,"d","x",!1),r(this,"d","y",!1),this._motionDelta=n(this,"d",!1,new a.math.Vector2D),this.__oldDirection={x:0,y:0},this.bind("UpdateFrame",this._linearMotionTick)},remove:function(t){this.unbind("UpdateFrame",this._linearMotionTick)},resetMotion:function(){return this.vx=0,this.vy=0,this.ax=0,this.ay=0,this._dx=0,this._dy=0,this},motionDelta:function(){return this._motionDelta},velocity:function(){return this._velocity},acceleration:function(){return this._acceleration},ccdbr:function(t){var e=this._cbr||this._mbr||this,i=this._dx,a=this._dy,r=0,n=0,o=i>0?r=i:-i,s=a>0?n=a:-a;return(t=t||{})._x=e._x-r,t._y=e._y-n,t._w=e._w+o,t._h=e._h+s,t},_linearMotionTick:function(t){var e=t.dt/1e3,i=this._vx,a=this._ax,r=this._vy,n=this._ay,o=i*e+.5*a*e*e,s=r*e+.5*n*e*e;this.vx=i+a*e,this.vy=r+n*e;var l=this.__oldDirection,h=this._vx,c=h?h<0?-1:1:0,u=this._vy,d=u?u<0?-1:1:0;(l.x!==c||l.y!==d)&&(l.x=c,l.y=d,this.trigger("NewDirection",l)),this._dx=o,this._dy=s,this._setPosition(this._x+o,this._y+s)}})},{"../core/core.js":10}],59:[function(t,e,i){var a=t("../core/core.js");a.c("Supportable",{_ground:null,_groundComp:null,_preventGroundTunneling:!1,canLand:!0,init:function(){this.requires("2D"),this.__area={_x:0,_y:0,_w:0,_h:0},this.defineField("ground",function(){return this._ground},function(t){})},remove:function(t){this.unbind("UpdateFrame",this._detectGroundTick)},startGroundDetection:function(t){return t&&(this._groundComp=t),this.uniqueBind("UpdateFrame",this._detectGroundTick),this},stopGroundDetection:function(){return this.unbind("UpdateFrame",this._detectGroundTick),this},preventGroundTunneling:function(t){return void 0===t&&(t=!0),t&&this.requires("Motion"),this._preventGroundTunneling=t,this},_detectGroundTick:function(){var t,e=this._groundComp,i=this._ground,r=a.rectManager.overlap;if(this._preventGroundTunneling)t=this.ccdbr(this.__area);else{var n=this._cbr||this._mbr||this;(t=this.__area)._x=n._x,t._y=n._y,t._w=n._w,t._h=n._h}if(t._h++,i){var o=i._cbr||i._mbr||i;i.__c[e]&&a(i[0])===i&&r(o,t)||(this._ground=null,this.trigger("LiftedOffGround",i),i=null)}if(!i){for(var s,l,h=a.map.unfilteredSearch(t),c=0,u=h.length;c<u;++c)if(l=(s=h[c])._cbr||s._mbr||s,s!==this&&s.__c[e]&&r(l,t)&&(this.canLand=!0,this.trigger("CheckLanding",s),this.canLand)){this._ground=i=s,this.y=i._y-this._h,this._x>i._x+i._w?this.x=i._x+i._w-1:this._x+this._w<i._x&&(this.x=i._x-this._w+1),this.trigger("LandedOnGround",i);break}}}}),a.c("GroundAttacher",{_groundAttach:function(t){t.attach(this)},_groundDetach:function(t){t.detach(this)},init:function(){this.requires("Supportable"),this.bind("LandedOnGround",this._groundAttach),this.bind("LiftedOffGround",this._groundDetach)},remove:function(t){this.unbind("LandedOnGround",this._groundAttach),this.unbind("LiftedOffGround",this._groundDetach)}}),a.c("Gravity",{_gravityConst:500,_gravityActive:!1,init:function(){this.requires("2D, Supportable, Motion"),this.bind("LiftedOffGround",this._startGravity),this.bind("LandedOnGround",this._stopGravity)},remove:function(t){this.unbind("LiftedOffGround",this._startGravity),this.unbind("LandedOnGround",this._stopGravity)},_gravityCheckLanding:function(t){this._dy<0&&(this.canLand=!1)},gravity:function(t){return this.uniqueBind("CheckLanding",this._gravityCheckLanding),this.startGroundDetection(t),this._startGravity(),this},antigravity:function(){return this._stopGravity(),this.stopGroundDetection(),this.unbind("CheckLanding",this._gravityCheckLanding),this},gravityConst:function(t){return this._gravityActive&&(this.ay-=this._gravityConst,this.ay+=t),this._gravityConst=t,this},_startGravity:function(){this._gravityActive||(this._gravityActive=!0,this.ay+=this._gravityConst)},_stopGravity:function(){this._gravityActive&&(this._gravityActive=!1,this.ay=0,this.vy=0)}})},{"../core/core.js":10}],60:[function(t,e,i){var a,r;t("../core/core.js").extend({rectManager:{merge:function(t,e,i){return void 0===i&&(i={}),i._h=Math.max(t._y+t._h,e._y+e._h),i._w=Math.max(t._x+t._w,e._x+e._w),i._x=Math.min(t._x,e._x),i._y=Math.min(t._y,e._y),i._w-=i._x,i._h-=i._y,i},overlap:function(t,e){return t._x<e._x+e._w&&t._x+t._w>e._x&&t._y<e._y+e._h&&t._y+t._h>e._y},integerBounds:function(t){return t._x=Math.floor(t._x),t._y=Math.floor(t._y),t._w=Math.ceil(t._w),t._h=Math.ceil(t._h),t},mergeSet:function(t){if(t.length<2)return t;for(var e=t.length-1;e--;)this.overlap(t[e],t[e+1])&&(this.merge(t[e],t[e+1],t[e]),t.splice(e+1,1));return t},boundingRect:function(t){if(t&&t.length){var e,i,a=1,r=t.length,n=t[0];for(n=[n._x,n._y,n._x+n._w,n._y+n._h];a<r;)(i=[(e=t[a])._x,e._y,e._x+e._w,e._y+e._h])[0]<n[0]&&(n[0]=i[0]),i[1]<n[1]&&(n[1]=i[1]),i[2]>n[2]&&(n[2]=i[2]),i[3]>n[3]&&(n[3]=i[3]),a++;return{_x:(i=n)[0],_y:i[1],_w:i[2]-i[0],_h:i[3]-i[1]}}},_pool:(a=[],r=0,{get:function(t,e,i,n){a.length<=r&&a.push({});var o=a[r++];return o._x=t,o._y=e,o._w=i,o._h=n,o},copy:function(t){a.length<=r&&a.push({});var e=a[r++];return e._x=t._x,e._y=t._y,e._w=t._w,e._h=t._h,e},recycle:function(t){r--}})}})},{"../core/core.js":10}],61:[function(t,e,i){var a,r={},n=function(t){a=t||64,this.map={},this.boundsDirty=!1,this.coordBoundsDirty=!1,this.boundsHash={maxX:-1/0,maxY:-1/0,minX:1/0,minY:1/0},this.boundsCoords={maxX:-1/0,maxY:-1/0,minX:1/0,minY:1/0}};function o(t,e,i){this.keys=t,this.map=i,this.obj=e}n.key=function(t,e){return t=t._cbr||t._mbr||t,(e=e||{}).x1=Math.floor(t._x/a),e.y1=Math.floor(t._y/a),e.x2=Math.floor((t._w+t._x)/a),e.y2=Math.floor((t._h+t._y)/a),e},n.hash=function(t){return t.x1+" "+t.y1+" "+t.x2+" "+t.y2},n.cellsize=function(){return a},n.prototype={insert:function(t,e){var i,a,r,s=n.key(t,e&&e.keys);for(e=e||new o(s,t,this),i=s.x1;i<=s.x2;i++)for(a=s.y1;a<=s.y2;a++)r=i<<16^a,this.map[r]||(this.map[r]=[]),this.map[r].push(t);return this.boundsDirty=!0,e},_searchHolder:[],search:function(t,e){var i,a,o,s,l,h=n.key(t,r),c=this._searchHolder;for(e=e||[],c.length=0,a=h.x1;a<=h.x2;a++)for(o=h.y1;o<=h.y2;o++)if(l=this.map[a<<16^o])for(s=0;s<l.length;s++)!c[l[s][0]]&&(i=(i=c[l[s][0]]=l[s])._cbr||i._mbr||i)._x<t._x+t._w&&i._x+i._w>t._x&&i._y<t._y+t._h&&i._y+i._h>t._y&&e.push(l[s]);return e},unfilteredSearch:function(t,e){var i,a,o,s,l=n.key(t,r);for(e=e||[],i=l.x1;i<=l.x2;i++)for(a=l.y1;a<=l.y2;a++)if(s=this.map[i<<16^a])for(o=0;o<s.length;o++)e.push(s[o]);return e},remove:function(t){var e,i,a=t.keys,r=t.obj,n=0;for(n=a.x1;n<=a.x2;n++)for(e=a.y1;e<=a.y2;e++)if(i=n<<16^e,this.map[i]){var o,s=this.map[i],l=s.length;for(o=0;o<l;o++)s[o]&&s[o][0]===r[0]&&s.splice(o,1)}this.boundsDirty=!0},refresh:function(t){var e,i,a,r,o,s=t.keys,l=t.obj;for(i=s.x1;i<=s.x2;i++)for(a=s.y1;a<=s.y2;a++)if(e=this.map[i<<16^a])for(r=0,o=e.length;r<o;r++)e[r]&&e[r][0]===l[0]&&e.splice(r,1);for(n.key(l,s),i=s.x1;i<=s.x2;i++)for(a=s.y1;a<=s.y2;a++)(e=this.map[i<<16^a])||(e=this.map[i<<16^a]=[]),e.push(l);return this.boundsDirty=!0,t},boundaries:function(){this._updateBoundaries();var t=this.boundsCoords;return{min:{x:t.minX,y:t.minY},max:{x:t.maxX,y:t.maxY}}},_keyBoundaries:function(){return this._updateBoundaries(),this.boundsHash},_updateBoundaries:function(){if(this.boundsDirty||this.coordBoundsDirty){var t,e,i,a=this.boundsHash;this.boundsDirty&&(a.maxX=-1/0,a.maxY=-1/0,a.minX=1/0,a.minY=1/0);var r=this.boundsCoords;for(var n in r.maxX=-1/0,r.maxY=-1/0,r.minX=1/0,r.minY=1/0,this.map)if((i=this.map[n]).length){var o=n>>16,s=n<<16>>16;if(s<0&&(o=~o),o>=a.maxX)for(t in a.maxX=o,i)"object"==typeof(e=i[t])&&"requires"in e&&(r.maxX=Math.max(r.maxX,e.x+e.w));if(o<=a.minX)for(t in a.minX=o,i)"object"==typeof(e=i[t])&&"requires"in e&&(r.minX=Math.min(r.minX,e.x));if(s>=a.maxY)for(t in a.maxY=s,i)"object"==typeof(e=i[t])&&"requires"in e&&(r.maxY=Math.max(r.maxY,e.y+e.h));if(s<=a.minY)for(t in a.minY=s,i)"object"==typeof(e=i[t])&&"requires"in e&&(r.minY=Math.min(r.minY,e.y))}this.boundsDirty=!1,this.coordBoundsDirty=!1}},traverseRay:function(t,e,i){var o,s,l=e.x,h=e.y;t={_x:t._x,_y:t._y,_w:0,_h:0};var c=this._keyBoundaries(),u=n.key(t,r),d=u.x1,p=u.y1,y=c.minX,m=c.minY,f=c.maxX,g=c.maxY,v=l>0?1:l<0?-1:0,w=h>0?1:h<0?-1:0,x=l>=0?(d+1)*a:d*a,_=h>=0?(p+1)*a:p*a,b=-1/0,S=0,C=0,k=1/0,D=1/0;for(0!==l&&(o=1/l,k=(x-t._x)*o,S=a*v*o),0!==h&&(o=1/h,D=(_-t._y)*o,C=a*w*o);1===v&&d<y&&y!==1/0||-1===v&&d>f&&f!==-1/0||1===w&&p<m&&m!==1/0||-1===w&&p>g&&g!==-1/0;)k<D?(b=k,d+=v,k+=S):(b=D,p+=w,D+=C);for(;y<=d&&d<=f&&m<=p&&p<=g;){if(s=this.map[d<<16^p]){for(var z=0;z<s.length;z++)if(i(s[z],b))return}k<D?(b=k,d+=v,k+=S):(b=D,p+=w,D+=C)}}},o.prototype={update:function(t){n.hash(n.key(t,r))!==n.hash(this.keys)?this.map.refresh(this):this.map.coordBoundsDirty=!0}},e.exports=n},{}]},{},[22]);const v=window.Crafty;delete window.Crafty,v.fn.forEach=function(t){this.each(function(e){t(this,e)})};const w=t=>(t<0?-180:180)-t,x={},_=t=>{if(x[t])return x[t];let e=v.math.degToRad(t),i={x:Math.cos(e),y:Math.sin(e)};return x[t]=i,i},b=(t,e)=>{let i=_(t.rotation);return[i.x*e,i.y*e]},S=(t,e)=>{let i=_(t.rotation+90);return[i.x*e,i.y*e]},C="Flipable",k=t=>{if(!t.emitter)return;let e=t.angle||0;t.emitter.xFlipped=!t.emitter.xFlipped,t.angle=w(e),t.trigger("Change",{angle:t.angle})},D=t=>{Array.from(t._children).forEach(e=>{"function"==typeof e.attr&&e.attr({x:t.x+(t.w-e.w)-(e.x-t.x)}),void 0!==e._dx&&(e._dx=-e._dx),"function"==typeof e.flip&&(e._flipX?e.unflip("X"):e.flip("X")),k(e),e._children&&D(e)})};v.c(C,{flipX(){if(this.xFlipped)return;this.xFlipped=!0;let t=this._rotation;this.rotation=0;try{"function"==typeof this.flip&&(this._flipX?this.unflip("X"):this.flip("X")),D(this)}catch(t){console.log(t)}return this._mirrorCollision(),this._mirrorRotationPoints(),this._mirrorStretchPoints(),this.rotation=-t,this},unflipX(){if(!this.xFlipped)return;this.xFlipped=!1;let t=this._rotation;this.rotation=0;try{"function"==typeof this.unflip&&(this._flipX?this.unflip("X"):this.flip("X")),D(this)}catch(t){console.log(t)}return this._mirrorCollision(),this._mirrorRotationPoints(),this._mirrorStretchPoints(),this.rotation=-t,this},_mirrorCollision(){if(this.map&&this.map.points)for(let t=0;t<this.map.points.length;t++){let e=this.map.points[t];if(t%2==0){let i=e-this.x;this.map.points[t]=this.x+(this.w-i)}}},_mirrorStretchPoints(){let t=e=>{Array.from(e._children).forEach(e=>{void 0!==e.stretch&&e.stretch[1]===e.stretch[3]&&(e.stretch[1]=1-e.stretch[1],e.stretch[3]=1-e.stretch[3],e._children&&t(e))})};void 0!==this.stretch&&this.stretch[1]===this.stretch[3]&&(this.stretch[1]=1-this.stretch[1],this.stretch[3]=1-this.stretch[3]),t(this)},_mirrorRotationPoints(){let t=e=>{Array.from(e._children).forEach(e=>{"function"==typeof e.attr&&(null!==e.origin&&(e._origin.x=e.w-e._origin.x),e._children&&t(e))})};this._origin.x=this.w-this._origin.x,t(this)}});var z={};z=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};const A="ColorEffects";v.c(A,{init(){this.attr({overrideColor:{_red:0,_green:0,_blue:0},overrideColorMode:"none",overrideColorStrength:0})},colorDesaturation(t){return null===t||(this.attr({desaturationColor:{_red:t._red/255,_green:t._green/255,_blue:t._blue/255}}),this.trigger("Invalidate")),this},colorOverride(t,e="all",i=1){if(null==t)return this;let a={};return u(z)(t)?a=t:v.assignColor(t,a),this.attr({overrideColor:{_red:a._red/255,_green:a._green/255,_blue:a._blue/255},overrideColorMode:e,overrideColorStrength:i}),this.trigger("Invalidate"),this},clearColorOverride(){return this.attr({overrideColorMode:"none"}),this.trigger("Invalidate"),this},saturationGradient(t,e){return this.attr({topDesaturation:t,bottomDesaturation:e}),this}}),v.c("Hideable",{_hidden:!1,properties:{hidden:{set(t){this._updateHidden(t)},get(){return this._hidden},configurable:!0,enumerable:!0},_hidden:{enumerable:!1}},init(){this.requires(A)},sendToBackground(t,e){return this._originalZ=this.z,this.attr({scale:t,z:e}),Array.from(this._children).filter(t=>t.attr).forEach(t=>{let i=t.z-this._originalZ;t.attr({z:e+i})}),this.hidden=!0,this},_updateHidden(t){this._hidden!==t&&(this._hidden=t,t?this.trigger("Hiding",this):this.trigger("Revealing",this))},hide(t,e){return this.hideMarker=t,e.below&&this.has("Sprite")&&0===this.rotation?(this.hideAt=e.below,Array.from(this._children).filter(t=>t.attr).forEach(t=>t.attr({hideAt:e.below}))):(this.attr({alpha:0}),Array.from(this._children).filter(t=>t.attr).forEach(t=>t.attr({alpha:0}))),this.hidden=!0,this},hideBelow(t){this.hideAt=t,Array.from(this._children).filter(t=>t.attr).forEach(e=>e.attr({hideAt:t}))},reveal(){return null!=this.hideMarker&&this.hideMarker.destroy(),Array.from(this._children).filter(t=>t.attr).forEach(t=>{let e=t.z-this.z;t.attr({z:this._originalZ+e})}),this.attr({scale:1,alpha:1,z:this._originalZ,hideAt:null}),Array.from(this._children).filter(t=>t.attr).forEach(t=>t.attr({alpha:1,hideAt:null})),this.hidden=!1,this},remove(){this.hideMarker&&(this.hideMarker.hasPool?this.hideMarker.recycle():this.hideMarker.destroy())}});const P="Scalable";v.c(P,{properties:{scaleX:{set(t){t!==this._scaleX&&this._updateScaleX(t)},get(){return this._scaleX},configurable:!0,enumerable:!0},_scaleX:{value:1,writable:!0,enumerable:!1,configurable:!1},scaleY:{set(t){t!==this._scaleY&&this._updateScaleY(t)},get(){return this._scaleY},configurable:!0,enumerable:!0},_scaleY:{value:1,writable:!0,enumerable:!1,configurable:!1},scale:{set(t){t!==this._scale&&this._updateScale(t)},get(){return this._scale},configurable:!0,enumerable:!0},_scale:{value:1,writable:!0,enumerable:!1,configurable:!1}},_updateScaleX(t){let e=this._scaleX;this._scaleX=t;let i=this.w;this.w=this.w/e*t,this.x=this.x+(i-this.w)/2,this._children.filter(t=>t.attr).forEach(a=>{let r=a.x-this.x;a.attr({x:this.x+r/e*t,w:(a.w+i-this.w)/e*t})}),this.map&&this.map.points&&(this.map.points=this.map.points.map((i,a)=>{if(a%2==1)return this.y;let r=a%2==0?this.x:this.y;return r+(i-r)/e*t}))},_updateScaleY(t){let e=this._scaleY;this._scaleY=t;let i=this.h;this.h=this.h/e*t,this.y=this.y+(i-this.h)/2,this._children.filter(t=>t.attr).forEach(a=>{let r=a.y-this.y;a.attr({y:this.y+r/e*t,h:(a.h+i-this.h)/e*t})}),this.map&&this.map.points&&(this.map.points=this.map.points.map((i,a)=>{if(a%2==0)return this.y;let r=a%2==0?this.x:this.y;return r+(i-r)/e*t}))},_updateScale(t){let e=this._scale;this._scale=t;let i=this.w,a=this.h;this.w=this.w/e*t,this.x=this.x+(i-this.w)/2,this.h=this.h/e*t,this.y=this.y+(a-this.h)/2,this._children.filter(t=>t.attr).forEach(r=>{let n=r.x-this.x,o=r.y-this.y;r.attr({x:this.x+n/e*t,y:this.y+o/e*t,w:(r.w+i-this.w)/e*t,h:(r.h+a-this.h)/e*t})}),this.map&&this.map.points&&(this.map.points=this.map.points.map((i,a)=>{let r=a%2==0?this.x:this.y;return r+(i-r)/e*t}))}});const F="easeInOutQuad",E="easeInQuad",B="easeOutQuad",T="linear",M={linear:t=>t,smoothStep:t=>(3-2*t)*t*t,smootherStep:t=>(6*t*t-15*t+10)*t*t*t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:(4-2*t)*t-1},L="Animator";v.c(L,{events:{Freeze(){this.animations=[],this.animating=!1,this.unbind("GameLoop",this._animateTick)}},init(){this.animations=[]},remove(){this.unbind("GameLoop",this._animateTick)},animate(t,e,i="linear"){return t?0===e?(t(1),Promise.resolve()):new Promise(a=>{let r={transition:t,timer:new v.easing(e,i),resolver:a};this.animations.push(r),this.animating||(this.animating=!0,this.uniqueBind("GameLoop",this._animateTick))}):Promise.resolve()},_animateTick({dt:t}){let e=[];this.animations.forEach((i,a)=>{let{timer:r,transition:n,resolver:o}=i;r.tick(t),n(r.value()),r.complete&&(n(1),e.push(a),o())}),e.reverse().forEach(t=>this.animations.splice(t,1)),0===this.animations.length&&(this.animating=!1,this.unbind("GameLoop",this._animateTick))}});const R=(t,e,i)=>{let a=i||t,r=Object.entries(e).reduce((t,[e,i])=>Object.prototype.hasOwnProperty.call(a,e)&&a[e]!==i?t.concat({key:e,current:a[e],newValue:i}):t,[]);return 0!=r.length&&(e=>{r.forEach(({key:i,current:a,newValue:r})=>{"overrideColor"===i?t[i]={_red:(1-e)*a._red+e*r._red,_green:(1-e)*a._green+e*r._green,_blue:(1-e)*a._blue+e*r._blue}:t[i]=(1-e)*a+e*r})})},O="TweenPromise";v.c(O,{required:L,async tweenPromise(t,e,i){let a=R(this,t);return this.animate(a,e,i)}}),v.c("Aimable",{init(){this.aim=this.aim.bind(this),this.resetAim=this.resetAim.bind(this)},async aim({target:t,speed:e=100,easing:i=F}){if(!t)return;let a=[],r=this.aimParts||[];this.forEachPart((n,o)=>{let s=this.spriteOptions(o);if(r.includes(s.key)){let r=n._parent,o=[r.x+s.ro[0],r.y+s.ro[1]],l=[t.x+t.w/2,t.y+t.h/2],h=o[0]-l[0],c=180*Math.atan2(o[1]-l[1],h)/Math.PI;n.addComponent(O);let u=Math.abs(n.rotation-c);a.push(n.tweenPromise({rotation:c},1e3/e*u,i))}}),await Promise.all(a)},async resetAim({speed:t=100,easing:e=F}={}){let i=[],a=this.aimParts||[];this.forEachPart((r,n)=>{let o=this.spriteOptions(n);if(a.includes(o.key)){r.addComponent(O);let a=Math.abs(r.rotation);i.push(r.tweenPromise({rotation:0},1e3/t*a,e))}}),await Promise.all(i)}}),v.c("BezierMove",{events:{GameLoop:"_moveBezierTick",Freeze:"remove"},remove(){this.bezierTimer.complete||this.trigger("BezierMoveEnd")},bezierMove(t,e){let i=e.speed||this.defaultSpeed,a=t.length/i*1e3;this.bezierTimer=new v.easing(a,e.easing||"linear"),this.bezierPath=t},_moveBezierTick(t){!this.bezierTimer.complete&&(this.bezierTimer.tick(t.dt),this._doMove(this.bezierTimer.value(),t),this.bezierTimer.complete&&this.trigger("BezierMoveEnd"))},_doMove(t,e){let i=this.bezierPath.get(t),a=i.x-this.x,r=i.y-this.y;if(this.updateMovementVisuals){let i=this.bezierPath.rotationAt(t);this.updateMovementVisuals(i,a,r,e.dt)}this.shift(a,r)}});const j=(t,{color:e="#FFFFFF",sup:i=null}={})=>{let a=(t,e,i,a)=>v.e(" 2D, Text, Tween, UILayerDOM, Delay").attr({w:v.viewport.width,z:1,alpha:0,baseText:t}).textAlign("center").text(t).attr({y:a}).textColor(e).textFont({size:i,weight:"bold",family:"Press Start 2P"}),r=[a(t,e,"30px",240)];if(i){let t=a(i,e,"16px",200);r=r.concat(t)}return{fadeIn:t=>new Promise(e=>{r[0].one("TweenEnd",e),r.forEach(e=>e.tween({alpha:1},t))}),fadeOut:t=>new Promise(e=>{r[0].one("TweenEnd",e),r.forEach(e=>e.tween({alpha:0},t))}),show:()=>{r.forEach(t=>t.attr({alpha:1}))},hide:()=>{r.forEach(t=>t.attr({alpha:0}))},zoomOut:t=>new Promise(e=>{r.forEach(t=>t.attr({alpha:1,scale:1,avoidCss3dTransforms:!0}).text(()=>(t.css({transform:`scale(${t.scale})`,transformOrigin:"center center"}),t.baseText)).dynamicTextGeneration(!0)),r[0].one("TweenEnd",()=>{r.forEach(t=>{t.attr({alpha:0,scale:1,avoidCss3dTransforms:!1}).text(t.baseText).dynamicTextGeneration(!1)}),e()}),r.forEach(e=>e.tween({alpha:0,scale:3},t))}),remove:()=>{r.forEach(t=>t.destroy())},blink:(t,e=4)=>new Promise(i=>{r[0].delay(()=>r.forEach(t=>t.attr({alpha:(t.alpha+1)%2})),t,2*e-1,i)})}};var H={};H="#define GLSLIFY 1\nattribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec4 aColor;\nattribute vec4 aDesaturation;\nattribute vec2 aGradient;\n\nvarying lowp vec4 vColor;\nvarying lowp vec4 vDesaturation;\nvarying lowp vec2 vGradient;\nvarying lowp vec2 vLayer;\nuniform  vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n\n  vColor = aColor;\n  vDesaturation = aDesaturation;\n  vGradient = aGradient;\n  vLayer = aLayer;\n}\n\n";var I={};I="precision mediump float;\n#define GLSLIFY 1\nvarying lowp vec4 vColor;\nvarying lowp vec2 vGradient;\nvarying lowp vec4 vDesaturation;\nvarying lowp vec2 vLayer;\nvoid main(void) {\n\n  //gl_FragColor = vec4(vColor.rgb*vColor.a*vLayer.y, vColor.a*vLayer.y);\n\n  mediump float mixFactor = vGradient.x;\n\n  mediump float lightness = (0.2126*vColor.r + 0.7152*vColor.g + 0.0722*vColor.b);\n  mediump float lightnessBase = (0.2126*vDesaturation.r + 0.7152*vDesaturation.g + 0.0722*vDesaturation.b);\n  mediump vec4 baseColor = vec4(vDesaturation.rgb, vColor.a) * (1.0 + (lightness - lightnessBase));\n  mediump vec4 mixColor = vec4(\n      (baseColor.rgba * mixFactor) + (vColor.rgba * (1.0 - mixFactor))\n      );\n\n  gl_FragColor = vec4(\n      mixColor.rgb * vColor.a * vLayer.y,\n      vColor.a * vLayer.y\n      );\n}\n\n",v.defaultShader("Color",new v.WebGLShader(u(H),u(I),[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aColor",width:4},{name:"aDesaturation",width:4},{name:"aGradient",width:2}],function(t,e){let i=null!=e.desaturationColor?e.desaturationColor:{_red:0,_green:0,_blue:0};t.program.writeVector("aColor",e._red/255,e._green/255,e._blue/255,e._strength),t.program.writeVector("aDesaturation",i._red/255,i._green/255,i._blue/255,1);let a=null!=e.scale?e.scale:1,r=null!=e.topDesaturation?e.topDesaturation:0,n=null!=e.bottomDesaturation?e.bottomDesaturation:0;return t.program.writeVector("aGradient",r+(1-a)*1.15,n+(1-a)*1.15)}));let G={_red:0,_green:0,_blue:0,_strength:1};const q="Horizon",U=()=>G,N=t=>{let e={};u(z)(t)?e=t:v.assignColor(t,e),(G._red!==e._red||G._green!==e._green||G._blue!==e._blue)&&(G=e,v(q).forEach(t=>t.colorDesaturation(e)))};v.c(q,{required:[A].join(","),init(){this.colorDesaturation(G)}}),v.c("HideBelow",{properties:{hideBelow:{set(t){this._hideBelow=t,this.trigger("Invalidate")},get(){return this._hideBelow},configurable:!0,enumerable:!0},_hideBelow:{writable:!0,enumerable:!1,configurable:!1},hideAbove:{set(t){this._hideAbove=t,this.trigger("Invalidate")},get(){return this._hideAbove},configurable:!0,enumerable:!0},_hideAbove:{writable:!0,enumerable:!1,configurable:!1}}});var V={};V="#define GLSLIFY 1\nattribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec4 aColor;\n\nvarying lowp vec4 vColor;\nvarying lowp vec2 vLayer;\nuniform vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n\n  vColor = aColor;\n  vLayer = aLayer;\n}\n\n";var X={};X="precision mediump float;\n#define GLSLIFY 1\nvarying lowp vec4 vColor;\nvarying lowp vec2 vLayer;\nvoid main(void) {\n  gl_FragColor = vec4(vColor.rgb*vColor.a*vLayer.y, vColor.a*vLayer.y);\n}\n",v.extend({defaultGradientShader(t){return t?this._defaultGradientShader=t:(void 0===this._defaultGradientShader&&(this._defaultGradientShader=new v.WebGLShader(u(V),u(X),[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aColor",width:4}],function(t,e){t.program.writeVector("aColor",e._topColor._red/255,e._topColor._green/255,e._topColor._blue/255,e._topColor._strength,e._bottomColor._red/255,e._bottomColor._green/255,e._bottomColor._blue/255,e._bottomColor._strength)})),this._defaultGradientShader)}});const W="Gradient";v.c(W,{events:{LayerAttached:"_setupGradient"},init(){this._topColor={_red:0,_green:0,_blue:0,_strength:1},this._bottomColor={_red:0,_green:0,_blue:0,_strength:1},this.ready=!0,this.bind("Draw",this._drawGradient),this._drawLayer&&this._setupGradient(this._drawLayer),this.trigger("Invalidate")},remove(){this.unbind("Draw",this._drawGradient),this.has("DOM")&&(this._element.style.backgroundColor="transparent"),this.trigger("Invalidate")},_setupGradient(t){"WebGL"===t.type&&this._establishShader("Gradient",v.defaultGradientShader())},_drawGradient(t){"webgl"===t.type&&t.program.draw(t,this)},topColor(t,e){return t?(this._setColor(this._topColor,t,e),this):this._topColor},bottomColor(t,e){return t?(this._setColor(this._bottomColor,t,e),this):this._bottomColor},_setColor(t,e,i){"string"==typeof e?v.assignColor(e,t):(t._red=e[0],t._green=e[1],t._blue=e[2]),void 0!==i&&(t._strength=i),this.trigger("Invalidate")}});const Y=(t,e,i)=>({_red:Math.round(e._red*(1-t)+i._red*t),_green:Math.round(e._green*(1-t)+i._green*t),_blue:Math.round(e._blue*(1-t)+i._blue*t),_strength:e._strength*(1-t)+i._strength*t}),K=([t,e])=>({_red:parseInt(t.slice(1,3),16),_green:parseInt(t.slice(3,5),16),_blue:parseInt(t.slice(5,7),16),_strength:e}),J=t=>t&&2===t.length&&"string"==typeof t[0]?K(t):t,$=(t,e,i,a,r)=>{let n={nextTopColor:J(e),nextBottomColor:J(i),startTopColor:a?J(a):t.topColor(),startBottomColor:r?J(r):t.bottomColor()};return e=>{t._topColor=Y(e,n.startTopColor,n.nextTopColor),t._bottomColor=Y(e,n.startBottomColor,n.nextBottomColor),t.trigger("Invalidate")}},Q="ColorFade",Z=()=>v("ScreenFader").get(0)||v.e(`WebGL, 2D, ScreenFader, ${Q}`).attr({z:5e3,x:0,y:0,w:v.viewport.width,h:v.viewport.height}),tt=(t="#000000")=>{let e=Z();return e.topColor(t,1),e.bottomColor(t,1),{start:async i=>{await e.colorFade([t,1],[t,0],i/2),await e.colorFade([t,0],[t,0],i/2),e.destroy()}}},te=(t="#000000")=>{let e=Z();return e.topColor(t,0),e.bottomColor(t,0),{start:async i=>{await e.colorFade([t,1],[t,0],i/2),await e.colorFade([t,1],[t,1],i/2)}}};v.c(Q,{required:[L,W].join(","),colorFade(t,e,i,a){let r=$(this,t,e);return this.animate(r,i,a)}});const ti="Delta2D";v.c(ti,{required:"2D",properties:{drx:{set:function(t){let[e,i]=b(this,t-this._drx);this.shift(e,i),this._drx=t},get:function(){return this._drx},enumerable:!0,configurable:!1},_drx:{value:0,writable:!0,enumerable:!1,configurable:!1},dry:{set:function(t){let[e,i]=S(this,t-this._dry);this.shift(e,i),this._dry=t},get:function(){return this._dry},enumerable:!0,configurable:!1},_dry:{value:0,writable:!0,enumerable:!1,configurable:!1},dx:{set:function(t){this.shift(t-this._dx,0),this._dx=t},get:function(){return this._dx},enumerable:!0,configurable:!1},_dx:{value:0,writable:!0,enumerable:!1,configurable:!1},dy:{set:function(t){this.shift(0,t-this._dy),this._dy=t},get:function(){return this._dy},enumerable:!0,configurable:!1},_dy:{value:0,writable:!0,enumerable:!1,configurable:!1}}});const ta="Stretchable",tr="Stretcher";v.c(ta,{properties:{sw:{set(t){t!==this._w&&this._stretch(t,this._h,"w")},get(){return this._w},configurable:!0,enumerable:!0},sh:{set(t){t!==this._h&&this._stretch(this._w,t,"h")},get(){return this._h},configurable:!0,enumerable:!0}},_stretch(t,e,i){this.trigger("Stretch",{dw:t-this._w,dh:e-this._h});let a={axis:i,amount:"w"===i?t-this._w:e-this._h};this._w=t,this._h=e,this._calculateMBR(),this.trigger("Resize",a),this.trigger("Invalidate")}}),v.c(tr,{init(){this._handleStretch=this._handleStretch.bind(this)},_handleStretch(t){let e=this.stretch[3]*t.dw,i=this.stretch[1]*t.dw-e,a=this.stretch[0]*t.dh,r=this.stretch[2]*t.dh-a;this._w+=i,this._h+=r;let[n,o]=b(this,e);this._x+=n,this._y+=o,this.trigger("Invalidate")},activateStretch(t){t.uniqueBind("Stretch",this._handleStretch)}});const tn=+new Date,to=()=>tn,ts={},tl=t=>{let e=ts[t];if(e)return e;let i={};v.assignColor(t,i);let a={_red:i._red/255,_green:i._green/255,_blue:i._blue/255};return ts[t]=a,a},th={sprites:[],gradients:[],attachHooks:[],attributes:{},frames:{},animations:{},hitbox:[]},tc={top:0,center:.5,bottom:1},tu={left:0,center:.5,right:1},td=["x","y","z","w","h","rx","ry","rotation","alpha","maxAlpha","overrideColor","overrideColorStrength","horizon","scale","scaleX","scaleY"],tp=t=>e=>Object.entries(e).filter(([t])=>td.includes(t)).reduce((e,[i,a])=>{switch(i){case"x":e.dx=t.xFlipped?-a:a;break;case"y":e.dy=a;break;case"z":e.z=t.z+a;break;case"rx":e.drx=t.xFlipped?-a:a;break;case"ry":e.dry=a;break;case"w":e.sw=a;break;case"overrideColor":null===a?e.overrideColorStrength=0:(e.overrideColor=tl(a),e.overrideColorStrength=1);break;case"horizon":e.topDesaturation=a[1],e.bottomDesaturation=a[0];break;default:e[i]=a}return e},{}),ty=(t,e)=>void 0===t?e:t,tm=(t,e)=>{let i={};return(e.sprites||[]).filter(([,t])=>t.key).map(([t,e])=>i[e.key]={z:0,rotation:0,alpha:1,scale:1,topDesaturation:0,bottomDesaturation:0,overrideColorStrength:e.overrideColor||e.accentColor?1:0,sprite:t,...e,x:0,y:0}),(e.gradients||[]).filter(t=>t.key).map(t=>i[t.key]={z:0,rotation:0,...t,x:0,y:0}),i.attributes={w:e.attributes.width,h:e.attributes.height,rotation:ty(e.attributes.rotation,0),scale:ty(e.attributes.scale,1)},!0===t.xFlipped&&(i.flipX=!0),i},tf=(t,e)=>{let i=null;return(t.appliedDefinition.sprites.forEach((t,a)=>{t[1].key===e&&(i=a)}),null===i)?null:t.composableParts[i]},tg=(t,e)=>(t.attachHooks.find(([t])=>t===e)||[])[1]||{},tv=(t,e)=>"default"===e?tm(t,t.appliedDefinition):e&&t.appliedDefinition.frames[e],tw=(t,e,i)=>{let a=tv(t,e);if(!a)return()=>{};let r=tv(t,i),n=tp(t),o=Object.entries(a).reduce((e,[i,a])=>{if("attributes"===i){let o={};(void 0!==t.scale||void 0!==a.scale)&&(a.w&&(o.w=a.w*(a.scale||t.scale)),a.h&&(o.h=a.h*(a.scale||t.scale)));let s=n({...a,...o});void 0!==s.sw&&t.addComponent(ta);let l=r&&n({...r[i]});return e.concat(R(t,s,l))}if("flipX"===i){t.addComponent(C);let i=t.xFlipped;return e.concat(()=>{i===t.xFlipped&&(t.xFlipped?t.unflipX():t.flipX())})}let o=t.composableParts.find(t=>t.attr("key")===i);if(o){let s=t.appliedDefinition.sprites.find(([,t])=>t.key===i),l={z:0,alpha:1,scaleX:1,scaleY:1,horizon:[0,0],...s&&s[1],x:0,y:0};l.w&&void 0!==t.scale&&(l.w=l.w*t.scale),l.h&&void 0!==t.scale&&(l.h=l.h*t.scale);let h=n({...l,...a,...void 0!==a.rotation&&{rotation:o._parent.rotation+a.rotation}}),c=r&&n({...l,...r[i]});h.overrideColor&&(o.addComponent(A),o.overrideColorMode="all"),0!==h.topDesaturation&&o.addComponent(q);let u=a.sprite;return e.concat([R(o,h,c),u&&(()=>{o._spriteName!==u&&(o.sprite(u),o._spriteName=u)})])}let s=t.gradientParts.find(t=>t.attr("key")===i);if(s){let o={z:0,w:s.originalSize.w,h:s.originalSize.h,...t.appliedDefinition.gradients.find(t=>t.key===i)||{},x:0,y:0},l=n({...o,...a}),h=r&&n({...o,...r[i]});return e.concat(R(s,l,h),$(s,a.topColor,a.bottomColor))}let l=t.currentAttachHooks[i];if(l){l.addComponent(ti);let t=n({x:0,y:0,...a});return e.concat([R(l,t)])}return e},[]).filter(Boolean);return t=>o.forEach(e=>e(t))},tx=(t,e)=>{let i=t.composableParts.find(t=>t.attr("key")===e.key);return i?t=>{let a=Math.min(Math.floor(t*e.sprites.length),e.sprites.length-1),r=e.sprites[a];i.sprite(r),i._spriteName=r}:()=>{}},t_="ComposableHook";v.c(t_,{events:{Freeze(){this._children.forEach(t=>t.freeze&&t.freeze())},Unfreeze(){this._children.forEach(t=>t.unfreeze&&t.unfreeze())}}});const tb="Composable";v.c(tb,{required:L,events:{Reorder(){let t=this.z-this.currentZ;this.forEachPart(e=>{e.z+=t}),Object.values(this.currentAttachHooks).forEach(e=>{e.z+=t,e.currentAttachment&&(e.currentAttachment.z+=t)}),this.currentZ=this.z},Freeze(){this.stopAnimation(),this._children.forEach(t=>t.freeze&&t.freeze())},Unfreeze(){this._children.forEach(t=>t.unfreeze&&t.unfreeze()),this.getAnimation("default")?this.playAnimation("default"):this.appliedEntityDefinition&&this.appliedEntityDefinition.structure&&this.appliedEntityDefinition.structure.frame?this.displayFrame(this.appliedEntityDefinition.structure.frame):this.displayFrame("default")}},init(){this.appliedDefinition=th,this.composableParts=[],this.collisionComponents=[],this.gradientParts=[],this.currentAttachHooks={},this.currentZ=this.z,this.animationListeners=[],this.displayFrame=this.displayFrame.bind(this),this.playAnimation=this.playAnimation.bind(this)},compose(t,{autoStartAnimation:e=!0}={}){if(this.appliedDefinition===t)return;let i={...th,...t};return this.setOwnAttributes(i.attributes),this.buildSprites(i.sprites,i.spriteAttributes),this.buildGradients(i.gradients),this.appliedDefinition=t,this.forEachPart((t,e)=>{let i=this.spriteOptions(e);if(!i.attachTo)return;let a=tf(this,i.attachTo);a&&a.attach(t)}),this.buildAttachHooks(i.attachHooks),i.hitbox.length>0&&(this.addComponent("Collision"),this.collision(i.hitbox)),i.attributes.scale&&(this.addComponent(P),this.attr({scale:i.attributes.scale})),this.getAnimation("default")&&e&&this.playAnimation("default"),this},getAnimation(t){return this.appliedDefinition.animations&&this.appliedDefinition.animations[t]},async playAnimation(t){let e=this.getAnimation(t);if(!e)throw Error(`Animation ${t} not found in playAnimation`);if(e.startEase){let t=e.timeline[0].startFrame;await this.displayFrame(t,e.startEase.duration,e.startEase.easing)}this.activeAnimation={name:t,data:e,easing:M[e.easing||"linear"],timeline:e.timeline.map(t=>({...t}))},this.animationStart=e.timer&&"global"===e.timer?to():+new Date,this.bind("GameLoop",this.updateAnimationFrame),await new Promise(t=>this.animationListeners.push(t))},animationPlaying(){return null!==this.activeAnimation},stopAnimation(){this.unbind("GameLoop",this.updateAnimationFrame),this.activeAnimation=null,this.animationListeners.forEach(t=>t()),this.animationListeners=[]},updateAnimationFrame({inGameTime:t}){t<this.animationStart&&(this.animationStart=t);let e=t-this.animationStart,i=(this.activeAnimation.data.repeat?e%this.activeAnimation.data.duration:e)/this.activeAnimation.data.duration,a=this.activeAnimation.easing(i);if(this.activeAnimation.timeline.forEach(t=>{if(t.start>a||a>t.end)return;t.animateFn||(t.animateFn=t.startFrame&&t.endFrame&&tw(this,t.endFrame,t.startFrame)||t.spriteAnimation&&tx(this,t.spriteAnimation)||(()=>{}));let e=(a-t.start)/(t.end-t.start);t.animateFn(e)}),i>=1&&!this.activeAnimation.data.repeat){let t=this.activeAnimation.data.after;this.stopAnimation(),t&&t.animation&&this.playAnimation(t.animation)}},setOwnAttributes(t){if(!t)return;let e={};if(t.width&&(e.w=t.width),t.height&&(e.h=t.height),t.ro){let[e,i]=t.ro;this.origin(e,i)}this.attr(e)},buildSprites(t,e){let i=[],a=this.appliedDefinition.sprites,r=0;t.forEach((t,n,o)=>{let s=a[r];if(s){if(t[0]!==s[0]){let i=o[n+1];if(i&&i[0]===s[0]){this.composableParts.splice(r,0,this.createAndAttachSprite(t,e)),r++;return}let a=this.composableParts[r];this.detach(a),a.destroy(),this.composableParts.splice(r,1,this.createAndAttachSprite(t,e)),r++}else if(t[0]===s[0]){let i=this.composableParts[r];this.applySpriteOptions(i,{...e,...t[1]}),r++}}else i.push(t)}),this.composableParts.slice(r).forEach(t=>{this.detach(t),t.destroy()}),this.composableParts=this.composableParts.slice(0,r).concat(i.map(t=>this.createAndAttachSprite(t,e)))},buildGradients(t){let e=[],i=this.appliedDefinition.gradients,a=0;t.forEach(t=>{if(i[a]){let e=this.composableParts[a];this.applySpriteOptions(e,t),a++}else e.push(t)}),this.gradientParts.slice(a).forEach(t=>{this.detach(t),t.destroy()}),this.gradientParts=this.gradientParts.slice(0,a).concat(e.map(t=>this.createAndAttachGradient(t)))},createAndAttachGradient(t){let e=this._drawLayer?this._drawLayer.name:"WebGL",i=v.e([e,"2D",W,ti].join(", "));return this.applyGradientOptions(i,t),i.attr({originalSize:{w:i.w,h:i.h}}),this.attach(i),i},applyGradientOptions(t,e){if(t.attr({x:this.x+(e.x||0),y:this.y+(e.y||0),z:this.z+(e.z||0)}),e.key&&t.attr({key:e.key}),t.attr({w:e.w||t.w,h:e.h||t.h,alpha:void 0===e.alpha?1:e.alpha}),e.topColor&&t.topColor(e.topColor[0],e.topColor[1]),e.bottomColor&&t.bottomColor(e.bottomColor[0],e.bottomColor[1]),e.ro){let[i,a]=e.ro;t.origin(i,a),e.rotation&&t.attr({rotation:e.rotation})}e.hitbox&&(t.addComponent("Collision"),t.collision(e.hitbox)),e.hideBelow&&t.addComponent("HideBelow").attr({hideBelow:e.hideBelow}),e.hideAbove&&t.addComponent("HideBelow").attr({hideAbove:e.hideAbove})},createAndAttachSprite([t,e],i){let a=this._drawLayer?this._drawLayer.name:"WebGL",r=v.e([a,"2D",ti,P,t].join(", "));r._spriteName=t;let n={...i,...e};return this.applySpriteOptions(r,n),r.attr({originalSize:{w:r.w,h:r.h}}),r.root=this,this.attach(r),n.stretch&&r.activateStretch(this),r},applySpriteOptions(t,e){if(t.attr({x:this.x+(e.x||0),y:this.y+(e.y||0),z:this.z+(e.z||0)}),e.key&&t.attr({key:e.key}),e.crop){let[i,a,r,n]=e.crop;t.crop(n,i,t.w-a-n,t.h-r-i)}if(e.scale&&t.attr({scale:e.scale}),e.scaleX&&t.attr({scale:e.scaleX}),e.scaleY&&t.attr({scale:e.scaleY}),e.stretch&&(t.addComponent(tr),t.attr({stretch:e.stretch})),e.overrideColor&&(t.addComponent(A),t.colorOverride(e.overrideColor)),e.accentColor&&(t.addComponent(A),t.colorOverride(e.accentColor,"partial")),e.lightness&&(t.addComponent(A),t.attr({lightness:e.lightness})),t.attr({w:e.w||t.w,h:e.h||t.h,alpha:void 0===e.alpha?1:e.alpha,maxAlpha:void 0===e.maxAlpha?1:e.maxAlpha}),e.flipX&&t.flip("X"),e.ro){let[i,a]=e.ro;t.origin(i,a),e.rotation&&t.attr({rotation:e.rotation})}if(e.hitbox&&(t.addComponent("Collision"),t.collision(e.hitbox)),e.hideBelow&&t.addComponent("HideBelow").attr({hideBelow:e.hideBelow}),e.hideAbove&&t.addComponent("HideBelow").attr({hideAbove:e.hideAbove}),e.horizon){let[i,a]=e.horizon;t.addComponent(q).saturationGradient(i,a)}},forEachPart(t){this.composableParts.forEach((e,i,a)=>t(e,i,a))},spriteOptions(t){return this.appliedDefinition.sprites[t][1]},attachHookSettings(t){return tg(this.appliedDefinition,t)},attachEntity(t,e){let i=this.attachHookSettings(t),a=this.currentAttachHooks[t];if(!a)return;if(a.currentAttachment&&a.currentAttachment!==e&&a.currentAttachment.destroy(),!e){a.attr({currentAttachment:null});return}let r=i.attachAlign||["top","left"],n=a.x-tu[r[1]]*e.w,o=a.y-tc[r[0]]*e.h;e.attr({x:n,y:o,z:a.z}),e.detachFromParent=()=>{a.detach(e),a.attr({currentAttachment:null})},a.attach(e),a.attr({currentAttachment:e})},clearAttachment(t){this.attachEntity(t,null)},buildAttachHooks(t){t.forEach(([t,e])=>{let i=this.currentAttachHooks[t]||v.e(`2D, ${t_}`);if(i.attr({x:this.x+(e.x||0),y:this.y+(e.y||0),z:this.z+(e.z||0),w:1,h:1,currentAttachment:i.currentAttachment||null}),e.attachTo){let t=tf(this,e.attachTo);t?t.attach(i):this.attach(i)}else this.attach(i);this.currentAttachHooks[t]=i})},getElementByKey(t){return tf(this,t)},addCollisionComponent(t,e=[]){return this.collisionComponents.push(t),(this.has("Collision")||e.length>0)&&this.addComponent(t),this.composableParts.forEach(i=>i.has("Collision")&&(e.length>0?e.forEach(t=>i[t]=function(...e){this.root[t](...e)}):i.addComponent(t))),this},clearCollisionComponents(){return this.collisionComponents.forEach(t=>this.removeComponent(t)),this.composableParts.forEach(t=>this.collisionComponents.forEach(e=>t.removeComponent(e))),this.collisionComponents=[],this},async displayFrame(t,e=0,i){if(!tv(this,t))return;let a=tw(this,t);return this.animate(a,e,i)}});let tS=1;const tC=()=>tS,tk=t=>(tS=t,v("SpriteAnimation").each(function(){if(!this.has("TimeManager"))return this.animationSpeed=t}),v("Delay").each(function(){if(!this.has("TimeManager"))return this.delaySpeed=t}),v("Tween").each(function(){if(!this.has("TimeManager"))return this.tweenSpeed=t}));v.bind("NewEntity",t=>{let e=v(t.id);!e.has("TimeManager")&&(e.has("SpriteAnimation")&&(e.animationSpeed=tS),e.has("Delay")&&(e.delaySpeed=tS),e.has("Tween")&&(e.tweenSpeed=tS))});var tD={};tD="#define GLSLIFY 1\nattribute vec2 aPosition;\nattribute vec3 aVelocity;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aSize;\nattribute vec4 aLife;\nattribute vec4 aColor1;\nattribute vec4 aColor2;\n\nvarying lowp vec4 vColor;\nvarying lowp vec2 vLayer;\nvarying lowp vec2 vLife;\n\nuniform  vec4 uViewport;\nuniform  vec4 uTimeOffset;\nuniform  vec2 uCoordOffset;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nfloat gravity(float accelleration, float duration) {\n  // https://www.vcalc.com/equation/?uuid=e6ccc22d-da27-11e2-8e97-bc764e04d25f\n  return 0.5 * accelleration * (duration / 1000.0) * (duration / 1000.0);\n}\n\nvoid main() {\n  vec2 pos = aPosition.xy;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  mat2 entityAngleMatrix = mat2(cos(aVelocity.y), sin(aVelocity.y), -sin(aVelocity.y), cos(aVelocity.y));\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n\n  float duration = uTimeOffset.x - aLife.x;\n  if (aVelocity.z == -1.0) {\n    duration = aLife.y - duration;\n  }\n  float durationScale = duration / aLife.y;\n\n  float dist = aVelocity.x * (duration / 1000.0);\n\n  vec2 movement = vec2(cos(aVelocity.y) * dist, sin(aVelocity.y) * dist);\n  vec2 gravityDisplacement = vec2(gravity(aLife.z, duration), gravity(aLife.a, duration));\n\n  pos = pos + movement + gravityDisplacement + uCoordOffset;\n\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n	gl_PointSize = (1.0 - durationScale) * aSize.x + durationScale * aSize.y;\n\n  vColor = mix(aColor1, aColor2, durationScale);\n  vLayer = aLayer;\n  vLife = vec2(duration, aLife.y);\n}\n\n";var tz={};tz="precision mediump float;\n#define GLSLIFY 1\nvarying lowp vec4 vColor;\nvarying lowp vec2 vLife;\n\nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\nuniform highp vec4 uSpriteCoords;\n\nvoid main(void) {\n  if (vLife.x > vLife.y || vLife.x < 0.0) {\n    discard;\n  }\n\n  if (uSpriteCoords.b == 0.0) {\n    gl_FragColor = vColor;\n    return;\n  }\n\n  highp vec2 coord = (uSpriteCoords.xy + (gl_PointCoord * uSpriteCoords.ba)) / uTextureDimensions;\n  mediump vec4 texelColor = texture2D(uSampler, coord);\n  mediump float lightness = (0.2126*texelColor.r + 0.7152*texelColor.g + 0.0722*texelColor.b);\n\n  mediump vec3 mixedColor = vColor.rgb * (lightness * 1.3);\n  gl_FragColor = vec4(mixedColor * texelColor.a * vColor.a, texelColor.a * vColor.a);\n}\n";const tA="WebGLParticles";let tP=null;const tF=(t,e)=>{let i=e.context;if(tP&&tP.gl===i)return[tP.fragmentShader,tP.vertexShader];let a=e._compileShader(t.fragmentCode,i.FRAGMENT_SHADER),r=e._compileShader(t.vertexCode,i.VERTEX_SHADER);return tP={gl:i,fragmentShader:a,vertexShader:r},[a,r]},tE=t=>{let e=t.context;e.deleteBuffer(t._indexBuffer),e.deleteBuffer(t._attributeBuffer),e.detachShader(t.shader,t.shader.vertexShader),e.detachShader(t.shader,t.shader.fragmentShader),e.deleteProgram(t.shader)};class tB{constructor(t,e,i){this.context=t,this.attributes=i,this.stride=e,this.array_size=16,this.max_size=4096,this.render_size=0,this._attributeArray=new Float32Array(this.array_size*this.stride),this._attributeBuffer=this.context.createBuffer(),this.active=!0}reactivate(){this.active=!0,this.render_size=0}deactivate(){this.active=!1}growArrays(t){if(this.render_size=Math.min(t,this.max_size),this.array_size>=this.max_size||this.array_size>=t)return;let e=Math.min(t,this.max_size),i=new Float32Array(e*this.stride);i.set(this._attributeArray),this._attributeArray=i,this.array_size=e}writeParticle(t,e){let i=this.attributes,a=t*this.stride;for(let t=0;t<i.length;t++)for(let r=0;r<i[t].width;r++)this._attributeArray[a]=e[i[t].name][r],a++}draw(){let t=this.context;t.bindBuffer(t.ARRAY_BUFFER,this._attributeBuffer);let e=this.attributes;for(var i=0;i<e.length;i++){let a=e[i];t.vertexAttribPointer(a.location,a.width,a.type,!1,this.stride*a.bytes,a.offset*a.bytes)}t.bufferData(t.ARRAY_BUFFER,this._attributeArray,t.STATIC_DRAW),t.drawArrays(t.POINTS,0,this.render_size)}}class tT{constructor(t,e){this.shader=e,this.layer=t,this.context=t.context,this.draw=function(){},this.array_size=0,this.max_size=96}initAttributes(t){this.attributes=t,this._attribute_table={};for(var e=0,i=0;i<t.length;i++){var a=t[i];this._attribute_table[a.name]=a,a.bytes=a.bytes||Float32Array.BYTES_PER_ELEMENT,a.type=a.type||this.context.FLOAT,a.offset=e,a.location=this.context.getAttribLocation(this.shader,a.name),this.context.enableVertexAttribArray(a.location),e+=a.width}this.stride=e,this.buffers=[]}registerEntity(t){let e=this.buffers.find(t=>!1===t.active);if(void 0===e){if(this.buffers.length>=this.max_size)throw"Number of entities exceeds maximum limit.";let e=new tB(this.context,this.stride,this.attributes);this.buffers.push(e),t.particleBuffer=e}else e.reactivate(),t.particleBuffer=e}unregisterEntity(t){t.particleBuffer.deactivate(),t.particleBuffer=null}resetRegistry(){this.buffers=[]}setCurrentEntity(t){this.drawBuffers.push(t.particleBuffer)}switchTo(){this.context.useProgram(this.shader),this.drawBuffers=[],this.hasTime=!1}setTexture(t){void 0===this.texture_obj&&(t.setToProgram(this.shader,"uSampler","uTextureDimensions"),this.texture_obj=t)}renderBatch(){var t=this.texture_obj;t&&null===t.unit&&this.layer.texture_manager.bindTexture(t);for(let t=0;t<this.drawBuffers.length;t++)this.drawBuffers[t].active&&this.drawBuffers[t].draw()}setViewportUniforms(t){var e=this.context;e.useProgram(this.shader),e.uniform4f(this.shader.viewport,-t._x,-t._y,t._w,t._h)}}v.c(tA,{init:function(){this.requires("Renderable"),this._customLayer||this._attachToLayer(v.s("DefaultWebGLLayer"))},remove:function(){tE(this.program),delete this.program,this._detachFromLayer()},drawVars:{type:"webgl",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(){if(this.ready){var t=this.drawVars.pos;t._x=this._x,t._y=this._y,t._w=this._w,t._h=this._h;var e=this.__coord||[0,0,0,0],i=this.drawVars.co;i.x=e[0],i.y=e[1],i.w=e[2],i.h=e[3],this._flipX&&(i.x=i.x+i.w,i.w=-i.w),this._flipY&&(i.y=i.y+i.h,i.h=-i.h);var a=this._drawContext;return this.drawVars.gl=a,(this.drawVars.program=this.program).setCurrentEntity(this),this.trigger("Draw",this.drawVars),this}},_makeProgram:function(t){var e=this._drawLayer.context;let[i,a]=tF(t,this._drawLayer);var r=e.createProgram();if(e.attachShader(r,a),e.attachShader(r,i),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))throw"Could not initialise shaders";return r.viewport=e.getUniformLocation(r,"uViewport"),r.vertexShader=a,r.fragmentShader=i,r},_establishShader:function(t,e){let i=this._makeProgram(e);var a=this._drawContext;i.time=a.getUniformLocation(i,"uTimeOffset"),i.coordOffset=a.getUniformLocation(i,"uCoordOffset"),i.spriteCoords=a.getUniformLocation(i,"uSpriteCoords");let r=new tT(this._drawLayer,i);r.name=t,r.initAttributes(e.attributeList),r.draw=e.drawCallback,r.setViewportUniforms(this._drawLayer._viewportRect()),this.program=r,this.program.registerEntity(this),this.ready=!0}});var tM={};tM=JSON.parse('{"scenery":true,"particles":true,"music":true,"wordDelay":0.25,"tags":["sint"],"lives":8}');const tL=()=>2*Math.random()-1,tR={},tO=u(tM).particles,tj=(t,e)=>{let i=tR[e];if(i){t.__image=i.image,t.program&&t._drawLayer&&t.program.setTexture(t._drawLayer.makeTexture(t.__image,t.img,!1));return}let a=v.e(`WebGL, ${e}`).attr({x:5e3,y:5e3});t.__image=a.__image,t.program&&t._drawLayer&&t.program.setTexture(t._drawLayer.makeTexture(t.__image,t.img,!1)),tR[e]={index:Object.keys(tR).length,coords:a.__coord,image:a.__image},a.destroy()},tH=t=>tR[t].coords,tI=(t,e)=>{let i=t.attachTo||t,a=t.particleSettings.motionLocked,r=(a?0:i.x)+Math.random()*t.w,n=(a?0:i.y)+Math.random()*t.h,o=e.velocity+tL()*e.velocityRandom,s=e.currentAngle+tL()*e.angleRandom,l=e.duration+tL()*e.durationRandom,h=e.startSize+tL()*e.startSizeRandom,c=e.endSize+tL()*e.endSizeRandom,u=e.startColor.map((t,i)=>t+tL()*e.startColorRandom[i]),d=e.endColor.map((t,i)=>t+tL()*e.endColorRandom[i]),p=t.timeFrame-(e.expired||0)*l;return{aPosition:[r,n],aVelocity:[o,s*Math.PI/180,e.emitterReverse?-1:1],aOrientation:[r,n,0],aSize:[h,c],aLife:[p,l,e.gravity[0],e.gravity[1]],expire:p+l,aLayer:[t._globalZ,t._alpha],aColor1:u,aColor2:d}};let tG=null;v.defaultShader("Particle",new v.WebGLShader(u(tD),u(tz),[{name:"aPosition",width:2},{name:"aVelocity",width:3},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aSize",width:2},{name:"aLife",width:4},{name:"aColor1",width:4},{name:"aColor2",width:4}],function(t,e){let i=t.program.context;e.particleSettings.motionLocked&&i.uniform2f(t.program.shader.coordOffset,e._deltaX,e._deltaY),!tG||t.program.hasTime||(i.uniform4f(t.program.shader.time,e.timeFrame,0,0,0),t.program.hasTime=e.timeFrame,i.uniform4f(t.program.shader.spriteCoords,...tH(e.particleSettings.sprite)),e.particleSettings.motionLocked||i.uniform2f(t.program.shader.coordOffset,0,0))}));const tq="ParticleEmitter";v.c(tq,{required:`2D, ${tA}`,ready:!0,__image:"",img:null,events:{LayerAttached:"_setupParticles",GameLoop:"_renderParticles",Move:function({_x:t,_y:e}){this.particleSettings&&this.particleSettings.motionLocked&&(this._deltaX+=this._x-t,this._deltaY+=this._y-e)}},init:function(){this._particlesPaused=!1,this._deltaX=this.x,this._deltaY=this.y,this.bind("Draw",this._drawParticles),this._drawLayer&&this._setupParticles(this._drawLayer),this.initialDraw=!0,this._mbr={_x:0,_y:0,_w:v.viewport.width,_h:v.viewport.height},this.trigger("Invalidate"),this.bind("Freeze",()=>{this.stopEmission()}),this.bind("Unfreeze",()=>{this.startEmission()}),this.bind("Change",t=>{Object.prototype.hasOwnProperty.call(t,"angle")&&(this.particleSettings.currentAngle=this.particleSettings.angle+t.angle)})},remove(){this.initialDraw=!0,this.unbind("Draw",this._drawParticles),this.trigger("Invalidate")},pauseParticles(){this._particlesPaused=!0},resumeParticles(){this._particlesPaused=!1},_setupParticles(t){"WebGL"===t.type&&(this._establishShader("Particle",v.defaultShader("Particle")),""!==this.__image&&this.program.setTexture(t.makeTexture(this.__image,this.img,!1)))},_drawParticles(t){if(!0===this.initialDraw){this.particleBuffer.growArrays(this._particles.length);for(let t=0;t<this._particles.length;t++)this._writeParticle(t,this._particles[t]);this.initialDraw=!1}t.program.draw(t,this)},_writeParticle(t,e){this.particleBuffer.writeParticle(t,e)},attachToEntity(t){this.attachedTo=t,this.z=t.z,t.bind("Reorder",()=>{this.z=t.z}),t.bind("Change",t=>{Object.prototype.hasOwnProperty.call(t,"angle")&&(this.particleSettings.currentAngle=this.particleSettings.angle+t.angle)}),this.particleSettings.currentAngle=this.particleSettings.angle+(t.angle||0),this.x=t.x,this.y=t.y,t.bind("Move",()=>{this.x=t.x,this.y=t.y,this._mbr={_x:0,_y:0,_w:v.viewport.width,_h:v.viewport.height}}),t.bind("Freeze",()=>{this.stopEmission()}),t.bind("Unfreeze",()=>{this.startEmission()}),t.bind("Remove",()=>{this.stopEmission(),this.attachedTo=null,this.autoDestruct=!0})},particles({emitter:{amount:t=150,w:e=10,h:i=10,duration:a=1/0,warmed:r=!1,reverse:n=!1,fidelity:o="low",motionLocked:s=!0}={},gravity:l=[0,0],particle:{velocity:h=80,velocityRandom:c=20,angle:u=0,angleRandom:d=360,duration:p=2e3,durationRandom:y=500,startSize:m=12,startSizeRandom:f=2,endSize:g=24,endSizeRandom:v=8,sprite:w=null,startColor:x=[1,1,1,1],startColorRandom:_=[0,0,0,0],endColor:b=[0,0,0,1],endColorRandom:S=[0,0,0,0]}={}}={},C=null){return tO||(t=1),s&&(this._deltaX=this._x,this._deltaY=this._y),this.particleSettings={amount:t,gravity:l,velocity:h,velocityRandom:c,angle:u,currentAngle:u,angleRandom:d,duration:p,durationRandom:y,startSize:m,startSizeRandom:f,endSize:g,endSizeRandom:v,sprite:w,startColor:x,startColorRandom:_,endColor:b,endColorRandom:S,emitterDuration:a,emitterReverse:n,emitterFidelity:o,motionLocked:s},C&&this.attachToEntity(C),this.attr({w:e,h:i}),this.timeFrame=0,this.startEmission({warmed:r}),this.particleSettings.sprite&&tj(this,this.particleSettings.sprite),this._particles=Array(t).fill(0).map(()=>tI(this,{...this.particleSettings,duration:0,durationRandom:0})),this.lastExpired=this._particles.reduce((t,e)=>e.expire>t?e.expire:t,0),this.nextExpireRatio="low"===o?140:p/t,this.nextExpireCheck=p/t,this.trigger("Invalidate"),this},stopEmission(){this.emissionRate=0,this.shouldHaveEmitted=0},startEmission({warmed:t=!1}={}){this.emissionRate=this.particleSettings.amount/this.particleSettings.duration,this.startTime=t?-1:0,this.shouldHaveEmitted=t?this.particleSettings.amount:Math.min(this.startTime/1e3*this.emissionRate,1)*this.particleSettings.amount},_renderParticles({dt:t,inGameTime:e}){if(this.particleSettings&&!this._particlesPaused){if(tG=tG||e,this.timeFrame=e-tG,-1!==this.startTime&&(this.startTime+=t,this.shouldHaveEmitted=Math.min(this.startTime/1e3*this.emissionRate,1)*this.particleSettings.amount),this.timeFrame>=this.nextExpireCheck&&this.startTime<this.particleSettings.emitterDuration&&tO){this.nextExpireCheck=this.timeFrame+this.nextExpireRatio;let t=-1===this.startTime;for(let e=0;e<this.shouldHaveEmitted;e++)if(this._particles[e].expire<this.timeFrame+20){let i=tI(this,t?{...this.particleSettings,expired:.9*Math.random()}:this.particleSettings);i.expire>this.lastExpired&&(this.lastExpired=i.expire),this._particles[e]=i,this._writeParticle(e,i)}t&&(this.startTime=0)}this.autoDestruct&&this.timeFrame>this.lastExpired&&this.destroy()}}});const tU=(()=>{let t={},e=new(window.AudioContext||window.webkitAudioContext),i={music:null,effectsGain:e.createGain(),musicGain:e.createGain()};i.effectsGain.connect(e.destination),i.musicGain.connect(e.destination);let a=t=>t.reduce((t,e,i,a)=>{let r=i>0&&t[a[i-1].name],n=0===i?0:r.end;return{...t,[e.name]:{type:e.type,start:n,end:n+e.duration,duration:e.duration,loopStart:e.loopStart,loopEnd:e.loopEnd,volume:e.volume,loop:e.loop}}},{}),r=(e,i)=>{t[e.name]={audioData:i,map:a(e.map)}},n=()=>{if(null!==i.music)return i.music.sampleName},o=!1,s=()=>{null!==i.music&&(i.music.source.stop(),i.music.source.disconnect(),i.music=null)},l=1,h=1;return document.addEventListener("visibilitychange",()=>{o||(document.hidden?e.suspend():e.resume())},!1),{pauseAudio:()=>{o=!0,e.suspend()},resumeAudio:()=>{o=!1,e.resume()},setEffectVolume:t=>{i.effectsGain.gain.setValueAtTime(t,e.currentTime),l=t},setMusicVolume:t=>{i.musicGain.gain.setValueAtTime(t,e.currentTime),h=t},getEffectsVolume:()=>l,getMusicVolume:()=>h,loadAudio:async i=>{let a=i.name;if(t[a])return t[a];let n=await window.fetch(i.file),o=await n.arrayBuffer();return r(i,await e.decodeAudioData(o)),t[a]},stopMusic:s,fadeMusicVolume:(t=0,e=1e3)=>{if(null!==i.music)return i.music.setVolume(t,e)},playAudio:(a,{volume:r=1}={})=>{let o=Object.values(t).find(t=>t.map[a]),l=o.map[a];if("music"===l.type){if(!1===u(tM).music||n()===a)return;s();let t=void 0===l.volume?1:l.volume,h=r*t,c=e.createBufferSource();c.buffer=o.audioData;let d=e.createGain();d.connect(i.musicGain),d.gain.setValueAtTime(0===h?.01:h,e.currentTime),c.connect(d),l.loop&&(c.loop=!0,l.loopStart&&(c.loopStart=l.loopStart),l.loopEnd&&(c.loopEnd=l.loopEnd)),c.start();let p=new Promise(t=>c.onended=t),y=async(i,a=0)=>{let r=i*t;d.gain.exponentialRampToValueAtTime(0===r?.01:r,e.currentTime+a/1e3)};return i.music={source:c,sampleName:a,setVolume:y},{stop:()=>c.stop(),setVolume:y,process:p}}{let t=e.createBufferSource();t.buffer=o.audioData;let a=void 0===l.volume?1:l.volume,n=r*a;l.loop&&(t.loop=!0,t.loopStart=l.start/1e3,t.loopEnd=l.end/1e3);let s=e.createGain();return s.connect(i.effectsGain),s.gain.setValueAtTime(0===n?.01:n,e.currentTime),t.connect(s),t.start(e.currentTime,l.start/1e3,t.loop?void 0:l.duration/1e3),{stop:()=>t.stop(),setVolume:async(t,i=0)=>{let r=t*a;s.gain.exponentialRampToValueAtTime(0===r?.01:r,e.currentTime+i/1e3)},process:new Promise(e=>t.onended=e)}}}}})();let tN=!1;const tV=()=>tN,tX=()=>{(tN=!tN)?(tk(0),tU.pauseAudio(),v("Delay").each(function(){return this.pauseDelays()}),v("Tween").each(function(){return this.pauseTweens()}),v(tq).each(function(){return this.pauseParticles()})):(tU.resumeAudio(),tk(1),v("Delay").each(function(){return this.resumeDelays()}),v("Tween").each(function(){return this.resumeTweens()}),v(tq).each(function(){return this.resumeParticles()})),v.trigger("GamePause",tN)},tW=(t,e,i,a)=>Math.sqrt((i-t)*(i-t)+(a-e)*(a-e)),tY=(t,e,i,a)=>{let r=tW(t,e,i,a);return[(i-t)/r,(a-e)/r]},tK=(t,{affects:e,duration:i=1,velocity:a=0,accelleration:r=0,upperBounds:n=1/0,lowerBounds:o=-1/0,origin:s,speed:l,name:h="Impact"})=>(t.effects=(t.effects||[]).concat({affects:e,duration:i,velocity:a,accelleration:r,upperBounds:n,lowerBounds:o,active:0,origin:s,speed:l,name:h}),t),tJ=(t,e)=>{if(!e&&t._isFlashing<1)return;e&&t._isFlashing<1&&(t._isFlashing=e?3:0),t._isFlashing--;let i=t._isFlashing>1;t.forEachPart?t.forEachPart(t=>t.attr({hitFlash:!!i&&{_red:.9,_green:.9,_blue:.9}})):t.attr({hitFlash:!!i&&{_red:.9,_green:.9,_blue:.9}})},t$=((t={})=>(e,i)=>{if(void 0===e.effects||0===e.effects.length)return!1;let{mutations:a,effects:r}=e.effects.reduce((a,r)=>{let n=1/0;if(r.origin&&r.speed&&void 0!==e.x&&void 0!==e.y){let t=tW(e.x,e.y,r.origin.x,r.origin.y),a=(r.active+i)/1e3*r.speed;n=t<a?(a-t)/r.speed*1e3:0}let o=Math.min(i,n,r.duration)/1e3,s=(i,a)=>t[i]?t[i](a,r,e):{[i]:a},l=r.velocity*o+.5*r.accelleration*o*o,h=l>r.upperBounds?r.upperBounds:l<r.lowerBounds?r.lowerBounds:l,c=0!==h?a.mutations.concat([].concat(r.affects).reduce((t,e)=>t.concat(Object.entries(s(e,h)).reduce((t,[e,i])=>t.concat([[e,t=>t+i]]),[])),[])):a.mutations;return a.mutations!==c?{...a,mutations:c}:a},{mutations:[],effects:e.effects.reduce((t,e)=>e.duration>i?t.concat({...e,duration:e.duration-i,active:e.active+i,velocity:e.velocity+e.accelleration*i/1e3}):t,[])});return a.reduce((t,[i,a])=>{let r=void 0!==t[i]?t[i]:e[i];return t[i]=a(r),t},{effects:r})})({health:(t,e,i)=>({health:Math.ceil(t)*(1-("Bullet"===e.name&&i.bulletResistance||0))}),position:(t,e,i)=>{if(void 0===i.weight)return{};let[a,r]=tY(e.origin.x,e.origin.y,i.x,i.y);return{xForce:a,yForce:r}}}),tQ="DamageSupport";v.c(tQ,{events:{EnterFrame:"_handleEffects"},init(){this.attr({health:0,vulnerable:!1}),this._isFlashing=0,this.allowDamage=this.allowDamage.bind(this),this.hasHealth=this.hasHealth.bind(this)},allowDamage(t){this.attr({vulnerable:!0,...t})},stopDamage(){this.attr({vulnerable:!1}),tJ(this,!1)},hasHealth(){return this.attr("health")>0},processDamage(t){if(!tV()&&!this.hidden&&this.vulnerable){let e=this;[].concat(t).forEach(t=>tK(e,t))}},_handleEffects({dt:t}){if(!this.effects||0===this.effects.length){tJ(this,!1);return}let e=t$(this,t);if(!1===e){tJ(this,!1);return}e.health&&e.health!==this.health&&this.trigger("HealthChange",e.health),tJ(this,e.health&&e.health<this.health),Object.assign(this,e),this.health<=0&&(this.stopDamage(),this.trigger("Dead"),this.trigger("HealthChange",0))}}),v.c("ViewportLocked",{events:{Move:"checkMotion"},checkMotion(){this._x<0&&(this.x=0,this.vx<0&&(this.vx=0)),this._y<0&&(this.y=0,this.vy<0&&(this.vy=0));let t=v.viewport.width-this.w;this._x>t&&(this.x=t,this.vx>0&&(this.vx=0));let e=v.viewport.height-this.h;this._y>e&&(this.y=e,this.vy>0&&(this.vy=0))}});const tZ="PausableMotion";v.c(tZ,{required:"Motion",init(){this.unbind("UpdateFrame",this._linearMotionTick),this.bind("GameLoop",this._linearMotionTick)}});var t0={},t1={};d(t1),p(t1,"default",()=>t2);var t2={"city.Intro":{checkpoints:[{entities:[["IntroShip",{key:"ship",relativeX:-.3,relativeY:.8}]],timeline:{defaultDuration:3e3,transitions:[{key:"ship",start:0,end:1,path:{data:[{x:-.3,y:.8},{x:-.2,y:.8}]}},{start:.4,end:.6,key:"ship",targetState:"t2o"},{start:.6,end:1,key:"ship",targetState:"t2r"}]}},{entities:[["IntroShip",{key:"ship",relativeX:-.2,relativeY:.8}]],timeline:{defaultDuration:500,transitions:[{key:"ship",start:.8,targetState:"heliStart"}]}},{entities:[["IntroShip",{key:"ship",state:"heliStart",relativeX:-.2,relativeY:.8}],["IntroHeli",{key:"heli",detach:!0}]],timeline:{defaultDuration:500,transitions:[{start:.2,end:1,key:"heli",targetState:"flying"},{start:0,end:.8,key:"ship",targetState:"shipStart"},{start:.8,end:1,key:"ship",targetState:"shipLiftOff"}]}},{entities:[["IntroShip",{key:"ship",state:"shipLiftOff",relativeX:-.2,relativeY:.8}],["IntroHeli",{key:"heli",state:"flying",detach:!0}],["PlayerShip",{key:"player",detach:!0,state:"flying"}]],timeline:{defaultDuration:1500,transitions:[{start:0,end:.5,key:"player",path:{name:"playerLiftOff",start:0,end:1},attributes:{z:10}},{start:0,end:1,key:"heli",path:{name:"intro.HeliLiftOff",start:0,end:.2},attributes:{z:14}},{start:0,end:1,key:"ship",targetState:"closed",path:{data:[{x:-.2,y:.8},{x:-.1,y:.8}]}}]}},{entities:[["IntroShip",{key:"ship",relativeX:-.1,relativeY:.8}],["IntroHeli",{key:"heli",state:"flying",relativeX:.466,relativeY:.458,z:10,detach:!0}]],timeline:{defaultDuration:8e3,transitions:[{start:0,end:.35,key:"heli",path:{name:"intro.HeliLiftOff",start:.2,end:1}},{key:"ship",start:.1,end:1,path:{data:[{x:-.1,y:.8},{x:-1,y:.8}]}},{key:"ship",start:1,end:1,remove:!0},{key:"heli",start:1,end:1,remove:!0}]}}],habitat:{scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",0]}}},t5={};d(t5),p(t5,"default",()=>t3);var t3={"city.Sunrise":{checkpoints:[{composables:[["background.night",{key:"night"}],["background.sky",{key:"sky",frame:"default",relativeX:-.1}]],backgroundColor:"#000010",timeline:{defaultDuration:45e3,transitions:[{key:"night",start:0,end:1,targetFrame:"middle"},{key:"sky",start:0,end:.5,targetFrame:"dawn"},{key:"sky",start:.5,end:1,targetFrame:"dawn2"},{start:0,end:.5,targetBackgroundColor:"#030820"},{start:.5,end:1,targetBackgroundColor:"#0f1630"}]}},{composables:[["background.night",{key:"night",frame:"middle"}],["background.sky",{key:"sky",frame:"dawn2",relativeX:-.1}],["background.horizon",{key:"stripe",frame:"default",relativeY:.49,relativeX:-.1}]],entities:[["Sun",{key:"sun",state:"large",relativeX:.9,relativeY:.7}]],backgroundColor:"#0f1630",timeline:{defaultDuration:6e4,transitions:[{key:"night",start:0,end:1,targetFrame:"end"},{key:"sky",start:0,end:.3,targetFrame:"dawn3"},{key:"sky",start:.3,end:.7,targetFrame:"dawn4"},{key:"sky",start:.7,end:1,targetFrame:"dawn5"},{start:0,end:.3,targetBackgroundColor:"#191f3d"},{start:.3,end:.85,targetBackgroundColor:"#27273d"},{start:.85,end:1,targetBackgroundColor:"#fd7321"},{key:"stripe",start:.1,end:.6,path:{data:[{x:0,y:.49},{x:0,y:.46}]}},{key:"sun",start:.5,end:1,path:{name:"sunrise",start:0,end:.2}}]}},{composables:[["background.night",{key:"night",frame:"end"}],["background.sky",{key:"sky",frame:"dawn5",relativeX:-.1}],["background.horizon",{key:"stripe",frame:"default",relativeY:.46,relativeX:-.1}]],entities:[["Sun",{key:"sun",state:"large",relativeX:.848,relativeY:.42}]],backgroundColor:"#fd7321",timeline:{defaultDuration:15e4,transitions:[{key:"sky",start:0,end:.5,targetFrame:"dawn6"},{key:"sky",start:.5,end:1,targetFrame:"dawn7"},{start:0,end:.5,targetBackgroundColor:"#fdab3a"},{start:.5,end:1,targetBackgroundColor:"#fcc67b"},{start:0,end:1,key:"sun",targetState:"full"},{key:"sun",start:0,end:1,path:{name:"sunrise",start:.2,end:.4}},{key:"stripe",targetFrame:"dawn",start:0,end:.2,path:{data:[{x:0,y:.46},{x:0,y:.43}]}},{key:"stripe",start:.7,end:1,path:{data:[{x:0,y:.43},{x:0,y:.8}]}},{key:"night",start:1,remove:!0},{key:"stripe",start:1,remove:!0}]}},{composables:[["background.sky",{key:"sky",frame:"dawn7",relativeX:-.1}]],entities:[["Sun",{key:"sun",state:"full",relativeX:.8,relativeY:.3}]],backgroundColor:"#fcc67b",timeline:{defaultDuration:12e4,transitions:[{key:"sky",start:0,end:.5,targetFrame:"dawn8"},{key:"sky",start:.5,end:1,targetFrame:"dawn9"},{start:0,end:.5,targetBackgroundColor:"#f3d7b1"},{start:.5,end:1,targetBackgroundColor:"#babcd9"},{start:0,end:1,key:"sun",targetState:"default"},{key:"sun",start:0,end:1,path:{name:"sunrise",start:.4,end:1}}]}},{composables:[["background.sky",{key:"sky",frame:"dawn9",relativeX:-.1}]],entities:[["Sun",{key:"sun",state:"default",relativeX:.4,relativeY:.1}]],backgroundColor:"#babcd9",timeline:{defaultDuration:1e3,transitions:[]}}],habitat:{isBackground:!0,scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0}}}},t4={};d(t4),p(t4,"default",()=>t6);var t6={"city.Sunset":{checkpoints:[{composables:[["background.sky",{key:"sky",frame:"dawn9",relativeX:-.1}]],entities:[["Sun",{key:"sun",state:"default",relativeX:.4,relativeY:.1}]],backgroundColor:"#babcd9",timeline:{defaultDuration:6e4,transitions:[{key:"sky",start:0,end:.5,targetFrame:"dawn8"},{key:"sky",start:.5,end:1,targetFrame:"dawn7"},{start:0,end:.5,targetBackgroundColor:"#f3d7b1"},{start:.5,end:1,targetBackgroundColor:"#fcc67b"},{start:0,end:1,key:"sun",targetState:"full"},{key:"sun",start:0,end:1,path:{name:"sunset",start:0,end:.6}}]}},{composables:[["background.sky",{key:"sky",frame:"dawn7",relativeX:-.1}]],entities:[["Sun",{key:"sun",state:"full",relativeX:.8,relativeY:.3}],["Moon",{key:"moon",state:"default",relativeX:.2,relativeY:.7}]],backgroundColor:"#fcc67b",timeline:{defaultDuration:3e4,transitions:[{key:"sky",start:0,end:.5,targetFrame:"dawn6"},{key:"sky",start:.5,end:1,targetFrame:"dawn5"},{start:0,end:.5,targetBackgroundColor:"#fdab3a"},{start:.5,end:1,targetBackgroundColor:"#fd7321"},{start:0,end:1,key:"sun",targetState:"large"},{key:"moon",start:0,end:1,path:{name:"moonrise",start:0,end:.25}},{key:"sun",start:0,end:1,path:{name:"sunset",start:.6,end:.75}}]}},{composables:[["background.night",{key:"night",frame:"end"}],["background.sky",{key:"sky",frame:"dawn5",relativeX:-.1}]],entities:[["Sun",{key:"sun",state:"large",relativeX:.848,relativeY:.42}],["Moon",{key:"moon",state:"default",relativeX:.3,relativeY:.4}]],backgroundColor:"#fd7321",timeline:{defaultDuration:3e4,transitions:[{key:"night",start:0,end:1,targetFrame:"middle"},{key:"sky",start:0,end:.3,targetFrame:"dawn4"},{key:"sky",start:.3,end:.7,targetFrame:"dawn3"},{key:"sky",start:.7,end:1,targetFrame:"dawn2"},{start:0,end:.15,targetBackgroundColor:"#27273d"},{start:.15,end:.7,targetBackgroundColor:"#191f3d"},{start:.7,end:1,targetBackgroundColor:"#0f1630"},{key:"moon",start:0,end:1,path:{name:"moonrise",start:.25,end:.45}},{key:"sun",start:0,end:.5,path:{name:"sunset",start:.75,end:1}},{key:"sun",start:1,remove:!0}]}},{composables:[["background.night",{key:"night",frame:"middle"}],["background.sky",{key:"sky",frame:"dawn2",relativeX:-.1}]],entities:[["Moon",{key:"moon",state:"default",relativeX:.2,relativeY:.4}]],backgroundColor:"#0f1630",timeline:{defaultDuration:3e4,transitions:[{key:"night",start:0,end:1,targetFrame:"default"},{key:"sky",start:0,end:.5,targetFrame:"dawn"},{key:"sky",start:.5,end:1,targetFrame:"default"},{start:0,end:.5,targetBackgroundColor:"#030820"},{start:.5,end:1,targetBackgroundColor:"#000010"},{key:"moon",start:0,end:1,targetFrame:"large",path:{name:"moonrise",start:.45,end:1}}]}},{composables:[["background.night",{key:"night"}],["background.sky",{key:"sky",frame:"default",relativeX:-.1}]],entities:[["Moon",{key:"moon",state:"large",relativeX:.3,relativeY:.2}]],backgroundColor:"#000010",timeline:{defaultDuration:1e3,transitions:[]}}],habitat:{isBackground:!0,scenery:"town.RoofTops",scrollSpeed:{vx:-100,vy:0}}}},t8={};d(t8),p(t8,"default",()=>t7);var t7={"city.Bridge":{checkpoints:[{particles:[["dust.bridge",{key:"dust"}]],timeline:{defaultDuration:1e3,transitions:[{key:"dust",start:.9,end:1,remove:!0}]}},{entities:[["BridgeCeiling",{key:"ceiling"}],["BridgeFrontDeck",{key:"front"}],["BridgeCeilingBackground",{key:"back"}],["PillarRight",{key:"pillarRight"}],["PillarLeft",{key:"pillarLeft"}]],timeline:{defaultDuration:500,transitions:[{key:"back",start:.3,end:1,targetFrame:"damaged",path:{data:[{x:-.1,y:.3},{x:-.1,y:.29}]}},{key:"pillarRight",start:.2,end:1,targetFrame:"rotateSmall"},{key:"pillarLeft",start:.2,end:1,targetFrame:"rotateSmall"},{key:"front",start:.7,end:1,targetFrame:"rotateSmall",path:{data:[{x:-.1,y:.29},{x:-.1,y:.3}]}},{key:"ceiling",start:0,end:1,targetFrame:"rotateSmall",path:{data:[{x:-.1,y:.3},{x:-.1,y:.28}]}}]}},{entities:[["BridgeCeiling",{key:"ceiling"}],["BridgeFrontDeck",{key:"front"}],["BridgeCeilingBackground",{key:"back"}],["PillarRight",{key:"pillarRight"}],["PillarLeft",{key:"pillarLeft"}]],timeline:{defaultDuration:500,transitions:[{key:"back",start:.3,end:1,targetFrame:"damaged",path:{data:[{x:-.1,y:.3},{x:-.1,y:.29}]}},{key:"pillarRight",start:.2,end:1,targetFrame:"rotateMedium"},{key:"pillarLeft",start:.2,end:1,targetFrame:"rotateMedium"},{key:"front",start:.7,end:1,targetFrame:"rotateMedium",path:{data:[{x:-.1,y:.29},{x:-.1,y:.3}]}},{key:"ceiling",start:0,end:1,components:["PlayerEnemy"],targetFrame:"rotateMedium",path:{data:[{x:-.1,y:.3},{x:-.1,y:.28}]}}]}},{particles:[["dust.bridge",{key:"dust"}]],entities:[["BridgeCeiling",{key:"ceiling"}],["BridgeCeilingBackground",{key:"back"}],["BridgeFrontDeck",{key:"front"}],["PillarRight",{key:"pillarRight"}],["PillarLeft",{key:"pillarLeft"}]],timeline:{defaultDuration:6e3,transitions:[{key:"dust",start:.7,end:1,remove:!0},{key:"ceiling",start:.2,end:.6,targetFrame:"rotateDown",path:{data:[{x:-.1,y:.28},{x:-.1,y:1.2}]}},{key:"front",start:.7,end:1,path:{data:[{x:-.1,y:.1},{x:-.1,y:1.3}]}},{key:"back",start:0,end:.5,targetFrame:"rotateDown",path:{data:[{x:-.1,y:.28},{x:-.1,y:.9}]}},{key:"pillarLeft",start:.7,end:1,targetFrame:"rotateDown"},{key:"pillarRight",start:.4,end:1,targetFrame:"rotateDown"}]}}],habitat:{scenery:"city.Bridge",scrollSpeed:{vx:0,vy:0},background:["city.Sunrise",3]}}},t9={};d(t9),p(t9,"default",()=>et);var et={"title.Intro":{checkpoints:[{composables:[["background.night",{key:"stars"}],["title.gradient",{key:"fadeIn"}],["title.jinte",{key:"jinte",relativeX:.35,relativeY:.45,frame:"far"}]],backgroundColor:"#606060",timeline:{defaultDuration:3e3,transitions:[{key:"jinte",start:0,end:1,path:{data:[{x:0,y:.8},{x:.1,y:.7},{x:-.05,y:.45}]}},{key:"jinte",start:.2,end:1,targetFrame:"close"},{key:"fadeIn",start:0,end:.2,targetFrame:"reveal"}]}}]}};t0={intro:{intro:{js:t1}},scenery:{sunrise:{js:t5},sunset:{js:t4},bridge:{bridge:{js:t8}}},title:{title:{js:t9}}};var ee={},ei={};d(ei),p(ei,"default",()=>ea);var ea={"player.ship":{attributes:{width:64,height:30.400000000000002},sprites:[["playerShip",{flipX:!0,key:"main",accentColor:"#ff0000",w:64,h:40}]],hitbox:[8,11.200000000000001,51.2,14.4,60,30.400000000000002,16,30.400000000000002],attachHooks:[["explosion",{x:20.8,y:14.4,z:2,attachAlign:["center","center"]}],["mainWeapon",{x:38.400000000000006,y:28.8,z:1,attachAlign:["center","right"]}],["laserWeapon",{x:38.400000000000006,y:28.8,z:4,attachAlign:["center","right"]}],["laserCharge",{x:38.400000000000006,y:28.8,z:4,attachAlign:["center","right"]}],["trail",{x:0,y:17.6,z:4,attachAlign:["center","left"]}],["reverseTrail",{x:30.400000000000002,y:33.6,z:1,attachAlign:["center","right"]}],["reverseTrail2",{x:30.400000000000002,y:25.6,z:-3,attachAlign:["center","right"]}]],frames:{normal:{main:{sprite:"playerShip"}},turn:{main:{sprite:"playerShipTurning"}},front:{main:{sprite:"playerShipFront"}},damaged:{main:{sprite:"playerShipDamaged"}},turnDamaged:{main:{sprite:"playerShipDamagedTurning"}},hidden:{main:{hidden:!0,alpha:0}},turned:{flipX:!0}},animations:{turnAround:{easing:"linear",duration:500,timeline:[{start:0,end:.33,startFrame:"normal",endFrame:"turn"},{start:.33,end:.6,startFrame:"front",endFrame:"front"},{start:.6,end:.66,startFrame:"front",endFrame:"turned"},{start:.66,end:.95,startFrame:"turn",endFrame:"turn"},{start:.95,end:1,startFrame:"turn",endFrame:"normal"}]},turnAroundDamaged:{easing:"linear",duration:500,timeline:[{start:0,end:.33,startFrame:"damaged",endFrame:"turnDamaged"},{start:.33,end:.6,startFrame:"front",endFrame:"front"},{start:.6,end:.66,startFrame:"front",endFrame:"turned"},{start:.66,end:.95,startFrame:"turnDamaged",endFrame:"turnDamaged"},{start:.95,end:1,startFrame:"turnDamaged",endFrame:"damaged"}]}}}},er={};d(er),p(er,"default",()=>en);var en={"portraits.pilot":{attributes:{width:128,height:128},sprites:[["pilot1",{key:"pilot"}]],frames:{idle:{pilot:{sprite:"pilot1"}},talk:{pilot:{sprite:"pilot2"}}},animations:{talking:{repeat:!0,easing:"linear",duration:500,timeline:[{start:0,end:.5,startFrame:"idle",endFrame:"talk"},{start:.5,end:1,startFrame:"talk",endFrame:"idle"}]}}},"portraits.general":{attributes:{width:128,height:128},sprites:[["general2",{key:"main"}]],frames:{idle:{main:{sprite:"general2"}},talk:{main:{sprite:"general1"}}},animations:{talking:{repeat:!0,easing:"linear",duration:500,timeline:[{start:0,end:.5,startFrame:"idle",endFrame:"talk"},{start:.5,end:1,startFrame:"talk",endFrame:"idle"}]}}},"portraits.drone":{attributes:{width:90,height:68},sprites:[["standardLargeDrone",{key:"portrait",w:90,h:58,crop:[20,60,50,0]}],["sphere2",{z:1,x:5,y:25,w:20,h:20,crop:[0,0,17,21],key:"eye"}]],frames:{idle:{eye:{x:0,y:0,alpha:1}},eyeMove:{eye:{x:24,y:-16,alpha:.6}},eyeDisappear:{eye:{x:24,y:-16,alpha:0}},eyeReset:{eye:{x:0,y:0,alpha:0}},eyeAppear:{eye:{x:0,y:0,alpha:1}}},animations:{talking:{repeat:!0,easing:"linear",duration:800,timeline:[{start:0,end:.7,startFrame:"eyeAppear",endFrame:"eyeMove"},{start:.7,end:.8,startFrame:"eyeMove",endFrame:"eyeDisappear"},{start:.8,end:.9,startFrame:"eyeDisappear",endFrame:"eyeReset"},{start:.9,end:1,startFrame:"eyeReset",endFrame:"eyeAppear"}]}}}},eo={};d(eo),p(eo,"default",()=>es);var es={cloth:{attributes:{width:128,height:96},sprites:[["clothBottom",{x:0,y:69}],["cloth",{x:0,y:0,z:4,hideBelow:88,key:"cloth"}]],frames:{up:{cloth:{y:0}},medium:{cloth:{y:10}},down:{cloth:{y:100}}}}},el={};d(el),p(el,"default",()=>eh);var eh={shipHatch:{attributes:{width:128,height:32},sprites:[["aircraftCarrierOpenHatch",{y:-4,x:0}],["aircraftCarrierHatchLid",{y:-2,x:0,key:"lid",crop:[2,0,0,0],z:1}],["aircraftCarrierWires",{x:68,y:-20,z:-1}],["aircraftCarrierHatchLid",{x:3,y:80,z:1,key:"floor",crop:[18,3,0,0],hideBelow:28}]],attachHooks:[["payload",{x:64,y:86,z:6,attachAlign:["bottom","center"],attachTo:"floor"}]],frames:{open:{lid:{x:-30,y:16},floor:{x:0,y:0}},closed:{lid:{x:0,y:0},floor:{x:0,y:0}},risen:{lid:{x:-30,y:16},floor:{y:-65}}}}},ec={};d(ec),p(ec,"default",()=>eu);var eu={"weapons.bullet":{attributes:{width:26,height:16,ro:[4,8]},hitbox:[2,3,14,3,14,12,2,12],sprites:[["sphere1",{z:-2,crop:[17,6,0,0],flipX:!0}]]},"weapons.lightBullet":{attributes:{width:32,height:32,ro:[4,14]},hitbox:[2,12,28,12,28,18,2,18],sprites:[["lightBullet",{z:-2}]]},"weapons.laser":{attributes:{width:20,height:5,ro:[2,3]},sprites:[["lightBullet",{alpha:1,x:0,y:-7,h:20,w:5,z:-2,stretch:[0,0,0,0],crop:[0,15,0,0],key:"beam1"}],["lightBullet",{alpha:1,x:5,y:-7,h:20,w:10,z:-2,stretch:[0,1,0,0],crop:[0,15,0,15],key:"beam2"}],["lightBullet",{alpha:1,x:15,y:-7,h:20,w:5,z:-2,stretch:[0,1,0,1],crop:[0,0,0,15],key:"beam3"}]],frames:{short:{attributes:{w:200}},reset:{beam1:{alpha:1},beam2:{alpha:1},beam3:{alpha:1}},disappear:{beam1:{alpha:0},beam2:{alpha:0},beam3:{alpha:0}},long:{attributes:{w:500}},rotate:{attributes:{rotation:10}},rotate2:{attributes:{rotation:-50}},flipped:{flipX:!0}}},"player.bullet":{attributes:{width:52,height:8,ro:[4,4]},hitbox:[2,3,14,3,14,12,2,12],sprites:[["sphere1",{z:-2,crop:[17,6,0,0],flipX:!0,w:52,h:8,overrideColor:"#ff8080"}]]},"weapons.sphere":{attributes:{width:16,height:16,ro:[8,8]},sprites:[["sphere1",{z:-2,crop:[0,17,17,0],key:"main"}]],animations:{default:{repeat:!0,duration:300,timeline:[{start:0,end:1,spriteAnimation:{key:"main",sprites:["sphere1","sphere2"]}}]}}},"weapons.rocket":{attributes:{width:47,height:16,ro:[4,8],scale:1},hitbox:[2,3,45,3,45,12,2,12],sprites:[["standardRocket",{z:1,key:"main"}]],attachHooks:[["trail",{x:47,y:8,z:-1,attachAlign:["center","left"]}],["tip",{x:0,y:8,z:1,attachAlign:["center","left"]}]],frames:{hidden:{main:{hidden:!0,alpha:0}},small:{attributes:{scale:.8}}}},"weapons.explosion":{attributes:{width:96,height:96,ro:[48,48]},sprites:[["explosion1",{scale:1,x:0,y:0,key:"main"}]],animations:{default:{duration:350,timeline:[{start:0,end:1,spriteAnimation:{key:"main",sprites:["explosion1","explosion2","explosion3","explosion4","explosion5","explosion6","explosion7","explosion8","explosion9","explosion10","explosion11","explosion12","explosion13","explosion14","explosion15","explosion16","explosion17","explosion18","explosion19","explosion20"]}}]}}},"weapons.largeExplosion":{attributes:{width:96,height:96,scale:1.75,ro:[84,84]},sprites:[["explosion1",{scale:1,x:0,y:0,key:"main"}]],animations:{default:{duration:350,timeline:[{start:0,end:1,spriteAnimation:{key:"main",sprites:["explosion1","explosion2","explosion3","explosion4","explosion5","explosion6","explosion7","explosion8","explosion9","explosion10","explosion11","explosion12","explosion13","explosion14","explosion15","explosion16","explosion17","explosion18","explosion19","explosion20"]}}]}}},"weapons.solidHit":{attributes:{width:8,height:8},sprites:[["explosion1",{scale:.25,x:-45,y:-45,key:"main"}]],animations:{default:{duration:100,timeline:[{start:0,end:1,spriteAnimation:{key:"main",sprites:["explosion1","explosion3","explosion5","explosion7","explosion9","explosion11","explosion13","explosion15","explosion17"]}}]}}},"weapons.waterHit":{attributes:{width:8,height:8},sprites:[["explosion5",{scaleX:.25,scaleY:.25,x:-45,y:-45,overrideColor:"#ffffff",key:"main"}]],frames:{high:{main:{scaleX:.25,scaleY:.75,y:-27}},end:{main:{scaleX:.25,scaleY:.25,y:-45,alpha:0}}},animations:{default:{duration:300,timeline:[{start:0,end:.3,startFrame:"default",endFrame:"high"},{start:.6,end:1,startFrame:"high",endFrame:"end"}]}}},"weapons.muzzleFlash":{attributes:{width:32,height:32,ro:[28,16]},sprites:[["muzzleFlash",{z:20,flipX:!0,key:"flash"}]],frames:{normal:{flash:{alpha:1}},end:{flash:{alpha:0}}},animations:{default:{repeat:!1,easing:"linear",duration:300,timeline:[{start:0,end:.3,startFrame:"end",endFrame:"normal"},{start:.7,end:1,startFrame:"normal",endFrame:"end"}]}}}},ed={};d(ed),p(ed,"default",()=>ep);var ep={"powerups.life":{attributes:{width:32,height:32},sprites:[["powerUpBox",{key:"main",accentColor:"#900000"}],["heart",{z:1,scale:.7,accentColor:"#ff9999",key:"symbol"}],["bigGlare",{z:-1,scale:.15,x:-84,y:-84,crop:[0,24,24,0],overrideColor:"#ff9999",alpha:.4,key:"glow"}]],hitbox:[0,0,32,0,32,32,0,32],attachHooks:[["explosion",{x:16,y:16,z:-2,attachAlign:["center","center"]}]],frames:{startGlow:{glow:{alpha:.4,scale:.15}},endGlow:{glow:{alpha:0,scale:.4}},pickedUp:{glow:{alpha:0,scale:.4},main:{alpha:0},symbol:{alpha:0,scale:1.2}},disappear:{glow:{alpha:0},main:{alpha:0,scale:.2},symbol:{alpha:0,scale:.2}}},animations:{default:{duration:2e3,repeat:!0,timeline:[{start:0,end:1,spriteAnimation:{key:"main",sprites:["powerUpBox","powerUpBox2","powerUpBox3","powerUpBox2"]}},{start:0,end:1,startFrame:"startGlow",endFrame:"endGlow"}]}}},"powerups.bonus":{attributes:{width:32,height:32},sprites:[["powerUpBox",{key:"main",accentColor:"#a67c00"}],["star",{z:1,scale:.7,accentColor:"#ffdc73",key:"symbol"}],["bigGlare",{z:-1,scale:.15,x:-84,y:-84,crop:[0,24,24,0],overrideColor:"#ffdc73",alpha:.4,key:"glow"}]],hitbox:[0,0,32,0,32,32,0,32],attachHooks:[["explosion",{x:16,y:16,z:-2,attachAlign:["center","center"]}]],frames:{startGlow:{glow:{alpha:.4,scale:.15}},endGlow:{glow:{alpha:0,scale:.4}},pickedUp:{glow:{alpha:0,scale:.4},main:{alpha:0},symbol:{alpha:0,scale:1.2}},disappear:{glow:{alpha:0},main:{alpha:0,scale:.2},symbol:{alpha:0,scale:.2}}},animations:{default:{duration:2e3,repeat:!0,timeline:[{start:0,end:1,spriteAnimation:{key:"main",sprites:["powerUpBox","powerUpBox2","powerUpBox3","powerUpBox2"]}},{start:0,end:1,startFrame:"startGlow",endFrame:"endGlow"}]}}},"powerups.upgrade":{attributes:{width:32,height:32},sprites:[["powerUpBox",{key:"main",accentColor:"#009000"}],["upgrade",{z:1,scale:.7,accentColor:"#99ff99",key:"symbol"}],["bigGlare",{z:-1,scale:.15,x:-84,y:-84,crop:[0,24,24,0],overrideColor:"#99ff99",alpha:.4,key:"glow"}]],hitbox:[0,0,32,0,32,32,0,32],attachHooks:[["explosion",{x:16,y:16,z:-2,attachAlign:["center","center"]}]],frames:{startGlow:{glow:{alpha:.4,scale:.15}},endGlow:{glow:{alpha:0,scale:.4}},pickedUp:{glow:{alpha:0,scale:.4},main:{alpha:0},symbol:{alpha:0,scale:1.2}},disappear:{glow:{alpha:0},main:{alpha:0,scale:.2},symbol:{alpha:0,scale:.2}}},animations:{default:{duration:2e3,repeat:!0,timeline:[{start:0,end:1,spriteAnimation:{key:"main",sprites:["powerUpBox","powerUpBox2","powerUpBox3","powerUpBox2"]}},{start:0,end:1,startFrame:"startGlow",endFrame:"endGlow"}]}}}},ey={};d(ey),p(ey,"default",()=>em);var em={"intro.ship":{attributes:{width:800,height:108},sprites:[["aircraftCarrierBottomFlat",{x:-64,y:10}],["aircraftCarrierBottomSpace",{x:64,y:10}],["aircraftCarrierBottomFlat",{x:192,y:10}],["aircraftCarrierBottomFlat",{x:320,y:10}],["aircraftCarrierBottomFlat",{x:448,y:10}],["aircraftCarrierBottomFlat",{x:576,y:10}],["aircraftCarrierEnd",{x:704,y:-54}],["aircraftCarrierTopFlat",{x:-64,y:-54}],["aircraftCarrierTopFlat",{x:64,y:-54}],["aircraftCarrierTopFlat",{x:192,y:-54}],["aircraftCarrierTopFlat",{x:320,y:-54}],["aircraftCarrierTopFlat",{x:448,y:-54}],["aircraftCarrierTopFlat",{x:576,y:-54}],["boxes",{x:622,y:-64,z:5}],["aircraftCarrierCabinStart",{x:96,y:-178,z:6}],["aircraftCarrierCabinRadar",{x:128,y:-178,z:6}],["aircraftCarrierCabin",{x:192,y:-178,z:6}],["aircraftCarrierCabinRadar",{x:256,y:-178,z:6}],["aircraftCarrierCabin",{x:320,y:-178,z:6}],["aircraftCarrierCabinEnd",{x:384,y:-178,z:6}],["aircraftCarrierRadar",{x:232,y:-185,z:6}],["aircraftCarrierAntenna",{x:316,y:-227,z:6}],["aircraftCarrierAntenna",{x:158,y:-227,z:6}],["aircraftCarrier7",{x:192,y:-116,z:6}],["aircraftCarrier7",{x:320,y:-116,z:6}]],attachHooks:[["boxLocation1",{x:650,y:-10,z:23}],["boxLocation2",{x:714,y:-16,z:23}],["hatch1",{x:220,y:-20,z:2,attachAlign:["top","left"]}],["heliStart",{x:612,y:-20,z:6,attachAlign:["bottom","center"]}],["hatch2",{x:412,y:-20,z:2,attachAlign:["top","left"]}],["bottom",{x:-64,y:70,z:21,attachAlign:["top","left"]}]]},"intro.boxes":{attributes:{width:32,height:32},hitbox:[0,7,32,7,32,32,0,32],sprites:[["boxes",{x:0,y:0,key:"main"}]],frames:{falling:{main:{sprite:"boxesFalling"}}}},"intro.parachute":{attributes:{width:32,height:32,rotation:0,ro:[14,2]},sprites:[["chute",{x:0,y:0,horizon:[.6,.6]}]],frames:{left:{attributes:{rotation:20}},right:{attributes:{rotation:-20}}},animations:{default:{repeat:!0,easing:"linear",duration:5e3,timeline:[{start:0,end:.5,startFrame:"left",endFrame:"right"},{start:.5,end:1,startFrame:"right",endFrame:"left"}]}}}},ef={};d(ef),p(ef,"default",()=>eg);var eg={"city.horizon":{attributes:{width:256,height:160},sprites:[["coast",{z:-598,horizon:[.9,.8]}]]},"city.cloud":{attributes:{width:256,height:960},sprites:[["cloud",{z:-398,horizon:[.95,.9],alpha:.9,scale:.5,key:"main"}]],frames:{close:{main:{scale:.8,horizon:[.85,.85]}}}},"city.horizonStart":{attributes:{width:256,height:160},sprites:[["coastStart",{z:-598,horizon:[.9,.8]}]],frames:{flipped:{flipX:!0}}},"city.cityStart":{attributes:{width:512,height:288},sprites:[["cityStart",{z:-305,horizon:[.4,.4]}]],frames:{flipped:{flipX:!0}}},"city.city":{attributes:{width:512,height:288},sprites:[["city",{z:-305,horizon:[.4,.4]}]]},"city.cityDistance":{attributes:{width:256,height:224},sprites:[["cityDistance",{z:-598,horizon:[.9,.7]}]]},"city.layer2":{attributes:{width:384,height:256},hitbox:[240,120,240,0,295,0,295,120],sprites:[["cityLayer2",{z:-505,horizon:[.6,.6]}],["cityLayer2",{z:-505,y:256,h:80,crop:[254,0,0,0],horizon:[.6,.6]}]]},explosion:{attributes:{width:96,height:96},sprites:[["explosion1",{key:"main"}]],animations:{default:{duration:350,timeline:[{start:0,end:1,spriteAnimation:{key:"main",sprites:["explosion1","explosion2","explosion3","explosion4","explosion5","explosion6","explosion7","explosion8","explosion9","explosion10","explosion11","explosion12","explosion13","explosion14","explosion15","explosion16","explosion17","explosion18","explosion19","explosion20"]}}]}}}},ev={};d(ev),p(ev,"default",()=>ew);var ew={"ocean.front":{attributes:{width:1024,height:96},sprites:[["waterFront1",{z:-20,key:"left",horizon:[.4,0]}],["waterFront2",{x:512,z:-20,key:"right",horizon:[.4,0]}]],frames:{waveR:{left:{scaleX:1.125,x:32,scaleY:.95,y:5},right:{scaleX:.875,x:32,scaleY:.95,y:5}},waveL:{left:{scaleX:.875,x:-32,scaleY:1.05,y:-5},right:{scaleX:1.125,x:-32,scaleY:1.05,y:-5}}},animations:{default:{repeat:!0,easing:"linear",duration:2e4,timer:"global",timeline:[{start:0,end:.2,startFrame:"default",endFrame:"waveL"},{start:.2,end:.5,startFrame:"waveL",endFrame:"default"},{start:.5,end:.8,startFrame:"default",endFrame:"waveR"},{start:.8,end:1,startFrame:"waveR",endFrame:"default"}]}}},"ocean.middle":{attributes:{width:512,height:192},sprites:[["waterMiddle",{z:-500,w:513,key:"middle",horizon:[.8,.1]}]],frames:{wave:{middle:{y:4}}},animations:{default:{repeat:!0,easing:"linear",duration:1e4,timer:"global",timeline:[{start:0,end:.5,startFrame:"default",endFrame:"wave"},{start:.5,end:1,startFrame:"wave",endFrame:"default"}]}}},"ocean.horizon":{attributes:{width:260,height:160},sprites:[["waterHorizon",{z:-600,w:260,horizon:[1,.4]}]]}},ex={};d(ex),p(ex,"default",()=>e_);var e_={"background.night":{attributes:{width:1024,height:576},sprites:[["stars",{z:0,y:-100,w:672,h:288,key:"topleft",ro:[672,288]}],["stars",{z:0,w:672,h:288,x:672,y:-100,key:"topright",attachTo:"topleft"}],["stars",{z:0,w:672,h:288,x:0,y:188,key:"bottomleft",attachTo:"topleft"}],["stars",{z:0,w:672,h:288,x:672,y:188,key:"bottomright",attachTo:"topleft"}]],frames:{middle:{topleft:{rotation:-3}},end:{topleft:{alpha:.5,rotation:-6},topright:{alpha:.5},bottomleft:{alpha:.5},bottomright:{alpha:.5}}}},"background.horizon":{attributes:{width:1230,height:50},gradients:[{z:4,w:1230,h:50,key:"sky",topColor:["#dddd00",0],bottomColor:["#dddd00",1]}],frames:{start:{sky:{h:50,topColor:["#dddd00",0],bottomColor:["#dddd00",1]}},dawn:{sky:{h:80,topColor:["#dddd00",0],bottomColor:["#dddd00",.6]}}}},"background.sky":{attributes:{width:1230,height:576},gradients:[{z:4,w:1230,h:400,key:"sky",topColor:["#000000",0],bottomColor:["#000000",0]}],frames:{dawn:{sky:{topColor:["#000020",.3],bottomColor:["#213a9e",.6]}},dawn2:{sky:{topColor:["#0f1630",.5],bottomColor:["#5e6d9f",.8]}},dawn3:{sky:{topColor:["#191f3d",.8],bottomColor:["#8b8289",1]}},dawn4:{sky:{topColor:["#27273d",1],bottomColor:["#a73e02",1]}},dawn5:{sky:{topColor:["#3e2d30",1],bottomColor:["#fd7321",1]}},dawn6:{sky:{topColor:["#383b65",1],bottomColor:["#fdab3a",1]}},dawn7:{sky:{topColor:["#354898",1],bottomColor:["#fcc67b",1]}},dawn8:{sky:{topColor:["#3856c1",1],bottomColor:["#f3d7b1",1]}},dawn9:{sky:{topColor:["#477cfc",1],bottomColor:["#babcd9",1]}}}},"background.sun":{attributes:{width:96,height:96,scale:.8},sprites:[["sun",{x:0,y:0,z:4,crop:[1,1,1,1]}],["directGlare",{x:-40,y:-40,z:2e3,crop:[1,1,1,1],alpha:0,key:"glare"}]],frames:{noGlare:{glare:{maxAlpha:0}},full:{glare:{maxAlpha:1}},large:{glare:{maxAlpha:0}}}},"background.moon":{attributes:{width:96,height:96,scale:.6},sprites:[["moon",{x:0,y:0,z:2,crop:[1,1,1,1]}]],frames:{full:{attributes:{scale:1}},large:{attributes:{scale:1.2}}}}},eb={};d(eb),p(eb,"default",()=>eS);var eS={"city.bridge.foot":{attributes:{width:512,height:288},sprites:[["cityBridge",{z:-305,horizon:[.4,.4]}]]},"city.bridge.deck":{attributes:{width:1024,height:128,ro:[934,90]},hitbox:[0,0,1024,0,1024,40,0,40],spriteAttributes:{accentColor:"#2ba04c"},sprites:[["bridgeDeck",{z:0,x:4,key:"deck"}],["bridgeDeck",{z:1,x:512,flipX:!0,key:"deck2"}]],frames:{damaged:{deck:{sprite:"damagedBridgeDeck"},deck2:{sprite:"damagedBridgeDeck"}},rotateSmall:{deck:{sprite:"damagedBridgeDeck"},deck2:{sprite:"damagedBridgeDeck"},attributes:{rotation:-1}},rotateMedium:{deck:{sprite:"damagedBridgeDeck"},deck2:{sprite:"damagedBridgeDeck"},attributes:{rotation:-2}},rotateDown:{deck:{sprite:"damagedBridgeDeck"},deck2:{sprite:"damagedBridgeDeck"},attributes:{rotation:-10}}}},"city.bridge.pillar":{attributes:{width:192,height:544,ro:[96,544]},sprites:[["bridgePillar",{z:0,key:"pillar"}]],frames:{damaged:{pillar:{sprite:"bridgePillarBroken"}},rotateSmall:{attributes:{rotation:-1},pillar:{sprite:"bridgePillarBroken"}},rotateMedium:{attributes:{rotation:-3},pillar:{sprite:"bridgePillarBroken"}},rotateDown:{attributes:{rotation:80},pillar:{sprite:"bridgePillarBroken",y:200}}}},"city.bridge.smallPillar":{attributes:{width:192,height:189},sprites:[["bridgePillar",{z:0,crop:[300,0,55,0]}]]}},eC={};d(eC),p(eC,"default",()=>ek);var ek={"grass.front":{attributes:{width:1024,height:96},sprites:[["grassFront",{z:-20,key:"left",horizon:[.2,0]}]]},"grass.middle":{attributes:{width:768,height:288},sprites:[["grassMiddle",{z:-100,w:768,key:"middle",horizon:[.6,.1]}]]},"grass.pond":{attributes:{width:769,height:288},sprites:[["pond",{z:-100,w:768,key:"middle",horizon:[.6,.1]}]]},"grass.pondStart":{attributes:{width:769,height:288},sprites:[["pondStart",{z:-100,w:768,key:"middle",horizon:[.6,.1]}]]},"grass.hedge":{attributes:{width:384,height:160},sprites:[["hedge",{z:-200,w:666,horizon:[.3,.3]}]]},"town.roof":{attributes:{width:460,height:460},sprites:[["roof",{z:-10,horizon:[.2,0]}]],hitbox:[50,450,50,145,65,145,230,10,400,145,410,145,410,450],attachHooks:[["chimneyLoc",{x:92,y:166,z:-5,attachAlign:["bottom","center"]}],["explosionLoc",{x:92,y:126,z:-5,attachAlign:["bottom","center"]}]]},"town.chimney":{attributes:{width:32,height:128},hitbox:[3,17,30,17,30,80,3,105],sprites:[["chimney",{key:"chimney",z:-15,horizon:[.2,.2]}]],attachHooks:[["smokeLoc",{x:14,y:16,z:-5,attachAlign:["bottom","center"]}],["gunLoc",{x:4,y:-16,z:-5,attachAlign:["bottom","center"]}]],frames:{dead:{chimney:{alpha:0}},shootStart:{chimney:{scaleX:1.2,scaleY:.8}},shootEnd:{chimney:{scaleX:.9,scaleY:1.1}}},animations:{shoot:{duration:400,repeat:!0,startEase:{duration:1,easing:"easeOutQuad"},easing:"easeInQuad",timeline:[{start:0,end:.2,startFrame:"default",endFrame:"shootStart"},{start:.2,end:.4,startFrame:"shootStart",endFrame:"shootEnd"},{start:.6,end:.7,startFrame:"shootEnd",endFrame:"default"}]}}},"town.middle":{attributes:{width:512,height:256},sprites:[["villageSkyline",{z:-300,horizon:[.4,.2]}]]},"town.middleFull":{attributes:{width:512,height:608},sprites:[["villageSkylineFull",{z:-550,horizon:[.4,.2]}]]},"town.skyline":{attributes:{width:256,height:128},sprites:[["villageDistantSkyline",{z:-550,horizon:[.5,.7]}]]},"hills.horizon":{attributes:{width:512,height:96},sprites:[["hillSkyline",{z:-600,horizon:[.8,.6]}]]},"sinterklaas.present":{attributes:{width:32,height:32},hitbox:[0,8,16,4,32,8,30,25,16,30,2,25],sprites:[["present",{}]]},"city.skyScraper":{attributes:{width:512,height:640,scale:2},sprites:[["bigBuildingTop",{}],["bigBuildingLayer",{y:192}],["bigBuildingLayer",{y:256}],["bigBuildingLayer",{y:384}],["bigBuildingLayer",{y:512}]]},"town.chimneyMini":{attributes:{width:32,height:94},hitbox:[3,17,30,17,30,94,3,94],sprites:[["chimney",{key:"chimney",z:0,crop:[1,1,32,1]}],["present",{key:"present",z:2,y:70,x:5,scale:.9}]],attachHooks:[["smokeLoc",{x:14,y:16,z:-5,attachAlign:["bottom","center"]}],["explosionLoc",{x:14,y:86,z:2,attachAlign:["bottom","center"]}],["gunLoc",{x:4,y:-16,z:-5,attachAlign:["bottom","center"]}]],frames:{dead:{chimney:{alpha:0}},shootStart:{chimney:{scaleX:1.2,scaleY:.8}},shootEnd:{chimney:{scaleX:.9,scaleY:1.1}}},animations:{shoot:{duration:400,repeat:!0,startEase:{duration:1,easing:"easeOutQuad"},easing:"easeInQuad",timeline:[{start:0,end:.2,startFrame:"default",endFrame:"shootStart"},{start:.2,end:.4,startFrame:"shootStart",endFrame:"shootEnd"},{start:.6,end:.7,startFrame:"shootEnd",endFrame:"default"}]}}}},eD={};d(eD),p(eD,"default",()=>ez);var ez={bird:{attributes:{width:60,height:50},hitbox:[0,17,50,15,40,40,0,25],sprites:[["bird",{x:-2,y:-11,key:"main"}]],attachHooks:[["trail",{x:32,y:18,z:-2,attachAlign:["center","right"],attachTo:"main"}],["explosion",{x:22,y:18,z:2,attachAlign:["center","center"],attachTo:"main"}],["smoke",{x:22,y:18,z:-5,attachAlign:["center","center"],attachTo:"main"}]],frames:{damaged:{main:{sprite:"bird"}},turned:{flipX:!0},hidden:{main:{hidden:!0,alpha:0}}}}},eA={};d(eA),p(eA,"default",()=>eP);var eP={fish:{attributes:{width:64,height:64},hitbox:[0,5,32,0,64,32,50,40,0,20],sprites:[["fish",{x:-2,y:-11,z:-80,key:"main"}]],attachHooks:[["trail",{x:54,y:28,z:-82,attachAlign:["center","right"],attachTo:"main"}],["explosion",{x:22,y:18,z:2,attachAlign:["center","center"],attachTo:"main"}],["smoke",{x:22,y:18,z:-5,attachAlign:["center","center"],attachTo:"main"}]],frames:{damaged:{main:{sprite:"fish"}},turned:{flipX:!0},hidden:{main:{hidden:!0,alpha:0}}}}},eF={};d(eF),p(eF,"default",()=>eE);var eE={jinte:{attributes:{width:160,height:192},hitbox:[80,32,92,32,140,90,150,108,120,128,105,143,105,166,40,166,28,128,28,100,65,80],sprites:[["playerTop",{x:0,y:0,key:"upper",w:160,h:128}],["playerBottom1",{x:0,y:128,key:"lower",w:160,h:64}]],frames:{fly1:{lower:{sprite:"playerBottom1"}},fly2:{lower:{sprite:"playerBottom2"}},hidden:{upper:{hidden:!0,alpha:0},lower:{hidden:!0,alpha:0}}},attachHooks:[["gun",{x:84,y:82,attachAlign:["center","right"]}],["frontFoot",{x:102,y:162,attachAlign:["center","center"]}],["backFoot",{x:32,y:162,attachAlign:["center","center"]}],["center",{x:70,y:110,attachAlign:["center","center"]}]],animations:{flying:{repeat:!0,easing:"linear",startEase:{easing:"linear",duration:250},duration:500,timeline:[{start:0,end:.5,startFrame:"fly1",endFrame:"fly2"},{start:.5,end:1,startFrame:"fly2",endFrame:"fly1"}]}}},"portraits.jinte":{attributes:{width:128,height:128},sprites:[["portraitJinte1",{key:"face"}]],frames:{idle:{face:{sprite:"portraitJinte1"}},talk:{face:{sprite:"portraitJinte2"}}},animations:{talking:{repeat:!0,easing:"linear",duration:500,timeline:[{start:0,end:.5,startFrame:"idle",endFrame:"talk"},{start:.5,end:1,startFrame:"talk",endFrame:"idle"}]}}},"portraits.jonas":{attributes:{width:128,height:224},sprites:[["portraitJonas",{key:"face"}]],frames:{idle:{face:{}},talk:{face:{}}},animations:{talking:{repeat:!0,easing:"linear",duration:500,timeline:[{start:0,end:.5,startFrame:"idle",endFrame:"talk"},{start:.5,end:1,startFrame:"talk",endFrame:"idle"}]}}},"portraits.sint":{attributes:{width:160,height:192},sprites:[["portraitSint",{key:"face"}]],frames:{idle:{face:{}},talk:{face:{}}},animations:{talking:{repeat:!0,easing:"linear",duration:500,timeline:[{start:0,end:.5,startFrame:"idle",endFrame:"talk"},{start:.5,end:1,startFrame:"talk",endFrame:"idle"}]}}},"weapons.carrot":{attributes:{width:32,height:32,ro:[4,14]},hitbox:[2,12,28,12,28,22,2,22],sprites:[["carrot",{z:-2}]]},"title.jinte":{attributes:{width:416,height:480,ro:[208,240]},sprites:[["title",{z:0,key:"jinte"}]],frames:{close:{jinte:{scale:1}},far:{jinte:{scale:.3}}}}},eB={};d(eB),p(eB,"default",()=>eT);var eT={seagull:{attributes:{width:96,height:80},hitbox:[19,37,50,15,80,50,40,60,5,45],sprites:[["seagull",{x:-2,y:-11,key:"main"}]],attachHooks:[["gun",{x:65,y:53,z:-2,attachAlign:["center","right"],attachTo:"main"}],["explosion",{x:42,y:38,z:2,attachAlign:["center","center"],attachTo:"main"}],["smoke",{x:42,y:38,z:-5,attachAlign:["center","center"],attachTo:"main"}]],frames:{damaged:{main:{sprite:"seagull"}},turned:{flipX:!0},hidden:{main:{hidden:!0,alpha:0}}}},flats:{attributes:{width:32,height:32,ro:[28,4]},hitbox:[26,2,0,20,5,30,16,26,28,4],sprites:[["flats",{key:"main",scale:.7}]]}},eM={};d(eM),p(eM,"default",()=>eL);var eL={"test.dino":{attributes:{width:200,height:153},sprites:[["dinoBody",{z:2,ro:[82,24],key:"body"}],["dinoTentacles",{x:26,y:37,z:2,ro:[16,16],attachTo:"body"}],["dinoArm",{x:16,y:82,z:3,ro:[34,16],key:"arm",attachTo:"body"}],["dinoNeck",{x:-32,y:42,z:1,ro:[50,16],key:"neck",attachTo:"body"}],["dinoJaw",{x:-89,y:52,z:1,ro:[70,16],key:"jaw",attachTo:"neck"}],["dinoTongue",{x:-39,y:52,z:-1,ro:[70,16],attachTo:"neck",key:"tongue"}],["dinoHead",{x:-94,y:23,z:2,ro:[70,37],key:"head",attachTo:"neck"}],["dinoTail",{x:124,y:24,z:1,ro:[10,22],attachTo:"body"}],["dinoUpperLeg",{x:116,y:46,z:3,ro:[32,16],key:"upperLeg",attachTo:"body"}],["dinoLowerLeg",{x:144,y:86,z:5,rotation:-55,ro:[16,16],key:"lowerLeg",attachTo:"upperLeg"}],["dinoFeet",{x:172,y:114,z:6,ro:[26,8],key:"feet",attachTo:"lowerLeg"}],["dinoToes",{x:157,y:118,z:7,ro:[22,20],attachTo:"feet"}],["dinoBackUpperLeg",{x:114,y:36,z:-3,ro:[22,20],key:"backUpperLeg",attachTo:"body"}],["dinoBackLowerLeg",{x:114,y:63,z:-2,ro:[16,20],key:"backLowerLeg",attachTo:"backUpperLeg"}],["dinoBackFeet",{x:98,y:95,z:-1,ro:[24,16],key:"backFeet",attachTo:"backLowerLeg"}],["dinoBackToes",{x:82,y:95,z:0,ro:[26,11],key:"backToes",attachTo:"backFeet"}]],frames:{roar1:{head:{rotation:40},jaw:{rotation:-42,x:-8},tongue:{x:-20},neck:{rotation:0},body:{rotation:20},arm:{rotation:-40},tail:{rotation:-10},topLeg:{rotation:25},bottomLeg:{rotation:-50},feet:{rotation:-10},toes:{rotation:-10},upperLegBack:{rotation:10},lowerLegBack:{rotation:-60},feetBack:{rotation:-80},toesBack:{rotation:0}}}}},eR={};d(eR),p(eR,"default",()=>eO);var eO={"test.wall":{attributes:{width:40,height:150},gradients:[{w:40,h:150,topColor:["#606060",1],bottomColor:["#606060",1]}]}},ej={};d(ej),p(ej,"default",()=>eH);var eH={"title.ship":{attributes:{width:288,height:160,scale:1,ro:[144,110]},sprites:[["titleShip",{key:"main",accentColor:"#ff0000",horizon:[0,0],z:200}]],frames:{far:{attributes:{scale:.1,rotation:0},main:{horizon:[1,1]}},close:{attributes:{scale:1.5,rotation:20},main:{horizon:[0,0]}}}},"title.gradient":{attributes:{width:1230,height:576},gradients:[{y:300,z:2,w:1230,h:300,key:"sky",topColor:["#000000",1],bottomColor:["#000000",1]}],frames:{reveal:{sky:{topColor:["#000000",0],bottomColor:["#000000",1]}}}}},eI={};d(eI),p(eI,"default",()=>eG);var eG={"battleship.deck":{attributes:{width:1390,height:170},hitbox:[20,60,1280,60,1280,188,20,188],sprites:[["aircraftCarrierStart",{x:0}],["aircraftCarrierTopFlat",{x:192}],["aircraftCarrierTopFlat",{x:320}],["aircraftCarrierTopFlat",{x:448}],["aircraftCarrierTopFlat",{x:576}],["aircraftCarrierTopFlat",{x:704}],["aircraftCarrierTopFlat",{x:832}],["aircraftCarrierTopFlat",{x:960}],["aircraftCarrierTopFlat",{x:1088}],["aircraftCarrierEnd",{x:1216}],["aircraftCarrierBottomFlat",{x:192,y:64}],["aircraftCarrierBottomSpace",{x:320,y:64}],["aircraftCarrierBottomFlat",{x:448,y:64}],["aircraftCarrierBottomFlat",{x:576,y:64}],["aircraftCarrierBottomFlat",{x:704,y:64}],["aircraftCarrierBottomSpace",{x:832,y:64}],["aircraftCarrierBottomFlat",{x:960,y:64}],["aircraftCarrierBottomFlat",{x:1088,y:64}],["aircraftCarrierWires",{x:1052,y:20,z:1}],["aircraftCarrierHole",{x:220,y:120,z:1}],["aircraftCarrierHole",{x:310,y:120,z:1}],["aircraftCarrierHole",{x:450,y:120,z:1}],["aircraftCarrierHole",{x:540,y:120,z:1}],["aircraftCarrierHole",{x:630,y:120,z:1}],["aircraftCarrierHole",{x:720,y:120,z:1}],["aircraftCarrierHole",{x:810,y:120,z:1}],["aircraftCarrierHole",{x:960,y:120,z:1}],["aircraftCarrierHole",{x:1050,y:120,z:1}]],attachHooks:[["mineCannon",{x:120,y:48,z:8,attachAlign:["bottom","center"]}],["deckGun1",{x:356,y:90,z:20,attachAlign:["bottom","center"]}],["deckGun2",{x:866,y:90,z:20,attachAlign:["bottom","center"]}],["deckGun3",{x:1120,y:70,z:7,attachAlign:["bottom","center"]}],["package",{x:1100,y:86,z:3,attachAlign:["bottom","center"]}],["laserField",{x:1120,y:86,z:8,attachAlign:["bottom","center"]}],["boxLocation1",{x:1020,y:73,z:8,attachAlign:["bottom","center"]}],["boxLocation2",{x:1230,y:80,z:8,attachAlign:["bottom","center"]}],["boxLocation3",{x:1133,y:37,z:1,attachAlign:["bottom","center"]}],["cabin1",{x:294,y:24,z:6,attachAlign:["bottom","left"]}],["heliPlace1",{x:540,y:24,z:2,attachAlign:["bottom","left"]}],["heliPlace2",{x:700,y:24,z:1,attachAlign:["bottom","left"]}],["cabin2",{x:832,y:24,z:3,attachAlign:["bottom","left"]}],["engineCore",{x:960,y:-62,z:4.5,attachAlign:["top","left"]}],["hatch1",{x:420,y:32,z:2,attachAlign:["top","left"]}],["hatch2",{x:612,y:32,z:2,attachAlign:["top","left"]}],["hatch3",{x:804,y:32,z:.5,attachAlign:["top","left"]}],["bottom",{x:10,y:135,z:21,attachAlign:["top","left"]}],["cabin1burn",{x:314,y:-16,z:2,attachAlign:["top","left"]}],["cabin1burn2",{x:314,y:0,z:2,attachAlign:["top","left"]}],["cabin2burn",{x:850,y:-16,z:2,attachAlign:["top","left"]}],["cabin2burn2",{x:850,y:0,z:2,attachAlign:["top","left"]}],["cabin1explode",{x:360,y:-56,z:10,attachAlign:["bottom","center"]}],["cabin2explode",{x:950,y:-56,z:14,attachAlign:["bottom","center"]}]],frames:{risen:{bottom:{y:25}},lowered:{bottom:{y:0}},sinking:{bottom:{y:-100}}}},"battleship.firstCabin":{attributes:{width:192,height:130},hitbox:[0,128,0,50,32,32,32,0,193,0,193,128],sprites:[["aircraftCarrierCabinEnd",{x:-12,y:-15,flipX:!0,crop:[0,4,0,0]}],["aircraftCarrierCabinRadar",{x:48,y:-15,flipX:!0}],["aircraftCarrierCabin",{x:112,y:-15}],["aircraftCarrierCabinStart",{x:176,y:-15,flipX:!0}],["aircraftCarrierAntenna",{x:128,y:-65,z:1,flipX:!0}],["aircraftCarrier5",{x:128,y:55,z:1}]],attachHooks:[["radar",{x:72,y:11,z:1,attachAlign:["bottom","center"]}]]},"battleship.firstCabinDestroyed":{attributes:{width:192,height:66},sprites:[["aircraftCarrierCabinEndBroken",{x:-16,y:-15,flipX:!0}],["aircraftCarrierCabinRadarBroken",{x:48,y:-15,flipX:!0}],["aircraftCarrierCabinBroken",{x:112,y:-15}],["aircraftCarrierCabinStartBroken",{x:176,y:-15,flipX:!0}]]},"battleship.secondCabin":{attributes:{width:256,height:130},hitbox:[0,55,32,40,32,0,260,0,260,128,0,128],sprites:[["aircraftCarrierCabinEnd",{x:-12,y:-15,flipX:!0,crop:[0,4,0,0]}],["aircraftCarrierCabinRadar",{x:48,y:-15,flipX:!0}],["aircraftCarrierCabin",{x:112,y:-15}],["aircraftCarrierCabin",{x:176,y:-15}],["aircraftCarrierCabinStart",{x:240,y:-15,flipX:!0}],["aircraftCarrierAntenna",{x:64,y:-63,z:.5,flipX:!0}],["aircraftCarrierAntenna",{x:160,y:-63,z:.5,flipX:!0}],["aircraftCarrierClosed",{x:128,y:50,z:.1}],["aircraftCarrierDoor",{x:134,y:56,w:84,z:2.5,key:"door",hideAbove:56}],["aircraftCarrier5",{x:76,y:40,z:.5}]],frames:{open:{door:{y:-68}}}},"battleship.secondCabinDestroyed":{attributes:{width:256,height:66},sprites:[["aircraftCarrierCabinEndBroken",{x:-16,y:-15,flipX:!0}],["aircraftCarrierCabinRadarBroken",{x:48,y:-15,flipX:!0}],["aircraftCarrierCabinBroken",{x:112,y:-15}],["aircraftCarrierCabinBroken",{x:176,y:-15}],["aircraftCarrierCabinStartBroken",{x:240,y:-15,flipX:!0}]]},"battleship.engine":{attributes:{width:96,height:96},hitbox:[16,16,80,16,80,80,16,80],sprites:[["aircraftCarrierEngine",{x:0,y:0,key:"cabin"}],["aircraftCarrierEngineMeter",{x:32,y:26,ro:[16,22],key:"meter",attachTo:"cabin"}]],attachHooks:[["smoke",{x:36,y:52,z:-1}],["explosion",{x:36,y:52,z:2,attachAlign:["center","center"]}]],frames:{perc0:{meter:{rotation:-90}},perc25:{meter:{rotation:-45}},perc50:{meter:{rotation:0}},perc75:{meter:{rotation:45}},perc100:{meter:{rotation:90}},shake1:{cabin:{x:2,y:-1},meter:{rotation:90}},shake2:{cabin:{x:-2,y:1},meter:{rotation:85}},shake3:{cabin:{x:1}},shake4:{cabin:{x:-1}},destroyed:{meter:{alpha:0},cabin:{sprite:"aircraftCarrierEngineDestroyed"}}},animations:{shake:{repeat:!0,duration:500,timeline:[{start:0,end:.5,startFrame:"shake3",endFrame:"shake4"},{start:.5,end:1,startFrame:"shake4",endFrame:"shake3"}]},heavyShake:{repeat:!0,duration:100,timeline:[{start:0,end:.5,startFrame:"shake1",endFrame:"shake2"},{start:0,end:1,startFrame:"shake1",endFrame:"shake2"}]}}}},eq={};d(eq),p(eq,"default",()=>eU);var eU={bulletCannon:{attributes:{width:100,height:42},hitbox:[64,24,96,24,96,45,64,45],sprites:[["turretFoot",{x:64,y:24,key:"foot"}],["bulletCannon",{x:0,y:0,key:"barrel",ro:[82,24],hitbox:[5,10,94,10,94,28,5,28]}]],attachHooks:[["gun",{x:0,y:18,z:2,attachAlign:["center","left"],attachTo:"barrel"}],["smoke",{x:80,y:32,z:-1,attachAlign:["center","center"]}],["explosion",{x:80,y:16,z:2,attachAlign:["center","center"],attachTo:"main"}],["fire",{x:80,y:32,z:1,attachAlign:["center","center"]}],["smoke2",{x:80,y:29,z:0,attachAlign:["center","center"]}]],frames:{dead:{barrel:{alpha:0}},up:{barrel:{rotation:90}},dead1:{barrel:{rotation:-90,y:-100,x:0}},dead2:{barrel:{rotation:-180,y:-5,x:-40,z:-2}},dead3:{barrel:{rotation:-180,y:-15,x:-40,z:-3}},mirrored:{flipX:!0}},animations:{dead:{duration:1e3,startEase:{duration:250,easing:"easeOutQuad"},easing:"easeInQuad",timeline:[{start:0,end:.5,startFrame:"dead1",endFrame:"dead2"},{start:.5,end:.75,startFrame:"dead2",endFrame:"dead3"},{start:.75,end:1,startFrame:"dead3",endFrame:"dead2"}]}}}},eN={};d(eN),p(eN,"default",()=>eV);var eV={bulletDrone:{attributes:{width:53,height:32},hitbox:[0,20,20,0,50,5,50,32,5,30],sprites:[["bulletDrone",{x:-7,key:"main"}],["helicopterGun",{x:25,y:15,z:-1,key:"barrel",ro:[20,10]}]],attachHooks:[["gun",{x:25,y:32,z:1,attachAlign:["center","left"],attachTo:"barrel"}],["trail",{x:55,y:12,z:-2,attachAlign:["center","right"],attachTo:"main"}],["explosion",{x:22,y:15,z:2,attachAlign:["center","center"],attachTo:"main"}],["smoke",{x:22,y:15,z:-5,attachAlign:["center","center"],attachTo:"main"}]],frames:{damaged:{main:{sprite:"standardDroneDamage"}},turned:{flipX:!0},hidden:{main:{hidden:!0,alpha:0},gun:{hidden:!0,alpha:0}}}}},eX={};d(eX),p(eX,"default",()=>eW);var eW={drone:{attributes:{width:60,height:50,scale:.7},hitbox:[0,20,50,0,60,40,0,50],sprites:[["standardDrone",{x:-2,y:-11,key:"main"}]],attachHooks:[["trail",{x:42,y:12,z:-2,attachAlign:["center","right"],attachTo:"main"}],["explosion",{x:22,y:18,z:2,attachAlign:["center","center"],attachTo:"main"}],["smoke",{x:22,y:18,z:-5,attachAlign:["center","center"],attachTo:"main"}]],frames:{damaged:{main:{sprite:"standardDroneDamage"}},turned:{flipX:!0},hidden:{main:{hidden:!0,alpha:0}}}}},eY={};d(eY),p(eY,"default",()=>eK);var eK={"droneShip.main":{attributes:{width:600,height:160},hitbox:[10,60,525,60,525,188,10,188],sprites:[["aircraftCarrierStart",{x:0}],["aircraftCarrierTopFlat",{x:192}],["aircraftCarrierTopFlat",{x:320}],["aircraftCarrierBottomFlat",{x:192,y:64}],["aircraftCarrierBottomSpace",{x:320,y:64}],["aircraftCarrierEnd",{x:448,y:0}],["aircraftCarrierLowCabinStart",{x:168,y:-28,flipX:!0}],["aircraftCarrierLowCabin",{x:200,y:-28}],["aircraftCarrierLowCabin",{x:232,y:-28}],["aircraftCarrierLowCabinStart",{x:264,y:-28}]],attachHooks:[["boxLocation1",{x:420,y:30,z:13}],["radar",{x:228,y:-6,z:1,attachAlign:["bottom","center"]}],["hatch1",{x:220,y:32,z:2,attachAlign:["top","left"]}],["bottom",{x:10,y:130,z:2,attachAlign:["top","left"]}],["gun",{x:360,y:90,z:22,attachAlign:["bottom","center"]}]]},"droneShip.radar":{attributes:{width:64,height:28},hitbox:[4,24,32,0,60,24,32,42],sprites:[["aircraftCarrierRadar",{x:0,y:-6,key:"main"}],["aircraftCarrierRadarEmit",{x:0,y:0,z:-1,key:"emit",scale:.9}]],attachHooks:[["smoke",{x:32,y:28,z:1,attachAlign:["center","left"]}],["explosion",{x:32,y:28,z:1,attachAlign:["center","center"]}]],frames:{emitStart:{emit:{x:0,y:0,alpha:1,scale:.9}},emitEnd:{emit:{x:0,y:-32,alpha:0,scale:3}},broken:{emit:{x:0,y:-32,alpha:0,scale:3},main:{hidden:!0,sprite:"aircraftCarrierRadarBroken"}}},animations:{pulse:{repeat:!0,easing:"linear",duration:1500,timeline:[{start:0,end:1,startFrame:"emitStart",endFrame:"emitEnd"}]}}}},eJ={};d(eJ),p(eJ,"default",()=>e$);var e$={helicopter:{attributes:{width:128,height:64,scale:1},hitbox:[10,45,50,10,125,20,110,50,13,57],sprites:[["helicopterLanded",{x:0,y:0,key:"heli",w:128,h:64,horizon:[0,0]}],["helicopterGun",{x:-5,y:43,z:-1,key:"barrel",w:32,h:32,ro:[20,10],horizon:[0,0]}]],attachHooks:[["gun",{x:2,y:62,z:1,attachAlign:["center","left"],attachTo:"barrel"}],["rockets",{x:60,y:42,z:1,attachAlign:["center","center"]}],["sparks",{x:60,y:42,z:2,attachAlign:["center","center"]}],["smoke",{x:60,y:52,z:-1,attachAlign:["center","center"]}],["fire",{x:80,y:32,z:1,attachAlign:["center","center"]}],["smoke2",{x:80,y:29,z:0,attachAlign:["center","center"]}]],frames:{landed:{attributes:{scale:.8,z:-100}},foreground:{attributes:{scale:1,z:100}},background:{flipX:!0,attributes:{scale:.7,z:-300},heli:{horizon:[.7,.7]},barrel:{horizon:[.7,.7]}},flyBackground1:{attributes:{scale:.7},heli:{sprite:"helicopter",horizon:[.7,.7]},barrel:{alpha:1,horizon:[.7,.7]}},flyBackground2:{attributes:{scale:.7},heli:{sprite:"helicopter2",horizon:[.7,.7]},barrel:{alpha:1,horizon:[.7,.7]}},fly1:{heli:{sprite:"helicopter"},barrel:{alpha:1}},fly2:{heli:{sprite:"helicopter2"},barrel:{alpha:1}},damaged:{heli:{sprite:"heliDamaged"},barrel:{alpha:1}},gunRotate1:{barrel:{rotation:10}},gunRotate2:{barrel:{rotation:-50}},turn1:{heli:{sprite:"helicopterTurning1",scaleX:.5},barrel:{alpha:0}},turn2:{heli:{sprite:"helicopterTurning2",scaleX:.5},barrel:{alpha:0}},turned:{flipX:!0},tilted:{attributes:{rotation:-10}},leveled:{attributes:{rotation:0}}},animations:{flying:{repeat:!0,easing:"linear",startEase:{easing:"linear",duration:250},duration:500,timeline:[{start:0,end:.5,startFrame:"fly1",endFrame:"fly2"},{start:.5,end:1,startFrame:"fly2",endFrame:"fly1"}]},flyingBackground:{repeat:!0,easing:"linear",startEase:{easing:"linear",duration:250},duration:500,timeline:[{start:0,end:.5,startFrame:"flyBackground1",endFrame:"flyBackground2"},{start:.5,end:1,startFrame:"flyBackground2",endFrame:"flyBackground1"}]},turning:{repeat:!0,easing:"linear",startEase:{easing:"linear",duration:250},duration:500,timeline:[{start:0,end:.5,startFrame:"turn1",endFrame:"turn2"},{start:.5,end:1,startFrame:"turn2",endFrame:"turn1"}]},turnAround:{easing:"linear",duration:500,after:{animation:"flying"},timeline:[{start:0,end:.05,startFrame:"fly1",endFrame:"turn2"},{start:.25,end:.5,startFrame:"turn2",endFrame:"turn1"},{start:.52,end:.55,startFrame:"turn1",endFrame:"turned"},{start:.75,end:.9,startFrame:"turn1",endFrame:"turn2"},{start:.95,end:1,startFrame:"turn2",endFrame:"fly1"}]}}}},eQ={};d(eQ),p(eQ,"default",()=>eZ);var eZ={largeDrone:{attributes:{width:90,height:70,scale:1,ro:[45,35]},hitbox:[0,20,80,0,50,60,20,67,0,50],sprites:[["standardLargeDrone",{x:0,y:0,key:"main",horizon:[0,0]}],["standardRocket",{x:22,y:33,z:1,key:"rocket",horizon:[0,0]}],["standardLargeDrone",{x:36,y:10,z:3,key:"wing",horizon:[0,0],crop:[10,10,47,36]}],["sphere2",{z:1,x:1,y:27,crop:[0,0,17,21],key:"eye"}]],attachHooks:[["trail",{x:55,y:20,z:-2,attachAlign:["center","center"]}],["explosion",{x:22,y:18,z:2,attachAlign:["center","center"]}],["smoke",{x:22,y:18,z:-5,attachAlign:["center","center"]}],["gun",{x:2,y:38,z:2,attachAlign:["center","left"]}],["rockets",{x:45,y:40,z:2,attachAlign:["center","center"]}],["rockets2",{x:45,y:40,z:1,attachAlign:["center","center"]}]],frames:{background:{attributes:{scale:.7},main:{horizon:[.7,.7]},wing:{horizon:[.7,.7]},rocket:{horizon:[.7,.7]}},rocketShow:{rocket:{y:-10,scale:.6,alpha:1}},rocketReset:{rocket:{y:-10,scale:.6,alpha:0}},rocketLoaded:{rocket:{y:0,scale:1,alpha:1}},rocketShot:{rocket:{y:0,scale:1,alpha:0}},eyeMove:{eye:{x:10,y:-6,alpha:.6}},eyeDisappear:{eye:{x:10,y:-6,alpha:0}},eyeReset:{eye:{alpha:0}},eyeAppear:{eye:{alpha:1}},damaged1:{main:{sprite:"standardLargeDroneDamage1"}},damaged2:{main:{sprite:"standardLargeDroneDamage2"}},damaged3:{main:{sprite:"standardLargeDroneDamage3"}},turned:{flipX:!0},laugh1:{attributes:{rotation:15}},laugh2:{attributes:{rotation:0}},hidden:{main:{hidden:!0,alpha:0},eye:{hidden:!0,alpha:0}}},animations:{eye:{repeat:!0,easing:"linear",duration:1e3,timeline:[{start:0,end:.7,startFrame:"eyeAppear",endFrame:"eyeMove"},{start:.7,end:.8,startFrame:"eyeMove",endFrame:"eyeDisappear"},{start:.8,end:.9,startFrame:"eyeDisappear",endFrame:"eyeReset"},{start:.9,end:1,startFrame:"eyeReset",endFrame:"eyeAppear"}]},laugh:{easing:"linear",duration:1800,after:{animation:"eye"},startEase:{duration:10,easing:"linear"},timeline:[{start:0,end:.05,startFrame:"eyeAppear",endFrame:"laugh2"},{start:.05,end:.25,startFrame:"laugh2",endFrame:"laugh1"},{start:.25,end:.5,startFrame:"laugh1",endFrame:"laugh2"},{start:.5,end:.75,startFrame:"laugh2",endFrame:"laugh1"},{start:.75,end:1,startFrame:"laugh1",endFrame:"laugh2"}]},rocketShot:{easing:"linear",duration:200,timeline:[{start:0,end:.2,startFrame:"rocketLoaded",endFrame:"rocketShot"},{start:.2,end:.5,startFrame:"rocketShot",endFrame:"rocketReset"},{start:.5,end:1,startFrame:"rocketReset",endFrame:"rocketShow"}]},rocketReload:{easing:"linear",duration:300,after:{animation:"eye"},timeline:[{start:0,end:1,startFrame:"rocketShow",endFrame:"rocketLoaded"}]}}}},e0={};d(e0),p(e0,"default",()=>e1);var e1={laserCannon:{attributes:{width:100,height:42},hitbox:[64,24,96,24,96,45,64,45],sprites:[["turretFoot",{x:64,y:24,key:"foot"}],["laserGunCore",{x:35,y:0,z:0,crop:[0,13,0,0],key:"core1",attachTo:"barrel"}],["laserGunCore",{x:6,y:0,z:0,crop:[0,13,0,0],key:"core2",attachTo:"core1"}],["laserGunHandle",{x:54,y:0,key:"barrel",ro:[23,15],hitbox:[-49,10,40,0,40,28,-49,28],crop:[0,0,0,22]}],["laserGunBarrel",{x:0,y:0,key:"top",attachTo:"barrel",ro:[30,8],crop:[0,0,16,0]}],["laserGunBarrel",{x:0,y:15,key:"bottom",attachTo:"barrel",ro:[30,8],crop:[14,0,0,0]}]],attachHooks:[["gun",{x:5,y:15,z:-1,attachAlign:["center","left"],attachTo:"barrel"}],["charge",{x:62,y:15,z:2,attachAlign:["center","left"],attachTo:"barrel"}],["discharge",{x:62,y:15,z:-10,attachAlign:["center","left"],attachTo:"barrel"}],["smoke",{x:80,y:32,z:4,attachAlign:["center","center"]}],["explosion",{x:80,y:16,z:2,attachAlign:["center","center"],attachTo:"main"}]],frames:{down:{barrel:{rotation:0}},half:{barrel:{rotation:45}},up:{barrel:{rotation:90}},open:{top:{rotation:-2,ry:-5},bottom:{rotation:2,ry:5},core1:{rx:-6},core2:{overrideColor:null}},charge:{core1:{rx:-6,overrideColor:"#ff8040"},core2:{overrideColor:"#ff8040"}},done:{core1:{overrideColor:null},core2:{overrideColor:null}},close:{top:{rotation:0,ry:0},bottom:{rotation:0,ry:0},core1:{rx:0}},dead1:{foot:{z:5},barrel:{rotation:-90,y:-100,x:0,overrideColor:"#606060"},core1:{x:-3,overrideColor:"#505050"},core2:{overrideColor:"#505050"},top:{overrideColor:"#606060"},bottom:{overrideColor:"#606060"}},dead2:{foot:{z:5},core1:{x:-3,overrideColor:"#505050"},core2:{overrideColor:"#505050"},barrel:{rotation:-180,y:-5,x:-40,overrideColor:"#606060"}},dead3:{foot:{z:5},core1:{x:-3,overrideColor:"#505050"},core2:{overrideColor:"#505050"},barrel:{rotation:-180,y:-9,x:-40,overrideColor:"#606060"}},mirrored:{flipX:!0}},animations:{dead:{duration:1e3,startEase:{duration:250,easing:"easeOutQuad"},easing:"easeInQuad",timeline:[{start:0,end:.5,startFrame:"dead1",endFrame:"dead2"},{start:.5,end:.75,startFrame:"dead2",endFrame:"dead3"},{start:.75,end:1,startFrame:"dead3",endFrame:"dead2"}]}}}},e2={};d(e2),p(e2,"default",()=>e5);var e5={mine:{attributes:{width:32,height:32,ro:[16,16]},hitbox:[4,16,16,4,28,16,16,28],sprites:[["present",{key:"main"}]],frames:{opening:{main:{sprite:"present"}},open:{main:{sprite:"present"}},blink:{main:{sprite:"present"}},hidden:{main:{hidden:!0,alpha:0}}},animations:{opening:{easing:"linear",duration:200,timeline:[{start:0,end:.5,startFrame:"default",endFrame:"opening"},{start:.5,end:1,startFrame:"opening",endFrame:"open"}]},blinking:{repeat:!0,easing:"linear",duration:400,timeline:[{start:0,end:.5,startFrame:"open",endFrame:"blink"},{start:.5,end:1,startFrame:"blink",endFrame:"open"}]}},attachHooks:[["explosion",{x:16,y:16,z:2,attachAlign:["center","center"],attachTo:"main"}],["smoke",{x:16,y:16,z:-5,attachAlign:["center","center"],attachTo:"main"}]]}},e3={};d(e3),p(e3,"default",()=>e4);var e4={mineCannon:{attributes:{width:64,height:42},hitbox:[32,24,64,24,64,45,32,45],sprites:[["turretFoot",{x:32,y:24,key:"foot"}],["mineCannon",{x:0,y:0,key:"barrel",ro:[52,24],hitbox:[5,10,64,10,64,28,5,28]}],["muzzleFlash",{x:-20,y:5,z:-1,alpha:0,scaleY:1.5,key:"flash",flipX:!0,attachTo:"barrel"}]],attachHooks:[["gun",{x:0,y:8,z:-20,attachAlign:["center","left"],attachTo:"barrel"}],["smoke",{x:48,y:32,z:-1,attachAlign:["center","center"]}],["explosion",{x:48,y:16,z:2,attachAlign:["center","center"],attachTo:"main"}]],frames:{dead:{flash:{alpha:0},barrel:{alpha:0}},aimHigh:{barrel:{rotation:50}},aimLow:{barrel:{rotation:10}},shotVis:{flash:{alpha:1}},shotHid:{flash:{alpha:0}}},animations:{blinking:{repeat:!1,easing:"linear",duration:450,timeline:[{start:0,end:.1,startFrame:"shotHid",endFrame:"shotVis"},{start:.3,end:1,startFrame:"shotVis",endFrame:"shotHid"}]}}}};ee={PlayerShip:{PlayerShip:{js:ei},portraits:{js:er}},common:{Cloth:{js:eo},ShipHatch:{js:el},weapons:{js:ec},powerups:{powerups:{js:ed}}},intro:{IntroShip:{js:ey}},scenery:{City:{js:ef},Ocean:{js:ev},backgrounds:{js:ex},bridge:{bridge:{js:eb}}},sinterklaas:{garden:{js:eC},Bird:{Bird:{js:eD}},Fish:{Fish:{js:eA}},Jinte:{Jinte:{js:eF}},Seagull:{Seagull:{js:eB}}},test:{Dino:{js:eM},test:{js:eR}},title:{items:{js:ej}},enemies:{BattleShip:{BattleShip:{js:eI}},BulletCannon:{BulletCannon:{js:eq}},BulletDrone:{bulletDrone:{js:eN}},Drone:{Drone:{js:eX}},DroneShip:{DroneShip:{js:eY}},Helicopter:{Helicopter:{js:eJ}},LargeDrone:{LargeDrone:{js:eQ}},LaserCannon:{LaserCannon:{js:e0}},Mine:{Mine:{js:e2}},MineCannon:{MineCannon:{js:e3}}}};var e6={},e8={};d(e8),p(e8,"default",()=>e7);var e7={PlayerShip:{structure:{composition:"player.ship",components:["ViewportLocked","DamageSupport","SunBlock","LaserSolid"],animation:null,attachments:{mainWeapon:{weapon:{pattern:"player.bullets",target:"PlayerEnemy",angle:180}},laserWeapon:{weapon:{pattern:"player.laser",target:"PlayerEnemy",angle:180}},trail:null,reverseTrail:null,reverseTrail2:null}},states:{dead:{frame:"hidden",audio:"explosion",attachments:{trail:null,reverseTrail:null,reverseTrail2:null,mainWeapon:null,explosion:{composition:"weapons.largeExplosion",animation:"default"}}},damaged:{frame:"damaged"},shooting:{attachments:{mainWeapon:{weapon:{active:!0}}}},noShooting:{attachments:{mainWeapon:{weapon:{active:!1}}}},laserShooting:{attachments:{laserWeapon:{weapon:{active:!0}}}},noLaserShooting:{attachments:{laserCharge:null,laserWeapon:{weapon:{active:!1}}}},laserCharge:{attachments:{laserCharge:{particles:{emitter:"player.laserCharge"}}}},stopLaserCharge:{attachments:{laserCharge:null}},starting:{attachments:{trail:{particles:{emitter:["player.trail",{particle:{velocity:50,startSize:10},emitter:{amount:100}}]}},reverseTrail:null,reverseTrail2:null}},flying:{attachments:{trail:{particles:{emitter:"player.trail"}},reverseTrail:null,reverseTrail2:null}},reverse:{attachments:{trail:null,reverseTrail:{particles:{emitter:"player.reverse"}},reverseTrail2:{particles:{emitter:"player.reverse"}}}},turned:{frame:"turned"},turning:{animation:"turnAround"},turningDamaged:{animation:"turnAroundDamaged"}},habitats:[{name:"Ocean",scenery:"City.Ocean",position:{x:200,y:380},scrollSpeed:{vx:-100,vy:0},background:["City.Sunrise",3]}]}},e9={};d(e9),p(e9,"default",()=>it);var it={Radar:{structure:{composition:"droneShip.radar",frame:"emitEnd"},states:{pulse:{animation:"pulse"},stopPulse:{animation:null,frame:"emitEnd"},dead:{animation:null,audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],frame:"broken",attachments:{explosion:{composition:"explosion",animation:"default"},smoke:{particles:{emitter:["smoke",{emitter:{w:10,h:2,amount:100,duration:6e3}}]}}}}}}},ie={};d(ie),p(ie,"default",()=>ii);var ii={HeliRocket:{structure:{composition:"weapons.rocket",components:["PlayerHit"],frame:"small",attachments:{trail:{particles:{emitter:"missile.trail"}},tip:null}},states:{hide:{attachments:{trail:null,tip:null}},explode:{frame:"hidden",attachments:{trail:null,tip:{weapon:{pattern:"mine.explosion",target:"PlayerShip",angle:0,active:!0}}}},waterHit:{attachments:{trail:null,tip:{particles:{emitter:["fountain",{emitter:{w:60,duration:1e3}}]}}}}},habitats:[{name:"Ocean",scenery:"City.Ocean",scrollSpeed:{vx:-100,vy:0},background:["City.Sunrise",2]}]}},ia={};d(ia),p(ia,"default",()=>ir);var ir={ExtraLife:{structure:{composition:"powerups.life",animation:"default",components:["DamageSupport","PlayerHit"]},states:{pickedUp:{frame:["pickedUp",{duration:300}],animation:null,audio:"powerup",attachments:{explosion:{particles:{emitter:"powerup.pickup"}}}},disappear:{animation:null,frame:"disappear"}}},Bonus:{structure:{composition:"powerups.bonus",animation:"default",components:["DamageSupport","PlayerHit"]},states:{pickedUp:{frame:["pickedUp",{duration:300}],animation:null,audio:"powerup",attachments:{explosion:{particles:{emitter:["powerup.pickup",{particle:{startColor:[.65,.48,0,.6],endColor:[.65,.48,0,0]}}]}}}},disappear:{animation:null,frame:"disappear"}}},Upgrade:{structure:{composition:"powerups.upgrade",animation:"default",components:["DamageSupport","PlayerHit"]},states:{pickedUp:{frame:["pickedUp",{duration:300}],animation:null,audio:"powerup",attachments:{explosion:{particles:{emitter:["powerup.pickup",{particle:{startColor:[.1,.7,.1,.6],endColor:[.3,.7,.3,0]}}]}}}},disappear:{animation:null,frame:"disappear"}}}},io={};d(io),p(io,"default",()=>is);var is={IntroShip:{structure:{composition:"intro.ship",components:["ShipSolid","GravitySolid",["HideBelow",{hideBelow:540,z:-12}]],attachments:{bottom:{particles:{emitter:["waterSplashes",{emitter:{w:850,amount:300,warmed:!0}}]}},hatch1:{composition:"shipHatch"},hatch2:{composition:"shipHatch",attachments:{payload:{name:"player1",entity:"PlayerShip"}}},boxLocation1:{entity:"ShipBoxes"},boxLocation2:{entity:"ShipBoxes"},heliStart:{entity:"IntroHeli"}}},states:{t1o:{attachments:{hatch1:{frame:"open"}}},t1r:{attachments:{hatch1:{frame:"risen"}}},t2o:{attachments:{hatch2:{frame:"open"}}},closed:{attachments:{hatch2:{frame:"closed"}}},t2r:{attachments:{hatch2:{frame:"risen"}}},heliStart:{attachments:{heliStart:{state:"liftOff"}}},shipStart:{attachments:{hatch2:{frame:"risen",attachments:{player1:{state:"starting"}}}}},shipLiftOff:{attachments:{hatch2:{frame:"risen",attachments:{player1:{state:"flying"}}}}}},habitats:[{name:"Ocean",scenery:"City.Ocean",position:{rx:-.3,ry:.8},scrollSpeed:{vx:-40,vy:0},background:["City.Sunrise",0]}]},IntroHeli:{structure:{composition:"helicopter",attributes:{scale:.8}},states:{start:{frame:"default",animation:!1},liftOff:{animation:"flying"},flying:{frame:"tilted",animation:"flying"}}},IntroHeliBackground:{structure:{composition:"helicopter",frame:"background",components:["DamageSupport"]},states:{flying:{animation:"flyingBackground"},shot:{animation:"flyingBackground",attachments:{sparks:{particles:{emitter:"electric"}}}}},habitats:[{name:"Ocean",scenery:"City.Ocean",position:{rx:.3,ry:.3},scrollSpeed:{vx:-80,vy:0},background:["City.Sunrise",0]}]},IntroParachute:{structure:{composition:"intro.parachute"},habitats:[{name:"Ocean",scenery:"City.Ocean",position:{rx:.3,ry:.3},scrollSpeed:{vx:-80,vy:0},background:["City.Sunrise",0]}]},ShipBoxes:{structure:{composition:"intro.boxes",components:["GravitySupport","PlayerHit"]},states:{falling:{frame:"falling"}}}},il={};d(il),p(il,"default",()=>ih);var ih={Sun:{structure:{composition:"background.sun",components:[["LightGlare",{glareAlphaLink:"glare"}],["Overlap",{checkCollission:"SunBlock",applyAlphaTo:"glare"}]]},states:{full:{frame:"full"},large:{frame:"large"}},habitats:[]},Moon:{structure:{composition:"background.moon"},states:{full:{frame:"full"},large:{frame:"large"}},habitats:[]}},ic={};d(ic),p(ic,"default",()=>iu);var iu={BattleShip:{structure:{composition:"battleship.deck",components:["ShipSolid","GravitySolid",["HideBelow",{hideBelow:540,z:-12}]],attachments:{bottom:{particles:{emitter:["waterSplashes",{emitter:{warmed:!0}}]}},cabin1:{composition:"battleship.firstCabin",attachments:{radar:{entity:"Radar"}}},cabin1burn:null,cabin2burn:null,cabin2:{composition:"battleship.secondCabin",components:["DamageSupport"]},mineCannon:{entity:"MineCannon"},package:{composition:"cloth",frame:"medium"},boxLocation1:{entity:"ShipBoxes"},boxLocation2:{entity:"ShipBoxes"},boxLocation3:{composition:"intro.boxes"},hatch1:{composition:"shipHatch",frame:"open",attachments:{payload:{entity:"PresentGun"}}},hatch3:{composition:"shipHatch",frame:"open",attachments:{payload:{entity:"PresentGun"}}},engineCore:{composition:"battleship.engine",frame:"perc0"}}},states:{risen:{frame:"risen"},lowered:{frame:"lowered"},sinking:{frame:"sinking"},t1o:{attachments:{hatch1:{frame:"open"}}},t1r:{attachments:{hatch1:{frame:"risen"}}},t2o:{attachments:{hatch2:{frame:"open"}}},t2r:{attachments:{hatch2:{frame:"risen"}}},t3o:{attachments:{hatch3:{frame:"open"}}},t3r:{attachments:{hatch3:{frame:"risen"}}},engineDoorOpen:{audio:"hatch-open",attachments:{cabin1:{composition:"battleship.firstCabin"},cabin1burn:null,cabin2burn:null,cabin2:{composition:"battleship.secondCabin",frame:["open",{easing:"easeInOutQuad",duration:2e3}]}}},engineTilt:{attachments:{cabin1:{composition:"battleship.firstCabin"},cabin1burn:null,cabin2burn:null,cabin2:{composition:"battleship.secondCabin",frame:["open",{easing:"easeInOutQuad",duration:2e3}]},engineCore:{composition:"battleship.engine",animation:"heavyShake",attachments:{smoke:{particles:{emitter:["smoke",{emitter:{w:60,amount:50}}]}}}}}},engineDestroyed:{audio:"explosion",attachments:{engineCore:{frame:"destroyed",animation:null,attachments:{explosion:{composition:"weapons.largeExplosion",animation:"default"}}}}},packageOpen:{attachments:{package:{frame:"down"},laserField:{entity:"LaserCannonForceField"}}},cabin1Explode:{attachments:{cabin1explode:{weapon:{pattern:"building.explosion",target:"PlayerShip",angle:0,active:!0}},cabin1burn:{particles:{emitter:["smoke",{emitter:{w:160}}]}},cabin1burn2:{particles:{emitter:["largeFire",{emitter:{w:160}}]}}}},cabin1Smoke:{attachments:{cabin1:{composition:"battleship.firstCabinDestroyed"},cabin1burn:{particles:{emitter:["smoke",{emitter:{w:160}}]}},cabin1burn2:{particles:{emitter:["largeFire",{emitter:{w:160}}]}}}},cabin2Explode:{attachments:{cabin2explode:{weapon:{pattern:"building.explosion2",target:"PlayerShip",angle:0,active:!0}},cabin2burn:{particles:{emitter:["smoke",{emitter:{w:220}}]}},cabin2burn2:{particles:{emitter:["largeFire",{emitter:{w:220}}]}}}},cabin2Smoke:{attachments:{cabin2:{composition:"battleship.secondCabinDestroyed"},cabin2burn:{particles:{emitter:["smoke",{emitter:{w:220}}]}},cabin2burn2:{particles:{emitter:["largeFire",{emitter:{w:220}}]}},engineCore:null}}},habitats:[{name:"Start",scenery:"city.Coast",position:{rx:.8,ry:.7},scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2]},{name:"Fase 1",scenery:"city.Coast",position:{rx:.5,ry:.7},scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2]},{name:"Fase 2",scenery:"city.Coast",position:{rx:-.17,ry:.65},scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2]},{name:"Fase 3",scenery:"city.Coast",position:{rx:-.7,ry:.7},scrollSpeed:{vx:100,vy:0},background:["city.Sunrise",2]},{name:"Sunk",scenery:"city.Coast",position:{rx:-.2,ry:.85},scrollSpeed:{vx:100,vy:0},background:["city.Sunrise",2]}]}},id={};d(id),p(id,"default",()=>ip);var ip={BulletCannon:{structure:{composition:"bulletCannon",attachments:{gun:{weapon:{pattern:"cannon.gun",target:"PlayerShip",angle:0,barrel:"barrel"}},smoke:null}},states:{mirrored:{frame:"mirrored"},dead:{animation:"dead",audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{smoke:{particles:{emitter:["smoke",{emitter:{w:10,h:2,amount:100,duration:6e3}}]}},smoke2:{particles:{emitter:"smokePlume"}},fire:{particles:{emitter:"smallFire"}},gun:null,explosion:{composition:"explosion",animation:"default"}}},shells:{attachments:{explosion:{particles:{emitter:["shells",{emitter:{w:10,h:10,amount:170,duration:200}}]}}}},noshells:{attachments:{explosion:null}},shooting:{attachments:{gun:{weapon:{active:!0}}}}}}},iy={};d(iy),p(iy,"default",()=>im);var im={BulletDrone:{structure:{composition:"bulletDrone",components:["DamageSupport","SolidCollision","PlayerEnemy","PlayerHit"],attachments:{gun:{weapon:{pattern:"bulletDrone.gun",target:"PlayerShip",angle:-5,barrel:"barrel"}},trail:{particles:{emitter:"bulletDrone.trail"}}}},states:{turned:{frame:"turned"},dead:{frame:"hidden",audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{trail:null,explosion:{composition:"explosion",animation:"default"},smoke:{particles:{emitter:"drone.smoke"}}}},shooting:{attachments:{gun:{weapon:{active:!0}}}}},habitats:[{name:"Bay",scenery:"city.Bay",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",3]}]}},ig={};d(ig),p(ig,"default",()=>iv);var iv={WarDrone:{structure:{composition:"drone",components:["DamageSupport","GravitySupport","SolidCollision","PlayerEnemy","PlayerHit"],attachments:{trail:{particles:{emitter:"drone.trail"}}}},states:{damaged:{frame:"damaged",attachments:{trail:null}},turned:{frame:"turned"},dead:{frame:"hidden",audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{trail:null,explosion:{composition:"explosion",animation:"default"},smoke:{particles:{emitter:"drone.smoke"}}}}},habitats:[{name:"Ocean",scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2]},{name:"Bay",scenery:"city.Bay",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",3]}]}},iw={};d(iw),p(iw,"default",()=>ix);var ix={DroneShip:{structure:{composition:"droneShip.main",components:["ShipSolid",["HideBelow",{hideBelow:540,z:-12}]],attachments:{bottom:{particles:{emitter:["waterSplashes",{emitter:{w:550,amount:300,warmed:!0}}]}},hatch1:{composition:"shipHatch"},gun:{entity:"BulletCannon"},boxLocation1:{entity:"ShipBoxes"},radar:{entity:"Radar",state:"stopPulse"}}},states:{t1o:{attachments:{hatch1:{frame:"open"}}},t1r:{attachments:{hatch1:{frame:"risen"}}},activateGun:{attachments:{gun:{state:"shooting"}}},deactivateGun:{attachments:{gun:{state:"default"}}},gunDestroyed:{attachments:{gun:{state:"dead"}}},radarPulse:{attachments:{radar:{state:"pulse"}}},radarStopPulse:{attachments:{radar:{state:"stopPulse"}}},radarDestroyed:{attachments:{radar:{state:"dead"}}}},habitats:[{name:"Ocean",scenery:"city.Ocean",position:{rx:.3,ry:.7},scrollSpeed:{vx:-40,vy:0},background:["city.Sunrise",1]}]}},i_={};d(i_),p(i_,"default",()=>ib);var ib={Helicopter:{structure:{composition:"helicopter",components:["DamageSupport","GravitySupport","SunBlock"],attachments:{gun:{weapon:{pattern:"heli.gun",target:"PlayerShip",angle:-5,barrel:"barrel"}},rockets:{weapon:{pattern:"heli.rocket",target:"PlayerShip"}},smoke:null}},states:{damaged:{frame:"damaged"},fire:{attachments:{fire:{particles:{emitter:"smallFire"}},smoke2:{particles:{emitter:"smokePlume"}}}},crashed:{frame:"damaged",attachments:{smoke:{particles:{emitter:["smoke",{emitter:{w:50,h:10,amount:100,duration:2e3}}]}}}},landed:{frame:"landed"},foreground:{frame:"foreground"},dead:{frame:"damaged",animation:null,audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{rockets:{weapon:{active:!1},composition:"explosion",animation:"default"},smoke:{particles:{emitter:["smoke",{emitter:{w:50,h:10,amount:100}}]}},gun:null}},flying:{animation:"flying"},toForeground:{animation:"turning"},tilted:{frame:"tilted"},leveled:{frame:"leveled"},turning:{animation:"turnAround",gun:{weapon:{active:!1}},rockets:{weapon:{active:!1}}},shooting:{animation:"flying",attachments:{gun:{weapon:{active:!0}},rockets:{weapon:{active:!0}}}}},habitats:[{name:"Ocean",scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",1]}]}},iS={};d(iS),p(iS,"default",()=>iC);var iC={LargeDrone:{structure:{composition:"largeDrone",components:["DamageSupport","GravitySupport","SolidCollision","PlayerEnemy"],attachments:{trail:{particles:{emitter:"largeDrone.trail"}},rockets:{weapon:{pattern:"largeDrone.homingRocket",target:"PlayerShip"}},rockets2:{weapon:{pattern:"largeDrone.rockets",target:"PlayerShip"}}}},states:{eyeMove:{animation:"eye"},laugh:{animation:"laugh",audio:"laugh"},reload:{animation:"rocketReload"},shootRockets:{attachments:{rockets:{weapon:{active:!0,maxBursts:1}}}},rocketStrike:{attachments:{rockets2:{weapon:{active:!0,maxBursts:1}}}},fireRocket:{animation:"rocketShot"},reloadRocket:{animation:"rocketReload"},damaged:{frame:"damaged",attachments:{trail:null}},turned:{frame:"turned"},dead:{frame:"hidden",audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{trail:null,explosion:{composition:"explosion",animation:"default"},smoke:{particles:{emitter:"drone.smoke"}}}}},habitats:[{name:"Bridge",scenery:"city.Bridge",scrollSpeed:{vx:0,vy:0},background:["city.Sunrise",3]}]},LargeBackgroundDrone:{structure:{composition:"largeDrone",frame:"background",components:[],attachments:{trail:{particles:{emitter:["largeDrone.trail",{gravity:[200,50],particle:{velocity:15,startSize:15,endSize:8}}]}},gun:{weapon:{pattern:"largeDrone.takeover",target:"IntroHeliBackground"}}}},states:{eyeMove:{animation:"eye"},turned:{frame:"turned"},shoot:{attachments:{gun:{weapon:{active:!0}}}}},habitats:[{name:"Ocean",scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",1]}]}},ik={};d(ik),p(ik,"default",()=>iD);var iD={LaserCannon:{structure:{composition:"laserCannon",attachments:{gun:{weapon:{pattern:"cannon.laser",target:"PlayerShip",angle:0,barrel:"barrel"}},smoke:null}},states:{mirrored:{frame:"mirrored"},close:{frame:["close",{duration:300}],attachments:{gun:null,charge:null}},open:{frame:["open",{duration:300}]},charge:{attachments:{charge:{particles:{emitter:"laserCharge"}}}},charged:{frame:"charge",attachments:{charge:null}},discharge:{frame:"done",attachments:{charge:null,discharge:{particles:{emitter:["smoke",{emitter:{w:10,h:2,amount:200,duration:300}}]}}}},dead:{animation:"dead",audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{smoke:{particles:{emitter:["smoke",{emitter:{w:10,h:2,amount:100,duration:3e3}}]}},charge:null,gun:null,explosion:{composition:"explosion",animation:"default"}}},shooting:{attachments:{gun:{weapon:{active:!0}}}}},habitats:[{name:"test walls",scenery:"test.Walls",position:{rx:.4,ry:.6},scrollSpeed:{vx:0,vy:0}}]},LaserCannonForceField:{structure:{particles:{emitter:["forceField",{emitter:{w:140,h:75,amount:200}}]},components:["SolidCollision"]},states:{stopped:{particles:{emitter:["forceFieldDisperse",{emitter:{w:140,h:75,amount:200,warmed:!0}}]}},started:{particles:{active:!0}}}}},iz={};d(iz),p(iz,"default",()=>iA);var iA={Mine:{structure:{composition:"mine",components:[["DamageSupport",{weight:20}],"SolidCollision",["SubmergeSupport",{submergeSprite:"shadow"}],"PlayerEnemy",["Rotating",{vr:0}]],attachments:{explosion:{}}},states:{rotate:{components:[["Rotating",{vr:40}]]},open:{animation:"opening"},blinking:{components:[["Rotating",{vr:120}]],animation:"blinking"},dead:{components:[["Rotating",{vr:0}]],frame:"hidden",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{explosion:{weapon:{pattern:"mine.explosion",target:"Jinte",angle:0,active:!0}},smoke:{particles:{emitter:["drone.smoke",{emitter:{w:60,h:60,amount:450,duration:600},particle:{startSize:30,endSize:20}}]}}}},explode:{components:[["Rotating",{vr:0}]],frame:"hidden",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{explosion:{weapon:{pattern:"mine.blast",target:"Jinte",angle:0,active:!0}},smoke:{particles:{emitter:["drone.smoke",{emitter:{w:60,h:60,amount:450,duration:600},particle:{startSize:30,endSize:20}}]}}}}},habitats:[{name:"Ocean",scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2]},{name:"Bay",scenery:"city.Bay",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",3]}]}},iP={};d(iP),p(iP,"default",()=>iF);var iF={MineCannon:{structure:{composition:"mineCannon",attachments:{smoke:null}},states:{dead:{frame:["dead",{duration:0}],animation:null,audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{smoke:{particles:{emitter:["smoke",{emitter:{w:10,h:2,amount:100,duration:3e3}}]}},gun:null,explosion:{composition:"explosion",animation:"default"}}},aimLow:{frame:["aimLow",{duration:1500}]},aimHigh:{frame:["aimHigh",{duration:1500}]},shoot:{animation:"blinking",audio:"explosion"}}}},iE={};d(iE),p(iE,"default",()=>iB);var iB={WarBird:{structure:{composition:"bird",components:["DamageSupport","GravitySupport","SolidCollision","SunBlock","PlayerEnemy","PlayerHit"],attachments:{trail:{particles:{emitter:"bird.trail"}}}},states:{damaged:{frame:"damaged",attachments:{trail:null}},turned:{frame:"turned"},dead:{frame:"hidden",audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{trail:null,explosion:{composition:"explosion",animation:"default"},smoke:{particles:{emitter:"drone.smoke"}}}}},habitats:[{name:"Garden",scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2]},{name:"Bay",scenery:"city.Bay",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",3]}]}},iT={};d(iT),p(iT,"default",()=>iM);var iM={WarFish:{structure:{composition:"fish",components:["DamageSupport","GravitySupport","SolidCollision","SunBlock","PlayerEnemy","PlayerHit"],attachments:{trail:{particles:{emitter:"fish.trail"}}}},states:{damaged:{frame:"damaged"},turned:{frame:"turned"},dead:{frame:"hidden",audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{trail:null,explosion:{composition:"explosion",animation:"default"},smoke:{particles:{emitter:"drone.smoke"}}}}},habitats:[{name:"Garden",scenery:"garden.Pond",scrollSpeed:{vx:-100,vy:0},background:["city.Sunset",1]},{name:"Bay",scenery:"city.Bay",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",3]}]}},iL={};d(iL),p(iL,"default",()=>iR);var iR={House:{structure:{composition:"town.roof",components:["ShipSolid"],attachments:{chimneyLoc:{composition:"town.chimney",attachments:{smokeLoc:{particles:{emitter:["smokePlume",{emitter:{warmed:!0}}]}}}}}},states:{dead:{animation:null,audio:"explosion",attachments:{explosionLoc:{composition:"explosion",animation:"default"},chimneyLoc:null}}},habitats:[{name:"Town",scenery:"town.RoofTops",position:{rx:.3,ry:.6},scrollSpeed:{vx:-40,vy:0},background:["city.Sunrise",4]}]},PresentGun:{structure:{composition:"town.chimneyMini",attachments:{gunLoc:{weapon:{pattern:"chimney.presents",target:"Jinte"}}}},states:{shooting:{animation:"shoot",attachments:{gunLoc:{weapon:{active:!0}}}},dead:{animation:null,frame:"dead",audio:"explosion",attachments:{explosionLoc:{composition:"explosion",animation:"default"},gunLoc:null}}}},HouseHostile:{structure:{composition:"town.roof",components:["ShipSolid"],attachments:{chimneyLoc:{composition:"town.chimney",attachments:{gunLoc:{weapon:{pattern:"chimney.presents",target:"Jinte"}}}}}},habitats:[{name:"Town",scenery:"town.RoofTops",position:{rx:.3,ry:.6},scrollSpeed:{vx:-40,vy:0},background:["city.Sunrise",4]}],states:{shooting:{attachments:{chimneyLoc:{animation:"shoot",attachments:{gunLoc:{weapon:{active:!0}}}}}},dead:{animation:null,audio:"explosion",attachments:{explosionLoc:{composition:"explosion",animation:"default"},chimneyLoc:null}}}}},iO={};d(iO),p(iO,"default",()=>ij);var ij={Jinte:{structure:{composition:"jinte",components:["ViewportLocked","DamageSupport","SunBlock","LaserSolid"],animation:null,attachments:{gun:{weapon:{pattern:"player.carrots",target:"PlayerEnemy",angle:180}},frontFoot:null,backFoot:null}},states:{dead:{frame:"hidden",audio:"explosion",attachments:{frontFoot:null,backFoot:null,gun:null,center:{composition:"weapons.largeExplosion",animation:"default"}}},damaged:{frame:"damaged"},shooting:{attachments:{gun:{weapon:{active:!0}}}},noShooting:{attachments:{gun:{weapon:{active:!1}}}},starting:{animation:"flying",attachments:{frontFoot:{particles:{emitter:["jinte.trail",{particle:{velocity:50,startSize:10},emitter:{amount:100}}]}},backFoot:{particles:{emitter:["jinte.trail",{particle:{velocity:50,startSize:10},emitter:{amount:100}}]}}}},flying:{animation:"flying",attachments:{frontFoot:{particles:{emitter:"jinte.trail"}},backFoot:{particles:{emitter:"jinte.trail"}}}},reverse:{attachments:{}},turned:{frame:"turned"},turning:{animation:"turnAround"},turningDamaged:{animation:"turnAroundDamaged"}},habitats:[{name:"Ocean",scenery:"City.Ocean",position:{x:200,y:380},scrollSpeed:{vx:-100,vy:0},background:["City.Sunrise",3]}]}},iH={};d(iH),p(iH,"default",()=>iI);var iI={Seagull:{structure:{composition:"seagull",components:["DamageSupport","GravitySupport","SolidCollision","SunBlock","PlayerEnemy","PlayerHit"],attachments:{gun:{weapon:{pattern:"seagull.flatsCannon",target:"Jinte"}}}},states:{shooting:{attachments:{gun:{weapon:{active:!0}}}},damaged:{frame:"damaged"},turned:{frame:"turned"},dead:{frame:"hidden",audio:"explosion",removeComponents:["SolidCollision","PlayerEnemy"],attachments:{gun:null,explosion:{composition:"explosion",animation:"default"},smoke:{particles:{emitter:"drone.smoke"}}}}},habitats:[{name:"Bay",scenery:"city.Bay",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",3]}]}};e6={PlayerShip:{PlayerShip:{js:e8}},common:{Radar:{js:e9},Weapons:{js:ie},powerups:{Powerups:{js:ia}}},intro:{IntroShip:{js:io}},scenery:{Sun:{js:il}},enemies:{BattleShip:{BattleShip:{js:ic}},BulletCannon:{BulletCannon:{js:id}},BulletDrone:{BulletDrone:{js:iy}},Drone:{Drone:{js:ig}},DroneShip:{DroneShip:{js:iw}},Helicopter:{Helicopter:{js:i_}},LargeDrone:{LargeDrone:{js:iS}},LaserCannon:{LaserCannon:{js:ik}},Mine:{Mine:{js:iz}},MineCannon:{MineCannon:{js:iP}}},sinterklaas:{Bird:{Bird:{js:iE}},Fish:{Fish:{js:iT}},House:{House:{js:iL}},Jinte:{Jinte:{js:iO}},Seagull:{Seagull:{js:iH}}}};var iG={},iq={};d(iq),p(iq,"default",()=>iU);var iU={"player.trail":{emitter:{w:2,h:2,amount:200,fidelity:"high",motionLocked:!1},particle:{sprite:"explosion7",angle:180,angleRandom:0,duration:500,durationRandom:0,velocity:200,velocityRandom:10,startSize:12,endSize:1,startColor:[1,.8,.5,.6],startColorRandom:[0,.05,0,0],endColor:[.9,.2,.2,0],endColorRandom:[0,0,0,0]}},"player.trail2":{emitter:{w:2,h:2,amount:200,fidelity:"high",motionLocked:!1},particle:{sprite:"explosion7",angle:180,angleRandom:0,duration:500,durationRandom:0,velocity:200,velocityRandom:10,startSize:8,endSize:1,startColor:[1,.8,.5,.6],startColorRandom:[0,.05,0,0],endColor:[.9,.2,.2,0],endColorRandom:[0,0,0,0]}},"player.reverse":{emitter:{w:2,h:2,amount:200,fidelity:"high",motionLocked:!1},particle:{sprite:"explosion7",angle:0,angleRandom:0,duration:500,durationRandom:0,velocity:200,velocityRandom:10,startSize:5,endSize:1,startColor:[1,.8,.5,.6],startColorRandom:[0,.05,0,0],endColor:[.9,.2,.2,0],endColorRandom:[0,0,0,0]}},"player.laserCharge":{emitter:{w:2,h:2,amount:70,reverse:!0},gravity:[0,10],particle:{sprite:"explosion7",angle:0,angleRandom:60,duration:500,durationRandom:0,velocity:100,velocityRandom:15,startSize:6,startSizeRandom:1,endSize:1,endSizeRandom:0,startColor:[1,.2,0,.8],startColorRandom:[.9,0,0,0],endColor:[1,1,.3,.2],endColorRandom:[0,0,0,0]}}},iN={};d(iN),p(iN,"default",()=>iV);var iV={"dust.bridge":{emitter:{w:1024,h:10,amount:300,fidelity:"low",duration:3e3},gravity:[0,95],particle:{sprite:"explosion7",angle:0,duration:4e3,angleRandom:20,velocity:10,startSize:40,startSizeRandom:15,endSize:20,endSizeRandom:5,startColor:[.17,.17,.17,.4],endColor:[.17,.17,.17,0]}}},iX={};d(iX),p(iX,"default",()=>iW);var iW={waterSplashes:{emitter:{w:1300,h:10,amount:500,fidelity:"low"},gravity:[-80,5],particle:{sprite:"explosion7",angle:0,angleRandom:20,velocity:10,startSize:30,endSize:30,startColor:[1,1,1,.8],endColor:[.8,.8,.8,0],endColorRandom:[.1,.1,0,.2]}},"missile.trail":{emitter:{w:2,h:2,amount:200,fidelity:"high",motionLocked:!1},gravity:[0,0],particle:{sprite:"explosion7",angle:0,angleRandom:0,duration:1300,durationRandom:0,velocity:0,velocityRandom:0,startSize:10,endSize:1,startColor:[.7,.7,.5,.6],startColorRandom:[0,0,0,0],endColor:[.3,.3,.3,0],endColorRandom:[0,0,0,0]}},explosion:{emitter:{w:2,h:2,amount:200,duration:500},gravity:[0,40],particle:{sprite:"explosion7",angles:[0,20,100,180,230,330],duration:1e3,durationRandom:0,velocity:50,velocityRandom:10,startSize:30,endSize:1,startColor:[.3,.2,.1,1],startColorRandom:[0,0,0,0],endColor:[.1,.1,.1,0],endColorRandom:[0,0,0,0]}},electric:{emitter:{w:70,h:15,amount:150,duration:1500},particle:{sprite:"explosion7",angle:0,angleRandom:20,duration:800,durationRandom:0,velocity:20,velocityRandom:0,startSize:4,startSizeRandom:2,endSize:2,endSizeRandom:1,startColor:[1,1,0,.4],startColorRandom:[0,0,0,0],endColor:[.2,.5,1,.1],endColorRandom:[0,0,0,0]}},sparks:{emitter:{w:2,h:2,amount:200,duration:350},gravity:[0,200],particle:{sprite:"explosion7",angle:0,angleRandom:70,duration:500,durationRandom:0,velocity:90,velocityRandom:0,startSize:2,startSizeRandom:0,endSize:3,endSizeRandom:2,startColor:[1,1,0,.6],startColorRandom:[0,0,0,0],endColor:[1,1,0,.2],endColorRandom:[0,0,0,0]}},laserHit:{emitter:{w:4,h:4,amount:200,duration:500},gravity:[0,100],particle:{sprite:"explosion7",angle:0,angleRandom:70,duration:500,durationRandom:0,velocity:50,velocityRandom:0,startSize:10,startSizeRandom:4,endSize:4,endSizeRandom:2,startColor:[1,.4,0,.8],startColorRandom:[.2,.1,0,0],endColor:[1,.4,0,.2],endColorRandom:[0,0,0,0]}},smoke:{emitter:{w:160,h:20,amount:300},gravity:[20,-60],particle:{sprite:"explosion7",angle:0,angleRandom:20,duration:2500,durationRandom:500,velocity:10,startSize:30,endSize:80,startColor:[.1,.1,.1,1],startColorRandom:[0,0,0,.2],endColor:[.1,.1,.1,0],endColorRandom:[0,0,0,0]}},largeFire:{emitter:{w:200,h:2,amount:70,fidelity:"high"},gravity:[0,-300],particle:{sprite:"explosion7",angle:0,angleRandom:200,duration:750,durationRandom:300,velocity:20,velocityRandom:20,startSize:30,endSize:3,startColor:[.8,.7,.1,.6],startColorRandom:[0,0,0,0],endColor:[.8,.7,.1,0],endColorRandom:[0,0,0,0]}},"test.fountain":{emitter:{w:10,h:10,amount:300},gravity:[0,90],particle:{sprite:"explosion7",angle:-90,angleRandom:50,velocity:120,startSize:10,endSize:10,startColor:[1,1,1,.8],startColorRandom:[0,.1,0,.2],endColor:[.1,.1,.1,0],endColorRandom:[0,0,0,.2]}},forceField:{emitter:{w:200,h:150,amount:170},particle:{sprite:"explosion7",angle:0,angleRandom:180,duration:800,velocity:2,startSize:2,endSize:4,startColor:[.7,.7,1,.8],startColorRandom:[0,0,0,0],endColor:[.2,.2,.4,0],endColorRandom:[0,0,0,0]}},forceFieldDisperse:{emitter:{w:200,h:150,amount:170,duration:1e3},gravity:[0,-50],particle:{sprite:"explosion7",angle:0,angleRandom:180,duration:800,velocity:8,startSize:2,endSize:2,startColor:[.7,.7,1,.8],startColorRandom:[0,0,0,0],endColor:[.8,.9,.3,1],endColorRandom:[0,0,0,0]}},smallFire:{emitter:{w:2,h:2,amount:50,fidelity:"high"},gravity:[0,-600],particle:{sprite:"explosion7",angle:0,angleRandom:200,duration:250,durationRandom:0,velocity:20,velocityRandom:10,startSize:10,endSize:3,startColor:[.8,.7,.1,.6],startColorRandom:[0,0,0,0],endColor:[.8,.7,.1,0],endColorRandom:[0,0,0,0]}},smokePlume:{emitter:{w:2,h:2,amount:50,fidelity:"high"},gravity:[0,-80],particle:{sprite:"explosion7",angle:0,angleRandom:10,duration:1500,durationRandom:100,velocity:10,startSize:10,endSize:30,startColor:[.1,.1,.1,.5],startColorRandom:[0,0,0,.1],endColor:[.1,.1,.1,0],endColorRandom:[0,0,0,0]}}},iY={};d(iY),p(iY,"default",()=>iK);var iK={"powerup.pickup":{emitter:{w:2,h:2,amount:600,duration:200},gravity:[0,-50],particle:{sprite:"explosion7",angle:0,angleRandom:360,duration:1e3,durationRandom:0,velocity:120,velocityRandom:40,startSize:15,endSize:5,startColor:[.7,.1,.1,.6],endColor:[.7,.3,.3,0]}}},iJ={};d(iJ),p(iJ,"default",()=>i$);var i$={shells:{emitter:{w:10,h:10,amount:170,duration:200},gravity:[0,160],particle:{sprite:"bulletShell",angle:-50,angleRandom:20,duration:1200,velocity:120,startSize:20,endSize:20,startColor:[.5,.6,.2,1],endColor:[.5,.6,.2,.3]}}},iQ={};d(iQ),p(iQ,"default",()=>iZ);var iZ={"bulletDrone.trail":{emitter:{w:2,h:2,amount:50,fidelity:"high",motionLocked:!1},gravity:[0,0],particle:{sprite:"explosion7",angle:0,angleRandom:0,duration:250,durationRandom:0,velocity:0,velocityRandom:10,startSize:10,endSize:1,startColor:[.5,.9,.5,.6],startColorRandom:[0,0,0,0],endColor:[.2,.9,.2,0],endColorRandom:[0,0,0,0]}},"drone.smoke":{emitter:{w:2,h:2,amount:400,duration:300},gravity:[-100,0],particle:{sprite:"explosion7",angle:0,angleRandom:360,duration:1800,durationRandom:0,velocity:10,velocityRandom:5,startSize:15,endSize:5,startColor:[.05,.05,.05,.6],startColorRandom:[0,0,0,0],endColor:[.05,.05,.05,0],endColorRandom:[0,0,0,0]}}},i0={};d(i0),p(i0,"default",()=>i1);var i1={"drone.trail":{emitter:{w:2,h:2,amount:50,fidelity:"high",motionLocked:!1},gravity:[0,0],particle:{sprite:"explosion7",angle:0,angleRandom:0,duration:250,durationRandom:0,velocity:0,velocityRandom:10,startSize:10,endSize:1,startColor:[.5,.5,.9,.6],startColorRandom:[0,0,0,0],endColor:[.2,.2,.9,0],endColorRandom:[0,0,0,0]}},"drone.smoke":{emitter:{w:2,h:2,amount:400,duration:300},gravity:[-100,0],particle:{sprite:"explosion7",angle:0,angleRandom:360,duration:1800,durationRandom:0,velocity:10,velocityRandom:5,startSize:15,endSize:5,startColor:[.05,.05,.05,.6],startColorRandom:[0,0,0,0],endColor:[.05,.05,.05,0],endColorRandom:[0,0,0,0]}}},i2={};d(i2),p(i2,"default",()=>i5);var i5={"largeDrone.trail":{emitter:{w:2,h:2,amount:50,fidelity:"high"},gravity:[0,0],particle:{sprite:"explosion7",angle:0,angleRandom:0,duration:150,durationRandom:0,velocity:100,velocityRandom:10,startSize:30,endSize:15,startColor:[.7,.7,.9,.5],startColorRandom:[0,0,0,0],endColor:[.35,.35,.45,0],endColorRandom:[0,0,0,0]}}},i3={};d(i3),p(i3,"default",()=>i4);var i4={laserCharge:{emitter:{w:2,h:2,amount:70,reverse:!0},gravity:[0,10],particle:{sprite:"explosion7",angle:0,angleRandom:360,duration:800,durationRandom:0,velocity:100,velocityRandom:15,startSize:6,startSizeRandom:1,endSize:1,endSizeRandom:0,startColor:[1,.2,0,.8],startColorRandom:[0,0,0,0],endColor:[1,1,0,.2],endColorRandom:[0,0,0,0]}}},i6={};d(i6),p(i6,"default",()=>i8);var i8={"bird.trail":{emitter:{w:2,h:2,amount:50,fidelity:"high",motionLocked:!1},gravity:[0,0],particle:{sprite:"explosion7",angle:0,angleRandom:0,duration:350,durationRandom:0,velocity:30,velocityRandom:10,startSize:10,endSize:1,startColor:[.9,.9,.5,.6],startColorRandom:[0,0,0,0],endColor:[.9,.9,.9,0],endColorRandom:[0,0,0,0]}},"drone.smoke":{emitter:{w:2,h:2,amount:400,duration:300},gravity:[-100,0],particle:{sprite:"explosion7",angle:0,angleRandom:360,duration:1800,durationRandom:0,velocity:10,velocityRandom:5,startSize:15,endSize:5,startColor:[.05,.05,.05,.6],startColorRandom:[0,0,0,0],endColor:[.05,.05,.05,0],endColorRandom:[0,0,0,0]}}},i7={};d(i7),p(i7,"default",()=>i9);var i9={"fish.trail":{emitter:{w:2,h:2,amount:100,duration:6e3,fidelity:"high",motionLocked:!1},gravity:[0,160],particle:{sprite:"explosion7",angle:20,angleRandom:0,duration:1550,durationRandom:0,velocity:100,velocityRandom:10,startSize:30,endSize:1,startColor:[1,1,1,.6],startColorRandom:[0,0,0,0],endColor:[1,1,1,0],endColorRandom:[0,0,0,0]}}},at={};d(at),p(at,"default",()=>ae);var ae={"jinte.trail":{emitter:{w:2,h:2,amount:100,fidelity:"high",motionLocked:!1},particle:{sprite:"explosion7",angle:180,angleRandom:0,duration:1500,durationRandom:0,velocity:80,velocityRandom:10,startSize:12,endSize:7,startColor:[.9,.9,.9,.6],startColorRandom:[0,.05,0,0],endColor:[.7,.7,.7,0],endColorRandom:[0,0,0,0]}}};iG={PlayerShip:{player:{js:iq}},common:{dust:{js:iN},unsorted:{js:iX},powerups:{powerups:{js:iY}}},enemies:{BulletCannon:{bulletCannon:{js:iJ}},BulletDrone:{bulletDrone:{js:iQ}},Drone:{drone:{js:i0}},LargeDrone:{largeDrone:{js:i2}},LaserCannon:{laserCannon:{js:i3}}},sinterklaas:{Bird:{bird:{js:i6}},Fish:{fish:{js:i7}},Jinte:{jinte:{js:at}}}};var ai={},aa={};d(aa),p(aa,"default",()=>ar);var ar={"mineCannon.lowShot":{path:[{x:.8,y:.6,events:[[.8,{event:"Loose"}]]},{x:.7,y:.6},{x:.6,y:.9}]},"mineCannon.highShot":{path:[{x:.8,y:.6,events:[[.8,{event:"Loose"}]]},{x:.6,y:.3},{x:.3,y:.5},{x:.1,y:.9}]},sunset:{path:[{x:.4,y:.1},{x:.8,y:.3},{x:.9,y:.7}]},sunrise:{path:[{x:.9,y:.7},{x:.8,y:.3},{x:.4,y:.1}]},moonrise:{path:[{x:.1,y:.7},{x:.2,y:.3},{x:.3,y:.1}]},evadePattern:{path:[{x:.5,y:.5},{x:.9,y:.2},{x:.7,y:.8},{x:.5,y:.2},{x:.3,y:.8},{x:.1,y:.5},{x:.3,y:.2},{x:.9,y:.5},{x:.4,y:.9},{x:.5,y:.5}]}},an={};d(an),p(an,"default",()=>ao);var ao={"powerup.circles":{path:[{x:.5,y:.5},{x:.51,y:.51},{x:.48,y:.52},{x:.47,y:.47},{x:.55,y:.45},{x:.57,y:.57},{x:.41,y:.59},{x:.39,y:.39},{x:.5,y:.5}]},"powerup.short":{path:[{x:.51,y:.51},{x:.48,y:.52},{x:.47,y:.47},{x:.5,y:.45},{x:.51,y:.51}]}},as={};d(as),p(as,"default",()=>al);var al={playerLiftOff:{path:[{x:.2,y:.6},{x:.19,y:.56},{x:.2,y:.55}]},"intro.HeliLiftOff":{path:[{x:.3,y:.6},{x:.32,y:.46},{x:.3,y:.35},{x:.15,y:.4},{x:-.25,y:.35}]},"intro.HeliBackground":{path:[{x:-.3,y:.3},{x:.1,y:.37},{x:.4,y:.3}]},"intro.HeliBackgroundCrash":{path:[{x:.4,y:.3},{x:.35,y:.35,events:[[.9,{event:"Escape1"}]]},{x:.45,y:.4},{x:.5,y:.3},{x:.45,y:.2,events:[[.5,{event:"Escape2"}]]},{x:.4,y:.25,events:[[.8,{event:"Escape3"}]]},{x:1.2,y:.2}]},"intro.DroneBackground":{path:[{x:1.1,y:.3},{x:.9,y:.2},{x:.7,y:.3,events:[[0,{setState:["shoot",0]}]]},{x:.7,y:.47,events:[[.6,{setState:["turned",0]}],[.7,{setState:["eyeMove",0]}]]},{x:.8,y:.3},{x:.95,y:.15},{x:1.2,y:.1}]}},ah={};d(ah),p(ah,"default",()=>ac);var ac={"bulletDrone.straight":{habitat:{scenery:"city.Bay",scrollSpeed:{vx:-150,vy:0},background:["city.Sunrise",3],entity:"BulletDrone"},path:[{x:1.1,y:.5,events:[[.1,{setState:["shooting",500]}]]},{x:-.1,y:.5}]},"bulletDrone.pattern1":{path:[{x:1.1,y:.5},{x:.9,y:.2},{x:.7,y:.8},{x:.5,y:.2},{x:.3,y:.8},{x:.1,y:.5,events:[[.2,{setState:["turned",500]}]]},{x:.3,y:.2,events:[[.9,{setState:["turned",500]}]]},{x:.9,y:.5},{x:-.1,y:.6}]},"bulletDrone.pattern2":{path:[{x:1.1,y:.5},{x:.5,y:.7},{x:.1,y:.5,events:[[.1,{setState:["turned",500]}]]},{x:.3,y:.2},{x:.8,y:.2,events:[[.6,{setState:["turned",500]}]]},{x:.9,y:.4},{x:.4,y:.5},{x:-.1,y:.2}]}},au={};d(au),p(au,"default",()=>ad);var ad={"drone.straight":{habitat:{scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarDrone"},path:[{x:1.1,y:.5},{x:-.1,y:.5}]},"drone.pattern1":{habitat:{scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarDrone"},path:[{x:1.1,y:.5},{x:.9,y:.2},{x:.7,y:.8},{x:.5,y:.2},{x:.3,y:.8},{x:.1,y:.5,events:[[.2,{setState:["turned",500]}]]},{x:.3,y:.2,events:[[.9,{setState:["turned",500]}]]},{x:.9,y:.5},{x:-.1,y:.6}]},"drone.pattern2":{habitat:{scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarDrone"},path:[{x:1.1,y:.5},{x:.5,y:.7},{x:.1,y:.5,events:[[.1,{setState:["turned",500]}]]},{x:.3,y:.2},{x:.8,y:.2,events:[[.6,{setState:["turned",500]}]]},{x:.9,y:.4},{x:.4,y:.5},{x:-.1,y:.2}]},"drone.pattern3":{habitat:{scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarDrone"},path:[{x:.5,y:-.1},{x:.5,y:.2},{x:.7,y:.31},{x:.8,y:.5},{x:.5,y:.5},{x:-.1,y:.3}]},"drone.pattern4":{habitat:{scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarDrone"},path:[{x:.5,y:1.11},{x:.5,y:.8},{x:.7,y:.8},{x:.93,y:.69},{x:.8,y:.5},{x:.5,y:.5},{x:-.1,y:.7}]},"drone.pattern5":{habitat:{scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarDrone"},path:[{x:-.2,y:.5,events:[[0,{setState:["turned",0]}]]},{x:.5,y:.8},{x:.93,y:.69,events:[[0,{setState:["turned",0]}]]},{x:.8,y:.5},{x:.5,y:.5},{x:-.1,y:.7}]},"drone.pattern6":{habitat:{scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarDrone"},path:[{x:1.1,y:.2},{x:.2,y:.4,events:[[0,{setState:["turned",0]}]]},{x:.6,y:.2},{x:1.1,y:.2}]}},ap={};d(ap),p(ap,"default",()=>ay);var ay={"heli.pattern1":{habitat:{scenery:"city.Ocean",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"Helicopter",entityState:"flying"},path:[{x:1.1,y:.5},{x:.9,y:.4},{x:.8,y:.2},{x:.9,y:.1},{x:.9,y:.3},{x:.5,y:.3},{x:.5,y:.1},{x:.6,y:.3},{x:.7,y:.7},{x:.8,y:.5}]},"heli.repeat1":{path:[{x:.8,y:.5},{x:.9,y:.3},{x:.8,y:.2},{x:.7,y:.4},{x:.8,y:.5}]},"heli.repeat2":{path:[{x:.8,y:.5},{x:.9,y:.4},{x:.8,y:.3},{x:.7,y:.4},{x:.9,y:.6},{x:.7,y:.7},{x:.8,y:.5}]},"heli.battleship1":{path:[{x:.38,y:.73,events:[[.5,{event:"detach"}],[.8,{setState:["leveled",1e3]}]]},{x:.38,y:.5},{x:.2,y:.4,events:[[.1,{setState:["turning",1e3]}]]},{x:.3,y:.3},{x:.7,y:.4,events:[[0,{setState:["turning",1e3]}]]},{x:.7,y:.2,events:[[0,{setState:["toForeground",1e3]}],[.1,{setState:["foreground",1e3]}],[.8,{setState:["flying",1e3]}],[.8,{setState:["shooting",1e3]}],[.8,{event:"active"}]]},{x:.6,y:.4},{x:.7,y:.4},{x:.6,y:.2}]},"heli.battleship2a":{path:[{x:.38,y:.73,events:[[.5,{event:"detach"}],[.8,{setState:["leveled",1e3]}]]},{x:.38,y:.5},{x:.2,y:.4,events:[[.1,{setState:["turning",1e3]}],[.7,{event:"moveShip"}]]},{x:.3,y:.3},{x:.6,y:.2}]},"heli.battleship2b":{path:[{x:.6,y:.2},{x:.7,y:.4,events:[[0,{setState:["turning",1e3]}]]},{x:.7,y:.2,events:[[0,{setState:["toForeground",1e3]}],[.1,{setState:["foreground",1e3]}],[.8,{setState:["flying",1e3]}],[.8,{setState:["shooting",1e3]}],[.8,{event:"active"}]]},{x:.6,y:.4},{x:.65,y:.4},{x:.7,y:.3}]},"heli.battleship2c":{path:[{x:.8,y:.3},{x:.7,y:.4},{x:.8,y:.5},{x:.85,y:.4},{x:.8,y:.3}]}},am={};d(am),p(am,"default",()=>af);var af={"largeDrone.intro":{habitat:{scenery:"city.Bridge",scrollSpeed:{vx:0,vy:0},background:["city.Sunrise",3],entity:"LargeDrone"},path:[{x:1.1,y:.2},{x:.8,y:.5},{x:.7,y:.4}]},"largeDrone.eight":{path:[{x:.7,y:.4},{x:.65,y:.3},{x:.7,y:.2},{x:.75,y:.3},{x:.65,y:.5},{x:.7,y:.6},{x:.75,y:.5},{x:.7,y:.4}]},"largeDrone.eight2":{path:[{x:.8,y:.4},{x:.65,y:.2},{x:.7,y:.1},{x:.85,y:.2},{x:.65,y:.5},{x:.8,y:.7},{x:.85,y:.5},{x:.8,y:.4}]}},ag={};d(ag),p(ag,"default",()=>av);var av={"bird.straight":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarBird"},path:[{x:1.1,y:.5},{x:-.1,y:.5}]},"bird.pattern1":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarBird"},path:[{x:1.1,y:.5},{x:.9,y:.2},{x:.7,y:.8},{x:.5,y:.2},{x:.3,y:.8},{x:.1,y:.5,events:[[.2,{setState:["turned",500]}]]},{x:.3,y:.2,events:[[.9,{setState:["turned",500]}]]},{x:.9,y:.5},{x:-.1,y:.6}]},"bird.pattern2":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarBird"},path:[{x:1.1,y:.5},{x:.5,y:.7},{x:.1,y:.5,events:[[.1,{setState:["turned",500]}]]},{x:.3,y:.2},{x:.8,y:.2,events:[[.6,{setState:["turned",500]}]]},{x:.9,y:.4},{x:.4,y:.5},{x:-.1,y:.2}]},"bird.pattern3":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarBird"},path:[{x:.5,y:-.1},{x:.5,y:.2},{x:.7,y:.31},{x:.8,y:.5},{x:.5,y:.5},{x:-.1,y:.3}]},"bird.pattern4":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarBird"},path:[{x:.5,y:1.11},{x:.5,y:.8},{x:.7,y:.8},{x:.93,y:.69},{x:.8,y:.5},{x:.5,y:.5},{x:-.1,y:.7}]},"bird.pattern5":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarBird"},path:[{x:-.2,y:.5,events:[[0,{setState:["turned",0]}]]},{x:.5,y:.8},{x:.93,y:.69,events:[[0,{setState:["turned",0]}]]},{x:.8,y:.5},{x:.5,y:.5},{x:-.1,y:.7}]},"bird.pattern6":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"WarBird"},path:[{x:1.1,y:.2},{x:.2,y:.4,events:[[0,{setState:["turned",0]}]]},{x:.6,y:.2},{x:1.1,y:.2}]}},aw={};d(aw),p(aw,"default",()=>ax);var ax={"fish.pattern1":{habitat:{scenery:"garden.Pond",scrollSpeed:{vx:-100,vy:0},background:["city.Sunset",1],entity:"WarFish"},path:[{x:.8,y:.95},{x:.6,y:.4},{x:.3,y:1.1}]},"fish.pattern2":{habitat:{scenery:"garden.Pond",scrollSpeed:{vx:-100,vy:0},background:["city.Sunset",1],entity:"WarFish"},path:[{x:.1,y:.95,events:[[0,{setState:["turned",500]}]]},{x:.4,y:.1},{x:.8,y:1.1}]}},a_={};d(a_),p(a_,"default",()=>ab);var ab={"house.straight":{habitat:{scenery:"town.RoofTops",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",4],entity:"HouseHostile"},path:[{x:1.1,y:.5},{x:-.6,y:.5}]}},aS={};d(aS),p(aS,"default",()=>aC);var aC={"seagull.pattern1":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"Seagull"},path:[{x:1.1,y:.5},{x:.9,y:.2},{x:.7,y:.8},{x:.5,y:.2},{x:.3,y:.8},{x:.1,y:.5,events:[[.2,{setState:["turned",500]}]]},{x:.3,y:.2,events:[[.9,{setState:["turned",500]}]]},{x:.9,y:.5},{x:-.1,y:.6}]},"seagull.pattern2":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"Seagull"},path:[{x:1.1,y:.5},{x:.5,y:.7},{x:.1,y:.5,events:[[.1,{setState:["turned",500]}]]},{x:.3,y:.2},{x:.8,y:.2,events:[[.6,{setState:["turned",500]}]]},{x:.9,y:.4},{x:.4,y:.5},{x:-.1,y:.2}]},"seagull.pattern3":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"Seagull"},path:[{x:.5,y:-.1},{x:.5,y:.2},{x:.7,y:.31},{x:.8,y:.5},{x:.5,y:.5},{x:-.1,y:.3}]},"seagull.pattern4":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"Seagull"},path:[{x:.5,y:1.11},{x:.5,y:.8},{x:.7,y:.8},{x:.93,y:.69},{x:.8,y:.5},{x:.5,y:.5},{x:-.1,y:.7}]},"seagull.pattern5":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"Seagull"},path:[{x:-.2,y:.5,events:[[0,{setState:["turned",0]}]]},{x:.5,y:.8},{x:.93,y:.69,events:[[0,{setState:["turned",0]}]]},{x:.8,y:.5},{x:.5,y:.5},{x:-.1,y:.7}]},"seagull.pattern6":{habitat:{scenery:"garden.Grass",scrollSpeed:{vx:-100,vy:0},background:["city.Sunrise",2],entity:"Seagull"},path:[{x:1.1,y:.2},{x:.2,y:.4,events:[[0,{setState:["turned",0]}]]},{x:.6,y:.2},{x:1.1,y:.2}]}};ai={common:{unsorted:{js:aa},powerups:{powerups:{js:an}}},intro:{intro:{js:as}},enemies:{BulletDrone:{bulletDrone:{js:ah}},Drone:{drone:{js:au}},Helicopter:{helicopter:{js:ap}},LargeDrone:{largeDrone:{js:am}}},sinterklaas:{Bird:{bird:{js:ag}},Fish:{fish:{js:aw}},House:{House:{js:a_}},Seagull:{seagull:{js:aS}}}};var ak={},aD={};d(aD),p(aD,"default",()=>az);var az={"city.CoastWithCloud":{width:1023,height:576,right:"city.Coast",left:"city.Coast",backgrounds:[["city.Sunrise",2]],altitudes:[0,100],elements:[{x:0,y:-85,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:-165,composition:"city.cloud",distance:.1,frame:"default"},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25},{x:0,y:-46,composition:"city.horizon",distance:.25}]},"city.CoastWithCloud2":{width:1023,height:576,right:"city.Coast",left:"city.Coast",backgrounds:[["city.Sunrise",2]],altitudes:[0,100],elements:[{x:0,y:-85,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:-265,composition:"city.cloud",distance:.2,frame:"close"},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25},{x:0,y:-46,composition:"city.horizon",distance:.25}]},"city.Coast":{width:1023,height:576,right:{"city.CoastWithCloud":.1,"city.CoastWithCloud2":.1,"city.Coast":.8},left:{"city.CoastWithCloud":.1,"city.CoastWithCloud2":.1,"city.Coast":.8},backgrounds:[["city.Sunrise",2]],altitudes:[0,100],elements:[{x:0,y:-85,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25},{x:0,y:-46,composition:"city.horizon",distance:.25}]},"city.CoastStart":{width:1023,height:576,right:"city.Coast",left:"city.Ocean",backgrounds:[["city.Sunrise",1]],altitudes:[0,250],elements:[{x:0,y:-85,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25},{x:0,y:-46,composition:"city.horizonStart",distance:.25}]},"city.CoastEnd":{width:1023,height:576,right:"city.Ocean",left:"city.Coast",backgrounds:[["city.Sunset",3]],altitudes:[0,250],elements:[{x:0,y:-85,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25},{x:0,y:-46,composition:"city.horizonStart",frame:"flipped",distance:.25}]},"city.OceanWithCloud":{width:1023,height:576,right:"city.Ocean",left:"city.Ocean",backgrounds:[["city.Sunrise",0]],altitudes:[0,250],elements:[{x:0,y:-85,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:-165,composition:"city.cloud",distance:.1,frame:"default"},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25}]},"city.OceanWithCloud2":{width:1023,height:576,right:"city.Ocean",left:"city.Ocean",backgrounds:[["city.Sunrise",0]],altitudes:[0,250],elements:[{x:0,y:-85,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:-265,composition:"city.cloud",distance:.2,frame:"close"},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25}]},"city.Ocean":{width:1023,height:576,right:{"city.OceanWithCloud":.1,"city.OceanWithCloud2":.1,"city.Ocean":.8},left:{"city.OceanWithCloud":.1,"city.OceanWithCloud2":.1,"city.Ocean":.8},backgrounds:[["city.Sunrise",0]],altitudes:[0,250],elements:[{x:0,y:-85,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25}]},"city.BayStart":{width:1023,height:576,right:"city.Bay",left:"city.Coast",backgrounds:[["city.Sunrise",2]],altitudes:[0,250],elements:[{x:0,y:-85,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25},{x:0,y:-46,composition:"city.horizon",distance:.25},{x:0,y:-148,composition:"city.cityStart",distance:.5}]},"city.BayEnd":{width:1023,height:576,right:"city.Coast",left:"city.Bay",backgrounds:[["city.Sunset",3]],altitudes:[0,250],elements:[{x:0,y:-85,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25},{x:0,y:-46,composition:"city.horizon",distance:.25},{x:0,y:-148,composition:"city.cityStart",frame:"flipped",distance:.5}]},"city.Bay":{width:1023,height:576,left:"city.Bay",right:"city.Bay",backgrounds:[["city.Sunrise",3]],altitudes:[0,250],elements:[{x:0,y:-85,z:-20,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-30,composition:"ocean.horizon",distance:.25},{x:0,y:-46,composition:"city.horizon",distance:.25},{x:0,y:-148,composition:"city.city",distance:.5},{x:0,y:-180,composition:"city.layer2",distance:.375},{x:240,y:-180,w:60,h:105,components:["SunBlock"],distance:.375}]},"city.BayFull":{width:1023,height:576,left:"city.BayFull",right:"city.BayFull",backgrounds:[["city.Sunrise",3]],altitudes:[0,250,500,700,900],elements:[{x:0,y:-85,z:-20,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-45,composition:"city.cityDistance",distance:.25},{x:0,y:-148,composition:"city.city",distance:.5},{x:0,y:-180,composition:"city.layer2",distance:.375},{x:240,y:-180,w:60,h:105,components:["SunBlock"],distance:.375}]}},aA={};d(aA),p(aA,"default",()=>aP);var aP={"city.Bridge":{width:1023,height:576,left:"city.Bay",right:"city.BayFull",backgrounds:[["city.Sunrise",3]],elements:[{x:0,y:-85,z:-20,composition:"ocean.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid","GravityLiquid"],w:1024,h:45,attributes:{liquidParticles:"waterSplashes",liquidDensity:8}},{x:0,y:5,composition:"ocean.middle",distance:.5},{x:0,y:-45,composition:"city.cityDistance",distance:.25},{x:0,y:-20,composition:"city.bridge.foot",distance:.5},{x:0,y:-710,z:300,components:["SunBlock","BridgeFrontDeck"],composition:["city.bridge.deck",{attributes:{scale:1.1},spriteAttributes:{accentColor:"#b15a5a",lightness:.6}}],distance:1.1},{x:0,y:-590,z:299,components:["PillarLeft"],composition:["city.bridge.pillar",{attributes:{scale:1.1},spriteAttributes:{lightness:.6}}],distance:1.1},{x:920,y:-590,z:299,components:["PillarRight"],composition:["city.bridge.pillar",{attributes:{scale:1.1},spriteAttributes:{lightness:.6,flipX:!0}}],distance:1.1},{x:0,y:-580,z:-40,components:["SunBlock","BridgeCeiling","ShipSolid"],composition:["city.bridge.deck",{spriteAttributes:{accentColor:"#2ba04c"}}],distance:1},{x:0,y:-460,z:-42,components:["SunBlock","BridgeCeilingBackground"],composition:["city.bridge.deck",{attributes:{scale:.9},spriteAttributes:{accentColor:"#b15a5a"}}],distance:.9},{x:0,y:-345,z:-44,components:["SunBlock"],composition:["city.bridge.deck",{attributes:{scale:.8},spriteAttributes:{accentColor:"#2ba04c"}}],distance:.8},{x:0,y:-240,z:-46,composition:["city.bridge.deck",{attributes:{scale:.7},spriteAttributes:{accentColor:"#b15a5a",horizon:[.2,.2]}}],distance:.7},{x:20,y:-190,z:-47,composition:["city.bridge.pillar",{attributes:{scale:.5},spriteAttributes:{horizon:[.2,.2]}}],distance:.7},{x:600,y:-190,z:-46,composition:["city.bridge.pillar",{attributes:{scale:.5},spriteAttributes:{horizon:[.2,.2],flipX:!0}}],distance:.7},{x:0,y:-160,z:-48,composition:["city.bridge.deck",{attributes:{scale:.62},spriteAttributes:{accentColor:"#2ba04c",horizon:[.3,.3]}}],distance:.62},{x:0,y:-90,z:-50,composition:["city.bridge.deck",{attributes:{scale:.55},spriteAttributes:{accentColor:"#b15a5a",horizon:[.3,.3]}}],distance:.55},{x:0,y:-40,z:-52,composition:["city.bridge.deck",{attributes:{scale:.5},spriteAttributes:{accentColor:"#2ba04c",horizon:[.4,.4]}}],distance:.5},{x:20,y:3,z:-54,composition:["city.bridge.smallPillar",{attributes:{scale:.3},spriteAttributes:{horizon:[.4,.4]}}],distance:.5},{x:430,y:3,z:-54,composition:["city.bridge.smallPillar",{attributes:{scale:.3},spriteAttributes:{horizon:[.4,.4],flipX:!0}}],distance:.5}]}},aF={};d(aF),p(aF,"sceneries",()=>aE),p(aF,"default",()=>aB);const aE={"garden.Grass":{width:1023,height:576,left:"garden.Grass",right:"garden.Grass",backgrounds:[["city.Sunrise",4]],altitudes:[0,250,400,700],elements:[{x:0,y:-65,composition:"grass.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid"],w:1024,h:45},{x:0,y:-50,composition:"grass.middle",distance:.75},{x:0,y:-100,composition:"grass.hedge",distance:.65},{x:0,y:65,z:-80,composition:"hills.horizon",distance:.1875}]},"garden.PondStart":{width:1023,height:576,left:"garden.Grass",right:"garden.Pond",backgrounds:[["city.Sunrise",4]],altitudes:[0,250,400,700],elements:[{x:0,y:-65,composition:"grass.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid"],w:1024,h:45},{x:0,y:-50,composition:"grass.pondStart",distance:.75},{x:0,y:-100,composition:"grass.hedge",distance:.65},{x:0,y:65,z:-80,composition:"hills.horizon",distance:.1875}]},"garden.Pond":{width:1023,height:576,right:"garden.Pond",left:"garden.Pond",backgrounds:[["city.Sunrise",4]],altitudes:[0,250,400,700],elements:[{x:0,y:-65,composition:"grass.front"},{x:0,y:-45,components:["ShipSolid","BulletSolid"],w:1024,h:45},{x:0,y:-50,composition:"grass.pond",distance:.75},{x:0,y:-100,composition:"grass.hedge",distance:.65},{x:0,y:-165,z:-30,composition:"town.middle",distance:.5},{x:0,y:35,z:-70,composition:"town.skyline",distance:.25},{x:0,y:65,z:-80,composition:"hills.horizon",distance:.1875}]}};var aB=aE,aT={};d(aT),p(aT,"default",()=>aM);var aM={"town.RoofTops":{width:1023,height:576,left:"town.RoofTops",right:"town.RoofTops",backgrounds:[["city.Sunset",1]],altitudes:[0,250,400,700],elements:[{x:0,y:-165,z:-30,composition:"town.middleFull",distance:.5},{x:0,y:35,z:-70,composition:"town.skyline",distance:.25},{x:0,y:65,z:-80,composition:"hills.horizon",distance:.1875}]},"town.Rasberg":{width:1023,height:576,left:"town.RoofTops",right:"city.BayFull",backgrounds:[["city.Sunset",2]],altitudes:[0,250,400,700],elements:[{x:-800,y:-865,z:300,composition:"city.skyScraper",distance:1},{x:-300,y:-1100,z:-200,composition:"city.skyScraper",distance:.7},{x:-1700,y:-1300,z:150,composition:"city.skyScraper",distance:1.1},{x:0,y:-165,z:-30,composition:"town.middleFull",distance:.5},{x:0,y:35,z:-70,composition:"town.skyline",distance:.25},{x:0,y:65,z:-80,composition:"hills.horizon",distance:.1875}]}},aL={};d(aL),p(aL,"default",()=>aR);var aR={"test.Walls":{width:1023,height:576,right:"test.Walls",left:"test.Walls",elements:[{components:["ShipSolid","BulletSolid","LaserSolid","SolidCollision","Collision"],x:100,y:-385,composition:"test.wall"},{components:["ShipSolid","BulletSolid","LaserSolid","SolidCollision","Collision"],x:700,y:-485,composition:"test.wall"}]}};ak={scenery:{city:{ts:aD},bridge:{bridge:{ts:aA}}},sinterklaas:{garden:{ts:aF},town:{ts:aT}},test:{test:{js:aL}}};var aO={},aj={};d(aj),p(aj,"default",()=>aH);var aH={"player.bullets":{spawnRhythm:{initialDelay:1,burst:1,shotDelay:[120,60],burstDelay:1,spawns:[["bullet",{angleRange:{from:[0,-5],to:[1,5],step:3}}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[1050,1200],composition:"weapons.lightBullet",damage:[{velocity:[-2e4,-3e4],affects:"health",duration:[2,4],name:"Bullet"}],queue:[{cleanOutOfScreen:!0},{duration:4e3}],collisions:{SolidCollision:{spawns:[["sparkHit",{}],["sparks",{emitter:{duration:100}}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:120,audio:"laser-shot"}]},sparkHit:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100,audio:"laser-hit"}]},sparks:{spawnPosition:"outside",velocity:0,particles:"sparks",queue:[{duration:500}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}},"player.laser":{spawnRhythm:{initialDelay:1,burst:1,shotDelay:3e3,burstDelay:1,shot:[{state:"laserCharge",audio:"laser-charge",duration:[1500,750]},{state:"stopLaserCharge",duration:300},{spawn:!0,duration:100,audio:"laser-fire"}],spawns:[["laser",{angleRange:{from:[180,175],to:[181,186],step:3}}]]},spawnables:{laser:{spawnPosition:[0,.5],attached:!0,beam:!0,velocity:2800,composition:"weapons.laser",queue:[{duration:340},{velocity:0},{duration:300},{duration:300,frame:"disappear"}],damage:[{velocity:[-500,-1e3],affects:"health",duration:[80,160],name:"Laser"}],collisions:{SolidCollision:{cooldown:10,spawns:[["sparks",{angle:180}]],remove:!1}}},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]},sparks:{attached:!0,spawnPosition:"outside",velocity:0,particles:"laserHit",queue:[{duration:150}]}}}},aI={};d(aI),p(aI,"default",()=>aG);var aG={"chimney.presents":{aiming:{offsetAimAngle:0,sight:95,resetOnDeactivation:!0,rotateSpeed:0,range:[70,-2]},spawnRhythm:{initialDelay:[1,1],burst:[5,5],shotDelay:[400,400],burstDelay:[800,400],shot:[{spawn:!0,duration:50}],spawns:[["bullet",{angle:90}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[200,300],composition:"sinterklaas.present",queue:[{duration:4e3,audio:["gun-shot",{volume:.8}]}],damage:[{velocity:[-15e3,-45e3],affects:"health",duration:[4,4],name:"Laser"}],collisions:{Jinte:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}},autoRotate:!1},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100,audio:"laser-hit"}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}},"seagull.flatsCannon":{aiming:{offsetAimAngle:-5,sight:0,resetOnDeactivation:!0,rotateSpeed:90,range:[-30,150]},spawnRhythm:{initialDelay:100,burst:2,shotDelay:300,burstDelay:1e3,spawns:[["flats",{angle:30,autoRotate:!0}]]},spawnables:{flats:{spawnPosition:[0,.5],velocity:[350,500],composition:"flats",queue:[{cleanOutOfScreen:!0},{aimOnTarget:!0,duration:0},{duration:4e3,audio:["gun-shot",{volume:.8}]}],damage:[{velocity:[-2e3,-15e3],affects:"health",duration:[2,4],name:"Laser"}],collisions:{Jinte:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100,audio:"laser-hit"}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}}},aq={};d(aq),p(aq,"default",()=>aU);var aU={"player.carrots":{spawnRhythm:{initialDelay:1,burst:1,shotDelay:[120,60],burstDelay:1,spawns:[["bullet",{angleRange:{from:[0,-5],to:[1,5],step:3}}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[1050,1200],composition:"weapons.carrot",damage:[{velocity:[-2e4,-3e4],affects:"health",duration:[2,4],name:"Bullet"}],queue:[{cleanOutOfScreen:!0},{duration:4e3}],collisions:{SolidCollision:{spawns:[["sparkHit",{}],["sparks",{emitter:{duration:100}}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:120,audio:"laser-shot"}]},sparkHit:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100,audio:"laser-hit"}]},sparks:{spawnPosition:"outside",velocity:0,particles:"sparks",queue:[{duration:500}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}}},aN={};d(aN),p(aN,"default",()=>aV);var aV={"boss.searchBullet":{spawnRhythm:{initialDelay:[1500,150],burst:1,shotDelay:[150,90],burstDelay:[3e3,800],spawns:[["bullet",{angle:0}],["bullet",{angle:20}],["bullet",{angle:-20}],["bullet",{angle:40}],["bullet",{angle:-40}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[200,600],composition:"weapons.bullet",queue:[{duration:[2e3,800],velocity:[0,100],easing:"easeOutQuad"},{velocity:[900,1200],aimOnTarget:!0},{duration:3e3}],collisions:{SolidCollision:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:400}]},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}},"boss.extreme-search":{spawnRhythm:{initialDelay:[1500,150],burst:1,shotDelay:4e3,burstDelay:[1500,500],spawns:[["bullet",{angleRange:{from:0,to:360,step:8}}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:200,composition:"weapons.bullet",queue:[{cleanOutOfScreen:!0},{duration:200},{duration:500,velocity:0},{velocity:[900,1200],aimOnTarget:!0},{duration:3e3}],collisions:{SolidCollision:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}},"boss.extreme-test":{spawnRhythm:{initialDelay:[1500,150],burst:[5,30],shotDelay:200,burstDelay:[2e3,10],spawns:[["bullet",{angleRange:{from:0,to:360,step:8}}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:200,composition:"weapons.bullet",queue:[{cleanOutOfScreen:!0},{duration:13e3}],collisions:{SolidCollision:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}},"boss.spawn":{spawnRhythm:{initialDelay:[1500,150],burst:[3,5],shotDelay:[350,250],burstDelay:[3e3,400],spawns:[["bullet",{}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[250,300],composition:"weapons.sphere",queue:[{duration:1500,velocity:20},{duration:4e3}],collisions:{SolidCollision:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},subSpawn:{spawnPosition:[0,.5],velocity:[250,300],composition:"weapons.bullet",queue:[{duration:1500}],collisions:{SolidCollision:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:400}]},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}},"building.explosion":{spawnRhythm:{initialDelay:1,maxBursts:1,burst:14,shotDelay:200,burstDelay:0,spawns:[["explosion",{spawnBox:{w:150,h:100}}]]},spawnables:{explosion:{spawnPosition:[.5,.5],velocity:[0,0],composition:"weapons.largeExplosion",emitDamage:[{targets:["PlayerShip"],velocity:-1e3,accelleration:50,upperBounds:0,speed:1200,affects:["health"],duration:100,name:"Explosion"}],queue:[{duration:100,audio:"explosion"},{duration:1e3}]}}},"building.explosion2":{spawnRhythm:{maxBursts:1,initialDelay:1,burst:18,shotDelay:180,burstDelay:0,spawns:[["explosion",{spawnBox:{w:250,h:100}}]]},spawnables:{explosion:{spawnPosition:[.5,.5],velocity:[0,0],composition:"weapons.largeExplosion",emitDamage:[{targets:["PlayerShip"],velocity:-1e3,accelleration:50,upperBounds:0,speed:2e3,affects:["health"],duration:100,name:"Explosion"}],queue:[{duration:100,audio:"explosion"},{duration:1e3}]}}}},aX={};d(aX),p(aX,"default",()=>aW);var aW={"turret.bullet":{spawnRhythm:{initialDelay:[1500,150],burst:[3,9],shotDelay:[150,90],burstDelay:[3e3,400],spawns:[["bullet",{}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[250,300],composition:"weapons.bullet",queue:[{duration:4e3}],collisions:{SolidCollision:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:400}]},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}},"turret.doubleBullet":{spawnRhythm:{initialDelay:[1500,150],burst:[3,9],shotDelay:[150,90],burstDelay:[3e3,400],spawns:[["bullet",{angle:-2}],["bullet",{angle:2}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[250,300],composition:"weapons.bullet",queue:[{duration:4e3}],collisions:{SolidCollision:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:400}]},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}}},aY={};d(aY),p(aY,"default",()=>aK);var aK={"cannon.gun":{aiming:{offsetAimAngle:0,sight:95,resetOnDeactivation:!0,rotateSpeed:60,range:[70,-2]},spawnRhythm:{initialDelay:[500,150],burst:[3,7],shotDelay:[150,100],burstDelay:[1e3,400],shot:[{state:"shells",duration:0},{spawn:!0,duration:50},{state:"noshells",duration:0}],spawns:[["bullet",{}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[400,500],composition:"weapons.bullet",queue:[{duration:4e3,audio:["gun-shot",{volume:.8}]}],damage:[{velocity:[-3e3,-15e3],affects:"health",duration:[2,4],name:"Laser"}],collisions:{PlayerShip:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:400}]},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100,audio:"laser-hit"}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}},"cannon.laser":{aiming:{offsetAimAngle:0,sight:95,resetOnDeactivation:!0,rotateSpeed:60,range:[70,-2]},spawnRhythm:{initialDelay:[500,150],burst:1,shotDelay:1,burstDelay:1e3,shot:[{state:"charge",audio:"laser-charge",duration:1200},{stopAiming:!0,state:"charged",duration:500},{duration:100},{spawn:!0,duration:100,audio:"laser-fire"},{state:"discharge",duration:500},{duration:500},{stopAiming:!1,duration:0}],spawns:[["laser",{angle:180}],["laser",{angle:200}],["laser",{angle:160}],["laser",{angle:220}],["laser",{angle:140}]]},spawnables:{laser:{spawnPosition:[0,.5],beam:!0,attached:!0,velocity:2500,composition:"weapons.laser",queue:[{duration:350},{velocity:0},{duration:150},{duration:300,frame:"disappear"}],damage:[{velocity:[-2e3,-4e3],affects:"health",duration:[2,4],name:"Laser"}],collisions:{LaserSolid:{cooldown:10,spawns:[["sparks",{angle:180}]],remove:!1},PlayerShip:{cooldown:10,spawns:[["sparks",{angle:180}]],remove:!1}}},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]},sparks:{attached:!0,spawnPosition:"outside",velocity:0,particles:"laserHit",queue:[{duration:50}]}}},"turret.bullet":{spawnRhythm:{initialDelay:[1500,150],burst:[3,9],shotDelay:[150,90],burstDelay:[3e3,400],spawns:[["bullet",{}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[250,300],composition:"weapons.bullet",queue:[{duration:4e3}],collisions:{SolidCollision:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:400}]},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}},"turret.doubleBullet":{spawnRhythm:{initialDelay:[1500,150],burst:[3,9],shotDelay:[150,90],burstDelay:[3e3,400],spawns:[["bullet",{angle:-2}],["bullet",{angle:2}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[250,300],composition:"weapons.bullet",queue:[{duration:4e3}],collisions:{SolidCollision:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:400}]},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}}},aJ={};d(aJ),p(aJ,"default",()=>a$);var a$={"bulletDrone.gun":{aiming:{offsetAimAngle:-5,sight:25,resetOnDeactivation:!0,rotateSpeed:60,range:[10,-50]},spawnRhythm:{initialDelay:[1500,150],burst:[3,6],shotDelay:[200,160],burstDelay:[2e3,400],spawns:[["bullet",{}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[250,300],composition:"weapons.bullet",queue:[{duration:4e3,audio:["gun-shot",{volume:.8}]}],damage:[{velocity:[-2e3,-15e3],affects:"health",duration:[2,4],name:"Laser"}],collisions:{PlayerShip:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:400}]},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100,audio:"laser-hit"}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}}},aQ={};d(aQ),p(aQ,"default",()=>aZ);var aZ={"heli.rocket":{spawnRhythm:{initialDelay:[2e3,1e3],burst:1,shotDelay:[500,250],burstDelay:[3e3,2e3],spawns:[["rocket",{angle:-90,autoRotate:!1}]]},spawnables:{rocket:{spawnPosition:[0,.5],velocity:[400,500],entity:"HeliRocket",damage:[{velocity:[-1e4,-3e4],affects:"health",duration:[4,8],name:"Blast"}],queue:[{duration:130},{velocity:0,angle:0,autoRotate:!0},{duration:500},{velocity:[450,500],steering:80,sight:25},{duration:6e3}],collisions:{PlayerShip:{state:"hide",spawns:[["hit",{}]]},GravityLiquid:{state:"waterHit",spawns:[["hit",{}]]}}},hit:{spawnPosition:"outside",velocity:0,composition:"weapons.explosion",queue:[{duration:100,audio:"explosion"},{duration:2e3}]}}},"heli.gun":{aiming:{offsetAimAngle:-5,sight:25,resetOnDeactivation:!0,rotateSpeed:60,range:[10,-50]},spawnRhythm:{initialDelay:[1500,150],burst:[5,9],shotDelay:[100,60],burstDelay:[3e3,400],spawns:[["bullet",{}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:[350,500],composition:"weapons.bullet",queue:[{duration:4e3,audio:["gun-shot",{volume:.8}]}],damage:[{velocity:[-2e3,-15e3],affects:"health",duration:[2,4],name:"Laser"}],collisions:{PlayerShip:{spawns:[["spark",{}]]},WaterCollision:{spawns:[["splash",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:400}]},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100,audio:"laser-hit"}]},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]}}}},a0={};d(a0),p(a0,"default",()=>a1);var a1={"largeDrone.takeover":{spawnRhythm:{maxBursts:1,initialDelay:10,burst:2,shotDelay:200,burstDelay:8e3,spawns:[["bullet",{}],["muzzleFlash",{}]]},spawnables:{bullet:{spawnPosition:[0,.5],velocity:400,composition:"weapons.sphere",damage:[{velocity:[-2e4,-3e4],affects:"health",duration:[2,4],name:"Laser"}],queue:[{cleanOutOfScreen:!0},{aimOnTarget:!0,duration:0},{duration:4e3}],collisions:{IntroHeliBackground:{spawns:[["sparks",{}],["sparkHit",{}]]}}},muzzleFlash:{spawnPosition:[0,.5],attached:!0,velocity:0,composition:"weapons.muzzleFlash",queue:[{duration:400,audio:"laser-shot"}]},sparks:{spawnPosition:"outside",velocity:0,particles:"sparks",queue:[{duration:500}]},sparkHit:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100,audio:"laser-hit"}]}}},"largeDrone.rockets":{spawnRhythm:{initialDelay:500,burst:16,shotDelay:10,burstDelay:1e3,shot:[{spawn:!0,duration:100},{state:"fireRocket",duration:200},{duration:20},{state:"reloadRocket",duration:300}],spawns:[["rocket",{angle:0,autoRotate:!1}]]},spawnables:{rocket:{spawnPosition:[0,.5],velocity:250,entity:"HeliRocket",damage:[{velocity:[-1e4,-3e4],affects:"health",duration:[4,8],name:"Blast"}],queue:[{cleanOutOfScreen:!0},{velocity:[450,500]},{duration:4e3},{collide:"PlayerShip"}],collisions:{PlayerShip:{state:"hide",spawns:[["hit",{}]]},GravityLiquid:{state:"waterHit",spawns:[["hit",{}]]}}},hit:{spawnPosition:"outside",velocity:0,composition:"weapons.explosion",queue:[{duration:100,audio:"explosion"},{duration:2e3}]}}},"largeDrone.homingRocket":{spawnRhythm:{initialDelay:1e3,burst:3,shotDelay:500,burstDelay:1e3,shot:[{spawn:!0,duration:100},{state:"fireRocket",duration:200},{duration:1e3},{state:"reloadRocket",duration:1500}],spawns:[["rocket",{angle:-90,autoRotate:!1}],["rocket",{angle:90,autoRotate:!1}],["wideRocket",{angle:-120,autoRotate:!1}],["wideRocket",{angle:120,autoRotate:!1}]]},spawnables:{rocket:{spawnPosition:[0,.5],velocity:250,entity:"HeliRocket",damage:[{velocity:[-1e4,-3e4],affects:"health",duration:[4,8],name:"Blast"}],queue:[{duration:220},{velocity:0,angle:0,autoRotate:!0},{duration:500},{velocity:[450,500],steering:180,sight:360},{duration:3e3},{collide:"PlayerShip"}],collisions:{PlayerShip:{state:"hide",spawns:[["hit",{}]]},GravityLiquid:{state:"waterHit",spawns:[["hit",{}]]}}},wideRocket:{spawnPosition:[0,.5],velocity:250,entity:"HeliRocket",damage:[{velocity:[-1e4,-3e4],affects:"health",duration:[4,8],name:"Blast"}],queue:[{cleanOutOfScreen:!0},{duration:550},{velocity:0,angle:0},{duration:170},{velocity:[450,500]},{duration:4e3},{collide:"PlayerShip"}],collisions:{PlayerShip:{state:"hide",spawns:[["hit",{}]]},GravityLiquid:{state:"waterHit",spawns:[["hit",{}]]}}},hit:{spawnPosition:"outside",velocity:0,composition:"weapons.explosion",queue:[{duration:100,audio:"explosion"},{duration:2e3}]}}}},a2={};d(a2),p(a2,"default",()=>a5);var a5={"cannon.laser":{aiming:{offsetAimAngle:0,sight:95,resetOnDeactivation:!0,rotateSpeed:60,range:[70,-2]},spawnRhythm:{initialDelay:[500,150],burst:1,shotDelay:1,burstDelay:1e3,shot:[{state:"charge",audio:"laser-charge",duration:1200},{stopAiming:!0,state:"charged",duration:500},{duration:100},{spawn:!0,duration:100,audio:"laser-fire"},{state:"discharge",duration:500},{duration:500},{stopAiming:!1,duration:0}],spawns:[["laser",{angle:180}],["laser",{angle:200}],["laser",{angle:160}],["laser",{angle:220}],["laser",{angle:140}]]},spawnables:{laser:{spawnPosition:[0,.5],beam:!0,attached:!0,velocity:2500,composition:"weapons.laser",queue:[{duration:350},{velocity:0},{duration:150},{duration:300,frame:"disappear"}],damage:[{velocity:[-2e3,-4e3],affects:"health",duration:[2,4],name:"Laser"}],collisions:{LaserSolid:{cooldown:10,spawns:[["sparks",{angle:180}]],remove:!1},PlayerShip:{cooldown:10,spawns:[["sparks",{angle:180}]],remove:!1}}},splash:{spawnPosition:"outside",velocity:0,composition:"weapons.waterHit",queue:[{duration:305}]},sparks:{attached:!0,spawnPosition:"outside",velocity:0,particles:"laserHit",queue:[{duration:50}]}}}},a3={};d(a3),p(a3,"default",()=>a4);var a4={"mine.blast":{spawnRhythm:{maxBursts:1,initialDelay:1,burst:1,shotDelay:0,burstDelay:0,spawns:[["explosion",{}],["bullet",{angleRange:{from:45,to:405,step:45}}]]},spawnables:{explosion:{spawnPosition:[.5,.5],velocity:[0,0],composition:"weapons.largeExplosion",emitDamage:[{targets:["Mine","PlayerShip"],velocity:-1e3,accelleration:50,upperBounds:0,speed:1200,affects:["health"],duration:100,name:"Explosion"}],queue:[{duration:100,audio:"explosion"},{duration:2e3}]},bullet:{spawnPosition:[0,.5],velocity:100,composition:"weapons.bullet",damage:[{velocity:[-3e3,-2e4],affects:"health",duration:[2,4],name:"Laser"}],queue:[{cleanOutOfScreen:!0},{duration:500,velocity:500},{duration:11e3}],collisions:{PlayerShip:{spawns:[["spark",{}]]}}},spark:{spawnPosition:"outside",velocity:0,composition:"weapons.solidHit",queue:[{duration:100}]}}},"mine.explosion":{spawnRhythm:{maxBursts:1,initialDelay:1,burst:1,shotDelay:0,burstDelay:0,spawns:[["explosion",{}]]},spawnables:{explosion:{spawnPosition:[.5,.5],velocity:[0,0],composition:"weapons.largeExplosion",emitDamage:[{targets:["Mine","PlayerShip"],velocity:-1e3,accelleration:50,upperBounds:0,speed:1200,affects:["health"],duration:100,name:"Explosion"}],queue:[{duration:100,audio:"explosion"},{duration:2e3}]}}}};aO={PlayerShip:{player:{js:aj}},sinterklaas:{sintWeapons:{ts:aI},Jinte:{player:{js:aq}}},test:{test:{js:aN},turret:{js:aX}},enemies:{BulletCannon:{bulletCannon:{js:aY}},BulletDrone:{bulletDrone:{js:aJ}},Helicopter:{helicopter:{js:aQ}},LargeDrone:{largeDrone:{js:a0}},LaserCannon:{laserCannon:{js:a2}},Mine:{mine:{js:a3}}}};const a6=t=>{let e={},i=t=>{"object"!=typeof t||Array.isArray(t)||Object.entries(t).forEach(([t,a])=>{"default"===t?Object.entries(a).forEach(([t,i])=>{e[t]=i}):i(a)})};return i(t),e},a8=a6(t0),a7=a6(ee),a9=a6(e6),rt=a6(iG),re=a6(ai),ri=a6(ak),ra=a6(aO),rr=t=>e=>t[e],rn=rr(a8),ro=rr(a7),rs=rr(a9),rl=rr(rt),rh=rr(re),rc=rr(ri),ru=rr(ra);var rd={},rp={},ry={},rm={},rf={};rf=function(){this.__data__=[],this.size=0};var rg={},rv={},rw={};rw=function(t,e){return t===e||t!=t&&e!=e},rv=function(t,e){for(var i=t.length;i--;)if(rw(t[i][0],e))return i;return -1};var rx=Array.prototype.splice;rg=function(t){var e=this.__data__,i=rv(e,t);return!(i<0)&&(i==e.length-1?e.pop():rx.call(e,i,1),--this.size,!0)};var r_={};r_=function(t){var e=this.__data__,i=rv(e,t);return i<0?void 0:e[i][1]};var rb={};rb=function(t){return rv(this.__data__,t)>-1};var rS={};function rC(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var a=t[e];this.set(a[0],a[1])}}rS=function(t,e){var i=this.__data__,a=rv(i,t);return a<0?(++this.size,i.push([t,e])):i[a][1]=e,this},rC.prototype.clear=rf,rC.prototype.delete=rg,rC.prototype.get=r_,rC.prototype.has=rb,rC.prototype.set=rS,rm=rC;var rk={};rk=function(){this.__data__=new rm,this.size=0};var rD={};rD=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i};var rz={};rz=function(t){return this.__data__.get(t)};var rA={};rA=function(t){return this.__data__.has(t)};var rP={},rF={},rE={},rB={},rT={},rM={},rL={},rR=f("fNJVo");rL=rR.Symbol;var rO={},rj=Object.prototype,rH=rj.hasOwnProperty,rI=rj.toString,rG=rL?rL.toStringTag:void 0;rO=function(t){var e=rH.call(t,rG),i=t[rG];try{t[rG]=void 0;var a=!0}catch(t){}var r=rI.call(t);return a&&(e?t[rG]=i:delete t[rG]),r};var rq={},rU=Object.prototype.toString;rq=function(t){return rU.call(t)};var rN=rL?rL.toStringTag:void 0;rM=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":rN&&rN in Object(t)?rO(t):rq(t)},rT=function(t){if(!z(t))return!1;var e=rM(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};var rV={},rX={},rR=f("fNJVo");rX=rR["__core-js_shared__"];var rW=(h=/[^.]+$/.exec(rX&&rX.keys&&rX.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"";rV=function(t){return!!rW&&rW in t};var rY={},rK=Function.prototype.toString;rY=function(t){if(null!=t){try{return rK.call(t)}catch(t){}try{return t+""}catch(t){}}return""};var rJ=/^\[object .+?Constructor\]$/,r$=Object.prototype,rQ=Function.prototype.toString,rZ=r$.hasOwnProperty,r0=RegExp("^"+rQ.call(rZ).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");rB=function(t){return!(!z(t)||rV(t))&&(rT(t)?r0:rJ).test(rY(t))};var r1={};r1=function(t,e){return null==t?void 0:t[e]},rE=function(t,e){var i=r1(t,e);return rB(i)?i:void 0};var rR=f("fNJVo");rF=rE(rR,"Map");var r2={},r5={},r3={},r4={},r6={};r6=rE(Object,"create"),r4=function(){this.__data__=r6?r6(null):{},this.size=0};var r8={};r8=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e};var r7={},r9=Object.prototype.hasOwnProperty;r7=function(t){var e=this.__data__;if(r6){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return r9.call(e,t)?e[t]:void 0};var nt={},ne=Object.prototype.hasOwnProperty;nt=function(t){var e=this.__data__;return r6?void 0!==e[t]:ne.call(e,t)};var ni={};function na(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var a=t[e];this.set(a[0],a[1])}}ni=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=r6&&void 0===e?"__lodash_hash_undefined__":e,this},na.prototype.clear=r4,na.prototype.delete=r8,na.prototype.get=r7,na.prototype.has=nt,na.prototype.set=ni,r3=na,r5=function(){this.size=0,this.__data__={hash:new r3,map:new(rF||rm),string:new r3}};var nr={},nn={},no={};no=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t},nn=function(t,e){var i=t.__data__;return no(e)?i["string"==typeof e?"string":"hash"]:i.map},nr=function(t){var e=nn(this,t).delete(t);return this.size-=e?1:0,e};var ns={};ns=function(t){return nn(this,t).get(t)};var nl={};nl=function(t){return nn(this,t).has(t)};var nh={};function nc(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var a=t[e];this.set(a[0],a[1])}}function nu(t){var e=this.__data__=new rm(t);this.size=e.size}nh=function(t,e){var i=nn(this,t),a=i.size;return i.set(t,e),this.size+=i.size==a?0:1,this},nc.prototype.clear=r5,nc.prototype.delete=nr,nc.prototype.get=ns,nc.prototype.has=nl,nc.prototype.set=nh,r2=nc,rP=function(t,e){var i=this.__data__;if(i instanceof rm){var a=i.__data__;if(!rF||a.length<199)return a.push([t,e]),this.size=++i.size,this;i=this.__data__=new r2(a)}return i.set(t,e),this.size=i.size,this},nu.prototype.clear=rk,nu.prototype.delete=rD,nu.prototype.get=rz,nu.prototype.has=rA,nu.prototype.set=rP,ry=nu;var nd={},np={},ny={};ny=function(){try{var t=rE(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),np=function(t,e,i){"__proto__"==e&&ny?ny(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i},nd=function(t,e,i){(void 0===i||rw(t[e],i))&&(void 0!==i||e in t)||np(t,e,i)};var nm={};nm=function(t,e,i){for(var a=-1,r=Object(t),n=i(t),o=n.length;o--;){var s=n[++a];if(!1===e(r[s],s,r))break}return t};var nf={},ng=f("lNdKa"),nv={},nw={},nx={},rR=f("fNJVo");nx=rR.Uint8Array,nw=function(t){var e=new t.constructor(t.byteLength);return new nx(e).set(new nx(t)),e},nv=function(t,e){var i=e?nw(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)};var n_={};n_=function(t,e){var i=-1,a=t.length;for(e||(e=Array(a));++i<a;)e[i]=t[i];return e};var nb={},nS={},nC=Object.create;nS=function(){function t(){}return function(e){if(!z(e))return{};if(nC)return nC(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();var nk={},nD={};nk=(nD=function(t,e){return function(i){return t(e(i))}})(Object.getPrototypeOf,Object);var nz={},nA=Object.prototype;nz=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||nA)},nb=function(t){return"function"!=typeof t.constructor||nz(t)?{}:nS(nk(t))};var nP={},nF={},nE={};nE=function(t){return null!=t&&"object"==typeof t},nF=function(t){return nE(t)&&"[object Arguments]"==rM(t)};var nB=Object.prototype,nT=nB.hasOwnProperty,nM=nB.propertyIsEnumerable;nP=nF(function(){return arguments}())?nF:function(t){return nE(t)&&nT.call(t,"callee")&&!nM.call(t,"callee")};var nL={};nL=Array.isArray;var nR={},nO={},nj={};nj=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},nO=function(t){return null!=t&&nj(t.length)&&!rT(t)},nR=function(t){return nE(t)&&nO(t)};var nH=f("2W9As"),nI={},nG=Object.prototype,nq=Function.prototype.toString,nU=nG.hasOwnProperty,nN=nq.call(Object);nI=function(t){if(!nE(t)||"[object Object]"!=rM(t))return!1;var e=nk(t);if(null===e)return!0;var i=nU.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&nq.call(i)==nN};var nV={},nX={},nW={};nW["[object Float32Array]"]=nW["[object Float64Array]"]=nW["[object Int8Array]"]=nW["[object Int16Array]"]=nW["[object Int32Array]"]=nW["[object Uint8Array]"]=nW["[object Uint8ClampedArray]"]=nW["[object Uint16Array]"]=nW["[object Uint32Array]"]=!0,nW["[object Arguments]"]=nW["[object Array]"]=nW["[object ArrayBuffer]"]=nW["[object Boolean]"]=nW["[object DataView]"]=nW["[object Date]"]=nW["[object Error]"]=nW["[object Function]"]=nW["[object Map]"]=nW["[object Number]"]=nW["[object Object]"]=nW["[object RegExp]"]=nW["[object Set]"]=nW["[object String]"]=nW["[object WeakMap]"]=!1,nX=function(t){return nE(t)&&nj(t.length)&&!!nW[rM(t)]};var nY={};nY=function(t){return function(e){return t(e)}};var nK=f("74qZ6"),nJ=nK&&nK.isTypedArray;nV=nJ?nY(nJ):nX;var n$={};n$=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var nQ={},nZ={},n0={},n1=Object.prototype.hasOwnProperty;n0=function(t,e,i){var a=t[e];n1.call(t,e)&&rw(a,i)&&(void 0!==i||e in t)||np(t,e,i)},nZ=function(t,e,i,a){var r=!i;i||(i={});for(var n=-1,o=e.length;++n<o;){var s=e[n],l=a?a(i[s],t[s],s,i,t):void 0;void 0===l&&(l=t[s]),r?np(i,s,l):n0(i,s,l)}return i};var n2={},n5={},n3={};n3=function(t,e){for(var i=-1,a=Array(t);++i<t;)a[i]=e(i);return a};var nH=f("2W9As"),n4={},n6=/^(?:0|[1-9]\d*)$/;n4=function(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&n6.test(t))&&t>-1&&t%1==0&&t<e};var n8=Object.prototype.hasOwnProperty;n5=function(t,e){var i=nL(t),a=!i&&nP(t),r=!i&&!a&&nH(t),n=!i&&!a&&!r&&nV(t),o=i||a||r||n,s=o?n3(t.length,String):[],l=s.length;for(var h in t)(e||n8.call(t,h))&&!(o&&("length"==h||r&&("offset"==h||"parent"==h)||n&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||n4(h,l)))&&s.push(h);return s};var n7={},n9={};n9=function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e};var ot=Object.prototype.hasOwnProperty;n7=function(t){if(!z(t))return n9(t);var e=nz(t),i=[];for(var a in t)"constructor"==a&&(e||!ot.call(t,a))||i.push(a);return i},n2=function(t){return nO(t)?n5(t,!0):n7(t)},nQ=function(t){return nZ(t,n2(t))},nf=function(t,e,i,a,r,n,o){var s=n$(t,i),l=n$(e,i),h=o.get(l);if(h){nd(t,i,h);return}var c=n?n(s,l,i+"",t,e,o):void 0,u=void 0===c;if(u){var d=nL(l),p=!d&&nH(l),y=!d&&!p&&nV(l);c=l,d||p||y?nL(s)?c=s:nR(s)?c=n_(s):p?(u=!1,c=ng(l,!0)):y?(u=!1,c=nv(l,!0)):c=[]:nI(l)||nP(l)?(c=s,nP(s)?c=nQ(s):(!z(s)||rT(s))&&(c=nb(l))):u=!1}u&&(o.set(l,c),r(c,l,a,n,o),o.delete(l)),nd(t,i,c)},rp=function t(e,i,a,r,n){e!==i&&nm(i,function(o,s){if(n||(n=new ry),z(o))nf(e,i,s,a,t,r,n);else{var l=r?r(n$(e,s),o,s+"",e,i,n):void 0;void 0===l&&(l=o),nd(e,s,l)}},n2)};var oe={},oi={};oi=function(t){return t};var oa={},or={};or=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)};var on=Math.max;oa=function(t,e,i){return e=on(void 0===e?t.length-1:e,0),function(){for(var a=arguments,r=-1,n=on(a.length-e,0),o=Array(n);++r<n;)o[r]=a[e+r];r=-1;for(var s=Array(e+1);++r<e;)s[r]=a[r];return s[e]=i(o),or(t,this,s)}};var oo={},os={},ol={};ol=function(t){return function(){return t}};var oh=Date.now;e=ny?function(t,e){return ny(t,"toString",{configurable:!0,enumerable:!1,value:ol(e),writable:!0})}:oi,i=0,a=0,oo=function(){var t=oh(),r=16-(t-a);if(a=t,r>0){if(++i>=800)return arguments[0]}else i=0;return e.apply(void 0,arguments)},oe=function(t,e){return oo(oa(t,e,oi),t+"")};var oc={};oc=function(t,e,i){if(!z(i))return!1;var a=typeof e;return("number"==a?!!(nO(i)&&n4(e,i.length)):"string"==a&&e in i)&&rw(i[e],t)},r=function(t,e,i){rp(t,e,i)},rd=oe(function(t,e){var i=-1,a=e.length,n=a>1?e[a-1]:void 0,o=a>2?e[2]:void 0;for(n=r.length>3&&"function"==typeof n?(a--,n):void 0,o&&oc(e[0],e[1],o)&&(n=a<3?void 0:n,a=1),t=Object(t);++i<a;){var s=e[i];s&&r(t,s,i,n)}return t}),v.c("GravitySupport",{init(){this.activateGravity=this.activateGravity.bind(this),this._onGravityCollisionHit=this._onGravityCollisionHit.bind(this)},activateGravity(t=["GravitySolid","GravityLiquid"]){this.addComponent("Motion","Collision",tZ),this.ay=400,this.bind("HitOn",this._onGravityCollisionHit),this.checkHits(...t)},_onGravityCollisionHit(t){let e="none",i=null;if(t.forEach(t=>{let a=t.obj;a.has("GravitySolid")&&(e="solid",i=a),a.has("GravityLiquid")&&(e="liquid",i=a)}),"solid"===e&&(this.vy>200?this.attr({vy:-this.vy/4}):(this.attr({ay:0,ax:0,vx:0,vy:0}),this.showState&&this.showState("crashed"),i.attach(this))),"liquid"===e){if(this.attr({ax:0,ay:0,vx:0,vy:this.vy/i.liquidDensity,hideBelow:i.y+30,surfaceLevel:i.y}),i.liquidParticles){let t=[].concat(i.liquidParticles,{emitter:{w:this.w,h:10,amount:1.5*this.w}}),e=u(rd)({},rl(t[0]),t[1]);this.liquidEmitter=v.e(tq).attr({x:this.x,y:i.y+20}).particles(e)}this.uniqueBind("GameLoop",this._sinkAway)}},_sinkAway(){let t=this.y>this.hideBelow;Object.values(this.currentAttachHooks).forEach(t=>{t.currentAttachment&&t.currentAttachment.emitter&&t.currentAttachment.emitter.emissionRate>0&&t.y>this.hideBelow&&t.currentAttachment.emitter.stopEmission()}),t&&(this.liquidEmitter.stopEmission(),this.liquidEmitter.autoDestruct=!0,this.destroy(),this.unbind("GameLoop",this._sinkAway))}}),v.c("SubmergeSupport",{init(){this._onGravityCollisionHit=this._onGravityCollisionHit.bind(this),this.addComponent("Motion","Collision"),this.bind("HitOn",this._onGravityCollisionHit),this.checkHits("GravityLiquid"),this.clearShadow=this.clearShadow.bind(this)},events:{Freeze(){this.liquidEmitter&&(this.liquidEmitter.stopEmission(),this.liquidEmitter.autoDestruct=!0,this.liquidEmitter=null),this.shadow&&(this.shadow.destroy(),this.shadow=null)},Remove(){this.liquidEmitter&&(this.liquidEmitter.stopEmission(),this.liquidEmitter.autoDestruct=!0,this.liquidEmitter=null),this.shadow&&(this.shadow.destroy(),this.shadow=null)}},_onGravityCollisionHit(t){if(this.surface)return;let e=null;if(t.forEach(t=>{let i=t.obj;i.has("GravityLiquid")&&(e=i)}),this.attr({hideBelow:e.y+30,surface:e}),e.liquidParticles){let t=[].concat(e.liquidParticles,{emitter:{w:this.w,h:10,amount:Math.min(Math.max(1.5*this.w,100),500)}}),i=u(rd)({},rl(t[0]),t[1]);this.liquidEmitter=v.e(tq).attr({x:this.x,y:e.y+20}).particles(i)}this.uniqueBind("EnterFrame",this._sinkAway)},clearShadow(){this.shadow&&(this.shadow.destroy(),this.shadow=null)},_sinkAway(){let t=this.y>this.hideBelow,e=this.y+this.h<this.hideBelow-30;if(Object.values(this.currentAttachHooks).forEach(t=>{t.currentAttachment&&t.currentAttachment.emitter&&t.currentAttachment.emitter.emissionRate>0&&t.y>this.hideBelow&&t.currentAttachment.emitter.stopEmission()}),this.shadow&&(this.shadow.x=this.x,this.shadow.alpha=1-(this.y-this.hideBelow)/200),(t||e)&&this.liquidEmitter)this.liquidEmitter.stopEmission(),this.liquidEmitter.autoDestruct=!0,this.liquidEmitter=null,t&&(this.shadow=v.e(`2D, WebGL, ${this.submergeSprite}`).attr({w:this.w,x:this.x,y:this.hideBelow-20}),this.uniqueBind("Remove",this.clearShadow));else if(null===this.liquidEmitter&&!t&&!e){this.shadow&&(this.shadow.destroy(),this.shadow=null);let t=[].concat(this.surface.liquidParticles,{emitter:{w:this.w,h:10,amount:Math.min(Math.max(1.5*this.w,100),500)}}),e=u(rd)({},rl(t[0]),t[1]);this.liquidEmitter=v.e(tq).attr({x:this.x,y:this.surface.y+20}).particles(e)}}}),v.c("Invincible",{init(){this.requires("Delay"),this.blinkOn=!0},_blink(){this.blinkOn=!this.blinkOn,this.alpha=this.blinkOn?.5:1},remove(){this.cancelDelay(this._blink),this.alpha=1},invincibleDuration(t){return this.delay(this._blink,250,-1),-1!==t&&this.delay(()=>this.removeComponent("Invincible"),t,0),this}});const ou="Listener";v.c(ou,{init(){this.listeners=[]},remove(){this.listeners.forEach(({object:t,event:e,callback:i})=>{t.unbind(e,i)}),this.listeners=[]},listenTo(t,e,i,a){null==a&&(a=this);let r=(...t)=>{i.apply(a,t)};this.listeners.push({object:t,event:e,callback:r}),t.uniqueBind(e,r)}});const od="ControlScheme";v.c(od,{init(){this.has("Cheats")||this.addComponent("Cheats"),this.trigger("Activated"),v.trigger("PlayerActivated")},remove(){this.has("Cheats")&&this.removeComponent("Cheats"),this.trigger("Deactivated"),v.trigger("PlayerDeactivated")}});const op="ShipControls";v.c(op,{init(){this.bind("NewDirection",t=>{this.disableControls||(-1===t.x&&!this.xFlipped||1===t.x&&this.xFlipped?"dead"!==this.appliedEntityState&&"reverse"!==this.appliedEntityState&&this.showState("reverse"):"flying"!==this.appliedEntityState&&this.showState("flying"))})},buttonPressed(t,e){this.disableControls||"dead"===this.appliedEntityState||this.trigger(e?"ButtonPressed":"ButtonReleased",t)}});const oy="ShipCollision";v.c(oy,{required:`Collision, ${tQ}`,init(){this.onHit("ShipSolid",t=>{let e=this.motionDelta(),i=0,a=0,r=0,n=0;t.map(t=>{let o=0,s=0;if("SAT"===t.type)o-=t.overlap*t.nx,s-=t.overlap*t.ny;else{let{obj:i}=t,a={x:0,y:0};i.intersect(this.x-e.x+a.x,this.y+a.y,this.w,this.h)&&(s-=e.y-a.y),i.intersect(this.x+a.y,this.y-e.y+a.y,this.w,this.h)&&(o-=e.x-a.x)}if(0!==o&&(o>0?(r<0&&this._squashShip(),r=1,i=Math.max(i,o)):(r>0&&this._squashShip(),r=-1,i=Math.min(i,o))),0!==s)return s<0?(n>0&&this._squashShip(),n=-1,a=Math.min(a,s)):(n<0&&this._squashShip(),n=1,a=Math.max(a,s))});let o=this.x,s=this.y;this.shift(i,a),(o===this.x&&i||s===this.y&&a)&&this._squashShip()}),this.onHit("PlayerEnemy",()=>{this.processDamage({velocity:-8e3,affects:"health",name:"Impact"})}),this.onHit("PlayerHit",t=>{this.health<=0||t.map(t=>{let e=t.obj;e.processDamage&&e.processDamage({velocity:-13e3,affects:"health",name:"Impact"})})})},_squashShip(){this.processDamage({velocity:-25e3,affects:"health",name:"Impact"})}});const om="AngleMotion";v.c(om,{properties:{velocity:{set:function(t){this._velocity=t,this._setAngleAndVelocity(this._angle,this._velocity)},get:function(){return this._velocity},configurable:!0,enumerable:!0},_velocity:{value:0,writable:!0,enumerable:!1},angle:{set:function(t){this._angle=t,this._setAngleAndVelocity(this._angle,this._velocity)},get:function(){return this._angle},configurable:!0,enumerable:!0},_angle:{value:0,writable:!0,enumerable:!1}},_setAngleAndVelocity(t,e){if(0===e){this.attr({vy:0,vx:0});return}this.attr({vy:-Math.sin(t/180*Math.PI)*e,vx:-Math.cos(t/180*Math.PI)*e})}});const of="Beam";v.c(of,{required:ta,properties:{beamVelocity:{set:function(t){this._beamVelocity=t,this._setBeamVelocity(this._beamVelocity)},get:function(){return this._beamVelocity},configurable:!0,enumerable:!0},_beamVelocity:{value:0,writable:!0,enumerable:!1}},events:{Freeze(){this._beamVelocity=0,this.beamBlocked=!1}},_setBeamVelocity(t){if(0===t){this.unbind("EnterFrame",this._updateBeam);return}this.beamLength=this.sw,this.uniqueBind("EnterFrame",this._updateBeam)},_updateBeam({dt:t}){let e=this._beamVelocity*(t/1e3);this.beamBlocked||(this.sw+=e),this.beamLength+=e}});const og="Steering";v.c(og,{properties:{steering:{set:function(t){this._steering!==t&&(this._steering=t,0===t?this.unbind("GameLoop",this._updateSteering):(this._updateSteering({dt:1}),this.uniqueBind("GameLoop",this._updateSteering)))},get:function(){return this._steering},configurable:!0,enumerable:!0},_steering:{value:0,writable:!0,enumerable:!1}},events:{Freeze(){this.currentTarget=null}},_updateSteering({dt:t}){if(!this.currentTarget&&this.target){let t=v(this.target);t.length>0&&(this.currentTarget=v(t[Math.floor(Math.random()*t.length)]))}if(!this.currentTarget)return;let e={x:this.currentTarget.x+this.currentTarget.w/2,y:this.currentTarget.y+this.currentTarget.h/2},i={x:this.x-e.x,y:this.y-e.y},a=Math.atan2(i.y,i.x)/Math.PI*180,r=this._steering/1e3*t,n=(a-this.angle-360)%360,o=(a-this.angle+360)%360,s=Math.abs(n)<Math.abs(o)?n:o;this.sight&&(s>this.sight||s<-this.sight)||(s>r?this.attr({angle:(360+this.angle+r)%360,rotation:this.autoRotate?this.rotation:(360+this.rotation+r)%360}):s<-r?this.attr({angle:(360+this.angle-r)%360,rotation:this.autoRotate?this.rotation:(360+this.rotation-r)%360}):this.attr({angle:(360+a)%360,rotation:this.autoRotate?this.rotation:(360+a)%360}))}});const ov=(t,e)=>t?w(e):e,ow=t=>Array.isArray(t)&&2===t.length&&t.every(t=>"number"==typeof t),ox=(t,e,i=0)=>void 0===e?i:ow(e)?e[0]+(e[1]-e[0])*t:e,o_=(t,e)=>e&&Object.entries(e).reduce((e,[i,a])=>({...e,[i]:ox(t,a)}),{}),ob="ScreenBound";v.c(ob,{required:"2D",init(){this.bind("GameLoop",this._checkBounds)},_checkBounds(){let t=-v.viewport._x+v.viewport._width/v.viewport._scale+10,e=-v.viewport._x-50,i=-v.viewport._y+v.viewport._height/v.viewport._scale+10,a=-v.viewport._y-50;(this.x>t||e>this.x||a>this.y||this.y>i)&&this.freeze()}});const oS=(t,e)=>{let i=null,a=null;if("SAT"===e.type){let[r,n]=b(t,t.w),o=t.bulletSettings.attached?r:-e.overlap;i=t.x+o-e.overlap*e.nx,a=t.y+n+t.h/2-e.overlap*e.ny}else{let r=e.obj,n=t.x<r.x&&t.w+t.x>r.x||void 0!==t.vx&&t.vx>0,o=t.x<r.x+r.w&&t.x+t.w>r.x||void 0!==t.vx&&t.vx<0,s=t.y<r.y&&t.h+t.y>r.y,l=t.y<r.w+r.h&&t.y+t.h>r.y;!n||s||l?!o||s||l?s?(i=t.x+t.w/2,a=r.y):l&&(i=t.x+t.w/2,a=r.y+r.h):(i=r.x+r.w,a=t.y+t.h/2):(i=r.x,a=t.y+t.h/2)}return{x:i,y:a,angle:t.angle}},oC="Bullet";v.c(oC,{required:`2D, Motion, WebGL, ${om}, ${of}, ${C}, ${tZ}`,events:{Freeze(){this.cooldowns={},this._parent&&this._parent.detach(this)}},init(){this.cooldowns={}},_targetHit(t,e,i){let a=this.bulletSettings.collisions[i];this.cooldowns[i]=30,t&&t.processDamage&&this.bulletSettings.damage&&v.rectManager.overlap(t,v.viewport.rect())&&(t.processDamage(this.bulletSettings.damage),this.spawner.mainEntity.trigger("DealtDamage",{damage:this.bulletSettings.damage,target:t})),a.state&&this.showState(a.state),(a.spawns||[]).forEach(([t,i])=>{oA(this.weaponDefinition,t,i,this,e,this.target)}),!1!==a.remove&&(this.unbind("GameLoop",this._updateBullet),this.bulletTime=0,this.freeze())},_bulletHitOn(t,e){let i=e[0].obj,a=oS(this,e[0]);this._targetHit(i,a,t)},bullet(t,e,i){this.weaponDefinition=t,this.bulletSettings={...e},this.bulletSettings.queue=(this.bulletSettings.queue||[]).map(t=>({duration:0,delay:0,...o_(this.difficulty,t)})),this.bulletSettings.damage=e.damage&&e.damage.map(t=>o_(this.difficulty,t));let a=ox(this.difficulty,e.velocity);this.attr({angle:e.angle,velocity:this.bulletSettings.attached?0:a,beamVelocity:this.bulletSettings.attached?a:0,target:i}),this.bulletTime=0,this.maxBulletTime=this.bulletSettings.queue.reduce((t,e)=>t+ox(this.difficulty,e.duration),0),this.uniqueBind("GameLoop",this._updateBullet)},_updateBullet({dt:t}){if(this.bulletTime+=t,this.bulletSettings.collisions&&(Object.keys(this.bulletSettings.collisions).forEach(e=>{let i=this.cooldowns[e];void 0!==i&&i>0&&(this.cooldowns[e]=i-t)}),this.bulletSettings.beam)){let t=1/0,e=null,i=null,a=_(this.angle);Object.keys(this.bulletSettings.collisions).forEach(r=>{let n=v.raycast(this,a,-1,r);n[0]&&n[0].distance<t&&(t=n[0].distance,e=n[0],i=r)}),e?(this.beamBlocked=!0,this.sw=e.distance+6,this._targetHit(e.obj,{x:e.x,y:e.y},i)):(this.beamBlocked=!1,this.sw=this.beamLength)}let e=this.bulletSettings.queue[0];if(e){e.delay=(e.delay||0)-t;let i=0===e.duration?1:(e.duration-(e.duration+e.delay))/e.duration;if(e.delay<=0&&0===e.duration&&(void 0!==e.velocity&&(this.bulletSettings.attached?this.attr({beamVelocity:e.velocity}):this.attr({velocity:e.velocity})),void 0!==e.angle&&this.attr({angle:ov(this.xFlipped,e.angle)}),void 0!==e.cleanOutOfScreen&&this.addComponent(ob),void 0!==e.collide&&(this._targetHit(void 0,{x:this.ox,y:this.oy},e.collide),e.collide=void 0),void 0!==e.steering&&this.addComponent(og).attr({steering:e.steering,sight:e.sight}),void 0!==e.aimOnTarget)){let t=v(this.target);if(t.length>0){let e=v(t[Math.floor(Math.random()*t.length)]),i={x:e.x+e.w/2,y:e.y+e.h/2},a={x:this.x-i.x,y:this.y-i.y},r=Math.atan2(a.y,a.x)/Math.PI*180;this.attr({angle:r,rotation:r})}}if(e.duration>0){if(e.audio){let[t,i]=[].concat(e.audio);tU.playAudio(t,i),e.audio=null}if(void 0!==e.frame&&(this.displayFrame(e.frame,e.duration),e.frame=null),!e.animateFn&&void 0!==e.velocity){let t=R(this,this.bulletSettings.attached?{beamVelocity:e.velocity}:{velocity:e.velocity}),i=M[e.easing||"linear"];e.animateFn=e=>t(i(e))}e.animateFn&&e.animateFn(i)}i>=1&&this.bulletSettings.queue.shift()}this.bulletTime>this.maxBulletTime&&0===this.bulletSettings.queue.length&&(this.unbind("GameLoop",this._updateBullet),this._parent&&this._parent.detach(this),this.bulletTime=0,this.freeze())}});let ok=[];v.bind("SceneDestroy",()=>ok=[]);const oD=t=>{let e=ok.find(e=>e.__frozen&&e.bulletDefinition===t);if(e)return t.entity&&e.showState("default"),e.unfreeze(),e.attr({x:3e3,y:3e3,angle:0,rotation:0}),e;let i=v.e(oC).attr({x:3e3,y:3e3,angle:0,rotation:0});if(i.bulletDefinition=t,t.sprite&&i.addComponent(t.sprite),t.composition){let e=ro(t.composition);i.addComponent(tb).compose(e)}if(t.particles){let e=rl(t.particles);i.addComponent(tq).particles(e)}if(t.entity&&i.addComponent(oB).applyDefinition(t.entity),!t.beam){let e=Object.keys(t.collisions||{});e.length>0&&(i.has("Collision")||i.addComponent("Collision"),e.forEach(t=>{i.onHit(t,e=>i._bulletHitOn(t,e))}))}return ok=ok.concat(i),i},oz=(t,e,i,a,r)=>{let n={...t,...e};if(n.angleRange)for(let t=ox(a,n.angleRange.from);t<=ox(a,n.angleRange.to);t+=ox(a,n.angleRange.step)){let e=i.angle+t;r({...n,angle:e})}else{let t=(i.angle||0)+(({...n,...e}).angle||0);r({...n,angle:t})}},oA=(t,e,i,a,r,n)=>{let o=t.spawnables[e];if(!o)throw Error(`Spawn ${e} not defined`);oz(o,i,r,a.difficulty,i=>{let s=oD(o),l=!1!==i.autoRotate,h=ov(a.xFlipped,i.angle||0),c=ov(a.xFlipped,l?h:0);if(s.attr({itemName:e,spawner:a,difficulty:a.difficulty,x:r.x-s.w/2,y:r.y-s.h/2,z:a.z,autoRotate:l,angle:h,steering:0,rotation:c}),"object"==typeof i.spawnPosition){let{w:t=0,h:e=0}=i.spawnBox||{},a=-(t/2)+Math.random()*t,n=-(e/2)+Math.random()*e;s.attr({x:r.x-s._origin.x+a,y:r.y-s._origin.y+n})}o.attached&&a.attach(s),o.emitDamage&&o.emitDamage.forEach(t=>{let e={...o_(a.difficulty,t),origin:{...r}},i=a.sourceEntity&&a.sourceEntity[0];t.targets.reduce((t,e)=>t.concat(Array.from(v(e))),[]).filter((t,e,a)=>a.indexOf(t)===e&&t!==i).forEach(t=>{let i=v(t);i.processDamage&&i.processDamage(e)})}),s.bullet(t,i,n)})},oP="Weapon";v.c(oP,{init(){this.xFlipped=!1,this.spawnQueue=[],this.burstsFired=0},weapon(t){return this.definition=t,this.active=!1,this.aimingEnabled=!0,this},flip(t){"X"===t&&(this.xFlipped=!this.xFlipped,void 0!==this.definition.angle&&(this.definition.angle=w(this.definition.angle||0)))},unflip(t){"X"===t&&(this.xFlipped=!this.xFlipped,void 0!==this.definition.angle&&(this.definition.angle=w(this.definition.angle||0)))},async activate(t){if(!this.definition.pattern)return;this.active=!0,this.burstsFired=0,this.activatedAt=new Date*1;let e=this.definition.pattern.spawnRhythm;return this.maxBursts=t||e.maxBursts||1/0,this.initialDelay=ox(this.difficulty,e.initialDelay),this._makeQueue(),this.uniqueBind("GameLoop",this._updateSpawnFrame),new Promise(t=>{this.one("WeaponFireComplete",()=>t(this))})},_makeQueue(){let t=this.definition.pattern.spawnRhythm;this.shotQueue=(t.shot||[{spawn:!0,duration:0}]).map(t=>({...t,duration:ox(this.difficulty,t.duration||0)})),this.shotQueueLength=this.shotQueue.reduce((t,e)=>t+e.duration,0)},async deactivate(){return this.active=!1,this.unbind("GameLoop",this._updateSpawnFrame),this.trigger("WeaponFireComplete"),this},_weaponSpawn(t,e=0){t.spawns.forEach(([t,i])=>{oA(this.definition.pattern,t,i,this,{x:this.x+(this.definition.x||0),y:this.y+(this.definition.y||0),angle:this.definition.angle+e},this.definition.target)})},_aimBarrel({dt:t}){let e=this.definition.pattern.aiming,i=0;if(e&&this.barrel){if(!this.aimingEnabled)return this.barrel.rotation;let a=v(this.definition.target);if(a.length>0){let r=v(a[Math.floor(Math.random()*a.length)]),n={x:r.x+r.w/2,y:r.y+r.h/2},o={x:this.barrel.ox-n.x,y:this.barrel.oy-n.y},s=Math.atan2(o.y,o.x);if(this.barrel.root.xFlipped){let a=s/Math.PI*180-180,r=w(v.math.clamp(w(a<0?a+180:a),e.range[1],e.range[0])),n=.001*e.rotateSpeed*t,o=v.math.clamp((r<0?r+360:r)-180-this.barrel.rotation,-n,n),l=this.barrel.rotation+o;i=l+(e.offsetAimAngle||0),this.barrel.attr({rotation:l})}else{let a=v.math.clamp(s/Math.PI*180,e.range[1],e.range[0]),r=.001*e.rotateSpeed*t,n=v.math.clamp(a-this.barrel.rotation,-r,r),o=this.barrel.rotation+n;i=o-(e.offsetAimAngle||0),this.barrel.attr({rotation:o})}}}return i},_updateSpawnFrame({dt:t}){let e=this.definition.pattern.spawnRhythm,i=this._aimBarrel({dt:t});if(this.initialDelay>0){if(this.initialDelay-=t,!(this.initialDelay<=0))return;this.shotIndex=0,this.shotDelay=0}if(this.shotDelay<=0){let a=0-this.shotDelay,r=this.mainEntity,n=this.shotQueue[0];if(n){n.delay=(n.delay||0)-t;let a=0===n.duration?1:(n.duration-(n.duration+n.delay))/n.duration;n.state&&r&&(r.showState(n.state,n.duration),n.state=void 0),!0===n.stopAiming&&(this.aimingEnabled=!1,n.stopAiming=void 0),n.audio&&(tU.playAudio(n.audio),n.audio=void 0),!1===n.stopAiming&&(this.aimingEnabled=!0,n.stopAiming=void 0),n.spawn&&(this._weaponSpawn(e,i),n.spawn=!1),a>=1&&this.shotQueue.shift()}if(a>this.shotQueueLength&&0===this.shotQueue.length){if(this.shotIndex++,this.shotIndex>=ox(this.difficulty,e.burst)){let t=ox(this.difficulty,e.burstDelay);this.burstsFired+=1,this.initialDelay=t+ox(this.difficulty,e.shotDelay),ox(this.difficulty,this.maxBursts)<=this.burstsFired?this.deactivate():this._makeQueue();return}this.shotDelay=ox(this.difficulty,e.shotDelay),this.shotDelay>0&&this._makeQueue()}}this.shotDelay-=t}});const oF=t=>{if(!t)return{};let e=t.x,i=t.y;return t.rx&&(e=v.viewport.width*t.rx),t.ry&&(i=v.viewport.height*t.ry),{x:e,y:i}},oE=(t,e={})=>{let{location:i,...a}=e;return v.e("2D, WebGL, EntityDefinition").attr({x:0,y:0}).applyDefinition(t).attr({...oF(i),...a})},oB="EntityDefinition",oT=(t,e,i,a)=>{let r=[];if(i.composition){let t=ro(i.composition);e.addComponent(tb).compose(t),i.frame||(e.getAnimation("default")?r.push(e.playAnimation("default")):r.push(e.displayFrame("default",a))),i.animation||e.stopAnimation()}if(void 0!==i.animation&&e.has(tb)&&r.push(i.animation?e.playAnimation(i.animation):e.stopAnimation()),i.frame&&e.has(tb)){let[t,n]="string"==typeof i.frame?[i.frame,{duration:a}]:i.frame;r.push(e.displayFrame(t,n.duration||a,n.easing))}if(i.audio&&tU.playAudio(i.audio),i.entity&&e.addComponent(oB).applyDefinition(i.entity),i.state&&r.push(e.showState(i.state,a)),i.particles){if(i.particles.emitter){let a=i.particles.emitter;if(Array.isArray(a)){let t=u(rd)({},rl(a[0]),a[1]);if(e.emitter)e.emitter.particles(t,e);else{let i=v.e(tq).particles(t,e);e.attr({w:t.emitter.w,h:t.emitter.h}),e.emitter=i,e.emitting=a[0]}}else{let t=rl(a);if(e.emitter)e.emitter.particles(t,e);else{let i=v.e(tq).particles(t,e);e.attr({w:t.emitter.w,h:t.emitter.h}),e.emitter=i,e.emitting=a}}if(!!t.xFlipped!=!!e.emitter.xFlipped){let t=(e.angle||0)-e.emitter.particleSettings.currentAngle;e.emitter.xFlipped=!e.emitter.xFlipped,e.angle=w(e.emitter.particleSettings.currentAngle)+t,e.trigger("Change",{angle:e.angle})}}!0===i.particles.active&&e.emitter.startEmission(),!1===i.particles.active&&e.emitter.stopEmission()}if(i.components&&i.components.forEach(t=>{if("string"==typeof t)e.addComponent(t);else{let[i,a]=t;e.addComponent(i).attr(a)}}),i.removeComponents&&i.removeComponents.forEach(t=>e.removeComponent(t)),i.weapon){if(i.weapon.pattern){let a=ru(i.weapon.pattern);if(!e.has(oP)||e.definition&&e.definition.pattern!==a){if(i.weapon.barrel){let a=t.getElementByKey(i.weapon.barrel);e.barrel=a}else e.barrel=null;e.attr({difficulty:0,mainEntity:t}).addComponent(oP).weapon({...i.weapon,pattern:a})}}r.push(i.weapon.active?e.activate(i.weapon.maxBursts):e.deactivate())}return i.attachments&&"function"==typeof e.attachEntity&&Object.entries(i.attachments).forEach(([i,n])=>{if(n){let o=n.name||i,s=e[o]||v.e("2D").attr({w:1,h:1,sourceEntity:t});r.push(oT(t,s,n,a)),e.attachEntity(i,s),e[o]=s}else e.clearAttachment(i),e[i]=null}),Promise.all(r)};v.c(oB,{init(){this.appliedEntityDefinition=null,this.appliedEntityName=null,this.appliedEntityState="default",this.showState=this.showState.bind(this)},applyDefinition(t){let e=rs(t);return this.addComponent(t),oT(this,this,e.structure,0),this.appliedEntityDefinition=e,this.appliedEntityName=t,this},showState(t,e=0){let i="default"===t?this.appliedEntityDefinition.structure:this.appliedEntityDefinition.states[t];if(i)return this.appliedEntityState=t,oT(this,this,i,e)}}),v.c("ShipSpawnable",{required:ou,events:{Activated:"spawnShip"},spawnPosition(t){return this.spawnPosition=t,null==this.spawnPosition&&(this.spawnPosition=()=>({x:this.x,y:this.y})),this},spawnShip({existing:t=!1}){if(!this.has(od)||!(this.lives>0))return;let e=this.spawnPosition();return e.x<10&&(e.x=10),null!=this.ship&&(e={x:this.ship.x,y:this.ship.y},this.ship.destroy(),this.ship=null),this.ship=t&&v(this.shipType).get(0)||oE(this.shipType,{location:e}),this.ship.addComponent(op,oy),this.ship.allowDamage({health:50}),this.has(od)&&this.assignControls(this.ship),this.trigger("ShipSpawned",this.ship),v.trigger("ShipSpawned",this.ship),this.ship}}),v.c("Rotating",{required:"2D",events:{GameLoop({dt:t}){0!==this.vr&&(this.rotation=(this.rotation+this.vr*t/1e3)%360)}}});var oM={};oM="#define GLSLIFY 1\nattribute vec2 aPosition;\nattribute vec4 aSpriteDimensions;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute vec4 aOverrideColor;\nattribute vec4 aGradient;\n\nvarying mediump vec3 vTextureCoord;\nvarying lowp vec4 vColor;\nvarying lowp vec4 vOverrideColor;\nvarying lowp vec4 vGradient;\nvarying lowp vec4 vSpriteDimensions;\n\nuniform vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n  vColor = aColor;\n  vOverrideColor = aOverrideColor;\n  vGradient = aGradient;\n  vSpriteDimensions = aSpriteDimensions;\n}\n\n";var oL={};oL="precision mediump float;\n#define GLSLIFY 1\nvarying mediump vec3 vTextureCoord;\nvarying mediump vec4 vColor;\nvarying mediump vec4 vOverrideColor;\nvarying mediump vec4 vGradient;\nvarying mediump vec4 vSpriteDimensions;\n\nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nfloat random(vec3 scale, float seed) {\n  // use the fragment position for a different seed per-pixel\n  return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvec3 rgb2hsv(vec3 c) {\n  vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n  float d = q.x - min(q.w, q.y);\n  float e = 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main() {\n  highp vec2 coord = vTextureCoord.xy / uTextureDimensions;\n\n  if ((vGradient.a >= 0.0) && (vTextureCoord.y >= vGradient.a)) {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n\n  if ((vGradient.z >= 0.0) && (vTextureCoord.y <= vGradient.z)) {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n\n  mediump vec4 texelColor = texture2D(uSampler, coord);\n  mediump float yCoord = (vTextureCoord.y - vSpriteDimensions.y) / vSpriteDimensions.a;\n  mediump float mixFactor = (vGradient.x * (1.0 - yCoord)) + (vGradient.y * yCoord);\n\n  mediump float lightness = (0.2126 * texelColor.r + 0.7152 * texelColor.g + 0.0722 * texelColor.b);\n  if (vOverrideColor.a >= 1.0 && vOverrideColor.a <= 2.0) {\n    mediump float overrideLightness = (0.2126 * vOverrideColor.r + 0.7152 * vOverrideColor.g + 0.0722 * vOverrideColor.b);\n    texelColor = mix(texelColor, vec4(vOverrideColor.rgb * (lightness + overrideLightness), texelColor.a), vOverrideColor.a - 1.0);\n  }\n  if (vOverrideColor.a == 6.0) {\n    texelColor = vec4(vOverrideColor.rgb, texelColor.a);\n  }\n  if (vOverrideColor.a >= 4.0 && vOverrideColor.a <= 5.0) {\n    vec3 texelHSV = rgb2hsv(texelColor.rgb);\n    if ((texelHSV.x < .84) && (texelHSV.x > .82)) {\n      vec3 overrideHSV = rgb2hsv(vOverrideColor.rgb);\n      texelHSV.x = overrideHSV.x;\n      texelHSV.y *= overrideHSV.y;\n      texelHSV.z *= overrideHSV.z;\n      vec3 texelRGB = hsv2rgb(texelHSV);\n      texelColor = mix(texelColor, vec4(texelRGB.rgb, texelColor.a), vOverrideColor.a - 4.0);\n    }\n  }\n\n  mediump float lightnessBase = (0.2126*vColor.r + 0.7152*vColor.g + 0.0722*vColor.b);\n  mediump vec4 baseColor = vec4(vColor.rgb, texelColor.a) * (1.0 + (lightness - lightnessBase));\n  mediump vec4 mixColor = vec4(\n    (baseColor.rgba * mixFactor) + (texelColor.rgba * (1.0 - mixFactor))\n  );\n\n  if (vColor.a > 1.0) {\n    mixColor.rgb = vColor.rgb;\n  }\n\n  gl_FragColor = vec4(\n    mixColor.rgb * vColor.a * texelColor.a * vTextureCoord.z,\n    texelColor.a * vTextureCoord.z\n  );\n}\n\n";const oR=t=>{if(!t._parent)return t.hideBelow?[t.hideBelow]:[];{let e=[];if(t.hideBelow){let i=t._parent.y+t.hideBelow;e.push(i)}return e.concat(oR(t._parent))}},oO=t=>{if(!t._parent)return t.hideAbove?[t.hideAbove]:[];{let e=[];if(t.hideAbove){let i=t._parent.y+t.hideAbove;e.push(i)}return e.concat(oO(t._parent))}},oj=t=>{let e=oR(t);return 0===e.length?null:Math.min(...e)},oH=t=>{let e=oO(t);return 0===e.length?null:Math.min(...e)};v.defaultShader("Sprite",new v.WebGLShader(u(oM),u(oL),[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2},{name:"aColor",width:4},{name:"aOverrideColor",width:4},{name:"aGradient",width:4},{name:"aSpriteDimensions",width:4}],function(t,e){let i;let{co:a}=t;t.program.writeVector("aTextureCoord",a.x+1,a.y+1,a.x+1,a.y+a.h-1,a.x+a.w-1,a.y+1,a.x+a.w-1,a.y+a.h-1),t.program.writeVector("aSpriteDimensions",a.x,a.y,a.w,a.h);let r=null!=e.desaturationColor?e.desaturationColor:{_red:0,_green:0,_blue:0},n=null!=e.overrideColor?e.overrideColor:{_red:0,_green:0,_blue:0},o=null!=e.lightness?e.lightness:1;i=e.hidden&&null!=e.scale?e.scale:1;let s=null!=e.topDesaturation?e.topDesaturation:0,l=null!=e.bottomDesaturation?e.bottomDesaturation:0,h=s+(1-i)*1.15,c=l+(1-i)*1.15;e.hitFlash&&(n=e.hitFlash,h=0,c=0),t.program.writeVector("aColor",r._red,r._green,r._blue,o);let u=0;null!=e.overrideColor&&(u=1+e.overrideColorStrength),"partial"===e.overrideColorMode&&(u=4+e.overrideColorStrength),"none"===e.overrideColorMode&&(u=0),e.hitFlash&&(u=6),t.program.writeVector("aOverrideColor",n._red,n._green,n._blue,u);let d=-1;e.hideAt&&(d=Math.max(0,a.y+(e.hideAt-e.y)/e.h*a.h));let p=oj(e);null!==p&&(d=Math.max(0,a.y+(p-e.y)/e.h*a.h));let y=-1,m=oH(e);null!==m&&(y=Math.max(0,a.y+(m-e.y)/e.h*a.h)),t.program.writeVector("aGradient",h,c,y,d)})),v.c("TextInput",{init(){this.requires("2D, DOM, Text")},remove(){},textInput(t,e){return new Promise(i=>{let a="A  ",r=0;this.text(a),t.bind("Up",()=>{a=this._updateText(a,r,1),this.text(a)}),t.bind("Down",()=>{a=this._updateText(a,r,-1),this.text(a)}),t.bind("Left",()=>(r=Math.max(r-1,0),this._updateCursor(r))),t.bind("Right",()=>{r=Math.min(r+1,e-1),this._updateCursor(r)}),t.bind("Fire",()=>{let n=r;r=Math.min(r+1,e-1),this._updateCursor(r),r===n&&r===e-1&&(t.unbind("Up"),t.unbind("Down"),t.unbind("Left"),t.unbind("Right"),t.unbind("Fire"),i(a))}),this.cursor=v.e("2D, DOM, Text").attr({x:this.x,y:this.y,w:this.w}).text("_  ").textColor("#0000FF").textAlign("left").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),this.attach(this.cursor)})},_updateCursor(t){let e=Array(t+1).join("&nbsp;")+"_";this.cursor.text(e)},_updateText(t,e,i){let a="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-_.=!$& ",r=a.indexOf(t[e])+a.length,n=a[(r+i)%a.length];return t.slice(0,e)+n+t.slice(e+1)}}),v.c("LightGlare",{required:"2D, WebGL",events:{EnterFrame(){let t=v.viewport.width/2,e=v.viewport.height/2,i=this.x+this.w/2-t,a=this.y+this.h/2-e,r=this.glareLink||this.getElementByKey(this.glareAlphaLink),n=r?r.alpha:1,o=(t,e)=>{e.attr({x:this.x+this.w/2-e.w/2+(-i-i)*t,y:this.y+this.h/2-e.h/2+(-a-a)*t,alpha:e.baseAlpha*n})};o(1.1,this.bigGlare),o(.9,this.blueGlare),o(.8,this.redGlare)}},init(){this.bigGlare=v.e("2D, WebGL, Glare, bigGlare, Horizon").crop(0,0,200,200).attr({w:200,h:200,z:91,baseAlpha:.3,alpha:0}).origin("center").saturationGradient(.1,.1),this.blueGlare=v.e("2D, WebGL, Glare, bigGlare, Horizon").crop(0,0,200,200).attr({w:80,h:80,z:91,baseAlpha:.5,alpha:0}).origin("center").saturationGradient(1,1),this.redGlare=v.e("2D, WebGL, Glare, bigGlare, ColorEffects").crop(0,0,200,200).attr({w:20,h:20,z:91,baseAlpha:.7,alpha:0}).colorOverride("#fd6565").origin("center")}}),v.c("Overlap",{required:"2D,  Collision",events:{UpdateFrame(){let t=[0],e=this.area(),i=this.hit(this.checkCollission);i&&i.forEach(e=>{let i=e.obj,a=Math.max(this.x,i.x),r=Math.min(this.x+this.w,i.x+i.w),n=Math.max(this.y,i.y),o=Math.min(this.y+this.h,i.y+i.h);t.push((r-a)*(o-n)*1.7)});let a=1.7*Math.max(...t),r=this.glareLink||this.getElementByKey(this.applyAlphaTo);r.alpha=(1-(a>e?1:a/e))*r.maxAlpha}}});var oI={};oI=new URL("symsonic-hero.826b0761.mp3",import.meta.url).toString();var oG={};oG=new URL("zak-120bpm.f1ef8ffb.mp3",import.meta.url).toString();var oq={};oq=new URL("stoomboot-210bpm.fc071f2f.mp3",import.meta.url).toString();const oU=[{name:"effects",file:u(new URL("effects.fbcc1da6.ogg",import.meta.url).toString()),map:[{name:"explosion",type:"sfx",duration:629},{name:"gun-shot",type:"sfx",duration:295},{name:"hatch-open",type:"sfx",duration:1126,volume:.4},{name:"helicopter",type:"sfx",duration:409,loop:!0,volume:.4},{name:"laser-charge",type:"sfx",duration:1674,volume:.3},{name:"laser-fire",type:"sfx",duration:1725,volume:1.2},{name:"laser-hit",type:"sfx",duration:267},{name:"laser-shot",type:"sfx",duration:453,volume:.2},{name:"laugh",type:"sfx",duration:1695},{name:"powerup",type:"sfx",duration:906}]},{name:"hero",file:u(oI),map:[{name:"hero",type:"music",loop:!0,loopEnd:180+55.682,loopStart:69.862}]},{name:"sint",file:u(oG),map:[{name:"sint",type:"music",loop:!0}]},{name:"boss",file:u(oq),map:[{name:"boss",type:"music",loop:!0}]}];var oN={};oN=new URL("dino.f265853a.png",import.meta.url).toString();var oV={};oV=JSON.parse('{"tile":32,"tileh":32,"map":{"backgroundPlanet":[10,0,8,8],"dinoHead":[0,0,3,2],"dinoBody":[3,0,5,4],"dinoArm":[1,4,2,2],"dinoNeck":[3,4,2,2],"dinoJaw":[0,2,3,2],"dinoTail":[2,6,4,2],"dinoUpperLeg":[5,4,2,2],"dinoLowerLeg":[1,6,1,2],"dinoFeet":[0,6,1,1],"dinoToes":[0,5,1,1],"dinoTongue":[0,4,1,1],"dinoBackFeet":[0,7,1,1],"dinoBackUpperLeg":[6,6,2,2],"dinoBackLowerLeg":[7,4,1,2],"dinoBackToes":[8,4,1,1],"dinoTentacles":[8,0,2,1]}}');var oX={};oX=new URL("mega-texture.85bd0e29.png",import.meta.url).toString();var oW={};oW=JSON.parse('{"tile":32,"tileh":32,"map":{"waterHorizon":[0,17,8,5],"waterMiddle":[32,0,16,6],"waterFront1":[0,29,16,3],"waterFront2":[16,29,16,3],"coastStart":[18,12,8,1],"coast":[8,17,8,1],"cityBridge":[0,24,16,5],"cityStart":[0,0,16,9],"city":[16,0,16,9],"cityLayer2":[0,9,12,8],"cityDistance":[32,6,8,7],"cityDistanceBaseBottom":[32,9,8,4],"cityDistanceBaseTop":[40,6,8,7],"grassFront":[50,13,32,3],"grassMiddle":[50,7,16,6],"pond":[55,0,16,6],"pondStart":[72,0,16,6],"hedge":[67,8,12,5],"roof":[67,17,14,14],"chimney":[58,33,1,4],"present":[57,34,1,1],"villageSkyline":[49,39,16,8],"villageSkylineFull":[49,39,16,19],"villageDistantSkyline":[49,33,8,4],"hillSkyline":[49,38,6,1],"playerTop":[0,63,5,4],"playerBottom1":[0,67,5,2],"playerBottom2":[5,67,5,2],"portraitJinte1":[16,59,4,4],"portraitJinte2":[20,59,4,4],"portraitJonas":[16,64,4,7],"portraitSint":[22,64,5,6],"fish":[10,59,2,2],"bird":[12,59,2,2],"seagull":[11,63,3,3],"flats":[10,61,1,1],"carrot":[8,61,1,1],"moon":[12,61,2,2],"title":[51,59,13,15],"bigBuildingTop":[16,13,13,6],"bigBuildingBrokenTop":[30,13,13,6],"bigBuildingLayer":[16,19,13,4],"bigBuildingBottom":[16,23,13,6],"bigBuildingBottom2":[30,23,13,6],"glass":[12,9,4,3],"cloud":[16,9,8,3],"shadow":[16,12,2,1],"bridgeDeck":[0,32,16,4],"damagedBridgeDeck":[16,32,16,4],"bridgePillar":[36,29,6,17],"bridgePillarBroken":[42,29,6,17],"bigGlare":[0,38,7,7],"sun":[12,13,3,3],"chute":[12,12,1,1],"directGlare":[8,18,6,6],"aircraftCarrierEnd":[30,43,6,5],"aircraftCarrierStart":[19,43,6,5],"aircraftCarrierBottomFlat":[22,45,4,3],"aircraftCarrierBottomSpace":[26,45,4,3],"aircraftCarrierTopFlat":[26,43,4,2],"aircraftCarrierClosed":[8,44,3,3],"aircraftCarrierDoor":[11,44,1,3],"aircraftCarrier5":[14,42,1,1],"aircraftCarrier7":[14,41,1,1],"aircraftCarrierEngine":[15,41,3,3],"aircraftCarrierEngineDestroyed":[15,38,3,3],"aircraftCarrierEngineMeter":[14,43,1,1],"aircraftCarrierOpenHatch":[31,38,4,1],"aircraftCarrierHatchLid":[31,39,4,1],"aircraftCarrierLowCabin":[17,46,1,2],"aircraftCarrierLowCabinStart":[18,46,1,2],"aircraftCarrierCabinStart":[7,38,1,6],"aircraftCarrierCabinRadar":[8,38,2,6],"aircraftCarrierCabin":[10,38,2,6],"aircraftCarrierCabinEnd":[12,38,2,6],"aircraftCarrierCabinStartBroken":[18,39,1,4],"aircraftCarrierCabinRadarBroken":[19,39,2,4],"aircraftCarrierCabinBroken":[21,39,2,4],"aircraftCarrierCabinEndBroken":[23,39,2,4],"aircraftCarrierRadar":[26,38,2,2],"aircraftCarrierRadarBroken":[26,40,2,2],"aircraftCarrierRadarEmit":[23,38,2,1],"aircraftCarrierAntenna":[29,38,2,3],"aircraftCarrierWires":[25,38,1,1],"aircraftCarrierHole":[22,38,1,1],"boxes":[28,39,1,1],"boxesFalling":[28,38,1,1],"debris1":[44,13,4,4],"stars":[44,17,21,9],"playerShip":[0,48,3,2],"playerShipTurning":[0,46,3,2],"playerShipDamaged":[0,50,3,2],"playerShipDamagedTurning":[3,46,3,2],"playerShipFront":[6,49,3,2],"muzzleFlash":[10,48,1,1],"shipEngineFire":[4,53,3,1],"freddie":[3,49,3,2],"standardMine":[3,51,1,1],"mineOpening1":[4,51,1,1],"mineOpening2":[5,51,1,1],"mineBlink":[6,51,1,1],"standardDrone":[0,52,2,2],"standardDroneDamage":[2,52,2,2],"standardRocket":[4,52,2,1],"bulletDrone":[0,36,2,1],"helicopter":[0,54,4,2],"helicopter2":[4,54,4,2],"heliDamaged":[8,54,4,2],"helicopterLanded":[12,56,4,2],"helicopterTurning1":[16,56,2,2],"helicopterTurning2":[18,56,2,2],"helicopterGun":[12,54,1,1],"standardLargeDrone":[0,56,3,3],"standardLargeDroneDamage1":[3,56,3,3],"standardLargeDroneDamage2":[6,56,3,3],"standardLargeDroneDamage3":[9,56,3,3],"rapidFireBoost":[11,48,1,1],"speedBoost":[12,48,1,1],"damageBoost":[13,48,1,1],"aimBoost":[14,48,1,1],"heart":[13,49,1,1],"star":[14,49,1,1],"upgrade":[15,49,1,1],"powerUpBox":[10,49,1,1],"powerUpBox2":[11,49,1,1],"powerUpBox3":[12,49,1,1],"sphere1":[7,51,1,1],"sphere2":[8,51,1,1],"lightBullet":[9,51,1,1],"laserTank":[0,59,6,3],"laserTankBarrel":[6,59,4,2],"bulletCannon":[13,55,3,1],"mineCannon":[11,51,2,1],"turretFoot":[12,55,1,1],"general1":[16,48,4,4],"general2":[20,48,4,4],"pilot1":[16,52,4,4],"pilot2":[20,52,4,4],"explosion1":[24,48,3,3],"explosion2":[27,48,3,3],"explosion3":[30,48,3,3],"explosion4":[33,48,3,3],"explosion5":[36,48,3,3],"explosion6":[24,51,3,3],"explosion7":[27,51,3,3],"explosion8":[30,51,3,3],"explosion9":[33,51,3,3],"explosion10":[36,51,3,3],"explosion11":[24,54,3,3],"explosion12":[27,54,3,3],"explosion13":[30,54,3,3],"explosion14":[33,54,3,3],"explosion15":[36,54,3,3],"explosion16":[24,57,3,3],"explosion17":[27,57,3,3],"explosion18":[30,57,3,3],"explosion19":[33,57,3,3],"explosion20":[36,57,3,3],"laserGunCore":[10,50,2,1],"laserGunHandle":[11,50,2,1],"laserGunBarrel":[13,50,3,1],"bulletShell":[13,12,1,1],"clothBottom":[12,47,5,1],"cloth":[12,44,5,3],"titleShip":[47,26,9,5],"burstRing":[48,0,6,6]}}');const oY=[{name:"mega-texture",image:u(oX),map:u(oW)},{name:"dino",image:u(oN),map:u(oV)}],oK=async t=>new Promise(e=>{let i={sprites:{}};oY.filter(e=>t.includes(e.name)).forEach(t=>{i.sprites[t.image.split("?").at(0)]=t.map}),v.load(i,e)});var oJ=()=>({loadSpriteSheets:oK,loadAudio:async t=>Promise.all(t.map(t=>oU.find(e=>e.name===t)).filter(Boolean).map(t=>tU.loadAudio(t)))}),o$=(t,e)=>{let i=(t,...e)=>t(...e),a=i=>{let a=Math.floor(i/40);return new Promise((i,r)=>v.e("Delay").delay(()=>{t.currentScript()||i(void 0),!0===e.gameEnded&&r(Error("Game Over"))},40,a,function(){i(void 0),this.destroy()}))};return{until:async(e,i)=>{let a=!1,r=0;for(e(t).then(()=>{a=!0});!a;)await i(t,r),r++},waitWhile:async(t,...e)=>{let r=await i(t,...e);for(;r;)await a(50),r=await i(t,...e)},waitForEvent:(t,e,i)=>new Promise((a,r)=>{let n=()=>{a()};t.one("Remove",n),t.one("GameOver",n),t.one(e,async()=>{t.unbind("Remove",n),t.unbind("GameOver",n);try{await i()}catch(t){r(t);return}a()})}),wait:a,exec:async(e,...i)=>{await e(t,...i)},parallel:t=>Promise.all(t.map(t=>t())),race:t=>Promise.race(t.map(t=>t())),call:i}},oQ={};!function(t){function e(t){function e(t,e,i){this.x=t,this.y=e,this.z=i}e.prototype.dot2=function(t,e){return this.x*t+this.y*e},e.prototype.dot3=function(t,e,i){return this.x*t+this.y*e+this.z*i},this.grad3=[new e(1,1,0),new e(-1,1,0),new e(1,-1,0),new e(-1,-1,0),new e(1,0,1),new e(-1,0,1),new e(1,0,-1),new e(-1,0,-1),new e(0,1,1),new e(0,-1,1),new e(0,1,-1),new e(0,-1,-1)],this.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this.perm=Array(512),this.gradP=Array(512),this.seed(t||0)}e.prototype.seed=function(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(var e=this.p,i=0;i<256;i++){a=1&i?e[i]^255&t:e[i]^t>>8&255;var a,r=this.perm,n=this.gradP;r[i]=r[i+256]=a,n[i]=n[i+256]=this.grad3[a%12]}};var i=.5*(Math.sqrt(3)-1),a=(3-Math.sqrt(3))/6,r=1/3,n=1/6;function o(t){return t*t*t*(t*(6*t-15)+10)}e.prototype.simplex2=function(t,e){var r,n,o,s,l,h=(t+e)*i,c=Math.floor(t+h),u=Math.floor(e+h),d=(c+u)*a,p=t-c+d,y=e-u+d;p>y?(s=1,l=0):(s=0,l=1);var m=p-s+a,f=y-l+a,g=p-1+2*a,v=y-1+2*a;c&=255,u&=255;var w=this.perm,x=this.gradP,_=x[c+w[u]],b=x[c+s+w[u+l]],S=x[c+1+w[u+1]],C=.5-p*p-y*y;C<0?r=0:(C*=C,r=C*C*_.dot2(p,y));var k=.5-m*m-f*f;k<0?n=0:(k*=k,n=k*k*b.dot2(m,f));var D=.5-g*g-v*v;return D<0?o=0:(D*=D,o=D*D*S.dot2(g,v)),70*(r+n+o)},e.prototype.simplex3=function(t,e,i){var a,o,s,l,h,c,u,d,p,y,m=(t+e+i)*r,f=Math.floor(t+m),g=Math.floor(e+m),v=Math.floor(i+m),w=(f+g+v)*n,x=t-f+w,_=e-g+w,b=i-v+w;x>=_?_>=b?(h=1,c=0,u=0,d=1,p=1,y=0):(x>=b?(h=1,c=0,u=0):(h=0,c=0,u=1),d=1,p=0,y=1):_<b?(h=0,c=0,u=1,d=0,p=1,y=1):x<b?(h=0,c=1,u=0,d=0,p=1,y=1):(h=0,c=1,u=0,d=1,p=1,y=0);var S=x-h+n,C=_-c+n,k=b-u+n,D=x-d+2*n,z=_-p+2*n,A=b-y+2*n,P=x-1+3*n,F=_-1+3*n,E=b-1+3*n;f&=255,g&=255,v&=255;var B=this.perm,T=this.gradP,M=T[f+B[g+B[v]]],L=T[f+h+B[g+c+B[v+u]]],R=T[f+d+B[g+p+B[v+y]]],O=T[f+1+B[g+1+B[v+1]]],j=.5-x*x-_*_-b*b;j<0?a=0:(j*=j,a=j*j*M.dot3(x,_,b));var H=.5-S*S-C*C-k*k;H<0?o=0:(H*=H,o=H*H*L.dot3(S,C,k));var I=.5-D*D-z*z-A*A;I<0?s=0:(I*=I,s=I*I*R.dot3(D,z,A));var G=.5-P*P-F*F-E*E;return G<0?l=0:(G*=G,l=G*G*O.dot3(P,F,E)),32*(a+o+s+l)},e.prototype.perlin2=function(t,e){var i,a=Math.floor(t),r=Math.floor(e);t-=a,e-=r,a&=255,r&=255;var n=this.perm,s=this.gradP,l=s[a+n[r]].dot2(t,e),h=s[a+n[r+1]].dot2(t,e-1),c=s[a+1+n[r]].dot2(t-1,e),u=s[a+1+n[r+1]].dot2(t-1,e-1),d=o(t);return(1-(i=o(e)))*((1-d)*l+d*c)+i*((1-d)*h+d*u)},e.prototype.perlin3=function(t,e,i){var a=Math.floor(t),r=Math.floor(e),n=Math.floor(i);t-=a,e-=r,i-=n,a&=255,r&=255,n&=255;var s=this.perm,l=this.gradP,h=l[a+s[r+s[n]]].dot3(t,e,i),c=l[a+s[r+s[n+1]]].dot3(t,e,i-1),u=l[a+s[r+1+s[n]]].dot3(t,e-1,i),d=l[a+s[r+1+s[n+1]]].dot3(t,e-1,i-1),p=l[a+1+s[r+s[n]]].dot3(t-1,e,i),y=l[a+1+s[r+s[n+1]]].dot3(t-1,e,i-1),m=l[a+1+s[r+1+s[n]]].dot3(t-1,e-1,i),f=l[a+1+s[r+1+s[n+1]]].dot3(t-1,e-1,i-1),g=o(t),v=o(e),w=o(i);return(1-v)*((1-w)*((1-g)*h+g*p)+w*((1-g)*c+g*y))+v*((1-w)*((1-g)*u+g*m)+w*((1-g)*d+g*f))},t.Noise=e}(oQ);var oZ={},o0={},o1={},o2={},o5=Math.floor,o3=Math.random;o2=function(t,e){return t+o5(o3()*(e-t+1))},o1=function(t,e){var i=-1,a=t.length,r=a-1;for(e=void 0===e?a:e;++i<e;){var n=o2(i,r),o=t[n];t[n]=t[i],t[i]=o}return t.length=e,t},o0=function(t){return o1(n_(t))};var o4={},o6={},o8={},o7={};o7=function(t,e){for(var i=-1,a=null==t?0:t.length,r=Array(a);++i<a;)r[i]=e(t[i],i,t);return r},o8=function(t,e){return o7(e,function(e){return t[e]})};var o9={},st={},se={};se=nD(Object.keys,Object);var si=Object.prototype.hasOwnProperty;st=function(t){if(!nz(t))return se(t);var e=[];for(var i in Object(t))si.call(t,i)&&"constructor"!=i&&e.push(i);return e},o9=function(t){return nO(t)?n5(t):st(t)},o6=function(t){return null==t?[]:o8(t,o9(t))},o4=function(t){return o1(o6(t))},oZ=function(t){return(nL(t)?o0:o4)(t)};const sa=t=>t[0],sr=t=>sa(u(oZ)(v(t).get())),sn=t=>{let e=Math.random();for(let i in t){let a=t[i];if(!(e>a))return i;e-=a}},so=t=>"string"==typeof t?t:sn(t),ss=t=>{(sr("Scenery")||v.e("Scenery, 2D")).setNextScenery(t)},sl=()=>(sr("Scenery")||v.e("Scenery, 2D")).movingDirection,sh=t=>{(sr("Scenery")||v.e("Scenery, 2D")).setAltitude(t)},sc=()=>(sr("Scenery")||v.e("Scenery, 2D")).altitude;let su=null,sd=0,sp=null;const sy=()=>{sp(),su=null,sd=0,sp=null},sm=(t,e=0)=>new Promise(i=>{su=t,sd=e,sp=i});v.c("SceneryBlock",{required:`2D, Motion, ${tZ}`,events:{Freeze(){this._children.forEach(t=>t.freeze())},Unfreeze(){this._children.forEach(t=>t.unfreeze())}},init(){this.bind("Move",this.sceneryBlockMoved)},remove(){this.unbind("Move",this.sceneryBlockMoved)},moveScenery(t,e,{vx:i,vy:a}){this.shift(t,e);let r=t-i/v.timer.FPS(),n=e-a/v.timer.FPS();this._children.forEach(t=>{1!==t.distance&&t.shift(-r*(1-t.distance),-n*(1-t.distance*t.distance))})},sceneryBlockMoved(){this.sceneryName===su&&(this.vx<=0&&this.x<-sd?sy():this.vx>0&&this.x>sd&&sy());let t={v1:this.x,v2:this.x+this.w,v3:1/0,v4:-1/0},e=this.dx,i=this.dy;this._children.forEach(a=>{1!==a.distance&&(a.shift(-e*(1-a.distance),-i*(1-a.distance*a.distance)),a.distance===this.farthestDistance&&(a.x<t.v3&&(t.v3=a.x),a.x+a.w>t.v4&&(t.v4=a.x+a.w)))}),this.sceneryVectors=t}});const sf=(t,e,i)=>{let a=v.e("SceneryBlock").attr({x:e,y:i,w:t.width,h:t.height}),r=[];a.resetPositioning=function(){let t={x:v.viewport.width/2,y:v.viewport.height/2},e=this.w/2,i=this.h/2,a={x:this.x+e,y:this.y+i};r.forEach(r=>r(t,a,e,i))};let n=1;return t.elements.forEach(e=>{let i;if(e.composition){let t;t="string"==typeof e.composition?ro(e.composition):u(rd)({},ro(e.composition[0]),e.composition[1]),i=v.e("2D, Composable").compose(t).attr({z:e.z}),e.frame&&i.displayFrame(e.frame)}if(e.components){if(i)e.components.forEach(t=>i.addComponent(t));else{let t=["2D"].concat(e.components);i=v.e(t.join(", ")).attr({z:e.z||0,w:e.w,h:e.h})}}e.attributes&&i.attr(e.attributes);let o=void 0===e.distance?1:e.distance;o<n&&(n=o),r.push((a,r,n,s)=>{let l=(e.x<0?t.width*o:0)+e.x,h=t.height*(o*o)+e.y,c=r.x*o+a.x*(1-o),u=r.y*(o*o)+a.y*(1-o*o),d=c-n*o,p=u-o*o*s;i.attr({x:d+l,y:p+h,distance:o})}),a.attach(i)}),a.attr({farthestDistance:n}),a.resetPositioning(),a},sg=(t,e)=>{let i=v.viewport.width/v.viewport._scale;return(i-(i-e*t)/2)/(e*t)*e},sv={RIGHT:1,LEFT:2,ALL:3};v.c("Scenery",{init(){this.currentScenery=null,this.movingDirection={vx:0,vy:0},this.altitude=0,this.blocks=[],this.delay=null,this.bind("GameLoop",this.verifySceneryContent)},remove(){this.unbind("GameLoop",this.verifySceneryContent),this.blocks.forEach(t=>t.destroy())},setNextScenery(t){rc(t)&&(0===this.blocks.length?(this.startScenery(t,{direction:sv.ALL}),this.checkCountDown=5):this.currentScenery=t)},startScenery(t,{startXPos:e=0,startYPos:i=null,direction:a=sv.RIGHT}={}){this.altitude=i||this.altitude;let r=rc(t);if(!r)throw Error(`Scenery ${t} not found`);let n=this.blocks.find(e=>e.__frozen&&e.sceneryName===t);if(n){n.unfreeze();let t=e-n.x,i=this.altitude-n.y;n.moveScenery(t,i,this.movingDirection),n.resetPositioning()}else{let i=this.blocks.find(t=>t.__frozen);if((n=sf(r,e,this.altitude)).sceneryName=t,i){let t=this.blocks.indexOf(i);i.destroy(),this.blocks[t]=n}else this.blocks.push(n)}if(n.attr(this.movingDirection),a===sv.RIGHT||a===sv.ALL){let t=e+n.w,i=this.currentScenery||so(r.right);sg(n.farthestDistance,r.width)>t&&(this.currentScenery=null,this.startScenery(i,{startXPos:t,startYPos:this.altitude,direction:sv.RIGHT}))}if(a===sv.LEFT||a===sv.ALL){let t=this.currentScenery||so(r.left),i=e-rc(t).width;-sg(n.farthestDistance,r.width)<i&&(this.currentScenery=null,this.startScenery(t,{startXPos:i,startYPos:this.altitude,direction:sv.LEFT}))}},setScrollVelocity({vx:t,vy:e}){this.movingDirection={vx:t,vy:e},this.blocks.forEach(i=>i.attr({vx:t,vy:e})),this.checkCountDown>5&&(this.checkCountDown=0===this.blocks.length?1/0:5)},setAltitude(t){this.blocks.forEach(e=>!e.__frozen&&e.moveScenery(0,t-this.altitude,this.movingDirection)),this.altitude=t},verifySceneryContent({dt:t}){if(0===t)return;let{vx:e,vy:i}=this.movingDirection;if(0===e&&0===i||(this.checkCountDown--,this.checkCountDown>0))return;let a=v.timer.FPS();this.checkCountDown=Math.min(800/Math.abs(e)*a,800/Math.abs(i)*a);let r=this.blocks.reduce((t,e)=>{if(e.__frozen)return t;let i=e.sceneryVectors;return{v1:t.v1<i.v1?t.v1:i.v1,v2:t.v2>i.v2?t.v2:i.v2,v3:t.v3<i.v3?t.v3:i.v3,v4:t.v4>i.v4?t.v4:i.v4,left:t.v1<i.v1?t.left:e,right:t.v2>i.v2?t.right:e}},{v1:1/0,v2:-1/0,v3:1/0,v4:-1/0,left:null,right:null}),n=v.viewport.width/v.viewport._scale;if(e<0&&r.left.sceneryVectors.v4<0&&(r.left.attr({vx:0,vy:0}),r.left.freeze()),e>0&&r.right.sceneryVectors.v3>n&&(r.right.attr({vx:0,vy:0}),r.right.freeze()),e<0&&r.v4<n+800){let t=r.right,i=this.currentScenery||so(rc(t.sceneryName).right);this.currentScenery=null,this.startScenery(i,{startXPos:r.v2+e/a,startYPos:this.altitude,direction:sv.RIGHT});return}if(e>0&&r.v3>-800){let t=r.left,i=this.currentScenery||so(rc(t.sceneryName).left);this.currentScenery=null;let n=rc(i),o=r.v1-n.width;this.startScenery(i,{startXPos:o+e/a,startYPos:this.altitude,direction:sv.LEFT});return}}});var sw={};sw=f("lQT0x");const sx=t=>{let e=t.length,i=[],a=[null],r=2;i.push(t[0]/r);for(let n=1;n<e;n++)a.push(1/r),r=(n<e-1?4:3.5)-a[n],i.push((t[n]-i[n-1])/r);for(let t=1;t<e;t++)i[e-t-1]-=a[e-t]*i[e-t];return i},s_=t=>{let e,i;let a=t.length-1;if(a<1)return[];if(1===a)return i=[{x:2*(e=[{x:(2*t[0].x+t[1].x)/3,y:(2*t[0].y+t[1].y)/3}])[0].x-t[0].x,y:2*e[0].y-t[0].y}],[e,i];let r=[],n=[];for(let e=1;e<a-1;e++)r.push(4*t[e].x+2*t[e+1].x),n.push(4*t[e].y+2*t[e+1].y);r.unshift(t[0].x+2*t[1].x),n.unshift(t[0].y+2*t[1].y),r.push((8*t[a-1].x+t[a].x)/2),n.push((8*t[a-1].y+t[a].y)/2);let o=sx(r),s=sx(n);e=[],i=[];for(let r=0;r<a;r++)e.push({x:o[r],y:s[r]}),r<a-1?i.push({x:2*t[r+1].x-o[r+1],y:2*t[r+1].y-s[r+1]}):i.push({x:(t[a].x+o[a-1])/2,y:(t[a].y+s[a-1])/2});return[e,i]};class sb{constructor(t){this.points=t,this.curves=[];let e=s_(t);for(let i=0;i<t.length-1;i++){let a=t[i],r=t[i+1],n=e[0][i],o=e[1][i],s=new(u(sw))(a.x,a.y,n.x,n.y,o.x,o.y,r.x,r.y);this.curves.push({curve:s,length:s.length()})}let i=0;this.curves.forEach(t=>{t.min=i/this.length,i+=t.length,t.max=i/this.length})}get length(){return this.curves.reduce((t,e)=>t+e.length,0)}getLUT(t){let e=Math.ceil(this.length/t);return this.curves.map(t=>{let i=Math.ceil(t.length/e);return t.curve.getLUT(i)}).reduce((t,e)=>t.concat(e),[])}get(t){let e=this.curves.find(e=>e.min<=t&&e.max>=t);if(!e)return null;let i=(t-e.min)/(e.max-e.min);return e.curve.get(i)}rotationAt(t){let e=this.curves.find(e=>e.min<=t&&e.max>=t),i=(t-e.min)/(e.max-e.min),a=e.curve.derivative(i);return 180*Math.atan2(a.y,a.x)/Math.PI}}const sS=t=>t.map(t=>`${t.x}|${t.y}|`).join(),sC={},sk=t=>{let e=sS(t);return sC[e]=sC[e]||new sb(t),sC[e]},sD="StackableCoordinates";v.c(sD,{required:"2D",init(){this.stackableProps={},this.propertyStacks={},this.uniqueBind("Move",this._updateBaseCoords)},createStackablePropertyFor(t,e){void 0===this.stackableProps[t]&&(this.propertyStacks[e]?this.propertyStacks[e]=this.propertyStacks[e].concat(t):(this.propertyStacks[e]=[e,t],this.stackableProps[e]=this[e]),this.stackableProps[t]=0,v.defineField(this,t,()=>this.stackableProps[t],i=>{this.stackableProps[t]=i,this.recalculateStackableProp(e)}))},recalculateStackableProp(t){this._stackRecalc=!0,this[t]=this.propertyStacks[t].reduce((t,e)=>t+this.stackableProps[e],0),this._stackRecalc=!1},applyStackableProperty(t,e){this._stackRecalc=!0,this.stackableProps[e]+=this.stackableProps[t],this.stackableProps[t]=0,this._stackRecalc=!1},_updateBaseCoords(t){this._stackRecalc||(this.stackableProps.x+=this.x-t._x,this.stackableProps.y+=this.y-t._y)}});const sz="WayPointMotion",sA=(t,e)=>{let i=t.event;i.setState&&e.showState&&e.showState(i.setState[0],i.setState[1]),i.event&&e.trigger(i.event)};v.c(sz,{required:sD,init(){this.createStackablePropertyFor("xPath","x"),this.createStackablePropertyFor("yPath","y")},remove(){this.stopFlyPattern()},flyPattern(t,{duration:e,velocity:i,easing:a="linear",start:r=0,end:n=1}={}){this.pattern=t;let o=v.viewport.width,s=v.viewport.height,l=this.pattern[0],h=t.map(({x:t,y:e})=>({x:(t-l.x)*o,y:(e-l.y)*s}));this.bezierPath=sk(h),this.eventQueue=t.reduce((t,e,i)=>{if(void 0===e.events)return t;let a=this.bezierPath.curves[i];return t.concat(e.events.map(([t,e])=>({pos:a.min+a.length*t/this.bezierPath.length,event:e})))},[]);let c=(e||this.bezierPath.length/i*1e3)/(n-r);this.wayPointEasing=new v.easing(c,a),this.wayPointEasing.tick(r*c),this.targetPatternValue=n;let u=this.wayPointEasing.value();return this.pathOffset=this.bezierPath.get(u),this.inMotion||(this.inMotion=!0,this.bind("GameLoop",this.updateAcceleration)),this},stopFlyPattern(){this.inMotion&&(this.unbind("GameLoop",this.updateAcceleration),this.inMotion=!1,this.trigger("PatternAborted"))},updateAcceleration({dt:t}){this.wayPointEasing.tick(t);let e=this.wayPointEasing.value();this.eventQueue=this.eventQueue.filter(t=>!(t.pos<=e)||(sA(t,this),!1));let i=this.bezierPath.get(e);i&&this.attr({xPath:i.x-this.pathOffset.x,yPath:i.y-this.pathOffset.y}),(e>=this.targetPatternValue||!i)&&(this.unbind("GameLoop",this.updateAcceleration),this.applyStackableProperty("xPath","x"),this.applyStackableProperty("yPath","y"),this.inMotion=!1,this.trigger("PatternCompleted",{patternCompleted:!0}))}});const sP="Animation";v.c(sP,{init(){this.elements={}},remove(){this.unbind("GameLoop",this._animateTick)},setAnimation(t,{maxCheckpoint:e=0,start:i=0,...a}={}){this.currentAnimation!==t&&(this.currentAnimation=t,this.maxAllowedCheckpoint=e,this.setActiveCheckpoint(i,a))},setCheckpointLimit(t){let e=this.maxAllowedCheckpoint;this.maxAllowedCheckpoint=t,this.targetCheckpoint<t&&!this.playingAnimation&&this.setActiveCheckpoint(this.targetCheckpoint===e?this.targetCheckpoint:this.targetCheckpoint+1)},setActiveCheckpoint(t,{autoStart:e=!0,duration:i=null}={}){this.unbind("GameLoop",this.updateAnimation);let a=this.currentAnimation.checkpoints[t];if(this.playingAnimation=!1,!a)return;this.targetCheckpoint=t;let r=Object.keys(this.elements);(a.composables||[]).forEach(([t,e])=>{let i=ro(t),a=this.elements[e.key];if(r=r.filter(t=>t!==e.key),a&&a.appliedDefinition===i){let t=e.frame||"default";a.targetFrame!==t&&a.displayFrame(t)}else{a&&a.destroy();let t=(e.relativeX||0)*v.viewport.width,r=(e.relativeY||0)*v.viewport.height,n=v.e(["2D","WebGL",tb].join(",")).attr({x:t,y:r,w:40,h:40,z:this.z||0}).compose(i);n.displayFrame(e.frame||"default"),this.elements[e.key]=n}}),(a.entities||[]).forEach(([t,e])=>{let i=this.elements[e.key];if(r=r.filter(t=>t!==e.key),i)this.z&&i.attr({z:this.z}),e.state&&i.showState(e.state);else{let i=(e.relativeX||0)*v.viewport.width,a=(e.relativeY||0)*v.viewport.height,r=v(t).get(0)||oE(t,e).attr({x:i,y:a,z:(this.z||0)+(e.z||0)});e.detach&&r.detachFromParent&&r.detachFromParent(),this.elements[e.key]=r,e.state&&r.showState(e.state)}}),(a.particles||[]).forEach(([t,e])=>{let i=this.elements[e.key];if(r=r.filter(t=>t!==e.key),i)this.z&&i.attr({z:(this.z||0)+(e.z||0)}),e.state&&i.showState(e.state);else{let i=(e.relativeX||0)*v.viewport.width,a=(e.relativeY||0)*v.viewport.height,r=u(rd)({},rl(t),e.particles),n=v.e(tq).attr({x:i,y:a,z:(this.z||0)+(e.z||0)}).particles(r);e.detach&&n.detachFromParent&&n.detachFromParent(),this.elements[e.key]=n}}),a.background&&N(a.background),r.forEach(t=>{delete this.elements[t]}),a.backgroundColor&&N(K([a.backgroundColor,1])),e&&a.timeline&&t<this.maxAllowedCheckpoint&&(this.animationDuration=i||a.timeline.defaultDuration,this.animationDuration&&(this.animationTimer=new v.easing(this.animationDuration,T),this.timeLineEvents=a.timeline.transitions.map(t=>({...t,handled:!1})),this.playingAnimation=!0,this.uniqueBind("GameLoop",this.updateAnimation)))},updateAnimation({dt:t}){this.animationTimer.tick(t);let e=this.animationTimer.value();this.timeLineEvents.forEach(i=>{if(!i.handled&&!(i.start>e)){if(i.targetFrame&&i.key){let t=this.elements[i.key];i.handled=!0,t&&t.displayFrame(i.targetFrame,(i.end-i.start)*this.animationDuration)}if(i.targetState&&i.key){let t=this.elements[i.key];i.handled=!0,t&&t.showState(i.targetState,(i.end-i.start)*this.animationDuration)}if(i.attributes&&i.key){let t=this.elements[i.key];if(i.handled=!0,t){let e=R(t,i.attributes);t.animate(e,(i.end-i.start)*this.animationDuration)}}if(i.components&&i.key){let t=this.elements[i.key];i.handled=!0,t&&i.components.forEach(e=>t.addComponent(e))}if(i.targetBackgroundColor&&(i.sourceColor&&i.ease?(i.ease.tick(t),N(Y(i.ease.value(),i.sourceColor,i.targetColor)),i.ease.value()>=1&&(i.handled=!0)):(i.sourceColor=U(),i.targetColor=K([i.targetBackgroundColor,1]),i.ease=new v.easing((i.end-i.start)*this.animationDuration,T),i.ease.tick(t),N(Y(i.ease.value(),i.sourceColor,i.targetColor)))),i.path&&i.key){i.handled=!0;let t=this.elements[i.key];if(!t)return;t.addComponent(sz);let e=(i.end-i.start)*this.animationDuration,a=i.path.data||rh(i.path.name).path;t.flyPattern(a,{duration:e,start:i.path.start||0,end:i.path.end||1,easing:i.path.easing||"linear"})}if(i.remove&&i.key){if(i.handled=!0,!this.elements[i.key])return;this.elements[i.key].destroy(),delete this.elements[i.key]}}}),e>=1&&(this.unbind("GameLoop",this.updateAnimation),this.playingAnimation=!1,this.maxAllowedCheckpoint>this.targetCheckpoint&&this.currentAnimation.checkpoints.length>this.targetCheckpoint+1?(this.trigger("CheckpointReached",{checkpoint:this.targetCheckpoint+1}),this.setActiveCheckpoint(this.targetCheckpoint+1)):(this.trigger("CheckpointReached",{checkpoint:this.targetCheckpoint+1}),this.trigger("AnimationEnded",{checkpoint:this.targetCheckpoint})))}});const sF=(t,{max:e=1/0,start:i=0,z:a=0}={})=>{let r=v.e(sP).attr({z:a});r.setAnimation(t,{maxCheckpoint:e,start:i});let n=null,o=[];return r.bind("CheckpointReached",({checkpoint:t})=>{n=t,o=o.filter(({checkpoint:e,resolver:i})=>null==e?(i({checkpoint:t,player:r}),!0):!(e<=t)||(i(t),!1))}),{waitTillCheckpoint:t=>t<=n?Promise.resolve():new Promise((e,i)=>{o.push({checkpoint:t,resolver:e,rejecter:i})}),onCheckpointChange:t=>{o.push({checkpoint:null,resolver:t})},updateCheckpoint:t=>{r.setActiveCheckpoint(t)},updateCheckpointLimit:t=>{r.setCheckpointLimit(t)},waitTillEnd:()=>new Promise(t=>r.one("AnimationEnded",t)),destroy:()=>{o.forEach(({rejecter:t})=>t&&t(Error("Animation destroyed"))),r.destroy()}}},sE="Background";v.c(sE,{required:["2D, WebGL",sP].join(","),init(){this.attr({x:0,y:0,w:v.viewport.width/v.viewport._scale,h:v.viewport.height/v.viewport._scale,z:-1e3}),this.bind("ViewportScale",this.updateBackdrop)},remove(){Object.keys(this.elements).forEach(t=>{this.elements[t].destroy(),delete this.elements[t]})},updateBackdrop(){this.attr({w:v.viewport.width/v.viewport._scale,h:v.viewport.height/v.viewport._scale})}});const sB=(t,e)=>{(v(sE).get(0)||v.e(sE)).setAnimation(t,e)},sT=t=>{(v(sE).get(0)||v.e(sE)).setActiveCheckpoint(t)},sM=()=>(v(sE).get(0)||v.e(sE)).targetCheckpoint,sL=t=>{(v(sE).get(0)||v.e(sE)).setCheckpointLimit(t)};let sR=null;const sO=[];for(sR=1e6;sR--;)sO.push(Math.random());const sj=new oQ.Noise(++sR>=sO.length?sO[sR=0]:sO[sR]),sH=u(tM).scenery;var sI=t=>({trauma:{value:0,time:0,handler:null},addScreenTrauma:e=>{t.trauma.value+=e,t.trauma.value>0&&null===t.trauma.handler&&(t.trauma.handler=({dt:e})=>{let i=t.trauma.value*t.trauma.value;t.trauma.value=Math.max(0,t.trauma.value-.001*e);let a=0,r=0;if(i>0){t.trauma.time+=e;let n=sj.perlin2(.1,t.trauma.time/((3-t.trauma.value)*360)),o=sj.perlin2(t.trauma.time/((3-t.trauma.value)*360),.3);a=0+Math.round(30*i*n),r=0+Math.round(15*i*o)}v.viewport.x=a,v.viewport.y=r,0===i&&(v.unbind("GameLoop",t.trauma.handler),t.trauma.handler=null)},v.bind("GameLoop",t.trauma.handler))},setScrollingSpeed:async(t,e,{speed:i=50,instant:a=!1}={})=>{if(!sH)return;let r=sr("Scenery")||v.e("Scenery, 2D");return a?r.setScrollVelocity({vx:-t,vy:e}):new Promise(a=>{let{vx:n,vy:o}=sl(),s=Math.max(Math.abs(t- -n),Math.abs(e-o)),l=new v.easing(s/(i/1e3),F),h=({dt:i})=>{l.tick(i);let s=l.value();s>=1&&(v.unbind("GameLoop",h),a(void 0)),r.setScrollVelocity({vx:-(-n*(1-s)+t*s),vy:o*(1-s)+e*s})};v.bind("GameLoop",h)})},setAltitude:async(t,{speed:e=50,instant:i=!1}={})=>{if(sH)return i?sh(t):new Promise(i=>{let a=sc(),r=Math.abs(t-a),n=new v.easing(r/(e/1e3),F),o=({dt:e})=>{n.tick(e);let r=n.value();r>=1&&(v.unbind("GameLoop",o),i(void 0)),sh(a*(1-r)+t*r)};v.bind("GameLoop",o)})},setScenery:async t=>{if(sH)return ss(t)},waitTillInScreen:(t,e)=>sm(t,e),setBackground:async(t,e,i)=>{sH&&(sB(rn(t)),void 0!==i&&sL(i),void 0!==e&&0===sM()&&sT(e))},setGameSpeed:tk,fadeIn:tt,fadeOut:te,setBackgroundCheckpointLimit:async t=>{sL(t)},setBackgroundCheckpoint:async t=>{sM()<t&&sT(t)},playAnimation:(t,e)=>sF(rn(t),e)});const sG=(t,e,i,a,r)=>{t.addComponent("WayPointMotion");let n=i||t.defaultVelocity;t.flyPattern(e,{velocity:n,easing:a});let o=null;return{wasCompleted:()=>o,process:new Promise((e,i)=>{let a=n=>{o=n&&n.patternCompleted,t.unbind("PatternCompleted",a),t.unbind("PatternAborted",a),v.unbind("GameOver",a),!0===r.gameEnded&&i(Error("Game Over")),e(void 0)};t.one("PatternCompleted",a),t.one("PatternAborted",a),v.one("GameOver",a)}),abort:()=>t.stopFlyPattern()}};var sq=(t,e)=>({spawn:(t,e)=>oE(t,e),displayFrame:(t,e,i,a=T)=>t.displayFrame(e,i,a),showState:(t,e,i,a=T)=>t.showState(e,i,a),showAnimation:(t,e)=>t.playAnimation(e),allowDamage:(t,e)=>{t.addCollisionComponent("DamageSupport",["processDamage"]),t.allowDamage(e)},moveWithPattern:(t,i,a=null,r=T)=>sG(t,rh(i).path,a,r,e),moveTo:(t,i,a=null,r=T)=>{let n=v.viewport.width,o=v.viewport.height,s=t.x/n,l=t.y/o;return sG(t,[{x:s,y:l},{x:s,y:l,...i}],a,r,e)}});const sU="Health";v.c(sU,{required:"Color",events:{EnterFrame(){}},properties:{health:{set:function(t){this._health=t,this.w=Math.min(this.maxWidth,this.maxWidth*t),this._green=144*this._health,this._red=144*(1-this._health),this.trigger("Invalidate")},get:function(){return this._health},configurable:!0,enumerable:!0},_health:{value:1,writable:!0,enumerable:!1}},init(){this.color(0,144,0)}});let sN=100,sV=0,sX=0,sW=1;const sY=()=>sW,sK=(t,e,i,a)=>{sV+=t,sX+=1,sV>=sN&&sX>=10&&(a.exec(sQ(e,i,25*sW)),sV=0,sX=0,sN*=1.1)},sJ=()=>{s$()},s$=()=>{sW=1,v.trigger("MultiplierChange",sW),sN=100,sV=0},sQ=(t,e,i)=>async({allowDamage:a,showState:r,waitForEvent:n,wait:o,spawn:s,awardPoints:l,moveWithPattern:h})=>{let c=s("Bonus",{location:{x:t,y:e},defaultVelocity:40});await a(c,{health:10}),n(c,"Dead",async()=>{l(i,t,e,!1),sW+=1,v.trigger("MultiplierChange",sW),await r(c,"pickedUp"),await o(2e3),c.destroy()});let u=h(c,"powerup.short");await u.process,await r(c,"disappear",1e3),c.destroy()};let sZ=[];v.bind("SceneDestroy",()=>sZ=[]);const s0=()=>{let t=sZ.find(t=>t.__frozen);if(t)return t.unfreeze(),t.attr({alpha:1});let e=v.e(`2D, Text, DOM, ${O}`).attr({z:400,alpha:1,w:300}).textColor("#EEEEEE").textAlign("left").textFont({size:"12px",weight:"bold",family:"Press Start 2P"});return sZ=sZ.concat(e),e};var s1=(t,e)=>{let i=(v("HUDLives").get(0)||v.e(`2D, HUDLives, UILayerDOM, Text, HUD, HUDTop, ${O}`).attr({x:20,y:-10,w:100,alpha:0}).textColor("#FFFF00").textAlign("left").textFont({size:"8px",weight:"bold",family:"Press Start 2P"})).text(`Lives: ${e.lives}`),a=v("HUDHealth").get(0)||v.e(`2D, HUDHealth, UILayerWebGL, HUD, HUDTop, ${sU}, ${O}`).attr({x:150,y:-10,w:120,h:5,alpha:0,maxWidth:120});v("HUDHealthBar").get(0)||v.e(`2D, HUDHealthBar, UILayerWebGL, Color, HUD, HUDTop, ${O}`).attr({x:149,y:-11,w:122,h:7,z:-1,alpha:0,baseAlpha:.6}).color("#202020");let r=(v("HUDScore").get(0)||v.e(`2D, HUDScore, UILayerDOM, Text, HUD, HUDTop, ${O}`).attr({x:800,y:-10,w:220,alpha:0,score:0,displayScore:0}).textColor("#FFFF00").textAlign("left").textFont({size:"8px",weight:"bold",family:"Press Start 2P"})).text(function(){return this.score>this.displayScore+200?(this.displayScore+=10,this.textFont({size:"9px"}).textColor("#FFFF80")):this.score>this.displayScore+100?(this.displayScore+=5,this.textFont({size:"9px"}).textColor("#FFFF40")):this.score>this.displayScore&&(this.displayScore+=1,this.textFont({size:"8px"})),`Score: ${this.displayScore}`}).dynamicTextGeneration(!0,"GameLoop"),n=(v("HUDMultiplier").get(0)||v.e(`2D, HUDMultiplier, UILayerDOM, Text, HUD, HUDTop, ${O}`).attr({x:800,y:10,w:220,alpha:0}).textColor("#FFFF00").textAlign("left").textFont({size:"8px",weight:"bold",family:"Press Start 2P"})).text(`Bonus: ${sY()}x`);v.bind("MultiplierChange",()=>n.text(`Bonus: ${sY()}x`));let o=[],s=()=>{t.closeScript(),s$()};v.one("SceneDestroy",s),t.closeScript=()=>{v.unbind("SceneDestroy",s),v.unbind("MultiplierChange"),o.forEach(t=>t())};let l=async(t,e,i)=>{let a=s0().attr({x:e,y:i}).text(t);await a.tweenPromise({y:i-40,alpha:0},1e3),a.freeze()};return{onScriptClose:t=>{o.push(t)},setHealthbar:t=>{a.attr({health:t})},setEnergybar:t=>{},showBuff:(t,i,a,r)=>{let n=v(`BuffSlot${t}`);n.length>0&&n.destroy();let o=v.e(`2D, HUD, HUDBottom, WebGL, Color, BuffSlot${t}, ${O}`).attr({w:20,h:20,x:20+30*t,y:v.viewport.height-28,z:900,alpha:!0===e.hudShown?1:0}),s=()=>{if(i.canActivateBuff(a)){o.color("#5F5");return}let t=i.buffStatus(a);if(0===t.activeLeft&&0===t.cooldown){o.color("#333");return}if(t.activeLeft>0){o.color("#AA0");return}if(t.cooldown>0){o.color("#A10");return}};s(),i.uniqueBind("EnergyUpdate",()=>{s()}),i.uniqueBind("BuffActivated",t=>{t===a&&s()}),i.uniqueBind("BuffEnded",t=>{t===a&&s()}),i.uniqueBind("CooldownEnded",t=>{t===a&&s()}),v.e(`DOM, HUD, HUDBottom, 2D, Text, ${O}`).attr({w:60,h:20,x:1+30*t,y:v.viewport.height-11,alpha:!0===e.hudShown?1:0}).textColor("#111").textAlign("center").textFont({size:"8px",family:"Press Start 2P"}).text(`${r}`),v.e(`DOM, HUD, HUDBottom, 2D, Text, ${O}`).attr({w:60,h:20,x:30*t,y:v.viewport.height-10,alpha:!0===e.hudShown?1:0}).textColor("#eee").textAlign("center").textFont({size:"8px",family:"Press Start 2P"}).text(`${r}`)},loseLife:()=>{if(e.lives-=1,e.lives<0)throw e.gameEnded=!0,v.trigger("GameOver"),Error("Game Over");i.text(`Lives: ${e.lives}`)},gainLife:()=>{e.lives+=1,i.text(`Lives: ${e.lives}`)},awardPoints:async(i,a,n,o=!0)=>{e.score+=i,r.attr({score:e.score}),o&&sK(i,a,n,t),await l(`+${i}`,a,n)},awardText:l,playerHit:sJ,showHUD:()=>{if(!0===e.hudShown)return;e.hudShown=!0;let t=[];return v("HUDTop").each(function(){this.tweenPromise&&t.push(this.tweenPromise({alpha:void 0===this.baseAlpha?1:this.baseAlpha,y:this.y+20},500))}),v("HUDBottom").each(function(){this.tweenPromise&&t.push(this.tweenPromise({alpha:void 0===this.baseAlpha?1:this.baseAlpha},500))}),Promise.all(t)},hideHUD:()=>{if(!0!==e.hudShown)return;e.hudShown=!1;let t=[];return v("HUDTop").each(function(){this.tweenPromise&&t.push(this.tweenPromise({alpha:0,y:this.y-20},500))}),v("HUDBottom").each(function(){this.tweenPromise&&t.push(this.tweenPromise({alpha:0},500))}),Promise.all(t)}}};const s2=(t,e)=>Object.entries(t).reduce((t,[i,a])=>(t[i]="function"==typeof a?(...t)=>{if(!0===e.gameEnded)throw Error("Game Over");return a(...t)}:a,t),{}),s5=t=>{let e;return async i=>{let a=Math.random();e=a;let r={currentScript:()=>e===a};if([oJ,sI,sq,o$,s1].forEach(e=>Object.assign(r,s2(e(r,t),t))),!0!==t.gameEnded){v.one("EndGame",()=>{e=null,t.gameEnded=!0,v.trigger("GameOver")});try{return await i(r)}catch(t){if("Game Over"!==t.message)throw console.error(t.message),t}finally{r.closeScript()}}}},s3=(t,e=0,i=0,a=null)=>async({spawn:r,showState:n,waitForEvent:o,allowDamage:s,awardPoints:l,moveWithPattern:h})=>{let c=rh(t).path,u=r("WarDrone",{location:{rx:c[0].x,ry:c[0].y+e},defaultVelocity:a||400});await s(u,{health:30});let d=h(u,t);o(u,"Dead",async()=>{d.abort(),i>0&&l(i,u.x,u.y),await n(u,"dead"),u.destroy()}),await d.process,d.wasCompleted()&&u.destroy()},s4=(t,e,{points:i=10,delay:a=500,yOffset:r=0,speed:n=null}={})=>async({exec:o,wait:s})=>{let l=Array(t).fill().map(async(t,l)=>{await s(l*a),await o(s3(e,r,i,n))});await Promise.all(l)},s6=({existing:t=!1}={})=>async({spawn:e,showState:i,moveWithPattern:a})=>{let r=t&&v("IntroHeliBackground").get(0)||e("IntroHeliBackground",{location:{rx:-.3,ry:.3},z:-300,defaultVelocity:70});i(r,"flying");let n=a(r,"intro.HeliBackground");await n.process},s8=({existing:t=!1}={},e)=>async({spawn:i,showState:a,allowDamage:r,moveWithPattern:n,waitForEvent:o,moveTo:s,wait:l})=>{let h;let c=t&&v("IntroHeliBackground").get(0)||i("IntroHeliBackground",{location:{rx:-.3,ry:.3},z:-300,defaultVelocity:70});a(c,"flying"),o(c,"Dead",async()=>{a(c,"shot"),h=n(c,"intro.HeliBackgroundCrash",150,E).process}),o(c,"Escape1",async()=>{let t=i("IntroParachute",{x:c.x+10,y:c.y,z:-290,defaultVelocity:20}),e=s(t,{y:.6,x:.2},null,F);await e.process,t.destroy()}),o(c,"Escape2",async()=>{let t=i("IntroParachute",{x:c.x+10,y:c.y,z:-290,defaultVelocity:20}),e=s(t,{y:.6,x:.2},null,F);await e.process,t.destroy()}),o(c,"Escape3",async()=>{e.setVolume(0,4e3),await l(4e3),e.stop()});let u=t&&v("LargeBackgroundDrone").get(0)||i("LargeBackgroundDrone",{location:{rx:1.1,ry:.3},z:-280,defaultVelocity:200});a(u,"eyeMove"),await r(c,{health:10});let d=n(u,"intro.DroneBackground");await d.process,await l(100),await h,c.destroy(),u.destroy()},s7="Buffs";v.c(s7,{init(){this.buffs={}},defineBuff(t,e){let i=this.buffs[t];this.buffs[t]={activeLeft:0,cooldown:0,...i,settings:e}},buffStatus(t){return this.buffs[t]},buffActive(t){return this.buffs[t].activeLeft>0},canActivateBuff(t){let e=this.buffs[t];return!!e&&!(e.cooldown>0)&&!(e.activeLeft>0)&&!!Object.entries(e.settings.cost).every(([t,e])=>this[t]>=e)},activateBuff(t){let e=this.buffs[t];if(!this.canActivateBuff(t))return!1;Object.entries(e.settings.cost).every(([t,e])=>this[t]-=e),this.buffs[t].activeLeft=1e3*e.settings.duration,this.trigger("BuffActivated",t),this.uniqueBind("GameLoop",this._handleBuffs)},_handleBuffs({dt:t}){let e=0;Object.entries(this.buffs).every(([i,a])=>{a.activeLeft>0?(e++,a.activeLeft=Math.max(a.activeLeft-t,0),0===a.activeLeft&&(a.cooldown=1e3*a.settings.cooldown,this.trigger("BuffEnded",i))):a.cooldown>0&&(e++,a.cooldown=Math.max(a.cooldown-t,0),0===a.cooldown&&this.trigger("CooldownEnded",i))}),0===e&&this.unbind("GameLoop",this._handleBuffs)}});const s9=({existing:t=!1,hasLaser:e=!1,turned:i=!1}={})=>async({spawn:a,exec:r,waitForEvent:n,allowDamage:o,setHealthbar:s,setEnergybar:l,showState:h,setGameSpeed:c,addScreenTrauma:u,playerHit:d,wait:p,loseLife:y})=>{let m=v("Player").get(0),f=t&&v("PlayerShip").get(0);if(f&&f.has(op))return;let g=f||a("PlayerShip",{location:{rx:i?.8:.2,ry:.5},defaultVelocity:400});m.invincible||(g===f?(await o(g,{health:g.health||50}),g.energy=g.energy||0):(g.health=g.health||50,g.energy=0,p(2e3).then(async()=>{await o(g,{})}))),e&&(g.hasLaser=!0),g.health<25&&g.displayFrame("damaged"),s(g.health/50),l(g.energy/100),i&&await h(g,"turned"),h(g,"flying"),g.addComponent(op,oy,s7),m.has(od)&&m.assignControls(g),g.defineBuff("overdrive",{cost:{energy:25},duration:3,cooldown:3}),g.uniqueBind("ButtonPressed",t=>{if("fire"===t&&(g.showState("noLaserShooting"),g.showState("shooting")),"heavy"===t){if(!g.hasLaser)return;g.showState("noShooting"),g.showState("laserShooting")}"power1"===t&&(g.activateBuff("overdrive"),g.trigger("EnergyUpdate"),l(g.energy/100))}),g.uniqueBind("ButtonReleased",t=>{"fire"===t&&g.showState("noShooting"),"heavy"===t&&g.showState("noLaserShooting")}),g.uniqueBind("DealtDamage",({damage:t})=>{"Bullet"!==t[0].name||g.buffActive("overdrive")||(g.energy=Math.min(100,g.energy+1),g.trigger("EnergyUpdate"),l(g.energy/100))}),g.uniqueBind("HealthChange",t=>{t<g.health&&d(t-g.health);try{s(t/50)}catch(t){}t<25&&"dead"!==g.appliedEntityState&&g.displayFrame("damaged")}),g.uniqueBind("turn",()=>{g.health<25?h(g,"turningDamaged"):h(g,"turning")}),n(g,"Dead",async()=>{g.attr({disableControls:!0,vx:0,vy:0}),u(.8),c(.4);let t=h(g,"dead");await p(150),c(.7),await p(600),u(.5),await t;let e=!!g.xFlipped,i=g.hasLaser;g.destroy(),await y(),c(1),await p(1e3),r(s9({turned:e,hasLaser:i}))})},lt=(t,e,{portrait:i=null}={})=>new Promise(a=>{v("Dialog").each(function(){this.trigger("Abort"),this.destroy()});let r=.15*v.viewport.width,n=.7*v.viewport.width,o=v.viewport.height-20,s=v.e("UILayerWebGL, 2D, Color, Tween, Dialog").attr({w:n,h:15,alpha:0}).color("#000000").attr({x:r-10,y:o+50,z:100});s.bind("Abort",a);let l=0,h=i&&ro(i),c=null;h&&(l=(c=v.e(["UILayerWebGL","2D",tb,"Dialog"].join(", ")).attr({x:0,y:0,w:40,h:40}).compose(h,{autoStartAnimation:!1})).w+10,c.attr({x:s.x+5,y:s.y+s.h-c.h,z:s.z+1}));let d=e.split(/\s+/g),p=Math.floor((n-10-l)/10),y=d.reduce(([t,...e],i)=>!t.endsWith(".")&&i.length+1+t.length<p?[`${t} ${i}`.trim(),...e]:[i,t,...e],[""]).reverse(),m=Math.max(4,y.length+1+(t?2:0));s.attr({h:16*m}),c&&(c.attr({y:s.y+s.h-c.h}),s.attach(c)),s.tween({y:o-16*m,alpha:.8},200);let f=15;if(t){let e=v.e("UILayerDOM, 2D, Text").attr({w:n-20,x:s.x+10+l,y:s.y+10,z:101,alpha:1}).text(t).textColor("#707070").textFont({size:"10px",weight:"bold",family:"Press Start 2P"});s.attach(e),f=30}y.forEach((t,e)=>{s.attach(v.e("UILayerDOM, 2D, Text").attr({w:n-20,x:s.x+10+l,y:s.y+f+20*e,z:101}).text(t).textColor("#909090").textFont({size:"10px",weight:"bold",family:"Press Start 2P"}))});let g=y.join(" ").split(" ").length,w=y.length+Math.ceil(g*u(tM).wordDelay),x=0;v.e("Dialog, Delay").delay(function(){x++,c&&(x===w?(c.stopAnimation(),c.displayFrame("idle")):c.playAnimation("talking"))},1e3,w,function(){s.one("TweenEnd",()=>{v("Dialog").each(function(){this.destroy()}),a(void 0)}),s.tween({y:o+50,alpha:0},200)})}),le=async({wait:t})=>{let e=j("Checkpoint",{color:"#FFFFFF"});await e.show(),await t(500),e.fadeOut(1e3).then(()=>e.remove())},li=t=>async({showState:e,allowDamage:i,waitForEvent:a,call:r,awardPoints:n})=>{await i(t,{health:30}),a(t,"Dead",async()=>{n(25,t.x,t.y),e(t,"falling"),await r(t.activateGravity,"GravityLiquid")})},la=(t,e)=>async({spawn:i,call:a,waitForEvent:r,wait:n,until:o,allowDamage:s,moveWithPattern:l,awardPoints:h,showState:c})=>{let u=i("Helicopter",{location:{rx:1.1,ry:.5},defaultVelocity:100});u.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),await s(u,{health:900});let d=tU.playAudio("helicopter",{volume:.01});d.setVolume(2,2e3),await n(2e3),c(u,"shooting");let p=l(u,t);u.uniqueBind("HealthChange",t=>{t<450&&"dead"!==u.appliedEntityState&&c(u,"fire")});let y=r(u,"Dead",async()=>{p.abort(),d.stop(),h(250,u.x+20,u.y),await c(u,"dead"),await a(u.activateGravity)});r(u,"Remove",async()=>{d.stop()}),await p.process,await o(()=>y,async()=>{if("dead"===u.appliedEntityState)return n(500);p=l(u,e,150),await p.process})},lr=t=>async({showState:e,allowDamage:i,waitForEvent:a,call:r,awardPoints:n})=>{await i(t,{health:30}),a(t,"Dead",async()=>{n(25,t.x,t.y),e(t,"falling"),await r(t.activateGravity,"GravityLiquid")})},ln=()=>async({spawn:t,waitForEvent:e,until:i,parallel:a,wait:r,awardPoints:n,showState:o,allowDamage:s,exec:l,moveTo:h})=>{let c=null,u=t("DroneShip",{location:{rx:1.1,ry:.7},defaultVelocity:150});l(lr(u.boxLocation1)),o(u,"activateGun"),u.gun.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy");let d=e(u.gun,"Dead",async()=>{n(200,u.gun.x+20,u.gun.y),o(u.gun,"dead"),u.gun.clearCollisionComponents()});await s(u.gun,{health:600}),c=h(u,{x:.5},null,B),u.radar.addCollisionComponent("SolidCollision");let p=!1,y=e(u.radar,"Dead",async()=>{p=!0,n(100,u.radar.x+20,u.radar.y),o(u.radar,"dead"),u.radar.clearCollisionComponents()});o(u,"radarPulse"),await s(u.radar,{health:300}),await c.process,(c=h(u,{x:-.8},null,E)).process.then(()=>u.destroy());let m=10;await a([()=>i(()=>y,async({exec:t})=>{if(p){await r(1500);return}t(s4(2,"drone.pattern2",{points:m})),m=m>0?m-5:0,await r(1500)}),()=>d])};var lo=()=>{let t=0,e=[],i=[],a=0,r=!1;return{addSynchronisation:()=>{if(r)throw Error("Synchronisation already started");t++;let n=++a,o=null,s=new Promise(t=>o=t);return i.push(s),async()=>(r=!0,void 0===e.find(t=>t===n)&&(e.push(n),o()),Promise.allSettled(i))},get listeners(){return t},get completed(){return e.length}}};const ls=(t,e,i,a,r=0)=>async({spawn:n,wait:o,addScreenTrauma:s,waitForEvent:l,race:h,showState:c,allowDamage:u,awardPoints:d,moveTo:p})=>{let y=null;await o(50*t);let m=n("Mine",{location:{rx:e.x,ry:e.y>1?.9:e.y},defaultVelocity:200});e.y>1&&(y=p(m,{y:e.y},null,B),await y.process),await c(m,"rotate"),await u(m,{health:40}),y=p(m,{x:i.x},null,B),await h([()=>l(m,"Dead",async()=>{y&&y.abort(),a(),"explode"!==m.appliedEntityState&&(d(100,m.x,m.y),c(m,"dead"),s(.3),await o(500),m.destroy(),y&&y.abort())}),async()=>{await y.process,y.wasCompleted()&&(await a(),await o(r),"dead"!==m.appliedEntityState)&&(y=p(m,{y:i.y},null,F),await y.process,y.wasCompleted())&&(await o(200+2e3*Math.random()),await c(m,"open",500),"dead"!==m.appliedEntityState&&(c(m,"blinking"),await o(1e3),"dead"!==m.appliedEntityState&&(c(m,"explode"),s(.3),await o(500),m.destroy())))}])},ll=()=>async({exec:t})=>{let e=[{x:.3,y:.8},{x:.5,y:.2},{x:.5,y:.4},{x:.9,y:.2},{x:.9,y:.4},{x:.9,y:.8}],i=lo(),a=Array(6).fill(null).map(async(a,r)=>{let n=i.addSynchronisation();await t(ls(r,{x:1.2,y:1.1},e[r],n))});await Promise.all(a)},lh=(t,e,i)=>async({spawn:a,wait:r,addScreenTrauma:n,waitForEvent:o,race:s,allowDamage:l,showState:h,moveTo:c})=>{let u=null;await r(50*t);let d=a("Mine",{location:{rx:e.x,ry:e.y>1?.9:e.y},defaultVelocity:200});await h(d,"rotate"),await l(d,{health:40}),h(d,"blinking"),await r(2e3),await s([()=>o(d,"Dead",async()=>{u&&u.abort(),"explode"!==d.appliedEntityState&&(h(d,"dead"),n(.3),await r(1e3),d.destroy(),u&&u.abort())}),async()=>{"dead"!==d.appliedEntityState&&(u=c(d,{y:i.y},null,F),await u.process,u.wasCompleted()&&(await h(d,"open",500),"dead"!==d.appliedEntityState&&(h(d,"dead"),n(.3),await r(1e3),d.destroy())))}])},lc=()=>async({exec:t})=>{let e=[.05,.14,.27,.36,.45,.54,.63,.77,.86],i=u(oZ)([.25,.3,.4,.6]),a=Array(9).fill().map(async(a,r)=>{await t(lh(r,{x:e[r],y:.88},{x:e[r],y:i[r%i.length]}))});await Promise.all(a)},lu=(t,e)=>async({spawn:i,moveWithPattern:a,moveTo:r,addScreenTrauma:n,wait:o,waitForEvent:s,showState:l,allowDamage:h,race:c})=>{await l(t,e?"aimHigh":"aimLow");let u=t.currentAttachHooks.gun;if(!t.hasHealth())return;let d=i("Mine",{location:{x:u.x,y:u.y},defaultVelocity:350}).attr({z:u.z});s(d,"Loose",async()=>{d.attr({z:d.z+30})});let p=a(d,e?"mineCannon.highShot":"mineCannon.lowShot",null,B);await l(t,"shoot"),p.process.then(async()=>{let t;await h(d,{health:40});let e=v("PlayerShip").get(0);t=r(d,{y:1}),await t.process,t=r(d,{x:e.x/v.viewport.width}),await t.process,t=r(d,{y:e.y/v.viewport.height}),await c([()=>s(d,"Dead",async()=>{t&&t.abort(),"explode"!==d.appliedEntityState&&(l(d,"dead"),n(.3),await o(1e3),d.destroy(),t&&t.abort())}),async()=>{await t.process,t.wasCompleted()&&"dead"!==d.appliedEntityState&&(await l(d,"open",500),l(d,"blinking"),await o(1e3),"dead"!==d.appliedEntityState&&(l(d,"explode"),n(.3),await o(1e3),d.destroy()))}])})},ld=t=>async({awardPoints:e,showState:i,waitForEvent:a,allowDamage:r})=>{let n=a(t,"Dead",async()=>{e(200,t.x+20,t.y),i(t,"dead"),t.clearCollisionComponents()});t.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),r(t,{health:750}),i(t,"shooting"),await n},lp=t=>async({showState:e,waitForEvent:i,allowDamage:a,race:r,awardPoints:n,until:o})=>{let s=t.mineCannon;s.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy");let l=i(s,"Dead",async()=>{n(250,s.x,s.y),e(s,"dead"),s.clearCollisionComponents()});await r([async()=>{await a(s,{health:1200});let t=!0;await o(()=>l,async({exec:e})=>{await e(lu(s,t)),t=!t})},()=>l])},ly=t=>async({exec:e,waitForEvent:i,parallel:a,until:r,showState:n,awardPoints:o,allowDamage:s,wait:l})=>{let h=t.cabin1.radar;h.addCollisionComponent("SolidCollision"),n(h,"pulse"),await s(h,{health:500});let c=10;await a([()=>r(()=>i(h,"Dead",async()=>{o(100,h.x+20,h.y),n(h,"dead"),h.clearCollisionComponents()}),async({exec:t})=>{t(s4(2,"drone.pattern2",{points:c})),c=c>0?c-5:0,await l(2e3)}),()=>e(ld(t.deckGun1))])},lm=t=>async({wait:e,showState:i,moveTo:a,exec:r,parallel:n})=>{await n([()=>a(t,{y:.65},20,F).process,()=>i(t,"risen",2e3),async()=>{await e(1e3),await r(lc())}]),await n([()=>a(t,{y:.7},20,F).process,()=>i(t,"lowered",2e3)])},lf=t=>async({call:e,wait:i,waitForEvent:a,showState:r,awardPoints:n,allowDamage:o,until:s,moveWithPattern:l})=>{let h=t.heliPlace1,c=tU.playAudio("helicopter",{volume:.01});c.setVolume(.9,1e3),r(h,"flying"),await i(1e3),await r(h,"tilted",2e3);let u=l(h,"heli.battleship1",150,T);a(h,"detach",async()=>{h.detachFromParent()}),a(h,"active",async()=>{h.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),await o(h,{health:500})}),a(h,"Remove",async()=>{c.stop()}),h.uniqueBind("HealthChange",t=>{t<250&&"dead"!==h.appliedEntityState&&r(h,"fire")});let d=a(h,"Dead",async()=>{c.stop(),h.clearCollisionComponents(),u.abort(),n(250,h.x+20,h.y),await r(h,"dead"),h.z=t.z+5,await e(h.activateGravity)});await u.process,await s(()=>d,async()=>{if("dead"===h.appliedEntityState)return i(500);u=l(h,"heli.battleship2c",150,T),await u.process})},lg=t=>async({showState:e,wait:i,exec:a,parallel:r})=>{await i(1e3),await r([async()=>{await i(1e3),await a(ld(t.deckGun2)),await i(1e3),await e(t,"t3o",2e3),await e(t,"t3r",2e3),await a(ld(t.hatch3.payload))},()=>a(lf(t))]),await a(lm(t)),await r([async()=>{await e(t,"t2o",1e3),await e(t,"t2r",1e3),await a(ld(t.hatch2.payload))},async()=>{await e(t,"t1o",1e3),await e(t,"t1r",1e3),await a(ld(t.hatch1.payload))}]),await a(lm(t))},lv=t=>async({wait:e,moveTo:i,showState:a,moveWithPattern:r,waitForEvent:n,awardPoints:o,allowDamage:s,call:l,until:h})=>{let c=t.heliPlace2,u=tU.playAudio("helicopter",{volume:.01});u.setVolume(.9,1e3),a(c,"flying"),await e(1e3),await a(c,"tilted",2e3);let d=r(c,"heli.battleship2a",150,T);n(c,"detach",async()=>{c.detachFromParent()}),n(c,"active",async()=>{c.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),await s(c,{health:500})}),n(c,"Remove",async()=>{u.stop()}),c.uniqueBind("HealthChange",t=>{t<250&&"dead"!==c.appliedEntityState&&a(c,"fire")});let p=n(c,"Dead",async()=>{u.stop(),c.clearCollisionComponents(),d.abort(),o(250,c.x+20,c.y),await a(c,"dead"),await l(c.activateGravity)}),y=n(c,"moveShip",async()=>{let e=i(t,{x:-1},120,F);await e.process});await d.process,d=r(c,"heli.battleship2b",150,T),await y,await d.process,await h(()=>p,async()=>{if("dead"===c.appliedEntityState)return e(500);d=r(c,"heli.battleship2c",150,T),await d.process})},lw=t=>async({allowDamage:e,showState:i,wait:a,parallel:r,setScrollingSpeed:n,moveTo:o,awardPoints:s,exec:l,waitForEvent:h})=>{await a(2e3),await i(t,"packageOpen",1e3,F),await a(1e3);let c=t.deckGun3;await i(c,"open",500,F);let u=t.engineCore;u.addComponent("SolidCollision"),h(u,"Dead",async()=>{u.clearCollisionComponents(),i(t,"engineTilt"),h(u,"Dead",async()=>{u.clearCollisionComponents(),s(500,u.x+20,u.y),u.removeComponent("SolidCollision"),i(t.laserField,"stopped"),e(c,{health:500}),t.laserField.removeComponent("SolidCollision"),i(t,"engineDestroyed")}),await e(t.engineCore,{health:1e3})}),await e(t.engineCore,{health:500}),c.addCollisionComponent("SolidCollision");let d=h(c,"Dead",async()=>{c.clearCollisionComponents(),s(250,c.x+20,c.y),i(c,"dead")});await e(c,{health:500}),i(c,"shooting"),await r([async()=>{v("PlayerShip").get(0).trigger("turn"),await a(1e3),await i(t,"engineDoorOpen"),n(-100,0);let e=o(t,{x:-.9},85,F);await e.process},async()=>{await d,l(l_(c.x+c.w/2,c.y-c.h))}])},lx=(t,e)=>async({allowDamage:i,showState:a,waitForEvent:r,wait:n,spawn:o,gainLife:s,moveWithPattern:l})=>{let h=o("ExtraLife",{location:{x:t,y:e},defaultVelocity:50});await i(h,{health:10}),r(h,"Dead",async()=>{s(),await a(h,"pickedUp"),await n(2e3),h.destroy()});let c=l(h,"powerup.circles");await c.process,await a(h,"disappear",1e3),h.destroy()},l_=(t,e)=>async({allowDamage:i,awardText:a,showState:r,waitForEvent:n,wait:o,spawn:s,until:l})=>{let h=s("Upgrade",{location:{x:t,y:e},defaultVelocity:50});await i(h,{health:10});let c=n(h,"Dead",async()=>{let t=v("PlayerShip").get(0);t.hasLaser=!0,a("Laser weapon",h.x,h.y),await r(h,"pickedUp"),await o(2e3),h.destroy(),lt(null,`You gained a new weapon! The LASER. Use the ${t.controlName("heavy")} to shoot.`)});await l(()=>c,async({moveWithPattern:t})=>{let e=t(h,"powerup.circles");await e.process}),h.destroy()},lb=t=>async({allowDamage:e,showState:i,waitForEvent:a,awardPoints:r,addScreenTrauma:n,exec:o,wait:s})=>{let l=t.cabin1;l.addCollisionComponent("SolidCollision");let h=a(l,"Dead",async()=>{r(2e3,l.x+l.w/2,l.y),i(t,"cabin1Explode"),n(.5),await s(2e3),n(.5),l.clearCollisionComponents(),i(t,"cabin1Smoke")});await e(l,{health:500,bulletResistance:.99}),await h,l.removeComponent("SolidCollision"),o(lx(l.x+l.w/2,l.y-l.h))},lS=t=>async({allowDamage:e,showState:i,addScreenTrauma:a,waitForEvent:r,awardPoints:n,wait:o})=>{let s=t.cabin2;s.addCollisionComponent("SolidCollision");let l=r(s,"Dead",async()=>{n(2e3,s.x+s.w/2,s.y),i(t,"cabin2Explode"),a(.5),await o(2e3),a(.5),s.clearCollisionComponents(),i(t,"cabin2Smoke")});await e(s,{health:500,bulletResistance:.99}),await l,s.removeComponent("SolidCollision")},lC=t=>async({showState:e,allowDamage:i,waitForEvent:a,call:r,awardPoints:n})=>{await i(t,{health:30}),a(t,"Dead",async()=>{n(25,t.x,t.y),e(t,"falling"),await r(t.activateGravity,"GravityLiquid")})},lk=async({parallel:t,spawn:e,wait:i,showState:a,exec:r,moveTo:n,setBackgroundCheckpointLimit:o,setScrollingSpeed:s})=>{let l;let h=j("Warning!",{color:"#FF0000"});await t([()=>h.blink(500,4),()=>s(150,0),()=>lt("John","Battleship approaching!",{portrait:"portraits.pilot"})]),h.remove();let c=e("BattleShip",{location:{rx:1.1,ry:.7},defaultVelocity:85});r(lC(c.boxLocation1)),r(lC(c.boxLocation2)),l=n(c,{x:.8},null,F),await t([()=>l.process,()=>r(lp(c))]),await i(1e3),l=n(c,{x:.5},null,F),await t([()=>l.process,()=>r(ly(c))]),o(3),await i(1e3),l=n(c,{x:-.17},null,F),await t([()=>l.process,()=>r(lg(c))]),await r(lv(c)),await r(lw(c)),await t([async()=>{l=n(c,{x:-.7},null,F),await l.process},()=>r(lS(c))]),await t([async()=>{l=n(c,{x:-.2},null,F),await l.process},()=>r(lb(c))]),v("PlayerShip").get(0).trigger("turn"),s(150,0),t([()=>a(c,"sinking",17e3,F),async()=>{l=n(c,{x:-1.7,y:.85},null,F),await l.process,c.destroy()}]),await i(4e3)},lD=(t,e)=>async({spawn:i,wait:a,moveTo:r,allowDamage:n,showState:o,waitForEvent:s})=>{let l=null;await a(100*t);let h=i("HeliRocket",{location:{rx:1.1,ry:e.y},defaultVelocity:500});s(h,"Dead",async()=>{l&&l.abort(),await o(h,"explode"),await a(500),h.destroy()}),await n(h,{health:3}),l=r(h,{x:-.1},null,E),await l.process,l.wasCompleted()&&h.destroy()},lz=()=>async({exec:t})=>{let e=u(oZ)([{y:.8},{y:.7},{y:.6},{y:.5},{y:.4},{y:.3},{y:.2}]),i=[,,,,,].fill().map(async(i,a)=>{await t(lD(a,e[a]))});await Promise.all(i)},lA=t=>async({showState:e,until:i,moveWithPattern:a})=>{await i(()=>e(t,"shootRockets"),()=>a(t,"largeDrone.eight").process)},lP=t=>async({showState:e,until:i,moveWithPattern:a})=>{await i(()=>e(t,"rocketStrike"),()=>a(t,"largeDrone.eight2").process)},lF=(t,e,i)=>async({spawn:a,showState:r,moveTo:n,wait:o,waitForEvent:s,race:l,addScreenTrauma:h})=>{let c=a("Mine",{location:{x:t.x+.3*t.w,y:t.y+.5*t.h},defaultVelocity:200});await r(c,"rotate");let u=null,d=async()=>{u=n(c,{y:1.1}),await u.process,u.wasCompleted()&&(u=n(c,{x:e.x}),await u.process,u.wasCompleted())&&(u=n(c,{y:e.y}),await u.process,u.wasCompleted())&&(await i(),await o(100+1e3*Math.random()),await r(c,"open",500),"dead"!==c.appliedEntityState&&(r(c,"blinking"),await o(1e3),"dead"!==c.appliedEntityState&&(r(c,"explode"),h(.3),await o(500),c.destroy())))};await l([()=>s(c,"Dead",async()=>{u&&u.abort(),"explode"!==c.appliedEntityState&&(r(c,"dead"),h(.3),await o(500),c.destroy(),u&&u.abort())}),d])},lE=t=>async({exec:e,wait:i,moveWithPattern:a,parallel:r})=>{let n=lo(),o=a(t,"largeDrone.eight");r([{x:.2,y:.3},{x:.6,y:.3},{x:.4,y:.5},{x:.2,y:.8},{x:.6,y:.8}].map((a,r)=>async()=>{let o=n.addSynchronisation();await i(200*(r+1)),e(lF(t,a,o))})),await o.process},lB=()=>async({moveWithPattern:t,playAnimation:e,setScrollingSpeed:i,showState:a,spawn:r,exec:n,parallel:o,wait:s})=>{let l=r("LargeDrone",{location:{rx:1.1,ry:.2},defaultVelocity:200}),h=t(l,"largeDrone.intro");await h.process,await o([()=>lt("Drone","**Bzzt** We are in control of your army now!\nJust give up!",{portrait:"portraits.drone"}),()=>a(l,"laugh")]),await n(lA(l)),await n(lP(l)),await n(lE(l)),console.log("mine attack!"),await s(1e4);let c=e("city.Bridge",{max:2});await s(1e4),c.updateCheckpointLimit(1/0),await c.waitTillCheckpoint(3),await i(200,0),l.destroy()},lT=(t,e=0,i=0,a=null,r=!1)=>async({spawn:n,showState:o,waitForEvent:s,allowDamage:l,awardPoints:h,moveWithPattern:c})=>{let u=rh(t).path,d=n(r?"HouseHostile":"House",{location:{rx:u[0].x,ry:u[0].y+e},defaultVelocity:a||200});r&&o(d,"shooting"),d.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),s(d.chimneyLoc,"Dead",async()=>{h(i,d.chimneyLoc.x+20,d.chimneyLoc.y),o(d,"dead"),d.chimneyLoc.clearCollisionComponents()}),d.chimneyLoc.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),await l(d.chimneyLoc,{health:30});let p=c(d,t);await p.process,p.wasCompleted()&&d.destroy()},lM=(t,e,{points:i=10,delay:a=3500,yOffsets:r=[0],speed:n=null,shootModulo:o=1}={})=>async({exec:s,wait:l})=>Promise.all(Array(t).fill(0).map(async(t,h)=>{await l(h*a);let c=r[h%r.length];await s(lT(e,c,i,n,h%o==0))})),lL=({existing:t=!1,hasLaser:e=!1,turned:i=!1}={})=>async({spawn:a,exec:r,waitForEvent:n,allowDamage:o,setHealthbar:s,setEnergybar:l,showState:h,setGameSpeed:c,addScreenTrauma:u,playerHit:d,wait:p,loseLife:y})=>{let m=v("Player").get(0),f=t&&v("Jinte").get(0);if(f&&f.has(op))return;let g=f||a("Jinte",{location:{rx:i?.8:.2,ry:.5},defaultVelocity:400});m.invincible||(g===f?(await o(g,{health:g.health||50}),g.energy=g.energy||0):(g.health=g.health||50,g.energy=0,p(2e3).then(async()=>{await o(g,{})}))),e&&(g.hasLaser=!0),g.health<25&&g.displayFrame("damaged"),s(g.health/50),l(g.energy/100),i&&await h(g,"turned"),h(g,"flying"),g.addComponent(op,oy,s7),m.has(od)&&m.assignControls(g),g.defineBuff("overdrive",{cost:{energy:25},duration:3,cooldown:3}),g.uniqueBind("ButtonPressed",t=>{if("fire"===t&&(g.showState("noLaserShooting"),g.showState("shooting")),"heavy"===t){if(!g.hasLaser)return;g.showState("noShooting"),g.showState("laserShooting")}"power1"===t&&(g.activateBuff("overdrive"),g.trigger("EnergyUpdate"),l(g.energy/100))}),g.uniqueBind("ButtonReleased",t=>{"fire"===t&&g.showState("noShooting"),"heavy"===t&&g.showState("noLaserShooting")}),g.uniqueBind("DealtDamage",({damage:t})=>{"Bullet"!==t[0].name||g.buffActive("overdrive")||(g.energy=Math.min(100,g.energy+1),g.trigger("EnergyUpdate"),l(g.energy/100))}),g.uniqueBind("HealthChange",t=>{t<g.health&&d(t-g.health);try{s(t/50)}catch(t){}t<25&&"dead"!==g.appliedEntityState&&g.displayFrame("damaged")}),g.uniqueBind("turn",()=>{g.health<25?h(g,"turningDamaged"):h(g,"turning")}),n(g,"Dead",async()=>{g.attr({disableControls:!0,vx:0,vy:0}),u(.8),c(.4);let t=h(g,"dead");await p(150),c(.7),await p(600),u(.5),await t;let e=!!g.xFlipped,i=g.hasLaser;g.destroy(),await y(),c(1),await p(1e3),r(lL({turned:e,hasLaser:i}))})},lR=(t,e=0,i=0,a=null,r=!1)=>async({spawn:n,showState:o,waitForEvent:s,allowDamage:l,awardPoints:h,moveWithPattern:c})=>{let u=rh(t).path,d=n(r?"Seagull":"WarBird",{location:{rx:u[0].x,ry:u[0].y+e},defaultVelocity:a??(r?150:300)});await l(d,{health:r?120:30});let p=c(d,t);r&&o(d,"shooting"),s(d,"Dead",async()=>{p.abort(),i>0&&h(i,d.x,d.y),await o(d,"dead"),d.destroy()}),await p.process,p.wasCompleted()&&d.destroy()},lO=(t,e,{points:i=10,delay:a=500,yOffset:r=0,speed:n=null,gull:o=!1}={})=>async({exec:s,wait:l})=>Promise.all(Array(t).fill(0).map(async(t,h)=>{await l(h*a),await s(lR(e,r,i,n,o))})),lj=(t,e=0,i=0,a=null)=>async({spawn:r,showState:n,waitForEvent:o,allowDamage:s,awardPoints:l,moveWithPattern:h})=>{let c=rh(t).path,u=r("WarFish",{location:{rx:c[0].x,ry:c[0].y+e},defaultVelocity:a||300});await s(u,{health:30});let d=h(u,t);o(u,"Dead",async()=>{d.abort(),i>0&&l(i,u.x,u.y),await n(u,"dead"),u.destroy()}),await d.process,d.wasCompleted()&&u.destroy()},lH=(t,e,{points:i=10,delay:a=500,yOffset:r=0,speed:n=null}={})=>async({exec:o,wait:s})=>Promise.all(Array(t).fill(0).map(async(t,l)=>{await s(l*a),await o(lj(e,r,i,n))})),lI=(t,e)=>async({allowDamage:i,showState:a,waitForEvent:r,wait:n,spawn:o,gainLife:s,moveWithPattern:l})=>{let h=o("ExtraLife",{location:{rx:t,ry:e},defaultVelocity:50});await i(h,{health:10}),r(h,"Dead",async()=>{s(),await a(h,"pickedUp"),await n(2e3),h.destroy()});let c=l(h,"powerup.circles");await c.process,await a(h,"disappear",1e3),h.destroy()},lG=(t,e)=>async({spawn:i,moveWithPattern:a,moveTo:r,addScreenTrauma:n,wait:o,waitForEvent:s,showState:l,allowDamage:h,race:c})=>{await l(t,e?"aimHigh":"aimLow");let u=t.currentAttachHooks.gun;if(!t.hasHealth())return;let d=i("Mine",{location:{x:u.x,y:u.y},defaultVelocity:350}).attr({z:u.z});s(d,"Loose",async()=>{d.attr({z:d.z+30})});let p=a(d,e?"mineCannon.highShot":"mineCannon.lowShot",null,B);await l(t,"shoot"),p.process.then(async()=>{let t;await h(d,{health:40});let e=v("Jinte").get(0);t=r(d,{y:1}),await t.process,t=r(d,{x:e.x/v.viewport.width}),await t.process,t=r(d,{y:e.y/v.viewport.height}),await c([()=>s(d,"Dead",async()=>{t&&t.abort(),"explode"!==d.appliedEntityState&&(l(d,"dead"),n(.3),await o(1e3),d.destroy(),t&&t.abort())}),async()=>{await t.process,t.wasCompleted()&&"dead"!==d.appliedEntityState&&(await l(d,"open",500),l(d,"blinking"),await o(1e3),"dead"!==d.appliedEntityState&&(l(d,"explode"),n(.3),await o(1e3),d.destroy()))}])})},lq=t=>async({awardPoints:e,showState:i,waitForEvent:a,allowDamage:r})=>{let n=a(t,"Dead",async()=>{e(200,t.x+20,t.y),i(t,"dead"),t.clearCollisionComponents()});t.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),r(t,{health:750}),i(t,"shooting"),await n},lU=t=>async({showState:e,waitForEvent:i,allowDamage:a,race:r,awardPoints:n,until:o})=>{let s=t.mineCannon;s.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy");let l=i(s,"Dead",async()=>{n(250,s.x,s.y),e(s,"dead"),s.clearCollisionComponents()});await r([async()=>{await lt("Sinterklaas","Al die jaren bezorde die pakjes mij hoofdpijn!",{portrait:"portraits.sint"}),await lt("Sinterklaas","Nu gaan ze jullie hoofdpijn bezorgen, hahaha!",{portrait:"portraits.sint"}),await a(s,{health:800});let t=!0;await o(()=>l,async({exec:e})=>{await e(lG(s,t)),t=!t})},()=>l])},lN=t=>async({exec:e,waitForEvent:i,parallel:a,until:r,showState:n,awardPoints:o,allowDamage:s,wait:l})=>{let h=t.cabin1.radar;h.addCollisionComponent("SolidCollision"),n(h,"pulse"),await s(h,{health:500}),await i(h,"Dead",async()=>{o(100,h.x+20,h.y),n(h,"dead"),h.clearCollisionComponents()})},lV=t=>async({wait:e,showState:i,moveTo:a,exec:r,parallel:n})=>{await n([()=>a(t,{y:.65},20,F).process,()=>i(t,"risen",2e3),async()=>{await e(1e3),await r(lc())}]),await n([()=>a(t,{y:.7},20,F).process,()=>i(t,"lowered",2e3)])},lX=t=>async({showState:e,wait:i,exec:a,parallel:r})=>{await i(1e3),await lt("Sinterklaas","Tijd om mijn pakjesruim te legen!",{portrait:"portraits.sint"}),await a(lV(t)),await r([async()=>{await e(t,"t3r",1e3),await a(lq(t.hatch3.payload))},async()=>{await e(t,"t1r",1e3),await a(lq(t.hatch1.payload))}]),await a(lV(t))},lW=(t,e)=>async({allowDamage:i,showState:a,waitForEvent:r,wait:n,spawn:o,gainLife:s,moveWithPattern:l})=>{let h=o("ExtraLife",{location:{x:t,y:e},defaultVelocity:50});await i(h,{health:10}),r(h,"Dead",async()=>{s(),await a(h,"pickedUp"),await n(2e3),h.destroy()});let c=l(h,"powerup.circles");await c.process,await a(h,"disappear",1e3),h.destroy()},lY=t=>async({allowDamage:e,showState:i,waitForEvent:a,awardPoints:r,addScreenTrauma:n,exec:o,wait:s})=>{let l=t.cabin1;l.addCollisionComponent("SolidCollision");let h=a(l,"Dead",async()=>{r(2e3,l.x+l.w/2,l.y),i(t,"cabin1Explode"),n(.5),await s(2e3),n(.5),l.clearCollisionComponents(),i(t,"cabin1Smoke")});await e(l,{health:500}),await h,l.removeComponent("SolidCollision"),o(lW(l.x+l.w/2,l.y-l.h))},lK=t=>async({allowDamage:e,showState:i,addScreenTrauma:a,waitForEvent:r,awardPoints:n,wait:o})=>{let s=t.cabin2;s.addCollisionComponent("SolidCollision");let l=r(s,"Dead",async()=>{n(2e3,s.x+s.w/2,s.y),i(t,"cabin2Explode"),a(.5),await o(2e3),a(.5),s.clearCollisionComponents(),i(t,"cabin2Smoke")});await e(s,{health:500}),await l,s.removeComponent("SolidCollision")},lJ=t=>async({showState:e,allowDamage:i,waitForEvent:a,call:r,awardPoints:n})=>{await i(t,{health:30}),a(t,"Dead",async()=>{n(25,t.x,t.y),e(t,"falling"),await r(t.activateGravity,"GravityLiquid")})},l$=async({parallel:t,spawn:e,wait:i,showState:a,exec:r,moveTo:n,setBackgroundCheckpointLimit:o,setScrollingSpeed:s})=>{let l;let h=j("Pas op!",{color:"#FF0000"});await t([()=>h.blink(500,4),()=>s(150,0),()=>lt("Jonas","Daar is de stoomboot!",{portrait:"portraits.jonas"})]),h.remove();let c=e("BattleShip",{location:{rx:1.1,ry:.7},defaultVelocity:85});r(lJ(c.boxLocation1)),r(lJ(c.boxLocation2)),l=n(c,{x:.8},null,F),await t([()=>l.process,()=>r(lU(c))]),await i(1e3),l=n(c,{x:.5},null,F),await l.process,await r(lN(c)),await r(lY(c)),await i(1e3),l=n(c,{x:-.17},null,F),await l.process,await r(lX(c)),await t([async()=>{l=n(c,{x:-.4},null,F),await l.process},()=>r(lK(c))]),await lt("Sinterklaas","Neee!!!",{portrait:"portraits.sint"}),t([()=>a(c,"sinking",17e3,F),async()=>{l=n(c,{x:-1.7,y:.85},null,F),await l.process,c.destroy()}]),await i(4e3)};var lQ=[{name:"sint.intro",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,setBackground:r,playAnimation:n,setAltitude:o,showHUD:s,parallel:l,exec:h,onScriptClose:c,fadeIn:u,wait:d})=>{let p=j("Loading...");p.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","sint"]),tU.playAudio("sint"),await t(0,0,{instant:!0}),await e("garden.Grass"),r("city.Sunset",0,1);let y=u();p.remove(),await y.start(1e3),await lt("Jinte","Kijk Jonas, een lekkere tas vol wortels voor je",{portrait:"portraits.jinte"}),await lt("Jonas","Dank je, dat is perfecte munitie!",{portrait:"portraits.jonas"}),await lt("Jinte","Waaah, je praat!",{portrait:"portraits.jinte"}),await lt("Jonas","We zitten in jouw droomwereld. Ik kan hier zelfs vliegen!",{portrait:"portraits.jonas"}),await lt("Jonas","Maar Sinterklaas in deze wereld is op hol geslagen!",{portrait:"portraits.jonas"}),await lt("Jinte","Is Sinterklaas hier ook!??",{portrait:"portraits.jinte"}),await lt("Jonas","Jazeker! Maar we moeten hem stoppen, laten we gaan!",{portrait:"portraits.jonas"}),await lt("Jonas","Daarvoor had me toch munitie gebracht?",{portrait:"portraits.jonas"}),h(lL({existing:!0})),s(),await t(250,0);let m=j("Klaar voor de start",{color:"#FF0000"}),f=m.blink(200,4);await f,await m.zoomOut(500),m.remove(),await d(2e3),await lt("Jonas","Pas op voor de plofmussen!",{portrait:"portraits.jonas"}),await l([()=>h(lO(2,"bird.straight",{delay:300,yOffset:.1})),async()=>{await d(1500),await h(lO(2,"bird.straight",{delay:300,yOffset:-.1}))},async()=>{await d(3e3),await h(lO(2,"bird.straight",{delay:300,yOffset:-.3}))}]);let g=j("Strijd om de tuin",{color:"#FFFFFF",sup:"Hoofdstuk 1:"});await d(2e3),g.remove(),await h(le)},tags:{sint:!0}},{name:"sint.garden",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,setBackground:r,playAnimation:n,setAltitude:o,showHUD:s,parallel:l,exec:h,onScriptClose:c,fadeIn:u,waitTillInScreen:d,wait:p})=>{let y=j("Loading...");y.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","sint"]),tU.playAudio("sint"),await t(250,0,{instant:!0}),o(0,{instant:!0}),r("city.Sunset",0,1),await e("garden.Grass"),s(),y.remove(),h(lL({existing:!0})),await h(lO(5,"bird.pattern1")),await e("garden.PondStart"),await l([async()=>{await h(lO(5,"bird.pattern1")),await h(lO(8,"bird.pattern2"))},async()=>{await d("garden.PondStart",-625)}]),await p(3e3),await h(lH(4,"fish.pattern1")),await h(lH(4,"fish.pattern2")),await l([async()=>{await h(lH(4,"fish.pattern1"))},async()=>{await h(lH(4,"fish.pattern2"))}]),await o(700),await h(lO(5,"bird.pattern1")),await h(lO(8,"bird.pattern2"));let m=j("Berg cadeautjes",{color:"#FFFFFF",sup:"Hoofdstuk 2:"});await m.fadeIn(500),await p(4e3),await m.fadeOut(500),m.remove(),await h(le)},tags:{sint:!0}},{name:"sint.berg",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,setBackground:r,playAnimation:n,setAltitude:o,showHUD:s,parallel:l,exec:h,onScriptClose:c,fadeIn:u,waitTillInScreen:d,wait:p})=>{let y=j("Loading...");y.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","sint"]),tU.playAudio("sint"),r("city.Sunset",0,2),await t(250,0,{instant:!0}),o(700,{instant:!0}),await e("garden.Pond"),s(),y.remove(),h(lL({existing:!0})),await e("town.RoofTops"),await l([async()=>{await lt("Jonas","We moeten via Berg naar Maastricht vliegen",{portrait:"portraits.jonas"}),await lt("Jinte","Zijn stoomboot ligt daar op de Maas?",{portrait:"portraits.jinte"}),await lt("Jonas","Inderdaad",{portrait:"portraits.jonas"}),await h(lO(5,"bird.pattern4"))},async()=>{await d("town.RoofTops",-625)}]),await l([async()=>{await h(lO(5,"bird.pattern5"))},async()=>{await o(400)}]),await h(lM(5,"house.straight",{yOffsets:[0,.1,0,-.1,0],shootModulo:2})),await h(lO(5,"bird.pattern4")),await h(lM(5,"house.straight",{yOffsets:[0,.15,.5,-.1,0],shootModulo:3})),h(lI(.7,.4));let m=j("Stedentrip",{color:"#FFFFFF",sup:"Hoofdstuk 3:"});await m.fadeIn(500),await p(4e3),await m.fadeOut(500),m.remove(),await h(le)},tags:{sint:!0}},{name:"sint.maastricht",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,setBackground:r,playAnimation:n,setAltitude:o,showHUD:s,parallel:l,exec:h,onScriptClose:c,fadeIn:u,waitTillInScreen:d,wait:p})=>{let y=j("Loading...");y.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","sint"]),tU.playAudio("sint"),r("city.Sunset",1,3),await t(250,0,{instant:!0}),o(400,{instant:!0}),await e("town.RoofTops"),s(),y.remove(),h(lL({existing:!0})),await e("town.Rasberg"),await l([async()=>{await lt("Jinte","Ik zie Maastricht al, we zijn er bijna!",{portrait:"portraits.jinte"}),await h(lO(4,"bird.pattern2"))},async()=>{await d("town.Rasberg",-1020)}]),await p(7e3),await h(lO(1,"bird.pattern6",{gull:!0,points:30})),await lt("Jonas","Gatver! Flatsmeeuwen",{portrait:"portraits.jonas"}),await l([()=>h(lO(2,"bird.pattern2",{delay:1e3,points:30,gull:!0})),()=>o(0)]),await h(lH(4,"fish.pattern1")),await e("city.Bridge"),await l([async()=>{await h(lH(4,"fish.pattern1"))},async()=>{await h(lH(4,"fish.pattern2"))}]),await h(lO(2,"bird.pattern2",{delay:1e3,points:30,gull:!0})),await lt("Jonas","Het moet nu niet ver meer zijn!",{portrait:"portraits.jonas"}),await lt("Jinte","Ik hoop het, want ik wil mijn pakje open maken",{portrait:"portraits.jinte"}),await d("city.Bridge",520),await e("city.BayEnd"),await p(3e3),await h(lH(4,"fish.pattern1")),await h(lH(4,"fish.pattern1")),await e("city.CoastEnd"),tU.fadeMusicVolume(.2,5e3),await p(3e3),await lt("Jinte","Hey, wat is het ineens stil...",{portrait:"portraits.jinte"}),await h(lH(4,"fish.pattern2")),await lt("Jonas","Ja, dat is vast om de spanning op te bouwen",{portrait:"portraits.jonas"}),await h(lO(3,"bird.pattern2",{delay:2e3,points:30,gull:!0}));let m=j("Zie ginds...",{color:"#FFFFFF",sup:"Hoofdstuk 4:"});tU.fadeMusicVolume(0,2e3),await m.fadeIn(500),await p(4e3),await m.fadeOut(500),m.remove(),await h(le)},tags:{sint:!0}},{name:"sint.stoomboot",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,setBackground:r,playAnimation:n,setAltitude:o,showHUD:s,parallel:l,exec:h,onScriptClose:c,fadeIn:u,waitTillInScreen:d,wait:p})=>{let y=j("Loading...");y.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","boss"]),tU.playAudio("boss"),r("city.Sunset",3,4),await t(250,0,{instant:!0}),o(0,{instant:!0}),await e("city.Ocean"),s(),y.remove(),h(lL({existing:!0})),await h(l$);let m=j("Knockout!",{color:"#FFFFFF"}),f=m.blink(200,4);await f,await m.zoomOut(500),m.remove(),await p(2e3),await lt("Jonas","Woohoo!! Goed gedaan!",{portrait:"portraits.jonas"}),await lt("Jinte","Kijk, zo doen we dat!",{portrait:"portraits.jinte"}),await lt("Jonas","Dan is het nu tijd om je pakje open te maken",{portrait:"portraits.jonas"})},tags:{sint:!0}},{name:"stage1.intro",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,setBackground:r,playAnimation:n,setAltitude:o,showHUD:s,parallel:l,exec:h,onScriptClose:c,fadeIn:u,wait:d})=>{let p;let y=j("Loading...");y.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","hero"]),tU.playAudio("hero");let m=tU.playAudio("helicopter",{volume:0});c(()=>{m.stop()}),await t(150,0,{instant:!0}),await e("city.Ocean"),r("city.Sunrise",0,2);let f=u();y.remove();let g=n("city.Intro"),w=v("IntroShip").get(0);h(li(w.boxLocation1)),h(li(w.boxLocation2)),await f.start(1e3),await l([()=>lt("General","Let us escort you to the factory to install\nthe AI controlled defence systems. You are the last ship.",{portrait:"portraits.general"}),async()=>{await g.waitTillCheckpoint(1),m.setVolume(2,1500)},async()=>{await g.waitTillCheckpoint(3),m.setVolume(.6,3e3),h(s9({existing:!0}))}]),s();let x=j("Get ready",{color:"#FF0000"}),_=x.blink(200,4);t(350,0),await l([async()=>{await g.waitTillEnd()},async()=>{await _,await x.zoomOut(500),x.remove(),p=h(s6({existing:!0})),await l([async()=>{await lt("General","We send some drones for some last manual target practice",{portrait:"portraits.general"}),await lt("John","Let's go!",{portrait:"portraits.pilot"})},async()=>{await l([()=>h(s4(2,"drone.straight",{delay:300,yOffset:.1})),async()=>{await d(1500),await h(s4(2,"drone.straight",{delay:300,yOffset:-.1}))},async()=>{await d(3e3),await h(s4(2,"drone.straight",{delay:300,yOffset:-.3}))}]),await h(s4(5,"drone.pattern1")),await h(s4(8,"drone.pattern2"))}])}]),g.destroy(),o(200),await h(s4(5,"drone.pattern1")),await h(s4(8,"drone.pattern2")),await lt("John","Well that was fun. I will miss the manual mode..",{portrait:"portraits.pilot"}),await p,h(s8({existing:!0},m)),await lt("General","What is that! Evacuate!\nNow!",{portrait:"portraits.general"}),await d(1e3);let b=j("Hacked",{color:"#FFFFFF",sup:"Chapter 1:"});await l([()=>lt("General","The helicopter is out of control!",{portrait:"portraits.general"}),async()=>{await d(2e3),await b.fadeIn(500),await d(2e3),await b.fadeOut(500)}]),b.remove(),await l([()=>h(s4(5,"drone.pattern3")),()=>h(s4(5,"drone.pattern4"))]),await h(le)},tags:{campaign:!0}},{name:"stage1.hacked",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,wait:r,setAltitude:n,setBackground:o,parallel:s,showHUD:l,exec:h})=>{let c=j("Loading...");c.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","hero"]),tU.playAudio("hero"),await t(350,0,{instant:!0}),n(200,{instant:!0}),o("city.Sunrise",1,2),await e("city.Ocean"),l(),c.remove(),h(s9({existing:!0})),await s([async()=>{await r(2e3),await n(0)},()=>h(la("heli.pattern1","heli.repeat1"))]),await s([()=>h(s4(4,"drone.pattern6")),async()=>{await r(2e3),await h(s4(4,"drone.pattern6",{yOffset:.2}))},async()=>{await r(4e3),await h(s4(4,"drone.pattern6",{yOffset:.4}))}]),await h(s4(4,"drone.pattern5")),await h(ln()),await h(s4(4,"drone.pattern1")),await h(ll()),await e("city.CoastStart"),await h(ll()),await s([()=>h(s4(4,"drone.pattern6")),async()=>{await r(2e3),await h(s4(4,"drone.pattern6",{yOffset:.2}))},async()=>{await r(4e3),await h(s4(4,"drone.pattern6",{yOffset:.4}))}]),await h(ln()),await h(le)},tags:{campaign:!0}},{name:"stage1.battleship",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,setBackground:r,exec:n,showHUD:o})=>{let s=j("Loading...");s.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","hero"]),tU.playAudio("hero"),await t(350,0,{instant:!0}),await e("city.Coast"),r("city.Sunrise",2,2),o(),s.remove(),n(s9({existing:!0})),await n(s4(5,"drone.pattern2")),await n(lk),await n(le)},tags:{campaign:!0}},{name:"stage1.battleshipEnd",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,parallel:r,setBackground:n,wait:o,exec:s,showHUD:l})=>{let h=j("Loading...");h.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","hero"]),tU.playAudio("hero"),await t(150,0,{instant:!0}),await e("city.Coast"),n("city.Sunrise",3,3),l(),h.remove(),s(s9({existing:!0,hasLaser:!0})),await t(350,0),await e("city.BayStart"),await lt("General","I'm at a safe location now. We need to end this threat.\nHow are you holding up?",{portrait:"portraits.general"}),await r([async()=>{await lt("John","I'm fine. That ship had some advanced weaponry on board.\nDid you know that?",{portrait:"portraits.pilot"}),await lt("General","We can not acces the computer systems anymore. But this would\nmean they also have control over our R&D division.\nThis is really bad.",{portrait:"portraits.general"}),await lt("John","I will try to reach the R&D center to investigate.",{portrait:"portraits.pilot"})},()=>s(s4(4,"drone.straight",{delay:400,yOffset:.1,speed:330})),async()=>{await o(4e3),await s(s4(4,"drone.straight",{delay:400,yOffset:-.1,speed:330}))},async()=>{await o(8e3),await s(s4(4,"drone.straight",{delay:400,yOffset:-.3,speed:330}))},async()=>{await o(1e4),await s(s4(4,"drone.straight",{delay:400,yOffset:-.1,speed:330}))},async()=>{await o(12e3),await s(s4(4,"drone.straight",{delay:400,yOffset:.1,speed:330}))}]),await s(le)},tags:{campaign:!0}},{name:"stage1.bay",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,parallel:r,setBackground:n,wait:o,exec:s,showHUD:l})=>{let h=j("Loading...");h.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","hero"]),tU.playAudio("hero"),await t(250,0,{instant:!0}),await e("city.Bay"),n("city.Sunrise",3,3),l(),h.remove(),s(s9({existing:!0,hasLaser:!0})),await s(s4(5,"drone.pattern1")),await s(s4(8,"drone.pattern2")),await s(ll()),await e("city.Bridge"),await s(la("heli.pattern1","heli.repeat1")),await r([()=>s(s4(5,"drone.pattern3")),()=>s(s4(5,"drone.pattern5"))]),await s(ll()),await r([()=>s(la("heli.pattern1","heli.repeat2")),async()=>{await o(5e3),await s(la("heli.pattern1","heli.repeat1"))}]),await o(2e3),await r([()=>s(s4(5,"drone.pattern3")),()=>s(s4(5,"drone.pattern5"))]),await s(le)},tags:{campaign:!0}},{name:"stage1.bridge",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,setBackground:r,parallel:n,exec:o,waitTillInScreen:s,showHUD:l})=>{let h=j("Loading...");h.fadeIn(2e3),await i(["mega-texture"]),await a(["effects","hero"]),tU.playAudio("hero"),await t(250,0,{instant:!0}),await e("city.BayFull"),r("city.Sunrise",3,3),l(),h.remove(),o(s9({existing:!0,hasLaser:!0}));let c=j("Warning!",{color:"#FF0000"});await c.blink(500,4),c.remove(),await e("city.Bridge"),await n([async()=>{await s("city.Bridge",-625),await t(0,0)},async()=>{await o(lz()),await o(lz()),await o(lz())}]),await o(lB())},tags:{campaign:!0,wip:!0}},{name:"end",script:async()=>{let t=j("Congratulations!",{sup:"The end for now..."});await t.fadeIn(5e3),t.remove()},tags:{campaign:!0}},{name:"test.scenery",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,setBackground:r,addScreenTrauma:n,setAltitude:o,exec:s,wait:l,fadeIn:h})=>{let c=h(),u=j("Loading...");u.fadeIn(2e3),await i(["mega-texture"]),await a(["effects"]),await t(100,0,{instant:!0}),await e("city.Ocean"),r("city.Sunrise",0,5),u.remove(),await c.start(2e3),await l(5e3),await t(500,0),await lt("General","Let us escort you to the factory to install\nthe AI controlled defence systems. You are the last ship.",{portrait:"portraits.general"}),n(.8),n(.8),n(.8),n(.8),await lt("John","Let's go!",{portrait:"portraits.pilot"}),await s(s4(4,"drone.straight",500,.1)),n(.8),n(.8),n(.8),n(.8),await s(s4(4,"drone.straight",500,-.1)),await s(s4(4,"drone.straight",500,-.3)),await o(200),await s(s4(5,"drone.pattern1",500)),await s(s4(8,"drone.pattern2",500)),await o(0),await s(s4(5,"drone.pattern3",500)),await t(100,0),await s(ll()),await s(s4(5,"drone.pattern3",500)),await e("city.CoastStart"),await s(ll()),await t(250,0),await l(2e4),await e("city.BayStart"),await l(4e4),await e("city.Bridge"),await l(4e4)},tags:{test:!0}},{name:"test.laser",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,showHUD:r,showState:n,wait:o,exec:s})=>{let l=j("Loading...");l.fadeIn(2e3),await i(["mega-texture"]),await a(["effects"]),await t(0,0,{instant:!0}),await e("Test.Walls"),r(),l.remove(),s(s9({existing:!0,hasLaser:!0}));let h=v("PlayerShip").get(0);await n(h,"turned"),await o(12e4),await n(h,"turned"),await o(3e5)},tags:{test:!0}},{name:"test.composable",script:async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:a,showHUD:r,wait:n,exec:o})=>{let s=j("Loading...");s.fadeIn(2e3),await i(["mega-texture"]),await a(["effects"]),await t(0,0,{instant:!0}),await e("Test.Walls"),r(),s.remove();let l=+new Date;v.bind("EnterFrame",t=>{(+new Date-l)%6e4<40&&console.log(1e3/t.dt,"FPS")}),await n(3e5)},tags:{test:!0}}];const lZ=(t,e,i,a="#FFFFFF",r="20px")=>{let n=v.e("2D, UILayerDOM, Text").attr({x:e.x,y:e.y+i,w:e.w,z:e.z+1}).text(t).textColor(a).textAlign("center").textFont({size:r,weight:"bold",family:"Press Start 2P"});return e.attach(n),n},l0="Menu",l1=(t,e)=>t?e?"#FF0000":"#FFFF00":e?"#FF6666":"#999999",l2=t=>t.getName?t.getName():t.name,l5=(t,e)=>{let i=t.item[e];if(!i)return;i();let a=l2(t.item);t.text(a)};v.c(l0,{required:"2D",events:{Freeze(){this._detachController&&(this._detachController(),this._detachController=null),this._children.forEach(t=>t.freeze())},Unfreeze(){this._children.forEach(t=>t.unfreeze())}},init(){},remove(){this._detachController&&(this._detachController(),this._detachController=null)},menu(t,e){let i=0;return this.items=t.map(t=>{t.spaceAbove&&(i+=16);let e=lZ(l2(t),this,i,l1(!1,t.dangerous),"16px");return e.item=t,i+=32,e}),this.attr({h:i}),this._menuItem=0,this.selectOption(null,0),this.attachController(e),this},attachController(t){this._detachController&&(this._detachController(),this._detachController=null);let e=()=>{this._menuItem=this.selectOption(this._menuItem,1)},i=()=>{this._menuItem=this.selectOption(this._menuItem,-1)},a=()=>{l5(this.items[this._menuItem],"left")},r=()=>{l5(this.items[this._menuItem],"right")},n=()=>{l5(this.items[this._menuItem],"activate")};return t.bind("Down",e),t.bind("Up",i),t.bind("Left",a),t.bind("Right",r),t.bind("Fire",n),this._detachController=()=>{t.unbind("Down",e),t.unbind("Up",i),t.unbind("Left",a),t.unbind("Right",r),t.unbind("Fire",n)},this},selectOption(t,e){let i=null===t?e:(t+this.items.length+e)%this.items.length;if(t!==i){let e=null!==t&&this.items[t].item.deselect;e&&e();let a=this.items[i].item.select;a&&a()}return this.items.forEach((t,e)=>t.textColor(l1(e===i,t.item.dangerous))),i}});let l3=null;const l4=()=>{if(l3)return l3;let t=localStorage.getItem("SPDLZR-SET");if(!t)return{};try{l3=JSON.parse(t)}catch(t){l3=null}return l3||{}},l6=(t,e)=>{let i=l4();i[t]=e,l3=i,localStorage.setItem("SPDLZR-SET",JSON.stringify(i))};var l8=(t,e)=>{let i=l4()[t];return void 0===i?e:i};const l7="PauseMenu",l9={0:"Off",10:"Max"},ht=t=>l9[t]||t,he=void 0,hi=[{name:"Resume",activate:()=>{setTimeout(()=>tX())}},{getName:()=>{let t=Math.round(10*tU.getEffectsVolume());return`Sound [${ht(t)}]`},left:()=>{let t=Math.round(10*tU.getEffectsVolume());t=Math.max(0,t-1),tU.setEffectVolume(t/10),l6("effectsVolume",t/10)},right:()=>{let t=Math.round(10*tU.getEffectsVolume());t=Math.min(10,t+1),tU.setEffectVolume(t/10),l6("effectsVolume",t/10)},select:()=>{},deselect:()=>{}},{getName:()=>{let t=Math.round(10*tU.getMusicVolume());return`Music [${ht(t)}]`},left:()=>{let t=Math.round(10*tU.getMusicVolume());t=Math.max(0,t-1),tU.setMusicVolume(t/10),l6("musicVolume",t/10)},right:()=>{let t=Math.round(10*tU.getMusicVolume());t=Math.min(10,t+1),tU.setMusicVolume(t/10),l6("musicVolume",t/10)},select:()=>{},deselect:()=>{}},{name:"Restart",spaceAbove:!0,dangerous:!0,activate:()=>{setTimeout(()=>{tX(),v.trigger("EndGame",{mode:"restart"}),v.enterScene("Game")})}},{name:"Quit",dangerous:!0,activate:()=>{setTimeout(()=>{tX(),v.trigger("EndGame",{mode:"quit"}),v.enterScene("Intro")})}}];v.c(l7,{required:"UILayerDOM, 2D, Color",events:{Freeze(){this._children.forEach(t=>t.freeze())},Unfreeze(){this._children.forEach(t=>t.unfreeze())}},init(){},showMenu(t){return this.menu?this.menu.attachController(t):this.menuOptions(hi,t),this},menuOptions(t,e){this.attr({x:(v.viewport.width-400)/2,w:400,alpha:.8,z:200}).color("#222222");let i=70;return lZ("Game paused",this,20),this.menu=v.e(l0).attr({x:this.x,w:this.w,y:this.y+70,z:this.z+1}).menu(t,e),this.attach(this.menu),lZ(`version: ${he}`,this,i+=this.menu.h+10,"#eeeeee","8px"),i+=20,this.attr({y:(v.viewport.height-i)/2,h:i}),this}});const ha="Player";v.c(ha,{init(){this.reset()},reset(){this.has(od)&&this.removeComponent(od)}});const hr=["campaign"];v.defineScene("Game",async function({start:t=null,tags:e=hr}={}){let i=null;tk(1),v.bind("GamePause",t=>{if(t){let t=v("Player").get(0);null===i?i=v.e(l7).showMenu(t):(i.unfreeze(),i.showMenu(t))}else i&&i.freeze()});let a=null;v.one("EndGame",t=>{a=t.mode}),v.viewport.x=0,v.viewport.y=0,this.state={lives:u(tM).lives,score:0};let r=s5(this.state),n=null;try{let i=!1;for(let a of lQ)(i||null===t||t===a.name)&&e.every(t=>!0===a.tags[t])&&!0!==a.tags.wip&&(i=!0,!0!==this.state.gameEnded&&(n=a.name),await r(a.script));let a=te();tU.fadeMusicVolume(0,2e3),await a.start(2e3),v.enterScene("GameOver",{gameCompleted:!this.state.gameEnded,score:this.state.score,checkpoint:!0===this.state.gameEnded?n:null})}catch(e){if(null!==a)return;"Game Over"!==e.message&&console.error(e);let t=te();tU.fadeMusicVolume(0,2e3),await t.start(2e3),v.enterScene("GameOver",{score:this.state.score,checkpoint:n})}},function(){this.state.gameEnded=!0,tU.stopMusic(),v(ha).each(function(){this.removeComponent("ShipSpawnable")}),v(sP).each(function(){this.destroy()}),v.unbind("GameOver"),v.unbind("ScriptFinished"),v.unbind("GamePause")});var hn={},ho={},hs={};hs=function(t,e){for(var i=-1,a=null==t?0:t.length;++i<a&&!1!==e(t[i],i,t););return t};var hl={};hl=function(t,e){return t&&nZ(e,o9(e),t)};var hh={};hh=function(t,e){return t&&nZ(e,n2(e),t)};var ng=f("lNdKa"),hc={},hu={},hd={};hd=function(t,e){for(var i=-1,a=null==t?0:t.length,r=0,n=[];++i<a;){var o=t[i];e(o,i,t)&&(n[r++]=o)}return n};var hp={};hp=function(){return[]};var hy=Object.prototype.propertyIsEnumerable,hm=Object.getOwnPropertySymbols;hu=hm?function(t){return null==t?[]:(t=Object(t),hd(hm(t),function(e){return hy.call(t,e)}))}:hp,hc=function(t,e){return nZ(t,hu(t),e)};var hf={},hg={},hv={};hv=function(t,e){for(var i=-1,a=e.length,r=t.length;++i<a;)t[r+i]=e[i];return t},hg=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)hv(e,hu(t)),t=nk(t);return e}:hp,hf=function(t,e){return nZ(t,hg(t),e)};var hw={},hx={};hx=function(t,e,i){var a=e(t);return nL(t)?a:hv(a,i(t))},hw=function(t){return hx(t,o9,hu)};var h_={};h_=function(t){return hx(t,n2,hg)};var hb={},hS={},rR=f("fNJVo");hS=rE(rR,"DataView");var hC={},rR=f("fNJVo");hC=rE(rR,"Promise");var hk={},rR=f("fNJVo");hk=rE(rR,"Set");var hD={},rR=f("fNJVo");hD=rE(rR,"WeakMap");var hz="[object Map]",hA="[object Promise]",hP="[object Set]",hF="[object WeakMap]",hE="[object DataView]",hB=rY(hS),hT=rY(rF),hM=rY(hC),hL=rY(hk),hR=rY(hD),hO=rM;(hS&&hO(new hS(new ArrayBuffer(1)))!=hE||rF&&hO(new rF)!=hz||hC&&hO(hC.resolve())!=hA||hk&&hO(new hk)!=hP||hD&&hO(new hD)!=hF)&&(hO=function(t){var e=rM(t),i="[object Object]"==e?t.constructor:void 0,a=i?rY(i):"";if(a)switch(a){case hB:return hE;case hT:return hz;case hM:return hA;case hL:return hP;case hR:return hF}return e}),hb=hO;var hj={},hH=Object.prototype.hasOwnProperty;hj=function(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&hH.call(t,"index")&&(i.index=t.index,i.input=t.input),i};var hI={},hG={};hG=function(t,e){var i=e?nw(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)};var hq={},hU=/\w*$/;hq=function(t){var e=new t.constructor(t.source,hU.exec(t));return e.lastIndex=t.lastIndex,e};var hN={},hV=rL?rL.prototype:void 0,hX=hV?hV.valueOf:void 0;hN=function(t){return hX?Object(hX.call(t)):{}},hI=function(t,e,i){var a=t.constructor;switch(e){case"[object ArrayBuffer]":return nw(t);case"[object Boolean]":case"[object Date]":return new a(+t);case"[object DataView]":return hG(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return nv(t,i);case"[object Map]":case"[object Set]":return new a;case"[object Number]":case"[object String]":return new a(t);case"[object RegExp]":return hq(t);case"[object Symbol]":return hN(t)}};var nH=f("2W9As"),hW={},hY={};hY=function(t){return nE(t)&&"[object Map]"==hb(t)};var nK=f("74qZ6"),hK=nK&&nK.isMap;hW=hK?nY(hK):hY;var hJ={},h$={};h$=function(t){return nE(t)&&"[object Set]"==hb(t)};var nK=f("74qZ6"),hQ=nK&&nK.isSet;hJ=hQ?nY(hQ):h$;var hZ="[object Arguments]",h0="[object Function]",h1="[object Object]",h2={};h2[hZ]=h2["[object Array]"]=h2["[object ArrayBuffer]"]=h2["[object DataView]"]=h2["[object Boolean]"]=h2["[object Date]"]=h2["[object Float32Array]"]=h2["[object Float64Array]"]=h2["[object Int8Array]"]=h2["[object Int16Array]"]=h2["[object Int32Array]"]=h2["[object Map]"]=h2["[object Number]"]=h2[h1]=h2["[object RegExp]"]=h2["[object Set]"]=h2["[object String]"]=h2["[object Symbol]"]=h2["[object Uint8Array]"]=h2["[object Uint8ClampedArray]"]=h2["[object Uint16Array]"]=h2["[object Uint32Array]"]=!0,h2["[object Error]"]=h2[h0]=h2["[object WeakMap]"]=!1,ho=function t(e,i,a,r,n,o){var s,l=1&i,h=2&i,c=4&i;if(a&&(s=n?a(e,r,n,o):a(e)),void 0!==s)return s;if(!z(e))return e;var u=nL(e);if(u){if(s=hj(e),!l)return n_(e,s)}else{var d=hb(e),p=d==h0||"[object GeneratorFunction]"==d;if(nH(e))return ng(e,l);if(d==h1||d==hZ||p&&!n){if(s=h||p?{}:nb(e),!l)return h?hf(e,hh(s,e)):hc(e,hl(s,e))}else{if(!h2[d])return n?e:{};s=hI(e,d,l)}}o||(o=new ry);var y=o.get(e);if(y)return y;o.set(e,s),hJ(e)?e.forEach(function(r){s.add(t(r,i,a,r,e,o))}):hW(e)&&e.forEach(function(r,n){s.set(n,t(r,i,a,n,e,o))});var m=c?h?h_:hw:h?n2:o9,f=u?void 0:m(e);return hs(f||e,function(r,n){f&&(r=e[n=r]),n0(s,n,t(r,i,a,n,e,o))}),s},hn=function(t){return ho(t,4)};var h5={},h3={},h4={},h6=rL?rL.isConcatSpreadable:void 0;h4=function(t){return nL(t)||nP(t)||!!(h6&&t&&t[h6])},h3=function t(e,i,a,r,n){var o=-1,s=e.length;for(a||(a=h4),n||(n=[]);++o<s;){var l=e[o];i>0&&a(l)?i>1?t(l,i-1,a,r,n):hv(n,l):r||(n[n.length]=l)}return n};var h8={},h7={},h9={},ct={},ce={};ce=function(t){return"symbol"==typeof t||nE(t)&&"[object Symbol]"==rM(t)};var ci=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ca=/^\w*$/;ct=function(t,e){if(nL(t))return!1;var i=typeof t;return!!("number"==i||"symbol"==i||"boolean"==i||null==t||ce(t))||ca.test(t)||!ci.test(t)||null!=e&&t in Object(e)};var cr={},cn={};function co(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var i=function(){var a=arguments,r=e?e.apply(this,a):a[0],n=i.cache;if(n.has(r))return n.get(r);var o=t.apply(this,a);return i.cache=n.set(r,o)||n,o};return i.cache=new(co.Cache||r2),i}co.Cache=r2;var cs=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,cl=/\\(\\)?/g;o=(n=(cn=co)(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(cs,function(t,i,a,r){e.push(a?r.replace(cl,"$1"):i||t)}),e},function(t){return 500===o.size&&o.clear(),t})).cache,cr=n;var ch={},cc={},cu=1/0,cd=rL?rL.prototype:void 0,cp=cd?cd.toString:void 0;cc=function t(e){if("string"==typeof e)return e;if(nL(e))return o7(e,t)+"";if(ce(e))return cp?cp.call(e):"";var i=e+"";return"0"==i&&1/e==-cu?"-0":i},ch=function(t){return null==t?"":cc(t)},h9=function(t,e){return nL(t)?t:ct(t,e)?[t]:cr(ch(t))};var cy={},cm=1/0;cy=function(t){if("string"==typeof t||ce(t))return t;var e=t+"";return"0"==e&&1/t==-cm?"-0":e},h7=function(t,e){e=h9(e,t);for(var i=0,a=e.length;null!=t&&i<a;)t=t[cy(e[i++])];return i&&i==a?t:void 0};var cf={},cg={},cv={},cw={},cx={},c_={},cb={},cS={};cS=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var cC={};function ck(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new r2;++e<i;)this.add(t[e])}cC=function(t){return this.__data__.has(t)},ck.prototype.add=ck.prototype.push=cS,ck.prototype.has=cC,cb=ck;var cD={};cD=function(t,e){for(var i=-1,a=null==t?0:t.length;++i<a;)if(e(t[i],i,t))return!0;return!1};var cz={};cz=function(t,e){return t.has(e)},c_=function(t,e,i,a,r,n){var o=1&i,s=t.length,l=e.length;if(s!=l&&!(o&&l>s))return!1;var h=n.get(t),c=n.get(e);if(h&&c)return h==e&&c==t;var u=-1,d=!0,p=2&i?new cb:void 0;for(n.set(t,e),n.set(e,t);++u<s;){var y=t[u],m=e[u];if(a)var f=o?a(m,y,u,e,t,n):a(y,m,u,t,e,n);if(void 0!==f){if(f)continue;d=!1;break}if(p){if(!cD(e,function(t,e){if(!cz(p,e)&&(y===t||r(y,t,i,a,n)))return p.push(e)})){d=!1;break}}else if(!(y===m||r(y,m,i,a,n))){d=!1;break}}return n.delete(t),n.delete(e),d};var cA={},cP={};cP=function(t){var e=-1,i=Array(t.size);return t.forEach(function(t,a){i[++e]=[a,t]}),i};var cF={};cF=function(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i};var cE=rL?rL.prototype:void 0,cB=cE?cE.valueOf:void 0;cA=function(t,e,i,a,r,n,o){switch(i){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)break;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":if(t.byteLength!=e.byteLength||!n(new nx(t),new nx(e)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return rw(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=cP;case"[object Set]":var l=1&a;if(s||(s=cF),t.size!=e.size&&!l)break;var h=o.get(t);if(h)return h==e;a|=2,o.set(t,e);var c=c_(s(t),s(e),a,r,n,o);return o.delete(t),c;case"[object Symbol]":if(cB)return cB.call(t)==cB.call(e)}return!1};var cT={},cM=Object.prototype.hasOwnProperty;cT=function(t,e,i,a,r,n){var o=1&i,s=hw(t),l=s.length;if(l!=hw(e).length&&!o)return!1;for(var h=l;h--;){var c=s[h];if(!(o?c in e:cM.call(e,c)))return!1}var u=n.get(t),d=n.get(e);if(u&&d)return u==e&&d==t;var p=!0;n.set(t,e),n.set(e,t);for(var y=o;++h<l;){var m=t[c=s[h]],f=e[c];if(a)var g=o?a(f,m,c,e,t,n):a(m,f,c,t,e,n);if(!(void 0===g?m===f||r(m,f,i,a,n):g)){p=!1;break}y||(y="constructor"==c)}if(p&&!y){var v=t.constructor,w=e.constructor;v!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof v&&v instanceof v&&"function"==typeof w&&w instanceof w)&&(p=!1)}return n.delete(t),n.delete(e),p};var nH=f("2W9As"),cL="[object Arguments]",cR="[object Array]",cO="[object Object]",cj=Object.prototype.hasOwnProperty;cx=function(t,e,i,a,r,n){var o=nL(t),s=nL(e),l=o?cR:hb(t),h=s?cR:hb(e);l=l==cL?cO:l,h=h==cL?cO:h;var c=l==cO,u=h==cO,d=l==h;if(d&&nH(t)){if(!nH(e))return!1;o=!0,c=!1}if(d&&!c)return n||(n=new ry),o||nV(t)?c_(t,e,i,a,r,n):cA(t,e,l,i,a,r,n);if(!(1&i)){var p=c&&cj.call(t,"__wrapped__"),y=u&&cj.call(e,"__wrapped__");if(p||y){var m=p?t.value():t,f=y?e.value():e;return n||(n=new ry),r(m,f,i,a,n)}}return!!d&&(n||(n=new ry),cT(t,e,i,a,r,n))},cw=function t(e,i,a,r,n){return e===i||(null!=e&&null!=i&&(nE(e)||nE(i))?cx(e,i,a,r,t,n):e!=e&&i!=i)},cv=function(t,e,i,a){var r=i.length,n=r,o=!a;if(null==t)return!n;for(t=Object(t);r--;){var s=i[r];if(o&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++r<n;){var l=(s=i[r])[0],h=t[l],c=s[1];if(o&&s[2]){if(void 0===h&&!(l in t))return!1}else{var u=new ry;if(a)var d=a(h,c,l,t,e,u);if(!(void 0===d?cw(c,h,3,a,u):d))return!1}}return!0};var cH={},cI={};cI=function(t){return t==t&&!z(t)},cH=function(t){for(var e=o9(t),i=e.length;i--;){var a=e[i],r=t[a];e[i]=[a,r,cI(r)]}return e};var cG={};cG=function(t,e){return function(i){return null!=i&&i[t]===e&&(void 0!==e||t in Object(i))}},cg=function(t){var e=cH(t);return 1==e.length&&e[0][2]?cG(e[0][0],e[0][1]):function(i){return i===t||cv(i,t,e)}};var cq={},cU={};cU=function(t,e,i){var a=null==t?void 0:h7(t,e);return void 0===a?i:a};var cN={},cV={};cV=function(t,e){return null!=t&&e in Object(t)};var cX={};cX=function(t,e,i){e=h9(e,t);for(var a=-1,r=e.length,n=!1;++a<r;){var o=cy(e[a]);if(!(n=null!=t&&i(t,o)))break;t=t[o]}return n||++a!=r?n:!!(r=null==t?0:t.length)&&nj(r)&&n4(o,r)&&(nL(t)||nP(t))},cN=function(t,e){return null!=t&&cX(t,e,cV)},cq=function(t,e){return ct(t)&&cI(e)?cG(cy(t),e):function(i){var a=cU(i,t);return void 0===a&&a===e?cN(i,t):cw(e,a,3)}};var cW={},cY={};cY=function(t){return function(e){return null==e?void 0:e[t]}};var cK={};cK=function(t){return function(e){return h7(e,t)}},cW=function(t){return ct(t)?cY(cy(t)):cK(t)},cf=function(t){return"function"==typeof t?t:null==t?oi:"object"==typeof t?nL(t)?cq(t[0],t[1]):cg(t):cW(t)};var cJ={},c$={},cQ={};s=function(t,e){return t&&nm(t,e,o9)},c$=function(t,e){if(null==t)return t;if(!nO(t))return s(t,e);for(var i=t.length,a=l?i:-1,r=Object(t);(l?a--:++a<i)&&!1!==e(r[a],a,r););return t},cJ=function(t,e){var i=-1,a=nO(t)?Array(t.length):[];return c$(t,function(t,r,n){a[++i]=e(t,r,n)}),a};var cZ={};cZ=function(t,e){var i=t.length;for(t.sort(e);i--;)t[i]=t[i].value;return t};var c0={},c1={};c1=function(t,e){if(t!==e){var i=void 0!==t,a=null===t,r=t==t,n=ce(t),o=void 0!==e,s=null===e,l=e==e,h=ce(e);if(!s&&!h&&!n&&t>e||n&&o&&l&&!s&&!h||a&&o&&l||!i&&l||!r)return 1;if(!a&&!n&&!h&&t<e||h&&i&&r&&!a&&!n||s&&i&&r||!o&&r||!l)return -1}return 0},c0=function(t,e,i){for(var a=-1,r=t.criteria,n=e.criteria,o=r.length,s=i.length;++a<o;){var l=c1(r[a],n[a]);if(l){if(a>=s)return l;return l*("desc"==i[a]?-1:1)}}return t.index-e.index},h8=function(t,e,i){e=e.length?o7(e,function(t){return nL(t)?function(e){return h7(e,1===t.length?t[0]:t)}:t}):[oi];var a=-1;e=o7(e,nY(cf));var r=cJ(t,function(t,i,r){return{criteria:o7(e,function(e){return e(t)}),index:++a,value:t}});return cZ(r,function(t,e){return c0(t,e,i)})},h5=oe(function(t,e){if(null==t)return[];var i=e.length;return i>1&&oc(t,e[0],e[1])?e=[]:i>2&&oc(e[0],e[1],e[2])&&(e=[e[0]]),h8(t,h3(e,1),[])});var c2=(f("eC5G7"),f("eC5G7"));const c5=()=>{let t=[{initials:"SPL",score:3e4},{initials:"SPL",score:2e4},{initials:"SPL",score:1e4},{initials:"SPL",score:5e3},{initials:"SPL",score:2500},{initials:"SPL",score:1500},{initials:"SPL",score:1e3},{initials:"SPL",score:5e3},{initials:"SPL",score:2e3},{initials:"SPL",score:1500}].concat((()=>{let t=localStorage.getItem("SPDLZR");if(!t)return[];let e=t.slice(0,20),i=t.slice(20),a=u(c2).AES.decrypt(i,e).toString(u(c2).enc.Utf8);return a.length>1?JSON.parse(a):[]})());return u(h5)(t,"score").reverse()};v.defineScene("GameOver",async({gameCompleted:t=!1,score:e=0,checkpoint:i=null}={})=>{v.background("#000"),v.viewport.x=0,v.viewport.y=0;let a=v.viewport.width,r=v.viewport.height;console.log("checkpoint: ",i),v.e("2D, DOM, Text").attr({x:0,y:.2*r,w:a}).text(t?"Gefeliciteerd!":"Game Over").textColor("#FF0000").textAlign("center").textFont({size:"50px",weight:"bold",family:"Press Start 2P"});let n=[],o=u(hn)(c5()),s=t=>async()=>{let e=null;for(let i=0;i<o.length;i++)o[i].player===t.player&&(e=i);let i=`${t.name}: ${t.points}`;if(e<10){let t=(()=>{switch(e){case 0:return"ACE";case 1:return"2nd";case 2:return"3rd";default:return`${e+1}th`}})();i+=` - ${t}`}if(v.e("2D, DOM, Text").attr({x:0,y:.45*r+45*t.index,w:a}).text(i).textColor(t.color).textAlign("center").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),e>=10)return;let n=v.e("2D, DOM, Text").attr({x:.25*a,y:.45*r+(t.index+1)*45,w:a}).text("Enter name: ").textColor(t.color).textAlign("left").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),s=v.e("TextInput").attr({x:.6*a,y:.45*r+(t.index+1)*45,w:a}).textColor(t.color).textAlign("left").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),l=await s.textInput(t.player,3),h=function(){let t=localStorage.getItem("SPDLZR");if(!t)return[];let e=t.slice(0,20),i=t.slice(20),a=u(c2).AES.decrypt(i,e).toString(u(c2).enc.Utf8);return a.length>1?JSON.parse(a):[]}();h.push({initials:l,score:t.points,time:new Date().getTime()});let c=JSON.stringify(h),d=u(c2).AES.encrypt(c,"secret").toString().slice(8,28),p=u(c2).AES.encrypt(c,d).toString();localStorage.setItem("SPDLZR",d+p),n.destroy(),s.destroy()};v("Player ControlScheme").each(function(t){o.push({initials:null,player:this,score:e}),n.push(s({index:t,name:this.name,points:e,player:this,color:this.color()}))}),o=u(h5)(o,"score").reverse(),await n.reduce((t,e)=>t.then(e),Promise.resolve()),v.e("Delay").delay(function(){if(t)this.delay(()=>v.enterScene("Scores"),5e3);else{let t=10;v.e("2D, DOM, Text").attr({x:0,y:.8*r,w:a}).textColor("#FF0000").textAlign("center").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}).text("Continue at last checkpoint?");let e=v.e("2D, DOM, Text").attr({x:0,y:.8*r+30,w:a}).textColor("#FF0000").textAlign("center").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}),n="Press fire to continue";e.text(`${n} ${`00${t}`.slice(-2)}`),this.delay(function(){t-=1,e.text(`${n} ${`00${t}`.slice(-2)}`)},1e3,t,()=>v.enterScene("Scores")),v("Player").each(function(){this.reset(),this.one("Activated",()=>v.enterScene("Game",{start:i,tags:u(tM).tags}))})}},1e3,0)},()=>{v("Delay").each(function(){this.destroy()}),v("Player").each(function(){this.unbind("Activated")})}),v.defineScene("Intro",async()=>{v.background("#000000"),v.viewport.x=0,v.viewport.y=0,await oK(["mega-texture"]);let t=v.viewport.width,e=v.viewport.height;sF(rn("title.Intro"),{}),v.e("2D, DOM, Text, Tween, Delay").attr({x:.35*t,y:.1*e,w:400}).text("Sintlazer").textColor("#ff0000").textFont({size:"40px",weight:"bold",family:"Press Start 2P"}).delay(function(){this.tween({x:.65*t-400},2e3),this.one("TweenEnd",function(){this.tween({x:.35*t},2e3)})},4e3,-1),v.e("2D, DOM, Text, Tween, Delay").attr({x:.5*t-150,y:.7*e,w:300}).text("Press fire to start!").textColor("#FFFFFF").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}).delay(function(){this.tween({alpha:.5},1e3),this.one("TweenEnd",function(){this.tween({alpha:1},1e3)})},2e3,-1);let i=c5()[0];v.e("2D, DOM, Text").attr({x:0,y:.85*e,w:t}).text(`HI SCORE: ${i.score} ${i.initials}`).textColor("#FFFF00").textAlign("center").textFont({size:"10px",weight:"bold",family:"Press Start 2P"});let a=v.e("2D, DOM, Text").attr({x:0,y:.95*e,w:t}).text("").textColor("#303030").textAlign("center").textFont({size:"10px",weight:"bold",family:"Press Start 2P"});window.addEventListener("gamepadconnected",()=>{a.text("Gamepad detected!")}),Array.from(window.navigator.getGamepads()).some(t=>t&&t.connected)&&a.text("Gamepad detected!"),v(ha).each(function(){this.reset(),this.one("Activated",()=>v.enterScene("Game",{tags:u(tM).tags}))}),v.e("Delay").delay(()=>v.enterScene("Scores"),2e4)},()=>{v("Delay").each(function(){this.destroy()}),v(ha).each(function(){this.unbind("Activated")})});const c3=t=>{switch(t){case 0:return"ACE";case 1:return"2nd";case 2:return"3rd";default:return`${t+1}th`}},c4=t=>{switch(t){case 0:return"20px";case 1:case 2:return"18px";default:return"15px"}};v.defineScene("Scores",function(){v.background("#000000"),v.viewport.x=0,v.viewport.y=0;let t=v.viewport.width,e=v.viewport.height;v.e("2D, DOM, Text").attr({x:0,y:.1*e,w:t}).text("Highscores").textColor("#FF0000").textAlign("center").textFont({size:"40px",weight:"bold",family:"Press Start 2P"});let i=c5(),a=0;v.e("Delay").delay(function(){let r=i[a];if(r){let i=c3(a),n=c4(a);v.e("2D, DOM, Text").attr({x:0,y:.25*e+36*a,w:t}).text(`${i}  ${r.score} ${r.initials}`).textColor("#FFFF00").textAlign("center").textFont({size:n,weight:"bold",family:"Press Start 2P"}),a+=1}},500,9),v("Player").each(function(){this.reset(),this.one("Activated",()=>v.enterScene("Game",{tags:u(tM).tags}))}),v.e("Delay").delay(()=>v.enterScene("Credits"),2e4)},function(){return v("Delay").each(function(){this.destroy()}),v("Player").each(function(){this.unbind("Activated")})});const c6=[["Designed by",["Matthijs Groen"]],["Programming",["Matthijs Groen"]],["Graphics",["Matthijs Groen","& Midjourney"]],["Music",["Some Midis"]],["Testing",["Matthijs Groen"]]];v.defineScene("Credits",function(){v.background("#000000"),v.viewport.x=0,v.viewport.y=0;let t=v.viewport.width,e=v.viewport.height,i=0;v.e("2D, DOM, Text, CreditTask").attr({x:0,y:.4*e,w:t}).textColor("#FF0000").textAlign("center").textFont({size:"30px",weight:"bold",family:"Press Start 2P"}),v.e("2D, DOM, Text, CreditNames").attr({x:0,y:.5*e,w:t,h:300}).textColor("#FFFF00").textAlign("center").textFont({size:"20px",weight:"bold",family:"Press Start 2P"});let a=c6[i][0],r=c6[i][1];v("CreditTask").text(a),v("CreditNames").text(r.join("\n")),v.e("Delay").delay(()=>{let t=c6[i+=1][0],e=c6[i][1];v("CreditTask").text(t),v("CreditNames").text(e.join("\n"))},1500,c6.length-2),v("Player").each(function(){this.reset(),this.one("Activated",()=>v.enterScene("Game",{tags:u(tM).tags}))}),v.e("Delay").delay(()=>v.enterScene("Intro"),1500*c6.length)},function(){return v("Delay").each(function(){this.destroy()}),v("Player").each(function(){this.unbind("Activated")})});const c8="AnalogKeyboardControls";v.c(c8,{init(){this._player=null,this.requires(ou),this.bind("RemoveComponent",t=>{t===od&&this.removeComponent(c8)})},remove(){this.unbind("KeyDown",this._keyHandling)},setupControls(t){this._player=t,t.addComponent(od),t.assignControls=t=>{this.assignControls(t)}},controls(t){return this.controlMap=t,this.uniqueBind("KeyDown",this._keyHandling),this},_keyHandling(t){this.controlMap.pause.some(e=>e===t.key)&&tX(),this.controlMap.fire.some(e=>e===t.key)&&(this.trigger("Fire",t),this._player&&this._player.trigger("Fire",t)),this.controlMap.up.some(e=>e===t.key)&&(this.trigger("Up",t),this._player&&this._player.trigger("Up",t)),this.controlMap.down.some(e=>e===t.key)&&(this.trigger("Down",t),this._player&&this._player.trigger("Down",t)),this.controlMap.left.some(e=>e===t.key)&&(this.trigger("Left",t),this._player&&this._player.trigger("Left",t)),this.controlMap.right.some(e=>e===t.key)&&(this.trigger("Right",t),this._player&&this._player.trigger("Right",t))},assignControls(t){if(t.hasPlayerControls)return;let{controlMap:e}=this,i=0,a=0,r={up:!1,down:!1,left:!1,right:!1};t.hasPlayerControls=!0,t.addComponent("Motion").bind("GamePause",function(t){t?(r={up:!1,down:!1,left:!1,right:!1},this.disabledBeforePause=this.disableControls,this.disableControl()):this.disabledBeforePause||this.enableControl()}).bind("Move",function(){let t=500*i;(this.vy<t&&t<=0&&this.ay<0||this.vy>t&&t>=0&&this.ay>0)&&(this.vy=t,this.ay=0);let e=700*a;(this.vx<e&&e<=0&&this.ax<0||this.vx>e&&e>=0&&this.ax>0)&&(this.vx=e,this.ax=0)}),t.controlName=(t,e=!1)=>{let i=this.controlMap[t].map(t=>{switch(t){case v.keys.SPACE:return"spacebar";case v.keys.SHIFT:return"shift"}return`${String.fromCharCode(t)}${e?"":" key"}`});return e?i[0]:i.join(" or ")},t.disableControls=!1,t.prevSets={ax:t.ax,ay:t.ay,vx:t.vx,vy:t.vy},t.disableControl=function(){!0!==this.disableControls&&(this.disableControls=!0,this.prevSets={ax:this.ax,ay:this.ay,vx:this.vx,vy:this.vy},this.ax=0,this.ay=0,this.vx=0,this.vy=0,a=0,i=0)},t.enableControl=function(){!1!==this.disableControls&&(this.disableControls=!1,this.ax=this.prevSets.ax,this.ay=this.prevSets.ay,this.vx=this.prevSets.vx,this.vy=this.prevSets.vy)};let n=()=>{i=0,r.up&&(i-=1),r.down&&(i+=1),i=Math.min(1,Math.max(-1,i)),t.ay+=3e3*i,t.vy>0&&0===t.ay&&(t.ay-=6e3),t.vy<0&&0===t.ay&&(t.ay+=6e3),a=0,r.left&&(a-=1),r.right&&(a+=1),a=Math.min(1,Math.max(-1,a)),t.ax+=4200*a,t.vx>0&&0===t.ax&&(t.ax-=8400),t.vx<0&&0===t.ax&&(t.ax+=8400)};this.listenTo(t,"KeyDown",function(i){t.disableControls||(Object.entries(e).forEach(([e,a])=>{a.some(t=>t===i.key)&&t.buttonPressed(e,!0)}),e.up.some(t=>t===i.key)&&(r.up=!0),e.down.some(t=>t===i.key)&&(r.down=!0),e.left.some(t=>t===i.key)&&(r.left=!0),e.right.some(t=>t===i.key)&&(r.right=!0),n())}),this.listenTo(t,"KeyUp",function(i){t.disableControls||(Object.entries(e).forEach(([e,a])=>{a.some(t=>t===i.key)&&t.buttonPressed(e,!1)}),e.up.some(t=>t===i.key)&&(r.up=!1),e.down.some(t=>t===i.key)&&(r.down=!1),e.left.some(t=>t===i.key)&&(r.left=!1),e.right.some(t=>t===i.key)&&(r.right=!1),n())})}});const c7="Gamepad";v.c(c7,{_gpEnterFrame:function(){var t=this._getGamepad(this._gamepadIndex);t&&t.timestamp!==this._timestamp&&(this._timestamp=t.timestamp,this._emitGamepadEvents(t))},_emitGamepadEvents:function(t){for(var e=0;e<t.buttons.length;e++)(void 0!==this._buttonsState[e]&&this._buttonsState[e]!==t.buttons[e].value||void 0===this._buttonsState[e]&&0!==t.buttons[e].value)&&this.trigger("GamepadKeyChange",{button:e,value:t.buttons[e].value,pressed:t.buttons[e].pressed}),this._buttonsState[e]=t.buttons[e].value;for(var i=0;i<t.axes.length;i++)(void 0!==this._axesState[i]&&this._axesState[i]!==t.axes[i]||void 0===this._axesState[i]&&0!==t.axes[i])&&this.trigger("GamepadAxisChange",{axis:i,value:t.axes[i]})},_getGamepad:function(){var t=null,e=navigator.getGamepads||navigator.webkitGetGamepads;return e&&(t=e.apply(navigator)[this._gamepadIndex]),t},gamepad:function(t){return this._gamepadIndex=t||0,this._timestamp=0,this._buttonsState=[],this._axesState=[],this.bind("EnterFrame",this._gpEnterFrame),this}}),v.c("GamepadMultiway",{_AXIS_THRESHOLD:.75,_AXIS_ANALOG_THRESHOLD:.12,_BUTTONS_DIRECTION:{12:-90,13:90,14:180,15:0},_AXES_DIRECTION:{0:[180,0],1:[-90,90],2:[180,0],3:[-90,90]},init:function(){this.requires("Motion, Gamepad")},_gamepadKeyChange:function(t){!this.disableControls&&t.button in this._BUTTONS_DIRECTION&&(1===t.value&&-1===this._buttonsPressed.indexOf(t.button)?(this.vx=Math.round((this.vx+this._buttons[t.button].x)*1e3)/1e3,this.vy=Math.round((this.vy+this._buttons[t.button].y)*1e3)/1e3,this._buttonsPressed.push(t.button)):0===t.value&&-1!==this._buttonsPressed.indexOf(t.button)&&(this.vx=Math.round((this.vx-this._buttons[t.button].x)*1e3)/1e3,this.vy=Math.round((this.vy-this._buttons[t.button].y)*1e3)/1e3,this._buttonsPressed.splice(this._buttonsPressed.indexOf(t.button),1)))},_gamepadAxisChange:function(t){!this.disableControls&&t.axis in this._AXES_DIRECTION&&(this._analogControl?this._analogHandling(t):this._digitalHandling(t))},_digitalHandling:function(t){if(t.value<=-this._AXIS_THRESHOLD||t.value>=this._AXIS_THRESHOLD){var e=t.value<0?0:1,i=t.axis+":"+e;-1===this._axesPressed.indexOf(i)&&(this.vx=Math.round((this.vx+this._axes[t.axis][e].x)*1e3)/1e3,this.vy=Math.round((this.vy+this._axes[t.axis][e].y)*1e3)/1e3,this._axesPressed.push(i))}else for(var a=0;a<this._axesPressed.length;a++){var r=this._axesPressed[a];if(parseInt(r.substr(0,1),10)===t.axis){var n=r.split(":");this.vx=Math.round((this.vx-this._axes[t.axis][parseInt(n[1],10)].x)*1e3)/1e3,this.vy=Math.round((this.vy-this._axes[t.axis][parseInt(n[1],10)].y)*1e3)/1e3,this._axesPressed.splice(this._axesPressed.indexOf(r),1)}}},_analogHandling:function(t){t.value<=-this._AXIS_ANALOG_THRESHOLD||t.value>=this._AXIS_ANALOG_THRESHOLD?(0===t.axis&&(this.vx=t.value*this._speed.x),1===t.axis&&(this.vy=t.value*this._speed.y)):(0===t.axis&&(this.vx=0),1===t.axis&&(this.vy=0))},_calcSpeed:function(t){for(var e in this._BUTTONS_DIRECTION)this._buttons[e]={x:Math.round(1e3*Math.cos(this._BUTTONS_DIRECTION[e]*(Math.PI/180))*t.x)/1e3,y:Math.round(1e3*Math.sin(this._BUTTONS_DIRECTION[e]*(Math.PI/180))*t.y)/1e3};for(var i in this._AXES_DIRECTION)this._axes[i]=[],this._axes[i][0]={x:Math.round(1e3*Math.cos(this._AXES_DIRECTION[i][0]*(Math.PI/180))*t.x)/1e3,y:Math.round(1e3*Math.sin(this._AXES_DIRECTION[i][0]*(Math.PI/180))*t.y)/1e3},this._axes[i][1]={x:Math.round(1e3*Math.cos(this._AXES_DIRECTION[i][1]*(Math.PI/180))*t.x)/1e3,y:Math.round(1e3*Math.sin(this._AXES_DIRECTION[i][1]*(Math.PI/180))*t.y)/1e3}},gamepadMultiway:function(t){return t=t||{},this.requires("Gamepad"),this.gamepad(t.gamepadIndex||0),this._speed={x:150,y:150},this._buttons={},this._buttonsPressed=[],this._axes={},this._axesPressed=[],this._speedOnAxes={},this._analogControl=t.analog,t.speed&&(t.speed.x&&t.speed.y?(this._speed.x=t.speed.x,this._speed.y=t.speed.y):(this._speed.x=t.speed,this._speed.y=t.speed)),this._calcSpeed(this._speed),this.bind("GamepadKeyChange",this._gamepadKeyChange),this.bind("GamepadAxisChange",this._gamepadAxisChange),this},enableControl:function(){return this.disableControls=!1,void 0!==this.disabledVelocities&&(this.vx=this.disabledVelocities.x,this.vy=this.disabledVelocities.y),this.disabledVelocities=void 0,this},disableControl:function(){return this.disableControls=!0,this.disabledVelocities={x:this.vx,y:this.vy},this.vx=0,this.vy=0,this}});const c9="GamepadControls",ut=["â button","â¯ button","â¡ button","â³ button","Left shoulder button (L1)","Right shoulder button (R1)","Left trigger (L2)","Right trigger (R2)","Share button","Option button","Left stick (L3)","Right stick (R3)","D-pad up button","D-pad down button","D-pad left button","D-pad right button","Playstation button","touchpad"],ue=["â","â¯","â¡","â³","L1","R1","L2","R2","Share button","Option button","L3","R3","D-pad up","D-pad down","D-pad left","D-pad right","Playstation","touchpad"],ui=["a button","b button","x button","y button","Left bumper (LB)","Right bumper (RB)","Left trigger (LT)","Right trigger (RT)","Select button","Start button","Left stick (L)","Right stick (R)","D-pad up button","D-pad down button","D-pad left button","D-pad right button"],ua=["a","b","x","y","LB","RB","LT","RT","Select button","Start button","L","R","D-pad up","D-pad down","D-pad left","D-pad right"];v.c(c9,{init(){this.requires(ou),this.bind("RemoveComponent",function(t){t===od&&this.removeComponent(c9)}),this.emits={}},remove(){this.unbind("GamepadKeyChange",this._keyHandling)},setupControls(t){this._player=t,t.addComponent(od),t.assignControls=t=>{this.assignControls(t)}},controls(t){if(this.controlMap=t,null!=t.gamepadIndex)return this.requires(c7),this.gamepad(t.gamepadIndex),this.bind("GamepadKeyChange",this._keyHandling),this.bind("GamepadAxisChange",this._stickHandling),this},_stickHandling(t){let e;1===t.axis&&(e="vertical",t.value<-.5?this._startEmit(e,"Up"):t.value>.5?this._startEmit(e,"Down"):this._stopEmit(e)),0===t.axis&&(e="horizontal",t.value<-.5?this._startEmit(e,"Left"):t.value>.5?this._startEmit(e,"Right"):this._stopEmit(e))},_startEmit(t,e){(this.emits[t]&&this.emits[t].value)!==e&&(this._stopEmit(t),this.trigger(e),this._player&&this._player.trigger(e),this.emits[t]={interval:setInterval(()=>{this.trigger(e),this._player&&this._player.trigger(e)},200),value:e})},_stopEmit(t){return clearInterval(this.emits[t]&&this.emits[t].interval),delete this.emits[t]},_keyHandling(t){!(this.lastPressed&&this.lastPressed.getTime()>new Date().getTime()-200)&&(this.lastPressed=new Date,t.button===this.controlMap.pause&&t.pressed&&tX(),t.button===this.controlMap.fire&&t.pressed&&(this.trigger("Fire",t),this._player&&this._player.trigger("Fire",t)),t.button===this.controlMap.up&&t.pressed&&(this.trigger("Up",t),this._player&&this._player.trigger("Up",t)),t.button===this.controlMap.down&&t.pressed&&(this.trigger("Down",t),this._player&&this._player.trigger("Down",t)),t.button===this.controlMap.left&&t.pressed&&(this.trigger("Left",t),this._player&&this._player.trigger("Left",t)),t.button===this.controlMap.right&&t.pressed&&(this.trigger("Right",t),this._player&&this._player.trigger("Right",t)))},assignControls(t){if(t.hasPlayerControls)return;t.hasPlayerControls=!0,t.addComponent("GamepadMultiway").gamepadMultiway({speed:{y:550,x:750},gamepadIndex:this.controlMap.gamepadIndex,analog:!0}).bind("GamePause",function(t){t?(this.disabledBeforePause=this.disableControls,this.disableControl()):this.disabledBeforePause||this.enableControl()});let e=this._getGamepad(),i=["sony","dualshock","playstation","sixaxis","ps3","ps3","ps(r)"].some(t=>-1!==e.id.toLowerCase().indexOf(t)),a=["xbox","x-box"].some(t=>-1!==e.id.toLowerCase().indexOf(t));console.log(i?"Playstation controller":a?"XBox controller":`Generic controller ${e.id}`),t.controlName=(t,e=!1)=>{let r=this._getGamepad(),n=this.controlMap[t];if(r.id){if(i)return(e?ue:ut)[n];if(a)return(e?ua:ui)[n]}let o="1st";switch(n){case 0:o="1st";break;case 1:o="2nd";break;case 2:o="3rd";break;default:o=`${n+1}th`}return`${o}${e?"":" button"}`},this.listenTo(t,"GamepadKeyChange",e=>{Object.entries(this.controlMap).forEach(([i,a])=>{a===e.button&&t.buttonPressed(i,e.pressed)})})}});const ur="PlayerAssignable";v.c(ur,{init(){this._attachControllerAssignTrigger(),this.preferredPlayer=null},_assignControls(){let t=this._preferredPlayer()||this._firstUnassignedPlayer();if(null==t){this._attachControllerAssignTrigger();return}this.preferredPlayer=t.getId(),this.setupControls(t),t.one("Deactivated",()=>{this._attachControllerAssignTrigger()})},_attachControllerAssignTrigger(){this.one("Fire",this._assignControls)},_preferredPlayer(){if(null!==this.preferredPlayer){let t=v(this.preferredPlayer);if(!t.has(od))return t}},_firstUnassignedPlayer:()=>Array.from(v(ha)).map(t=>v(t)).find(t=>!t.has(od))});let un=0;v.uniqueBind("UpdateFrame",t=>{t.dt=t.dt*tC(),tV()||(un+=t.dt),t.inGameTime=un,0!==t.dt&&v.trigger("GameLoop",t)}),tU.setEffectVolume(l8("effectsVolume",.4)),tU.setMusicVolume(l8("musicVolume",.4)),tk(1),v.paths({images:"./"});const uo=document.getElementById("cr-stage");v.init(1024,576,uo),v.background("#000000"),v.timer.FPS(60),v.timer.steptype("variable"),v.createLayer("UILayerDOM","DOM",{scaleResponse:0,yResponse:0,xResponse:0,z:40}),v.createLayer("UILayerWebGL","WebGL",{scaleResponse:0,yResponse:0,xResponse:0,z:35}),v.e([ha,"Color"].join(", ")).attr({name:"Player 1",z:0,playerNumber:1}).setName("Player 1").color("#FF0000"),v.e([ha,"Color"].join(", ")).attr({name:"Player 1",z:0,playerNumber:1}).setName("Player 1").color("#FF0000"),v.e([c8,ur].join(", ")).controls({fire:[v.keys.SPACE],heavy:[v.keys.C,v.keys.SHIFT],switchWeapon:[v.keys.Z],shield:[v.keys.X],up:[v.keys.UP_ARROW,v.keys.W],down:[v.keys.DOWN_ARROW,v.keys.S],left:[v.keys.LEFT_ARROW,v.keys.A],right:[v.keys.RIGHT_ARROW,v.keys.D],power1:[v.keys["1"]],pause:[v.keys.P]}),v.e([c9,ur].join(", ")).controls({gamepadIndex:0,fire:0,heavy:1,switchWeapon:2,power1:4,pause:9,up:12,down:13,left:14,right:15}),v.enterScene("Intro");const us=()=>{let t=document.getElementById("cr-stage"),e=t.clientHeight,i=t.clientWidth,a=window.innerHeight-60,r=window.innerWidth,n=Math.min(a/e,r/i);t.style.transform=`scale(${n})`;let o=Math.max(0,(r-i*n)*.5);t.style.left=`${o}px`;let s=document.getElementsByTagName("footer")[0];s&&(s.style.top=`${576*n}px`)};window.addEventListener("resize",us),window.addEventListener("load",()=>{let t=document.getElementById("cr-stage");t.addEventListener("click",()=>{t.focus()})});const ul=document.querySelector("button");ul&&ul.addEventListener("click",()=>{document.getElementById("theater").requestFullscreen(),document.body.classList.add("fullscreen"),us(),document.addEventListener("fullscreenchange",()=>{document.fullscreenElement||(document.body.classList.remove("fullscreen"),us())})}),setTimeout(us,0);
//# sourceMappingURL=index.f8bb2aa0.js.map
